(function(){(this||window).webpackJsonp.registerAbsMids({"esri/widgets/Feature":602,"esri/layers/graphics/OptimizedGeometry":612,"esri/tasks/operations/urlUtils":617,"esri/tasks/Task":618,"esri/layers/graphics/OptimizedFeature":619,"esri/geometry/support/quantizationUtils":620,"esri/layers/graphics/OptimizedFeatureSet":628,"esri/tasks/operations/query":640,"esri/tasks/operations/queryAttachments":661,"esri/tasks/QueryTask":671,"esri/tasks/operations/queryRelatedRecords":672,"esri/core/throttle":827,"esri/widgets/Feature/support/featureUtils":971,"dojo/i18n!esri/widgets/Feature/nls/Feature":1403,"esri/widgets/Feature/nls/Feature":1404,"esri/widgets/Feature/FeatureViewModel":1405,"esri/widgets/Feature/support/RelatedFeatures":1406,"esri/widgets/Feature/support/attachmentUtils":1407,"esri/widgets/support/chartUtils":1408,"esri/widgets/support/uriUtils":1409,"dojo/i18n!esri/widgets/support/nls/uriUtils":1410,"esri/widgets/support/nls/uriUtils":1411})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[57,77,80,85],{1403:function(e,t,r){var i,n;i=[r(60),r(62),r(1404)],void 0===(n=function(e,t){return t(e,"esri/widgets/Feature/nls/Feature",r.dj.c(),!1)}.apply(null,i))||(e.exports=n)},1404:function(e,t,r){e.exports={root:{attach:"Attachments",fields:"Fields",fieldsSummary:"List of attributes and values",media:"Media",next:"Next",noTitle:"Untitled",previous:"Previous",lastEdited:"Last edited on {date}.",lastCreated:"Created on {date}.",lastEditedByUser:"Last edited by {user} on {date}.",lastCreatedByUser:"Created by {user} on {date}."},ar:!1,bs:!1,ca:!1,cs:!1,da:!1,de:!1,el:!1,es:!1,et:!1,fi:!1,fr:!1,hr:!1,hu:!1,he:!1,hi:!1,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,nb:!1,pl:!1,"pt-br":!1,"pt-pt":!1,ro:!1,ru:!1,sl:!1,sr:!1,sv:!1,th:!1,tr:!1,uk:!1,vi:!1,"zh-cn":!1,"zh-hk":!1,"zh-tw":!1}},1405:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(7),r(6),r(8),r(67),r(193),r(46),r(11),r(21),r(5),r(9),r(4),r(827),r(14),r(2),r(104),r(133),r(35),r(199),r(329),r(198),r(291),r(971),r(1406),r(44)],void 0===(n=function(e,t,i,n,a,o,s,l,u,p,d,c,f,h,y,m,v,_,g,b,x,I,F,w,T,A,M,R){function O(){return s(this,void 0,void 0,(function(){return o(this,(function(e){return[2,y.create((function(e){Promise.all([r.e(7),r.e(10)]).then((function(){var t=[r(583)];(function(t){e(t)}).apply(null,t)})).catch(r.oe)}))]}))}))}function C(e){return"string"==typeof e?e.replace(/(\n)/gi,'<br class="esri-text-new-line" />'):e}function N(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function E(e){return(""+e).trim()}function k(e){return e.replace(/[\u00A0-\u9999<>\&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}))}var S=["$datastore","$map","$layer"],j=h.getLogger("esri.widgets.FeatureViewModel"),P=/^\s*expression\//i,L=g.convertDateFormatToIntlOptions("short-date-short-time");return function(e){function t(t){var r=e.call(this)||this;return r._handles=new c,r._featureAbortController=null,r._graphicChangedThrottled=m.throttle(r._graphicChanged,1,r),r._effectivePopupTemplate=null,r._contentResponse=null,r._graphic=null,r.content=null,r.defaultPopupTemplateEnabled=!1,r.formattedAttributes=null,r.graphic=null,r.lastEditInfo=null,r.title="",r.view=null,r._handles.add(v.init(r,["graphic","graphic.sourceLayer.popupTemplate.title","graphic.sourceLayer.popupTemplate.content","graphic.sourceLayer.popupTemplate.fieldInfos","graphic.sourceLayer.popupTemplate.lastEditInfoEnabled","graphic.popupTemplate.title","graphic.popupTemplate.content","graphic.popupTemplate.fieldInfos","graphic.popupTemplate.lastEditInfoEnabled"],(function(){return r._graphicChangedThrottled()}))),r}return i(t,e),t.prototype.destroy=function(){this._clear(),this._cancelFeatureQuery(),this._handles.destroy(),this._handles=null,this.graphic=null,this._graphic=null},Object.defineProperty(t.prototype,"spatialReference",{get:function(){return this.get("view.spatialReference")||null},set:function(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"map",{get:function(){return this.get("view.map")||null},set:function(e){void 0!==e?this._override("map",e):this._clearOverride("map")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"waitingForContent",{get:function(){return!!this._featureAbortController},enumerable:!0,configurable:!0}),t.prototype._clear=function(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)},t.prototype._graphicChanged=function(){return s(this,void 0,void 0,(function(){var e,t,r,i;return o(this,(function(n){switch(n.label){case 0:if(this._cancelFeatureQuery(),this._clear(),e=this.graphic,t=e?e.clone():null,this._graphic=t,!t)return[2];r=y.createAbortController(),this._featureAbortController=r,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._queryFeature({signal:r.signal})];case 2:return n.sent(),[3,4];case 3:return i=n.sent(),j.error("error","error loading template",i),[3,4];case 4:return this._featureAbortController=null,[2]}}))}))},t.prototype._cancelFeatureQuery=function(){var e=this._featureAbortController;e&&e.abort(),this._featureAbortController=null},t.prototype._compileContent=function(e,t){var r=this;return e&&(e.nodeName||e&&R.isWidgetBase(e)||R.isWidget(e))?e:this._graphic?"string"==typeof e?this._compileText(new I({text:e})).text:Array.isArray(e)?e.map((function(e,i){var n=t&&t[i],a=n&&n.value;return"attachments"===e.type?r._compileAttachments(e,a):"fields"===e.type?r._compileFields(e):"media"===e.type?r._compileMedia(e):"text"===e.type?r._compileText(e):void 0})):void(e&&j.warn("invalid content type.")):void 0},t.prototype._compileFields=function(e){var t=this,r=this._effectivePopupTemplate,i=f.clone(e),n=r&&r.expressionInfos,a=i.fieldInfos?void 0:r&&r.fieldInfos,o=i.fieldInfos||f.clone(a),s=[];return o&&o.forEach((function(e){var r=e.fieldName.toLowerCase();if(!e.hasOwnProperty("visible")||e.visible){var i=t._isExpressionField(r)?t._getExpressionInfo(n,r):null;e.label=i?i.title:e.label,s.push(e)}})),i.fieldInfos=s,i},t.prototype._setImageValue=function(e){var t=e.value,r=e.formattedAttributes,i=e.layer,n=t.linkURL,a=t.sourceURL;if(a){var o=this._fixTokens(a,i);t.sourceURL=this._substituteAttributes(r,o)}if(n){var s=this._fixTokens(n,i);t.linkURL=this._substituteAttributes(r,s)}},t.prototype._compileMedia=function(e){var t=this,r=this._graphic,i=f.clone(e),n=i.mediaInfos,a=r.attributes,o=A.getSourceLayer(r),s=this.formattedAttributes.global;return i.mediaInfos=n&&n.map((function(e){var r=f.clone(e);if(r){var i=r.title?t._processFieldsInLinks(r.title,a):"",n=r.caption?t._processFieldsInLinks(r.caption,a):"";if(r.title=i?t._substituteAttributes(s,i):"",r.caption=n?t._substituteAttributes(s,n):"","image"===r.type){var l=r.value;return t._setImageValue({value:l,formattedAttributes:s,layer:o}),r.value.sourceURL?r:void 0}if("pie-chart"===r.type||"line-chart"===r.type||"column-chart"===r.type||"bar-chart"===r.type){l=r.value;return t._setChartValue({value:l,attributes:a,formattedAttributes:s,layer:o}),r}}})).filter(Boolean),i},t.prototype._substituteAttributes=function(e,t){return E(this._removeEmptyHref(u.substitute(t,e)))},t.prototype._compileText=function(e){var t=f.clone(e);if(t&&t.text){var r=this._graphic.attributes,i=this.formattedAttributes.global,n=this._processFieldsInLinks(t.text,r);t.text=this._substituteAttributes(i,n)}return t},t.prototype._formatEditInfo=function(e,t){var r=e.creatorField,i=e.creationDateField,n=e.editorField,a=e.editDateField;if(t){var o=t[a];if("number"==typeof o){var s=t[n];return{type:"edit",date:u.formatDate(o,L),user:s}}var l=t[i];if("number"==typeof l){var p=t[r];return{type:"create",date:u.formatDate(l,L),user:p}}}},t.prototype._compileLastEditInfo=function(){var e=this._effectivePopupTemplate,t=this._graphic;if(e){var r=e.lastEditInfoEnabled,i=t.get("sourceLayer.editFieldsInfo");if(r&&i)return this._formatEditInfo(i,t.attributes)}},t.prototype._compileTitle=function(){var e=this._effectivePopupTemplate,t=this._graphic,r=e&&e.title,i=t.attributes,n=this.formattedAttributes.global,a="function"==typeof r?r.call(null,{graphic:t}):r;if("string"==typeof a&&a){var o=this._processFieldsInLinks(a,i);return this._substituteAttributes(n,o)}return""},t.prototype._getExpressionInfo=function(e,t){if(this._isExpressionField(t)){var r,i=t.replace(P,"").toLowerCase();return e.some((function(e){return e.name.toLowerCase()===i&&(r=e,!0)})),r}},t.prototype._fixTokens=function(e,t){return e.replace(/(\{([^\{\r\n]+)\})/g,(function(e,r,i){var n=N(t,i);return n?"{"+n.name+"}":r}))},t.prototype._encodeAttributes=function(e){var t=e?f.clone(e):{};return Object.keys(t).forEach((function(e){return function(e,t){var r=t[e];if("string"==typeof r){var i=encodeURIComponent(r).replace(/\'/g,"&apos;");t[e]=i}}(e,t)})),t},t.prototype._createfieldInfoMap=function(e,t){var r=this,i=new Map;return e&&e.forEach((function(e){var n=r._getFixedFieldName(e.fieldName,t);e.fieldName=n,i.set(n.toLowerCase(),e)})),i},t.prototype._formatAttributeValue=function(e){var t=e.value,r=e.fieldName,i=e.fieldInfos,n=e.fieldInfoMap,a=e.layer;if(null==t)return t;var o=this._getDomainName(r,t);if(o)return o;var s=this._getTypeName(r);if(s)return s;if(n.get(r.toLowerCase()))return this._formatValueToFieldInfo(t,{fieldInfos:i,fieldName:r,layer:a});var l=a&&a.fieldsIndex;return l&&l.isDateField(r)?u.formatDate(t,L):C(t)},t.prototype._formatAttributes=function(e){var t=this,r=this._graphic,i=A.getSourceLayer(r),n=f.clone(r.attributes);this.addRelatedFeatureAttributes(n);var a=this._createfieldInfoMap(e,i);return Object.keys(n).forEach((function(r){var o=n[r];n[r]=t._formatAttributeValue({fieldName:r,fieldInfos:e,fieldInfoMap:a,layer:i,value:o})})),n},t.prototype._formatValueToFieldInfo=function(e,t){var r=t.fieldInfos,i=t.fieldName,n=this._getFieldInfo(r,i),o=f.clone(n),s=t.preventPlacesFormatting,l=N(t.layer,i);if(l&&"date"===l.type){var u=o.format||new w;u.dateFormat=u.dateFormat||"short-date-short-time",o.format=u}var p=o&&o.format;return"string"==typeof e||null==e||null==p?e:s?b.formatNumber(e,a({},b.convertNumberFormatToIntlOptions(p),{minimumFractionDigits:0,maximumFractionDigits:20})):p.format(e)},t.prototype._getDomainName=function(e,t){if(this.isRelatedField(e))return null;var r=this._graphic,i=A.getSourceLayer(r);if(!i||"function"!=typeof i.getFieldDomain)return null;var n=i.getFieldDomain(e,{feature:r});return n&&"coded-value"===n.type?n.getName(t):null},t.prototype._getFieldInfo=function(e,t){if(e&&e.length&&t){var r=t.toLowerCase(),i=void 0;return e.some((function(e){return!(!e.fieldName||e.fieldName.toLowerCase()!==r||(i=e,0))})),i}},t.prototype._getTypeName=function(e){if(this.isRelatedField(e))return null;var t=this._graphic,r=A.getSourceLayer(t);if(!r||"function"!=typeof r.getFeatureType)return null;var i=r.typeIdField;if(!i||e!==i)return null;var n=r.getFeatureType(t);return n?n.name:null},t.prototype._removeEmptyHref=function(e){return e.replace(/href=(""|'')/gi,"")},t.prototype._processFieldsInLinks=function(e,t){var r=this.get("_graphic.layer"),i=this._fixTokens(e,r),n=this._encodeAttributes(t);return i?i.replace(/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,(function(e,r,i){return function(e,t,r,i){return t=E(t),u.substitute(e,t&&"{"===t[0]?r:i)}(e,r||i,t,n)})):i},t.prototype._compileAttachments=function(e,t){var r=f.clone(e);return!t||t&&0===t.length?r:(r.attachmentInfos=t,r)},t.prototype._queryAttachments=function(){var e=this._graphic,t=A.getSourceLayer(e);if(!t)return y.resolve([]);var r="scene"===t.type&&t.associatedLayer?t.associatedLayer:t;if(r&&"function"==typeof r.queryAttachments){var i=r,n=i.objectIdField,a=e.attributes,o=a&&a[n],s=new T({objectIds:[o],returnMetadata:!0});return i.queryAttachments(s).then((function(e){return e[o]||[]}))}return y.resolve([])},t.prototype._queryContentElements=function(e){var t=this;if(!Array.isArray(e))return y.resolve();var r={};return e.forEach((function(e,i){if("attachments"===e.type){var n=t._queryAttachments();n&&(r[i]=n)}})),Object.keys(r).length?y.eachAlways(r):y.resolve()},t.prototype._getContent=function(){var e=this._effectivePopupTemplate,t=this._graphic,r=e&&e.content,i="function"==typeof r?r.call(null,{graphic:t}):r;return y.isThenable(i)?i:y.resolve(i)},t.prototype._querySourceLayer=function(e,t){var r=e.layer,i=e.outFields,n=e.objectIds;if("function"!=typeof r.queryFeatures||!n){var a="Could not query required fields for the specified layer. Some fields will not be available.",o=new d("query-required-fields",a,{outFields:i,objectIds:n});return j.warn("query-required-fields",a),y.reject(o)}var s=r.createQuery();return s.objectIds=n,s.outFields=i,s.returnGeometry=!0,r.queryFeatures(s,t).then((function(e){return e.features[0]}))},t.prototype._queryRequiredFieldsFeature=function(e){var t=this,r=this._graphic,i=this._effectivePopupTemplate,n=r.sourceLayer;return n&&i?("function"==typeof n.load?n.load(e):y.resolve()).then((function(){var a=r.attributes[n.objectIdField],o="number"==typeof a?[a]:void 0;return p.safeCast(i.getRequiredFields(n.fields)).then((function(i){return x.featureHasFields(i,r)?null:t._querySourceLayer({layer:n,outFields:i,objectIds:o},e)}))})):y.resolve(null)},t.prototype._queryFeature=function(e){var t=this,r=this._featureAbortController,i=this._graphic;return this._effectivePopupTemplate=i&&i.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled),this._getContent().then((function(n){if(r===t._featureAbortController&&i){var o=t._checkForRelatedFeatures(n,e),s=t._createFormattedExpressions().then((function(e){i.attributes=a({},i.attributes,e)})),l=t._queryContentElements(n).then((function(e){return t._contentResponse=e})),u=t._queryRequiredFieldsFeature(e).then((function(e){e&&(i.geometry=e.geometry,i.attributes=a({},i.attributes,e.attributes))}));return y.eachAlways([o,s,l,u]).then((function(){if(r===t._featureAbortController&&i){t._set("formattedAttributes",t._createFormattedAttributes(n)),t._set("title",t._compileTitle());var e=t._compileLastEditInfo();t._set("lastEditInfo",e||null);var a=t._compileContent(n,t._contentResponse);return t._set("content",a||null),a}}))}}))},t.prototype._isExpressionField=function(e){return P.test(e)},t.prototype._formatArcadeArray=function(e){return'<ul class="esri-widget__list">'+e.map((function(e){return"<li>"+("string"==typeof e?C(k(e)):e)+"</li>"})).join("")+"</ul>"},t.prototype._formatArcadeDictionary=function(e){return'<table class="esri-widget__table">'+e.keys().map((function(t){var r=e.field(t);return"<tr><th>"+t+"</th><td>"+("string"==typeof r?C(k(r)):r)+"</td></tr>"})).join("")+"</table>"},t.prototype._createFormattedExpressions=function(){return s(this,void 0,void 0,(function(){var e,t,r,i,n,a,l,u,p,d,c,f=this;return o(this,(function(h){switch(h.label){case 0:return t=(e=this)._effectivePopupTemplate,r=e._graphic,i=t&&t.expressionInfos,n=[],a={},i&&i.length?[4,O()]:[2,a];case 1:for(l=h.sent(),u=function(e){var t="expression/"+e.name,i=l.createSyntaxTree(e.expression),u=S.filter((function(e){return l.hasVariable(i,e)})),p=l.loadScriptDependencies(i,!0,u).then((function(){return s(f,void 0,void 0,(function(){var e,n,s,p,d=this;return o(this,(function(o){return e=this.spatialReference,n=l.getViewInfo({spatialReference:e}),(s=l.createExecContext(r,n)).useAsync=!0,this._addVarsToContext(l,u,s,n),p=l.createFunction(i,s),[2,l.executeAsyncFunction(p,s).then((function(e){a[t]="string"==typeof e?C(k(e)):Array.isArray(e)?d._formatArcadeArray(e):e&&"esri.arcade.Dictionary"===e.declaredClass?d._formatArcadeDictionary(e):e}),(function(e){return j.error("arcade-execution-error",e)}))]}))}))}));n.push(p)},p=0,d=i;p<d.length;p++)c=d[p],u(c);return[2,y.eachAlways(n).then((function(){return a}))]}}))}))},t.prototype._addVarsToContext=function(e,t,r,i){var n=this.graphic,a=this.map;t.forEach((function(t){var o=t.toLowerCase(),s={map:a,spatialReference:i.sr};"$map"===o&&(r.vars[o]=e.convertMapToFeatureSetCollection(s)),"$layer"===o&&(r.vars[o]=e.convertFeatureLayerToFeatureSet(n.sourceLayer,i.sr)),"$datastore"===o&&(r.vars[o]=e.convertServiceUrlToWorkspace(n.sourceLayer.url,i.sr))}))},t.prototype._createFormattedAttributes=function(e){var t=this,r=this._effectivePopupTemplate,i=r&&r.fieldInfos,n={global:this._formatAttributes(i),content:[]};return Array.isArray(e)&&e.forEach((function(e,r){"fields"===e.type&&e.fieldInfos&&(n.content[r]=t._formatAttributes(e.fieldInfos))})),n},t.prototype._getAllFieldInfos=function(e){var t=this._effectivePopupTemplate,r=[],i=t&&t.fieldInfos;return i&&r.push.apply(r,i),e&&Array.isArray(e)?(e.forEach((function(e){if("fields"===e.type){var t=e&&e.fieldInfos;r.push.apply(r,t)}})),r):r},t.prototype._checkForRelatedFeatures=function(e,t){var r=this._graphic,i=this._getAllFieldInfos(e);return this.queryRelatedInfos(r,i,t)},t.prototype._getChartOption=function(e){var t=e.value,r=e.attributes,i=e.formattedAttributes,n=e.fieldName,a=e.relatedFieldName,o=e.fieldInfos,s=e.index,l=this._graphic,u=A.getSourceLayer(l),p=t.normalizeField,d=t.tooltipField,c=p?this.isRelatedField(p)?r[this.getRelatedFieldInfo(p).fieldName]:r[p]:null,f=a&&void 0!==r[a]?r[a]:void 0!==r[n]?r[n]:i[n],h=void 0===f?null:f&&c?f/c:f,y=new F({x:s,y:h});if(this.isRelatedField(n)){var m=this.getRelatedFieldInfo(n),v=this.getRelatedFieldInfo(d),_=v?v.fieldName:null,g=this._formatValueToFieldInfo(h,{fieldInfos:o,fieldName:a,layer:u,preventPlacesFormatting:!!c}),b=m?m.label||m.fieldName:a,x=_&&void 0!==r[_]?r[_]:b;return y.tooltip=x+": "+g,y}var I=this._getFieldInfo(o,n),w=this._getFixedFieldName(n,u),T=I?I.label||I.fieldName:n,M=d&&void 0!==i[d]?i[d]:T,R=i[w];return y.tooltip=M+": "+R,y},t.prototype._getFixedFieldName=function(e,t){var r=N(t,e);return r?r.name:e},t.prototype._getFixedFieldNames=function(e,t){var r=this;return e&&e.map((function(e){return r._getFixedFieldName(e,t)}))},t.prototype._setChartValue=function(e){var t=this,r=e.value,i=e.attributes,n=e.formattedAttributes,a=e.layer,o=this._effectivePopupTemplate,s=this.relatedInfoCount,l=r.fields,u=r.normalizeField;if(r.fields=this._getFixedFieldNames(l,a),u&&(r.normalizeField=this._getFixedFieldName(u,a)),l.some((function(e){return!!(null!=n[e]||t.isRelatedField(e)&&s)}))){var p=o&&o.fieldInfos;l.forEach((function(e,a){if(t.isRelatedField(e))r.series=r.series.concat(t._getRelatedChartInfos({fieldInfos:p,fieldName:e,formattedAttributes:n,value:r}));else{var o=t._getChartOption({value:r,index:a,attributes:i,formattedAttributes:n,fieldName:e,fieldInfos:p});r.series.push(o)}}))}},t.prototype._getRelatedChartInfos=function(e){var t=this,r=e.fieldInfos,i=e.fieldName,n=e.formattedAttributes,a=e.value,o=[],s=this.getRelatedFieldInfo(i),l=s.layerId,u=s.fieldName,p=this.getRelatedInfo(l);if(!p)return o;var d=p.relatedFeatures,c=p.relation;if(!c||!d)return o;var f=c.cardinality;return d.forEach((function(e,s){var l=e.attributes;l&&Object.keys(l).forEach((function(e){e===u&&o.push(t._getChartOption({value:a,index:s,attributes:l,formattedAttributes:n,fieldName:i,relatedFieldName:e,fieldInfos:r}))}))})),"one-to-many"===f||"many-to-many"===f?o:[o[0]]},n([_.property()],t.prototype,"_featureAbortController",void 0),n([_.property({readOnly:!0})],t.prototype,"content",void 0),n([_.property({type:Boolean})],t.prototype,"defaultPopupTemplateEnabled",void 0),n([_.property({readOnly:!0})],t.prototype,"formattedAttributes",void 0),n([_.property({type:l})],t.prototype,"graphic",void 0),n([_.property({readOnly:!0})],t.prototype,"lastEditInfo",void 0),n([_.property({dependsOn:["view"]})],t.prototype,"spatialReference",null),n([_.property({readOnly:!0})],t.prototype,"title",void 0),n([_.property({dependsOn:["view"]})],t.prototype,"map",null),n([_.property({readOnly:!0,dependsOn:["_featureAbortController"]})],t.prototype,"waitingForContent",null),n([_.property()],t.prototype,"view",void 0),n([_.subclass("esri.widgets.FeatureViewModel")],t)}(_.declared(M))}.apply(null,i))||(e.exports=n)},1406:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(41),r(10),r(11),r(9),r(4),r(2),r(671),r(272),r(319),r(971)],void 0===(n=function(e,t,r,i,n,a,o,s,l,u,p,d,c,f){var h=new Map,y="esri.widgets.Popup.support.RelatedFeatures",m=s.getLogger(y);return function(e){function t(t){var r=e.call(this)||this;return r.relatedInfoCount=null,r.relatedInfos=new Map,r}return r(t,e),t.prototype.destroy=function(){this.relatedInfos.clear()},t.prototype.addRelatedFeatureAttributes=function(e){var t=this;this.relatedInfos.forEach((function(r){return t._addRelatedFeatureAttribute(e,r)}))},t.prototype.getRelatedFieldInfo=function(e){if(-1===e.indexOf("relationships/"))return null;var t=e.split("/").slice(1);return{layerId:t[0],fieldName:t[1]}},t.prototype.getRelatedInfo=function(e){return this.relatedInfos.get(e.toString())},t.prototype.isRelatedField=function(e){return void 0===e&&(e=""),!!e&&-1!==e.indexOf("relationships/")},t.prototype.queryRelatedInfos=function(e,t,r){var i=this;this.relatedInfos.clear();var n=f.getSourceLayer(e);if(!n)return l.resolve();var a=t.filter((function(e){return e&&i.isRelatedField(e.fieldName)}));return a&&a.length?(this._createRelatedInfos(t,n),this._queryLayerInfos(n,r).then((function(t){return i._updateRelatedInfoLayerInfos(t),i._queryRelatedFeatureMap(e,r).then((function(e){return Object.keys(e).forEach((function(t){i._setRelatedFeatures(e[t],t.toString())})),e}))}))):l.resolve()},t.prototype._addRelatedFeatureAttribute=function(e,t){var r=this;e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((function(i){return r._addAttributesFromFeature(e,i,t)})),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((function(i){return r._addAttributesFromFeature(e,i,t)})))},t.prototype._updateRelatedInfoLayerInfo=function(e,t){var r=e.value;r&&(this.getRelatedInfo(t).layerInfo=r.data)},t.prototype._updateRelatedInfoLayerInfos=function(e){var t=this;Object.keys(e).forEach((function(r){return t._updateRelatedInfoLayerInfo(e[r],r.toString())}))},t.prototype._addAttributesFromFeature=function(e,t,r){var i=this;e&&t&&r&&Object.keys(t.attributes).forEach((function(n){var a=i._relatedFieldInfoToString({layerId:r.relation.id.toString(),fieldName:n});e[a]=t.attributes[n]}))},t.prototype._relatedFieldInfoToString=function(e){return e?"relationships/"+e.layerId+"/"+e.fieldName:""},t.prototype._createRelatedInfoForFieldInfo=function(e,t){var r=this.getRelatedFieldInfo(e.fieldName);if(r){var i=r.layerId,n=r.fieldName;if(i){var a=this.getRelatedInfo(i)||this._createRelatedInfo(i,t);if(a&&(a.relatedFields.push(n),e.statisticType)){var o=new c({statisticType:e.statisticType,onStatisticField:n,outStatisticFieldName:n});a.outStatistics.push(o)}}}},t.prototype._createRelatedInfos=function(e,t){var r=this;e.forEach((function(e){return r._createRelatedInfoForFieldInfo(e,t)}))},t.prototype._queryRelatedFeatureMap=function(e,t){var r=this,i={};return this.relatedInfos.forEach((function(n,a){n.layerInfo&&(i[a]=r._queryRelatedLayerFeatures(e,n,t))})),l.eachAlways(i)},t.prototype._queryLayerInfos=function(e,t){var r=this,i={};return this.relatedInfos.forEach((function(n,a){var s=n.relation;if(!s){var u=new o("relation-required","A relation is required on a layer to retrieve related records.");return m.error(u),l.reject(u)}var p=s.relatedTableId;if(!p){u=new o("A related table ID is required on a layer to retrieve related records.");return m.error(u),l.reject(u)}var d=e.url+"/"+p,c=h.get(d),f=c||r._queryLayerInfo(d,t);c||h.set(d,f),i[a]=f})),l.eachAlways(i)},t.prototype._queryLayerInfo=function(e,t){return n(e,{query:{f:"json"},signal:t&&t.signal})},t.prototype._queryRelatedLayerFeatures=function(e,t,r){var i=f.getSourceLayer(e).layerId.toString(),n=t.layerInfo,a=t.queryTask,o=t.relation,s=this._getDestinationRelation(n,i);if(s){var u=o.keyField,p=s.keyField,c="string"===this._getDestinationFieldType(n,s)?p+"='"+e.attributes[u]+"'":p+"="+e.attributes[u],h=a.execute(new d({where:c,outFields:t.relatedFields}),r),y=t.outStatistics&&t.outStatistics.length>0&&n.supportsStatistics?a.execute(new d({where:c,outFields:t.relatedFields,outStatistics:t.outStatistics}),r):null;return l.eachAlways({features:h,statsFeatures:y||l.resolve()})}return l.resolve()},t.prototype._setRelatedFeatures=function(e,t){var r=this.getRelatedInfo(t);if(r){var i=e.value;if(i){var n=i.features,a=i.statsFeatures,o=n&&n.value;r.relatedFeatures=o?o.features:[];var s=a&&a.value;r.relatedStatsFeatures=s?s.features:[]}}},t.prototype._getRelation=function(e,t){if(!t.relationships)return null;var r=null;return t.relationships.some((function(t){return t.id===parseInt(e,10)&&(r=t,!0)})),r},t.prototype._createRelatedInfo=function(e,t){var r=this._getRelation(e,t);if(r){var i=t.url+"/"+r.relatedTableId,n={url:i,queryTask:new p({url:i}),relation:r,relatedFields:[],outStatistics:[]};return this.relatedInfos.set(e,n),n}},t.prototype._getDestinationRelation=function(e,t){var r;return e&&e.relationships&&e.relationships.some((function(e){return""+e.relatedTableId===t&&(r=e,!0)})),r},t.prototype._getDestinationFieldType=function(e,t){var r=void 0;return e.fields.some((function(e){return e.name===t.keyField&&(r=-1!==["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(e.type)?"number":"string",!0)})),r},i([u.aliasOf("relatedInfos.size")],t.prototype,"relatedInfoCount",void 0),i([u.property()],t.prototype,"relatedInfos",void 0),i([u.subclass(y)],t)}(u.declared(a))}.apply(null,i))||(e.exports=n)},1407:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=e.toUrl("../../../themes/base/images/files/");t.isSupportedImage=function(e){var t=e.toLowerCase();return"image/bmp"===t||"image/emf"===t||"image/exif"===t||"image/gif"===t||"image/x-icon"===t||"image/jpeg"===t||"image/png"===t||"image/tiff"===t||"image/x-wmf"===t},t.getIconPath=function(e){return e?"text/plain"===e?r+"text-32.svg":"application/pdf"===e?r+"pdf-32.svg":"text/csv"===e?r+"csv-32.svg":"application/gpx+xml"===e?r+"gpx-32.svg":"application/x-dwf"===e?r+"cad-32.svg":"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?r+"code-32.svg":"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?r+"zip-32.svg":-1!==e.indexOf("image/")?r+"image-32.svg":-1!==e.indexOf("audio/")?r+"sound-32.svg":-1!==e.indexOf("video/")?r+"video-32.svg":-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?r+"excel-32.svg":-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?r+"word-32.svg":-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?r+"report-32.svg":r+"generic-32.svg":r+"generic-32.svg"}}.apply(null,i))||(e.exports=n)},1408:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(6),r(8),r(24),r(50)],void 0===(n=function(e,t,i,n,a){function o(){var e=a.locale;return e&&(t.locales[e]||function(e){for(var r=e.split("-")[0].toLowerCase(),i=null,n=0,a=Object.keys(t.locales);n<a.length;n++){var o=a[n];if(o.indexOf(r)>-1){i=t.locales[o];break}}return i}(e))||s}Object.defineProperty(t,"__esModule",{value:!0});var s="en_US";t.locales={ar:"ar","bs-ba":"bs_BA","ca-es":"ca_ES","cs-cz":"cs_CZ","da-dk":"da_DK","de-ch":"de_CH","de-de":"de_DE","el-gr":"el_GR","en-ca":"en_CA","en-us":"en_US","es-es":"es_ES","et-ee":"et_EE","fi-fi":"fi_FI","fr-fr":"fr_FR","he-il":"he_IL","hi-in":"hi_IN","hr-hr":"hr_HR","hu-hu":"hu_HU","id-id":"id_ID","it-it":"it_IT","ja-jp":"ja_JP","ko-kr":"ko_KR","lt-lt":"lt_LT","lv-lv":"lv_LV","nb-no":"nb_NO","nl-nl":"nl_NL","pl-pl":"pl_PL","pt-br":"pt_BR","pt-pt":"pt_PT","ro-ro":"ro_RO","ru-ru":"ru_RU","sl-sl":"sl_SL","sr-rs":"sr_RS","sv-se":"sv_SE","th-th":"th_TH","tr-tr":"tr_TR","uk-ua":"uk_UA","vi-vn":"vi_VN","zh-cn":"zh_Hans","zh-hk":"zh_Hant","zh-tw":"zh_Hant"},t.getChartLocale=o;var l,u=null;t.loadChartsModule=function(e){return void 0===e&&(e=o()),n(this,void 0,void 0,(function(){var t,n,a,o,s;return i(this,(function(i){switch(i.label){case 0:return e===l?[2,u]:(l=e,[4,Promise.all([new Promise((function(e,t){r.e(100).then(function(){var t=[r(1491)];e.apply(null,t)}.bind(this)).catch(t.bind(this))})),new Promise((function(t,i){Promise.all([r.e(49),r.e(101)]).then(function(){var i=[r(1492)("./"+e)];t.apply(null,i)}.bind(this)).catch(i.bind(this))}))])]);case 1:return t=i.sent(),n=t[0],a=t[1],o=n.am4core,e===l&&(o.options.defaultLocale=a.default),"function"==typeof Object.assign?[3,3]:[4,new Promise((function(e,t){Promise.resolve().then(function(){var t=[r(340)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 2:s=i.sent(),Object.defineProperty(Object,"assign",{value:s.assign,writable:!0,configurable:!0}),i.label=3;case 3:return u=n,[2,n]}}))}))}}.apply(null,i))||(e.exports=n)},1409:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1410),r(63)],void 0===(n=function(e,t,r,i){function n(e){var t=null;return a.some((function(r){return r.pattern.test(e)&&(t=r),!!t})),t}Object.defineProperty(t,"__esModule",{value:!0});var a=[{id:"http",pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:r.view},{id:"tel",pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{id:"mailto",pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{id:"arcgis-appstudio-player",pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"App Studio Player"},{id:"arcgis-collector",pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"Collector"},{id:"arcgis-explorer",pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"Explorer"},{id:"arcgis-navigator",pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"Navigator"},{id:"arcgis-survey123",pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"Survey123"},{id:"arcgis-trek2there",pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"Trek2There"},{id:"arcgis-workforce",pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:r.workforce},{id:"iform",pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"iForm"},{id:"flow",pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"FlowFinity"},{id:"lfmobile",pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"Laserfische"},{id:"mspbi",pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:r.openInApp,appName:"Microsoft Power Bi"}];t.autoLink=function(e){if("string"!=typeof e||!e)return e;var t=n(e);if(!t)return e;var r=e.match(t.pattern),a=r&&r[2],o=i.replace(t.label,{appName:t.appName,hierPart:a}),s=t.target?'target="'+t.target+'"':"",l="_blank"===t.target?'rel="noreferrer"':"";return e.replace(t.pattern,"<a "+s+' href="$1" '+l+">"+o+"</a>")}}.apply(null,i))||(e.exports=n)},1410:function(e,t,r){var i,n;i=[r(60),r(62),r(1411)],void 0===(n=function(e,t){return t(e,"esri/widgets/support/nls/uriUtils",r.dj.c(),!1)}.apply(null,i))||(e.exports=n)},1411:function(e,t,r){e.exports={root:{openInApp:"Open in {appName}",view:"View"},ar:!1,bs:!1,ca:!1,cs:!1,da:!1,de:!1,el:!1,es:!1,et:!1,fi:!1,fr:!1,he:!1,hi:!1,hr:!1,hu:!1,id:!1,it:!1,ja:!1,ko:!1,lv:!1,lt:!1,nl:!1,nb:!1,pl:!1,"pt-br":!1,"pt-pt":!1,ro:!1,ru:!1,sl:!1,sr:!1,sv:!1,th:!1,tr:!1,uk:!1,vi:!1,"zh-cn":!1,"zh-hk":!1,"zh-tw":!1}},602:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(7),r(1403),r(193),r(102),r(14),r(2),r(54),r(1405),r(1407),r(1408),r(1409),r(44),r(137)],void 0===(n=function(e,t,r,i,n,a,o,s,l,u,p,d,c,f,h,y,m){var v="esri-icon-font-fallback-text",_="esri-icon-loading-indicator esri-rotating",g="esri-icon-left-triangle-arrow",b="esri-icon-right-triangle-arrow",x="esri-widget__table",I="esri-widget",F="esri-feature",w="esri-feature__size-container",T="esri-feature__title",A="esri-feature__main-container",M="esri-feature__button",R="esri-feature__icon",O="esri-feature__content-element",C="esri-feature__text",N="esri-feature__last-edited-info",E="esri-feature--media-pagination-visible",k="esri-feature__attachments",S="esri-feature__attachments--list",j="esri-feature__attachments--preview",P="esri-feature__attachments-title",L="esri-feature__attachments-items",z="esri-feature__attachments-item",q="esri-feature__attachment-item-mask",U="esri-feature__attachment-item-mask--icon",V="esri-feature__attachments-image",Q="esri-feature__attachments-image-overlay",D="esri-feature__attachments-link-icon esri-icon-link-external",B="esri-feature__attachments-image--resizable",J="esri-feature__attachments-filename",H="esri-feature__attachments-item-link",K="esri-feature__fields",$="esri-feature__field-header",Y="esri-feature__field-data",X="esri-feature__field-data--date",G="esri-feature__media",W="esri-feature__media-container",Z="esri-feature__media-item-container",ee="esri-feature__media-item",te="esri-feature__media-item-title",re="esri-feature__media-item-caption",ie="esri-feature__media-previous",ne="esri-feature__media-previous-icon",ae="esri-feature__media-previous-icon--rtl",oe="esri-feature__media-next",se="esri-feature__media-next-icon",le="esri-feature__media-next-icon--rtl",ue="esri-feature__media-chart",pe="esri-feature__loading-container",de="esri-feature__loading-spinner",ce={title:!0,content:!0,lastEditedInfo:!0};return function(e){function t(t){var r=e.call(this)||this;return r._chartMap=new Map,r._activeMediaMap=new Map,r._refreshTimers=new Map,r._mediaInfo=new Map,r.graphic=null,r.defaultPopupTemplateEnabled=!1,r.spatialReference=null,r.title=null,r.visibleElements=n({},ce),r.map=null,r.view=null,r.viewModel=new d,r}return r(t,e),t.prototype.postInitialize=function(){var e=this;this.own(l.init(this,"viewModel.content",(function(){return e._setupMediaRefreshTimers()})))},t.prototype.destroy=function(){this._clearMediaRefreshTimers(),this._activeMediaMap.clear(),this._activeMediaMap=null,this._destroyCharts()},t.prototype.castVisibleElements=function(e){return n({},ce,e)},t.prototype.render=function(){var e=y.tsx("div",{key:"loading-container",class:pe},y.tsx("span",{class:this.classes(_,de)})),t=this.visibleElements,r=this.viewModel,i=r.waitingForContent,n=r.title,a=t.title?y.tsx("h4",{class:T,innerHTML:n}):null,o=t.content?y.tsx("div",{class:A},[this._renderContent(),this._renderLastEditInfo()]):null;return y.tsx("div",{class:this.classes(F,I)},y.tsx("div",{class:w},a,i?e:o))},t.prototype.goToMedia=function(e,t){this._setContentElementMedia(e,t)},t.prototype.nextMedia=function(e){this._pageContentElementMedia(e,"next")},t.prototype.previousMedia=function(e){this._pageContentElementMedia(e,"previous")},t.prototype._buildKey=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e+"__"+(this.get("viewModel.graphic.uid")||"0")+"-"+t.join("-")},t.prototype._destroyCharts=function(){this._chartMap.forEach((function(e){return e.dispose()})),this._chartMap.clear()},t.prototype._renderContent=function(){var e=this.viewModel.content;return e?"string"==typeof e?y.tsx("div",{key:"content-string",innerHTML:e}):y.isWidget(e)?y.tsx("div",{key:"content-widget"},e.render()):e instanceof HTMLElement?y.tsx("div",{key:"content-html-element",bind:e,afterCreate:this._attachToNode}):y.isWidgetBase(e)?y.tsx("div",{key:"content-dijit",bind:e.domNode,afterCreate:this._attachToNode}):Array.isArray(e)&&e.length?y.tsx("div",{key:"content-content-elements"},e.map(this._renderContentElement,this)):null:null},t.prototype._renderContentElement=function(e,t){var r=this.visibleElements;if("boolean"!=typeof r.content&&!r.content[e.type])return null;switch(e.type){case"attachments":return this._renderAttachments(e,t);case"fields":return this._renderFields(e,t);case"media":return this._renderMedia(e,t);case"text":return this._renderText(e,t);default:return null}},t.prototype._renderAttachmentInfo=function(e){var t,r,i=e.attachmentInfo,n=e.supportsResizeAttachments,o=e.contentElement.displayType,s=i.contentType,l=i.orientationInfo,u=i.name,p=i.url,d="preview"===o?128:48,f=l?[l.rotation?"rotate("+l.rotation+"deg)":"",l.mirrored?"scaleX(-1)":""].join(" "):"",h=f?{transform:f}:{},m=n&&c.isSupportedImage(s),v=-1===p.indexOf("?")?"?":"&",_=m?""+p+v+"w="+d:c.getIconPath(s),g=((t={})[U]=!m,t),b=((r={})[B]=n,r);return y.tsx("li",{class:z,key:i},y.tsx("a",{class:H,href:p,rel:"noreferrer",target:"_blank"},y.tsx("div",{class:this.classes(g,q)},y.tsx("img",{styles:h,alt:"",class:this.classes(b,V),src:_}),y.tsx("span",{class:Q},y.tsx("span",{"aria-hidden":"true",class:D}))),y.tsx("span",{class:J},u||a.noTitle)))},t.prototype._renderAttachments=function(e,t){var r,i=this,n=e.displayType,o=e.attachmentInfos,s=o&&o.length,l=this.get("graphic.layer.capabilities.operations.supportsResizeAttachments"),u=((r={})[S]="preview"!==n,r[j]="preview"===n,r);return s?y.tsx("div",{key:"attachments-element",class:this.classes(k,O,u)},y.tsx("div",{class:P},a.attach),y.tsx("ul",{class:L},o.map((function(t,r){return i._renderAttachmentInfo({attachmentInfo:t,attachmentInfoIndex:r,supportsResizeAttachments:l,contentElement:e})})))):null},t.prototype._forceLTR=function(e){return"&lrm;"+e},t.prototype._renderFieldInfo=function(e,t){var r,i=this.viewModel.formattedAttributes,n=i?i.content[t]||i.global:null,a=e.fieldName,o=e.label||a,s=n?null==n[a]?"":n[a]:"",l=!(!e.format||!e.format.dateFormat),u="number"==typeof s&&!l?this._forceLTR(s):h.autoLink(s),p=((r={})[X]=l,r);return y.tsx("tr",{key:this._buildKey("fields-element-info-row",t)},y.tsx("th",{key:this._buildKey("fields-element-info-row-header",t),class:$,innerHTML:o}),y.tsx("td",{key:this._buildKey("fields-element-info-row-data",t),class:this.classes(Y,p),innerHTML:u}))},t.prototype._renderFields=function(e,t){var r=this,i=e.fieldInfos;return i?y.tsx("div",{key:this._buildKey("fields-element",t),class:this.classes(K,O)},y.tsx("table",{class:x,summary:a.fieldsSummary,key:this._buildKey("fields-element-table",t)},y.tsx("tbody",{key:this._buildKey("fields-element-table-body",t)},i.map((function(e){return r._renderFieldInfo(e,t)}))))):null},t.prototype._shouldOpenInNewTab=function(e){if(void 0===e&&(e=""),e)return!/^(?:mailto:|tel:)/.test(e.trim().toLowerCase())},t.prototype._clearMediaRefreshTimers=function(){this._refreshTimers.forEach((function(e){return clearTimeout(e)})),this._refreshTimers.clear()},t.prototype._clearMediaRefreshTimer=function(e){var t=this._refreshTimers.get(e);t&&(clearTimeout(t),this._refreshTimers.delete(e))},t.prototype._getImageSource=function(e,t){var r=-1!==e.indexOf("?")?"&":"?",i=e.split("#"),n=i[0],a=i[1],o=void 0===a?"":a;return""+n+r+"timestamp="+t+(o?"#":"")+o},t.prototype._setupMediaRefreshTimer=function(e){var t=this.get("viewModel.content");if(Array.isArray(t)){var r=t[e];if(r&&"media"===r.type){var i=this._activeMediaMap.get(e);isNaN(i)&&(i=0);var n=r.mediaInfos[i];n&&"image"===n.type&&n.refreshInterval&&this._setRefreshTimeout(e,n)}}},t.prototype._setupMediaRefreshTimers=function(){var e=this;this._clearMediaRefreshTimers();var t=this.get("viewModel.content");Array.isArray(t)&&t.forEach((function(t,r){return e._setupMediaRefreshTimer(r)}))},t.prototype._updateMediaInfoTimestamp=function(e,t){var r=Date.now();this._mediaInfo.set(t,{timestamp:r,sourceURL:this._getImageSource(e,r)}),this.scheduleRender()},t.prototype._setRefreshTimeout=function(e,t){var r=this,i=t.refreshInterval,n=t.value;if(i){var a=6e4*i;this._updateMediaInfoTimestamp(n.sourceURL,e);var o=setInterval((function(){r._updateMediaInfoTimestamp(n.sourceURL,e)}),a);this._refreshTimers.set(e,o)}},t.prototype._renderMediaInfoType=function(e){var t=e.mediaInfo,r=e.contentElementIndex,i=e.activeMediaIndex,n=t.title,a=void 0===n?"":n;if("image"===t.type){var o=t,s=o.value,l=o.refreshInterval,u=s.sourceURL,p=s.linkURL,d=this._shouldOpenInNewTab(p)?"_blank":"_self",c="_blank"===d?"noreferrer":"",f=l?this._mediaInfo.get(r):null,h=f?f.timestamp:0,m=f?f.sourceURL:u,v=y.tsx("img",{alt:a,key:this._buildKey("media-image",r,i,h),src:m});return(p?y.tsx("a",{title:a,href:p,rel:c,target:d},v):null)||v}if(-1!==t.type.indexOf("chart"))return y.tsx("div",{key:this._buildKey("media-chart",r,i),bind:this,"data-media-info":t,"data-content-element-index":r,class:ue,afterCreate:this._getChartDependencies})},t.prototype._getChartDependencies=function(e){var t=this,r=e["data-media-info"],i=e["data-content-element-index"],n=r.value,a=r.type;f.loadChartsModule().then((function(r){t._renderChart({chartDiv:e,contentElementIndex:i,type:a,value:n,chartsModule:r})}))},t.prototype._createPieChart=function(e){var t=e.chartDiv,r=e.chartsModule,i=r.am4core,n=r.am4charts,a=i.create(t,n.PieChart);a.rtl=m.isRTL();var o=a.series.push(new n.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value="y",o.dataFields.category="x",o.tooltip.label.wrap=!0,o.tooltip.label.maxWidth=150,o.tooltip.label.rtl=a.rtl,a},t.prototype._createXYChart=function(e){var t=e.chartDiv,r=e.type,i=e.value,n=e.chartsModule,a=n.am4core,o=n.am4charts,s=a.create(t,o.XYChart);s.rtl=m.isRTL();var l=i.series.length>15;if("column-chart"===r){var u=s.xAxes.push(new o.CategoryAxis);u.dataFields.category="x",u.renderer.labels.template.disabled=!0,u.tooltip.label.wrap=!0,u.tooltip.label.maxWidth=125,u.tooltip.label.rtl=s.rtl,u.tooltip.events.on("sizechanged",(function(){u.tooltip.dy=-u.tooltip.contentHeight})),s.yAxes.push(new o.ValueAxis),(d=s.series.push(new o.ColumnSeries)).dataFields.valueY="y",d.dataFields.categoryX="x",s.cursor=new o.XYCursor,l&&(s.scrollbarX=new a.Scrollbar)}if("bar-chart"===r){var p=s.yAxes.push(new o.CategoryAxis);p.dataFields.category="x",p.renderer.inversed=!0,p.renderer.labels.template.disabled=!0,p.tooltip.label.wrap=!0,p.tooltip.label.maxWidth=125,p.tooltip.label.rtl=s.rtl,p.tooltip.events.on("sizechanged",(function(){p.tooltip.dx=p.tooltip.contentWidth})),s.xAxes.push(new o.ValueAxis),(d=s.series.push(new o.ColumnSeries)).dataFields.valueX="y",d.dataFields.categoryY="x",s.cursor=new o.XYCursor,l&&(s.scrollbarY=new a.Scrollbar)}if("line-chart"===r){var d,c=s.xAxes.push(new o.CategoryAxis);c.dataFields.category="x",c.renderer.labels.template.disabled=!0,c.tooltip.label.wrap=!0,c.tooltip.label.maxWidth=125,c.tooltip.label.rtl=s.rtl,c.tooltip.events.on("sizechanged",(function(){c.tooltip.dy=-c.tooltip.contentHeight})),s.yAxes.push(new o.ValueAxis),(d=s.series.push(new o.LineSeries)).dataFields.categoryX="x",d.dataFields.valueY="y",s.cursor=new o.XYCursor,l&&(s.scrollbarX=new a.Scrollbar)}return s},t.prototype._renderChart=function(e){var t=e.contentElementIndex,r=e.type,i=e.value,n=e.chartsModule;n.am4core.useTheme(n.am4themes_animated);var a="pie-chart"===r?this._createPieChart(e):this._createXYChart(e);a.data=i.series.map((function(e){return{x:e.tooltip,y:e.y}})),this._chartMap.set(t,a)},t.prototype._renderMediaInfo=function(e){var t=e.mediaInfo,r=e.contentElementIndex,i=e.activeMediaIndex,n=this._renderMediaInfoType({mediaInfo:t,contentElementIndex:r,activeMediaIndex:i}),a=t.title?y.tsx("div",{key:this._buildKey("media-title",r),class:te,innerHTML:t.title}):null,o=t.caption?y.tsx("div",{key:this._buildKey("media-caption",r),class:re,innerHTML:t.caption}):null;return y.tsx("div",{key:this._buildKey("media-container",r),class:Z},y.tsx("div",{key:this._buildKey("media-item-container",r),class:ee},n),a,o)},t.prototype._renderMediaPageButton=function(e,t){var r="previous"===e,i=r?a.previous:a.next,n=r?this.classes(M,ie):this.classes(M,oe),o=r?this.classes(R,ne,g):this.classes(R,se,b),s=r?this.classes(R,ae,b):this.classes(R,le,g),l=r?"media-previous":"media-next",u=r?this._previousClick:this._nextClick;return y.tsx("div",{key:this._buildKey(l,t),title:i,tabIndex:0,role:"button",class:n,"data-content-element-index":t,bind:this,onkeydown:u,onclick:u},y.tsx("span",{"aria-hidden":"true",class:o}),y.tsx("span",{"aria-hidden":"true",class:s}),y.tsx("span",{class:v},i))},t.prototype._handleMediaKeyup=function(e){var t=e.currentTarget["data-content-element-index"],r=s.eventKey(e);"ArrowLeft"===r&&(e.stopPropagation(),this.previousMedia(t)),"ArrowRight"===r&&(e.stopPropagation(),this.nextMedia(t))},t.prototype._renderMedia=function(e,t){var r,i=e.mediaInfos,n=i&&i.length||0,a=((r={})[E]=n>1,r),o=this._renderMediaPageButton("previous",t),s=this._renderMediaPageButton("next",t),l=this._activeMediaMap.get(t);return isNaN(l)&&(this._activeMediaMap.set(t,0),l=0),n?y.tsx("div",{key:this._buildKey("media-element",t),"data-content-element-index":t,bind:this,onkeyup:this._handleMediaKeyup,class:this.classes(G,O,a)},y.tsx("div",{key:this._buildKey("media-element-container",t),class:W},o,this._renderMediaInfo({mediaInfo:i[l],contentElementIndex:t,activeMediaIndex:l}),s)):null},t.prototype._renderLastEditInfo=function(){var e=this.visibleElements,t=this.viewModel.lastEditInfo;if(!t||!e.lastEditedInfo)return null;var r=t.date,i=t.user,n="edit"===t.type?i?a.lastEditedByUser:a.lastEdited:i?a.lastCreatedByUser:a.lastCreated,s=o.substitute(n,{date:r,user:i});return y.tsx("div",{key:"edit-info-element",class:this.classes(N,O)},s)},t.prototype._renderText=function(e,t){return e.text?y.tsx("div",{key:this._buildKey("text-element",t),innerHTML:e.text,class:this.classes(C,O)}):null},t.prototype._attachToNode=function(e){e.appendChild(this)},t.prototype._setContentElementMedia=function(e,t){this._clearMediaRefreshTimer(e);var r=this.viewModel.content,i=r&&r[e],n=i&&i.mediaInfos;if(n&&n.length){var a=(t+n.length)%n.length;this._activeMediaMap.set(e,a),this._setupMediaRefreshTimer(e),this.scheduleRender()}},t.prototype._pageContentElementMedia=function(e,t){var r="previous"===t?-1:1,i=this._activeMediaMap.get(e)+r;this._setContentElementMedia(e,i)},t.prototype._previousClick=function(e){var t=e.currentTarget["data-content-element-index"];this.previousMedia(t)},t.prototype._nextClick=function(e){var t=e.currentTarget["data-content-element-index"];this.nextMedia(t)},i([u.aliasOf("viewModel.graphic")],t.prototype,"graphic",void 0),i([u.aliasOf("viewModel.defaultPopupTemplateEnabled")],t.prototype,"defaultPopupTemplateEnabled",void 0),i([u.aliasOf("viewModel.spatialReference")],t.prototype,"spatialReference",void 0),i([u.aliasOf("viewModel.title")],t.prototype,"title",void 0),i([u.property(),y.renderable()],t.prototype,"visibleElements",void 0),i([u.cast("visibleElements")],t.prototype,"castVisibleElements",null),i([u.aliasOf("viewModel.map")],t.prototype,"map",void 0),i([u.aliasOf("viewModel.view")],t.prototype,"view",void 0),i([u.property({type:d}),y.renderable(["viewModel.waitingForContent","viewModel.content","viewModel.lastEditInfo"])],t.prototype,"viewModel",void 0),i([y.accessibleHandler()],t.prototype,"_previousClick",null),i([y.accessibleHandler()],t.prototype,"_nextClick",null),i([u.subclass("esri.widgets.Feature")],t)}(u.declared(p))}.apply(null,i))||(e.exports=n)},612:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.lengths=e,this.coords=t};t.default=r}.apply(null,i))||(e.exports=n)},617:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var i in t)if("declaredClass"!==i){var n=t[i];if(null!=n&&"function"!=typeof n)if(Array.isArray(n)){r[i]=[];for(var a=0;a<n.length;a++)r[i][a]=e(n[a])}else"object"==typeof n?n.toJSON&&(r[i]=JSON.stringify(n)):r[i]=n}return r}}.apply(null,i))||(e.exports=n)},618:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(74),r(7),r(10),r(22),r(2)],void 0===(n=function(e,t,r,i,n,a,o,s,l){return function(e){function t(t){var r=e.call(this)||this;return r.requestOptions=null,r.url=null,r}return r(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"!=typeof e?e:a({url:e},t)},Object.defineProperty(t.prototype,"parsedUrl",{get:function(){return this._parseUrl(this.url)},enumerable:!0,configurable:!0}),t.prototype._parseUrl=function(e){return e?s.urlToObject(e):null},t.prototype._encode=function(e,t,r){var i={};for(var n in e)if("declaredClass"!==n){var a=e[n];if(null!=a&&"function"!=typeof a)if(Array.isArray(a)){i[n]=[];for(var o=0;o<a.length;o++)i[n][o]=this._encode(a[o])}else if("object"==typeof a)if(a.toJSON){var s=a.toJSON(r&&r[n]);i[n]=t?s:JSON.stringify(s)}else i[n]=t?a:JSON.stringify(a);else i[n]=a}return i},i([l.property({readOnly:!0,dependsOn:["url"]})],t.prototype,"parsedUrl",null),i([l.property()],t.prototype,"requestOptions",void 0),i([l.property({type:String})],t.prototype,"url",void 0),i([l.subclass("esri.tasks.Task")],t)}(l.declared(o))}.apply(null,i))||(e.exports=n)},619:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,r,i){void 0===e&&(e=null),void 0===t&&(t={}),this.geometry=e,t&&(this.attributes=t),r&&(this.centroid=r),null!=i&&(this.objectId=i)};t.default=r}.apply(null,i))||(e.exports=n)},620:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(56)],void 0===(n=function(e,t,r){function i(e){return e&&"upperLeft"===e.originPosition}function n(e,t){var r=e.scale,i=e.translate;return Math.round((t-i[0])/r[0])}function a(e,t){var r=e.scale,i=e.translate;return Math.round((i[1]-t)/r[1])}function o(e,t,r){for(var i,o,s,l,u=[],p=0;p<r.length;p++){var d=r[p];p>0?(s=n(e,d[0]),l=a(e,d[1]),s===i&&l===o||(u.push(t(d,s-i,l-o)),i=s,o=l)):(i=n(e,d[0]),o=a(e,d[1]),u.push(t(d,i,o)))}return u.length>0?u:null}function s(e,t,r,i){return o(e,r?i?A:T:i?T:w,t)}function l(e,t,r,i){for(var n=[],a=r?i?A:T:i?T:w,s=0;s<t.length;s++){var l=o(e,a,t[s]);l&&l.length>=3&&n.push(l)}return n.length?n:null}function u(e,t,r,i){for(var n=[],a=r?i?A:T:i?T:w,s=0;s<t.length;s++){var l=o(e,a,t[s]);l&&l.length>=2&&n.push(l)}return n.length?n:null}function p(e,t){var r=e.scale,i=e.translate;return t*r[0]+i[0]}function d(e,t){var r=e.scale;return e.translate[1]-t*r[1]}function c(e,t,r){var i=new Array(r.length);if(!r.length)return i;var n=e.scale,a=n[0],o=n[1],s=p(e,r[0][0]),l=d(e,r[0][1]);i[0]=t(r[0],s,l);for(var u=1;u<r.length;u++){var c=r[u];s+=c[0]*a,l-=c[1]*o,i[u]=t(c,s,l)}return i}function f(e,t,r){for(var i=new Array(r.length),n=0;n<r.length;n++)i[n]=c(e,t,r[n]);return i}function h(e,t,r,i){return c(e,r?i?A:T:i?T:w,t)}function y(e,t,r,i){return f(e,r?i?A:T:i?T:w,t)}function m(e,t,r,i){return f(e,r?i?A:T:i?T:w,t)}function v(e,t,r){for(var i=r[0],n=i[0],a=i[1],o=Math.min(n,t[0]),s=Math.min(a,t[1]),l=Math.max(n,t[2]),u=Math.max(a,t[3]),p=1;p<r.length;p++){var d=r[p],c=d[0],f=d[1];n+=c,a+=f,c<0&&(o=Math.min(o,n)),c>0&&(l=Math.max(l,n)),f<0?s=Math.min(s,a):f>0&&(u=Math.max(u,a))}return e[0]=o,e[1]=s,e[2]=l,e[3]=u,e}function _(e,t){if(!t.length)return null;e[0]=e[1]=Number.POSITIVE_INFINITY,e[2]=e[3]=Number.NEGATIVE_INFINITY;for(var r=0;r<t.length;r++)v(e,e,t[r]);return e}function g(e,t,r,i,o){return t.xmin=n(e,r.xmin),t.ymin=a(e,r.ymin),t.xmax=n(e,r.xmax),t.ymax=a(e,r.ymax),t!==r&&(i&&(t.zmin=r.zmin,t.zmax=r.zmax),o&&(t.mmin=r.mmin,t.mmax=r.mmax)),t}function b(e,t,r,i,n){return t.points=s(e,r.points,i,n),t}function x(e,t,r,i,o){return t.x=n(e,r.x),t.y=a(e,r.y),t!==r&&(i&&(t.z=r.z),o&&(t.m=r.m)),t}function I(e,t,r,i,n){var a=l(e,r.rings,i,n);return a?(t.rings=a,t):null}function F(e,t,r,i,n){var a=u(e,r.paths,i,n);return a?(t.paths=a,t):null}Object.defineProperty(t,"__esModule",{value:!0});var w=function(e,t,r){return[t,r]},T=function(e,t,r){return[t,r,e[2]]},A=function(e,t,r){return[t,r,e[2],e[3]]};t.toQuantizationTransform=function(e){return e?{originPosition:"upperLeft",scale:[e.tolerance,e.tolerance],translate:[e.extent.xmin,e.extent.ymax]}:null},t.equals=function(e,t){return e===t||null==e&&null==t||null!=e&&null!=t&&(i(e)?(r=e.translate[0],n=e.translate[1],a=e.scale[0]):(r=e.extent.xmin,n=e.extent.ymax,a=e.tolerance),i(t)?(o=t.translate[0],s=t.translate[1],l=t.scale[0]):(o=t.extent.xmin,s=t.extent.ymax,l=t.tolerance),r===o&&n===s&&a===l);var r,n,a,o,s,l},t.quantizeX=n,t.quantizeY=a,t.quantizeBounds=function(e,t,r){return t[0]=n(e,r[0]),t[3]=a(e,r[1]),t[2]=n(e,r[2]),t[1]=a(e,r[3]),t},t.quantizePoints=s,t.quantizeRings=l,t.quantizePaths=u,t.hydrateX=p,t.hydrateY=d,t.hydrateCoordsArray=c,t.hydrateCoordsArrayArray=f,t.hydrateBounds=function(e,t,r){return r?(t[0]=p(e,r[0]),t[1]=d(e,r[3]),t[2]=p(e,r[2]),t[3]=d(e,r[1]),t):[p(e,t[0]),d(e,t[3]),p(e,t[2]),d(e,t[1])]},t.hydratePoints=h,t.hydratePaths=y,t.hydrateRings=m,t.getQuantizedBoundsCoordsArray=v,t.getQuantizedBoundsCoordsArrayArray=_,t.getQuantizedBoundsPoints=function(e){var t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return v(t,t,e)},t.getQuantizedBoundsPaths=function(e){return _([0,0,0,0],e)},t.getQuantizedBoundsRings=function(e){return _([0,0,0,0],e)},t.quantizeExtent=g,t.quantizeMultipoint=b,t.quantizePoint=x,t.quantizePolygon=I,t.quantizePolyline=F,t.quantizeGeometry=function(e,t){return e&&t?r.isPoint(t)?x(e,{},t,!1,!1):r.isPolyline(t)?F(e,{},t,!1,!1):r.isPolygon(t)?I(e,{},t,!1,!1):r.isMultipoint(t)?b(e,{},t,!1,!1):r.isExtent(t)?g(e,{},t,!1,!1):null:null},t.hydrateExtent=function(e,t,r,i,n){return t.xmin=p(e,r.xmin),t.ymin=d(e,r.ymin),t.xmax=p(e,r.xmax),t.ymax=d(e,r.ymax),t!==r&&(i&&(t.zmin=r.zmin,t.zmax=r.zmax),n&&(t.mmin=r.mmin,t.mmax=r.mmax)),t},t.hydrateMultipoint=function(e,t,r,i,n){return t.points=h(e,r.points,i,n),t},t.hydratePoint=function(e,t,r,i,n){return t.x=p(e,r.x),t.y=d(e,r.y),t!==r&&(i&&(t.z=r.z),n&&(t.m=r.m)),t},t.hydratePolygon=function(e,t,r,i,n){return t.rings=m(e,r.rings,i,n),t},t.hydratePolyline=function(e,t,r,i,n){return t.paths=y(e,r.paths,i,n),t}}.apply(null,i))||(e.exports=n)},628:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1};t.default=r}.apply(null,i))||(e.exports=n)},640:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(41),r(46),r(16),r(22),r(56),r(271),r(651),r(564),r(617),r(50)],void 0===(n=function(e,t,r,i,n,a,o,s,l,u,p,d){function c(e,t){var r=e.geometry,i=e.toJSON(),n=i;if(r&&(n.geometry=JSON.stringify(r),n.geometryType=s.getJsonType(r),n.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),i.groupByFieldsForStatistics&&(n.groupByFieldsForStatistics=i.groupByFieldsForStatistics.join(",")),i.objectIds&&(n.objectIds=i.objectIds.join(",")),i.orderByFields&&(n.orderByFields=i.orderByFields.join(",")),!i.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete n.outFields:-1!==i.outFields.indexOf("*")?n.outFields="*":n.outFields=i.outFields.join(","),i.outSR?n.outSR=i.outSR.wkid||JSON.stringify(i.outSR):r&&(i.returnGeometry||i.returnCentroid)&&(n.outSR=n.inSR),i.returnGeometry&&delete i.returnGeometry,i.outStatistics&&(n.outStatistics=JSON.stringify(i.outStatistics)),i.pixelSize&&(n.pixelSize=JSON.stringify(i.pixelSize)),i.quantizationParameters&&(n.quantizationParameters=JSON.stringify(i.quantizationParameters)),i.source&&(n.layer=JSON.stringify({source:i.source}),delete i.source),i.timeExtent){var a=i.timeExtent,o=a.start,l=a.end;null==o&&null==l||(n.time=o===l?o:(null==o?"null":o)+","+(null==l?"null":l)),delete i.timeExtent}return n}function f(e,t,s,u,p){void 0===u&&(u={});var f="string"==typeof e?o.urlToObject(e):e,h=t.geometry?[t.geometry]:[];return u.responseType="pbf"===s?"array-buffer":"json",n.safeCast(l.normalizeCentralMeridian(h,null,u)).then((function(e){var n=e&&e[0];a.isSome(n)&&((t=t.clone()).geometry=n);var o=d.mapParameters(r({},f.query,{f:s},p,c(t,p)));return i(f.path+"/query",r({},u,{query:o}))}))}Object.defineProperty(t,"__esModule",{value:!0});var h,y="Layer does not support extent calculation.";t.queryToQueryStringParameters=c,t.executeQuery=function(e,t,r){return f(e,t,"json",r)},t.executeQueryPBF=function(e,t,r,i){return f(e,t,"pbf",i).then((function(e){var t=function(t){var r=e;return r.data=t,r};return r.useWorker?(null==h&&(h=new p.PBFWorker),h).parseFeatureQuery(e.data,r).then((function(e){return t(e)})):t(u.parsePBFFeatureQuery(e.data,r))}))},t.executeQueryForIds=function(e,t,r){return f(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){return f(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){return f(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(y);if(t.hasOwnProperty("count"))throw new Error(y);return e}))}}.apply(null,i))||(e.exports=n)},661:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(41),r(22),r(294),r(617)],void 0===(n=function(e,t,r,i,n,a,o){Object.defineProperty(t,"__esModule",{value:!0}),t.processAttachmentQueryResult=function(e,t){for(var r={},i=0,o=e;i<o.length;i++)for(var s=o[i],l=s.parentObjectId,u=0,p=s.attachmentInfos;u<p.length;u++){var d=p[u],c=d.id,f=n.addProxy(n.addTokenParameter(t+"/"+l+"/attachments/"+c)),h=a.fromJSON(d);h.set({url:f,parentObjectId:l}),r[l]?r[l].push(h):r[l]=[h]}return r},t.executeAttachmentQuery=function(e,t,n){var a={query:o.mapParameters(r({},e.query,{f:"json"},function(e){var t=e.toJSON();return t.attachmentTypes&&(t.attachmentTypes=t.attachmentTypes.join(",")),t.globalIds&&(t.globalIds=t.globalIds.join(",")),t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.size&&(t.size=t.size.join(",")),t}(t)))};return n&&(a=r({},n,a)),i(e.path+"/queryAttachments",a)}}.apply(null,i))||(e.exports=n)},671:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1),r(0),r(74),r(7),r(20),r(2),r(618),r(640),r(661),r(672),r(291),r(174),r(272),r(292)],void 0===(n=function(e,t,r,i,n,a,o,s,l,u,p,d,c,f,h,y){return function(e){function t(t){var r=e.call(this,t)||this;return r.gdbVersion=null,r.source=null,r}return r(t,e),t.prototype.execute=function(e,t){return this.executeJSON(e,t).then((function(e){return f.fromJSON(e)}))},t.prototype.executeJSON=function(e,t){return u.executeQuery(this.parsedUrl,this._normalizeQuery(e),a({},this.requestOptions,t)).then((function(e){return e.data}))},t.prototype.executeForCount=function(e,t){return u.executeQueryForCount(this.parsedUrl,this._normalizeQuery(e),a({},this.requestOptions,t)).then((function(e){return e.data.count}))},t.prototype.executeForExtent=function(e,t){return u.executeQueryForExtent(this.parsedUrl,this._normalizeQuery(e),a({},this.requestOptions,t)).then((function(e){return{count:e.data.count,extent:o.Extent.fromJSON(e.data.extent)}}))},t.prototype.executeForIds=function(e,t){return u.executeQueryForIds(this.parsedUrl,this._normalizeQuery(e),a({},this.requestOptions,t)).then((function(e){return e.data.objectIds}))},t.prototype.executeRelationshipQuery=function(e,t){return e=y.from(e),(this.gdbVersion||this.source)&&(e=e.clone().set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source})),d.executeRelationshipQuery(this.parsedUrl,e,a({},this.requestOptions,t)).then((function(e){var t=e.data,r={};return Object.keys(t).forEach((function(e){return r[e]=f.fromJSON(t[e])})),r}))},t.prototype.executeAttachmentQuery=function(e,t){var r=this;return p.executeAttachmentQuery(this.parsedUrl,c.from(e),a({},this.requestOptions,t)).then((function(e){return p.processAttachmentQueryResult(e.data.attachmentGroups,r.parsedUrl.path)}))},t.prototype._normalizeQuery=function(e){var t=h.from(e);return this.gdbVersion||this.source?(t===e?t.clone():t).set({gdbVersion:this.gdbVersion||e.gdbVersion,source:this.source||e.source}):t},i([s.property()],t.prototype,"gdbVersion",void 0),i([s.property()],t.prototype,"source",void 0),i([s.subclass("esri.tasks.QueryTask")],t)}(s.declared(l))}.apply(null,i))||(e.exports=n)},672:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(41),r(617)],void 0===(n=function(e,t,r,i,n){function a(e){var t=e.toJSON();return t.objectIds&&(t.objectIds=t.objectIds.join(",")),t.outFields&&(t.outFields=t.outFields.join(",")),t.outSpatialReference&&(t.outSR=t.outSR.wkid||JSON.stringify(t.outSR.toJSON()),delete t.outSpatialReference),t.source&&(t.layer=JSON.stringify({source:t.source}),delete t.source),t}Object.defineProperty(t,"__esModule",{value:!0}),t.toQueryStringParameters=a,t.executeRelationshipQuery=function(e,t,o){var s={query:n.mapParameters(r({},e.query,{f:"json"},a(t)))};return o&&(s=r({},o,s)),i(e.path+"/queryRelatedRecords",s).then((function(e){for(var t=e.data,r=t.geometryType,i=t.spatialReference,n={},a=0,o=t.relatedRecordGroups;a<o.length;a++){var s=o[a],l={fields:void 0,objectIdFieldName:void 0,geometryType:r,spatialReference:i,features:s.relatedRecords};if(null!=s.objectId)n[s.objectId]=l;else for(var u in s)s.hasOwnProperty(u)&&"relatedRecords"!==u&&(n[s[u]]=l)}return e.data=n,e}))}}.apply(null,i))||(e.exports=n)},827:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e,t,r,i){var n=null,a=1e3;"number"==typeof t?(a=t,i=r):(n=t,a=r);var o,s=0,l=function(){s=0,e.apply(i,o)},u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n&&n.apply(i,e),o=e,a?s||(s=setTimeout(l,a)):l()};return u.remove=function(){s&&(clearTimeout(s),s=0)},u.forceUpdate=function(){s&&(clearTimeout(s),l())},u.hasPendingUpdates=function(){return!!s},u}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=r,t.default=r}.apply(null,i))||(e.exports=n)},971:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getSourceLayer=function(e){if(e)return e.get("sourceLayer")||e.get("layer")}}.apply(null,i))||(e.exports=n)}}]);