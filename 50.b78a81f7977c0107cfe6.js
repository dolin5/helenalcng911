(function(){(this||window).webpackJsonp.registerAbsMids({"esri/core/sql/WhereClause":828,"esri/views/2d/engine/webgl/definitions":876,"esri/core/libs/gl-matrix-2/mat4":879,"esri/views/2d/engine/vectorTiles/GeometryUtils":881,"esri/views/2d/layers/graphics/graphicsUtils":888,"esri/core/libs/gl-matrix-2/math/mat4":889,"esri/core/libs/gl-matrix-2/mat4f64":890,"esri/core/pbf":894,"esri/core/libs/gl-matrix-2/mat3f64":897,"esri/core/libs/gl-matrix-2/factories/mat3f64":898,"esri/geometry/support/aaBoundingBox":899,"esri/layers/graphics/data/attributeSupport":900,"esri/layers/graphics/data/utils":901,"esri/core/libs/gl-matrix-2/factories/mat4f64":904,"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":907,"esri/views/3d/layers/support/FastSymbolUpdates":908,"esri/views/3d/support/debugFlags":909,"esri/views/2d/layers/features/support/AttributeStore":913,"dojo/regexp":915,"esri/layers/graphics/centroid":917,"esri/layers/graphics/data/spatialQuerySupport":918,"esri/layers/graphics/data/timeSupport":922,"esri/layers/graphics/data/FeatureStore":938,"esri/layers/graphics/data/QueryEngine":939,"esri/core/ItemCache":940,"esri/layers/graphics/data/QueryEngineCapabilities":945,"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":958,"esri/core/sql/WhereClauseCache":959,"esri/layers/graphics/contains":960,"esri/core/sql/AggregateFunctions":979,"esri/core/sql/StandardizedFunctions":980,"esri/core/sql/WhereGrammar":981,"esri/core/sql/sql92grammar":982,"esri/layers/graphics/data/QueryEngineResult":983,"esri/layers/graphics/data/AttributesBuilder":984,"esri/layers/support/PromiseQueue":985,"esri/views/2d/layers/features/controllers/BaseController":1025,"esri/views/2d/layers/features/support/pixelBuffering":1026,"esri/views/2d/layers/features/support/TileUpdateQueue":1148,"esri/views/2d/layers/features/controllers/MemoryController":2032})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[50,5,38],{1025:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(0),r(6),r(8),r(1),r(7),r(11),r(116),r(15),r(9),r(16),r(4),r(2),r(900),r(938),r(939),r(312),r(274),r(183),r(288),r(272),r(826),r(913),r(1026)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v,y,m,g,_,I,b,S,x,E){Object.defineProperty(t,"__esModule",{value:!0});var T=c.getLogger("esri.views.2d.layers.features.controllers.BaseController");t.needsGeometry=function(e,t){switch(e){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryMultipoint":return!0;case"esriGeometryPolygon":return function(e){var t=e&&e.getSymbols();return"backgroundFillSymbol"in e&&null!=e.backgroundFillSymbol||t.some((function(e){return"simple-fill"===e.type||"picture-fill"===e.type}))}(t);default:return T.error(new s("mapview-invalid-type",e+" is not supported")),!1}};var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._processingInMainThread=!1,t._availableFields=[],t._pixelBuffer=0,t.config=null,t.processor=null,t.remoteClient=null,t.service=null,t.tileStore=null,t.filters=new Array(S.definitions.MAX_FILTERS),t}return a(t,e),t.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])},t.prototype.startup=function(){return i(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return this._initAttributeStore(),[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)];case 1:return e.sent(),[4,p.all([this.attributeStore.updateFilters(this),this.updatePixelBuffer()])];case 2:return e.sent(),[2]}}))}))},t.prototype.destroy=function(){this.attributeStore.destroy()},Object.defineProperty(t.prototype,"arcadeInfo",{get:function(){return{geometryType:this.service.geometryType,fields:this.service.fields,spatialReference:this.spatialReference}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldsIndex",{get:function(){return new g(this.service.fields)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geometryInfo",{get:function(){return{geometryType:this.service.geometryType,hasZ:!1,hasM:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnCentroid",{get:function(){return this._get("returnCentroid")||function(e,t,r){function n(e){if(!e)return!1;var t=e.type;return"simple-marker"===t||"picture-marker"===t||"text"===t||"web-style"===t||"cim"===t}if("esriGeometryPolygon"===t&&e.labelingInfo)return!0;if("esriGeometryPolygon"!==t)return!1;switch(r.type){case"simple":return n(r.symbol);case"unique-value":return n(r.defaultSymbol)||r.uniqueValueInfos.some((function(e){return n(e.symbol)}));case"class-breaks":return n(r.defaultSymbol)||r.classBreakInfos.some((function(e){return n(e.symbol)}));default:return!0}}(this.config,this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryInfo",{get:function(){var e=null;if("heatmap"!==this.renderer.type){var t=this.renderer.visualVariables;t&&t.some((function(t){if("size"===t.type&&t.field&&!t.normalizationField)return e=[t.field+" DESC"],!0}))}return{returnCentroid:this.returnCentroid,returnGeometry:!0,outFields:this.availableFields,orderByFields:e,definitionExpression:this.config.definitionExpression,gdbVersion:this.config.gdbVersion,historicMoment:this.config.historicMoment}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this.config?_.fromJSON(this.config.renderer):(T.error("mapview-controller","Unable to create renderer for undefined configuration"),null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return m.fromWorker(this.config.processing)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availableFields",{get:function(){var e=this,t=this.config.availableFields.filter((function(t){return-1===e._availableFields.indexOf(t)}));return this._availableFields=this._availableFields.concat(t),this._availableFields},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewParams",{get:function(){return{viewingMode:"",scale:this.viewState&&this.viewState.scale||1}},enumerable:!0,configurable:!0}),t.prototype.getObjectId=function(e){return this.attributeStore.getFeatureId(e)},t.prototype.getLocalId=function(e){return this.attributeStore.getLocalId(e)},t.prototype.mapValidLocalIds=function(e){var t=this;return e.map((function(e){return t.attributeStore.getLocalId(e)})).filter((function(e){return null!=e}))},t.prototype.setViewState=function(e){this._set("viewState",e)},t.prototype.updatePixelBuffer=function(){return i(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return[4,E.computePxBuffer(this.renderer,this.service.geometryType)];case 1:return e=t.sent(),this._pixelBuffer=Math.max(this._pixelBuffer,e),[2]}}))}))},t.prototype.setHighlight=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.attributeStore.setHighlight(e)]}))}))},t.prototype.validateConfig=function(e,t){for(var r=0,n=e.filters;r<n.length;r++){var i=n[r];if(f.isSome(i)&&i.where)try{d.validateWhere(this.fieldsIndex,i.where)}catch(e){throw new s("mapview-bad-filter",e.message,{filter:i,missingFields:e.details})}}},t.prototype.onFeatureAdd=function(e){e.localId=this.attributeStore.createLocalId(e.objectId),this.attributeStore.setAttributeData(e.localId,e,this.geometryInfo,this.viewParams)},t.prototype.onFeatureRemove=function(e){!e.localId&&l("esri-2d-debug")&&console.debug("Feature must have localId"),this.attributeStore.freeLocalId(e.objectId)},t.prototype.enableEvent=function(e){},t.prototype._initAttributeStore=function(){var e=this;this.attributeStore=new x.default(o({type:"remote"},"heatmap"===this.renderer.type?{initialize:function(e,t){return p.resolve()},update:function(e,t){return p.resolve()},render:function(){return p.resolve()}}:{initialize:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",t,{signal:r})},update:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",t,{signal:r})},render:function(){return e.remoteClient.invoke("tileRenderer.featuresView.requestRender")}}))},t.prototype._createQueryEngine=function(e){void 0===e&&(e=this._createFeatureStore());var t=this.queryInfo,r=t.definitionExpression,n=t.gdbVersion,i=t.historicMoment;return new y.default({definitionExpression:r,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,gdbVersion:n,historicMoment:null!=i&&new Date(i),featureStore:e,timeInfo:this.service.timeInfo})},t.prototype._createTempQueryEngine=function(e){return void 0===e&&(e=this._createFeatureStore(!1)),this._createQueryEngine(e)},t.prototype._createFeatureStore=function(e){void 0===e&&(e=!0);var t={geometryType:this.service.geometryType,hasM:!1,hasZ:!1};if(e){var r=this.onFeatureAdd.bind(this),n=this.onFeatureRemove.bind(this);return new v.default(t,r,n)}return new v.default(t)},t.prototype._createDefaultQuery=function(e){var t=this,r=new b;r.outSpatialReference=this.spatialReference;var n=e.outFields,i=e.orderByFields,a=this.config,o=a.gdbVersion,s=a.historicMoment,u=a.definitionExpression;return this.processing&&(n=n&&n.filter((function(e){return!t.processing.getField(e)})),i=i&&i.filter((function(e){return!t.processing.getField(e)}))),n=n.length/this.service.fields.length>=.75?["*"]:n,r.gdbVersion=o,r.historicMoment=null!=s?new Date(s):null,r.outFields=n,r.where=u||"1=1",r.returnGeometry=e.returnGeometry,r.returnCentroid=e.returnCentroid,r.orderByFields=i,r.start=e.resultOffset,r.num=e.num,r},t.prototype._createQuery=function(e,t,r,n,i,a){var o=this.service.geometryType,s=this._createDefaultQuery(n);return s.maxRecordCountFactor=i,s.returnExceededLimitFeatures=a,s.resultType="tile",s.geometry=e,this.service.capabilities.query.supportsQuantization?(s.quantizationParameters=new I.default({mode:"view",originPosition:"upper-left",tolerance:r,extent:t}),"esriGeometryPolyline"===o&&(s.maxAllowableOffset=r)):"esriGeometryPolyline"!==o&&"esriGeometryPolygon"!==o||(s.maxAllowableOffset=r),s},t.prototype._applyProcessing=function(e,t){var r=this.processing;if(!r)return p.resolve(e);if(this._processingInMainThread)return this.remoteClient.invoke("executeProcessing",{featureSet:e},t);try{var n=r.process(e,r.options);return n?"then"in n?n:p.resolve(n):p.reject(new s("FeatureLayer","invalid processing.process() method, returns nothing"))}catch(r){return this._processingInMainThread=!0,this.remoteClient.invoke("executeProcessing",{featureSet:e},t)}},t.prototype.hasGeometryFilter=function(){return this.filters.some((function(e){return f.isSome(e)&&!!e.geometry}))},r([h.property({readOnly:!0,dependsOn:["config","service","spatialReference"]})],t.prototype,"arcadeInfo",null),r([h.property()],t.prototype,"config",void 0),r([h.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"fieldsIndex",null),r([h.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"geometryInfo",null),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"returnCentroid",null),r([h.property({readOnly:!0,dependsOn:["config","availableFields"]})],t.prototype,"queryInfo",null),r([h.property({dependsOn:["config"],readOnly:!0})],t.prototype,"renderer",null),r([h.property()],t.prototype,"processor",void 0),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"processing",null),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"availableFields",null),r([h.property({constructOnly:!0})],t.prototype,"remoteClient",void 0),r([h.property({constructOnly:!0})],t.prototype,"service",void 0),r([h.property({dependsOn:["tileStore"]})],t.prototype,"spatialReference",null),r([h.property({constructOnly:!0})],t.prototype,"tileInfo",void 0),r([h.property({constructOnly:!0})],t.prototype,"tileStore",void 0),r([h.property()],t.prototype,"filters",void 0),r([h.property({readOnly:!0})],t.prototype,"viewState",void 0),r([h.property({readOnly:!0,dependsOn:["viewState"]})],t.prototype,"viewParams",null),r([h.subclass("esri.views.2d.layers.features.controllers.BaseController")],t)}(h.declared(u.HandleOwner));t.default=M}.apply(null,n))||(e.exports=i)},1026:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(4),r(19),r(826),r(888)],void 0===(i=function(e,t,r,n,i,a,o,s){function u(e,t){return null==e?t:e}function l(e,t){return null==e.outline?t:u(e.outline.width,t)}function c(e,t){return n(this,void 0,void 0,(function(){var n,i,a,f,h,d,_,I,b,S,x;return r(this,(function(r){switch(r.label){case 0:return"simple-marker"===e.type?(n=Math.max(u(e.size,12),t),[2,p(e)+n*v]):"picture-marker"===e.type?(i=Math.max(u(e.height,12),t),a=u(e.width,12)*(i/u(e.height,12)),f=a/2,h=i/2,[2,p(e)+Math.sqrt(f*f+h*h)]):"text"===e.type?(s.getTextSymbolEstimatedSize(y,e,o.definitions.AVERAGE_GLYPH_MOSAIC_ITEM),d=y[2]*(u(e.horizontalAlignment,"top")in m?1:.5),_=y[3]*(u(e.horizontalAlignment,"center")in g?1:.5),I=function(e,t){return null==e.font?t:u(e.font.size,t)}(e,9),b=Math.max(I,t)/I,[2,p(e)+Math.sqrt(d*d+_*_)*b]):"simple-line"===e.type?[2,Math.max(u(e.width,.75),t)/2]:"simple-fill"===e.type||"picture-fill"===e.type?[2,Math.max(l(e,.75),t)/2]:"cim"===e.type?(S=o.CIMSymbolHelper.getEnvelope(e.data))?[2,Math.sqrt(S.width*S.width+S.height*S.height)]:[2,0]:"web-style"!==e.type?[3,2]:(x=c,[4,e.fetchCIMSymbol()]);case 1:return[2,x.apply(void 0,[r.sent(),t])];case 2:return[2,void 0]}}))}))}function f(e,t){return n(this,void 0,void 0,(function(){var n,i,a,o,s;return r(this,(function(r){switch(r.label){case 0:return function(e){return e.type in d}(e)?(i=(n=Math).min,o=(a=Math).max,s=[5],[4,c(e,t)]):[2,0];case 1:return[2,i.apply(n,[o.apply(a,s.concat([r.sent()])),75])]}}))}))}function p(e){var t=u(e.xoffset,0),r=u(e.yoffset,0);return Math.sqrt(t*t+r*r)}function h(e,t){return Math.max(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var d={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1},v=.707;t.computePxBuffer=function(e,t){return n(this,void 0,void 0,(function(){var n,o,s,u,l,c,p;return r(this,(function(r){switch(r.label){case 0:if("heatmap"===e.type)return[2,Math.round(3*e.blurRadius)];if("dot-density"===e.type)return[2,0];if("dictionary"===e.type)return"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?[2,100]:[2,50];for(n=e.getSymbols(),o=function(e){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;var t=e.getVisualVariablesForType("size");if(!t[0])return 0;var r=t[0];return"stops"===r.transformationType?r.stops.map((function(e){return e.size})).reduce(h,0):"clamped-linear"===r.transformationType?"number"==typeof r.maxSize?r.maxSize:r.maxSize.stops.map((function(e){return e.size})).reduce(h,0):"real-world-size"===r.transformationType?30:void 0}(e),s=[],u=0,l=n;u<l.length;u++)c=l[u],s.push(f(c,o));return[4,i.all(s)];case 1:return p=r.sent(),[2,a.pt2px(p.reduce(h,0))]}}))}))};var y=[0,0,0,0],m={left:1,right:1},g={top:1,bottom:1,baseline:1}}.apply(null,n))||(e.exports=i)},1148:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(0),r(6),r(8),r(10),r(4),r(29),r(2),r(74),r(305)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f){Object.defineProperty(t,"__esModule",{value:!0});var p=[0,0],h=function(e){function t(t){var r=e.call(this,t)||this;return r._queue=new Map,r._isPaused=!1,r._scheduledNextHandle=null,r._timestamp=Date.now(),r.tileInfoView=null,r._next=r._next.bind(r),r._finalize=r._finalize.bind(r),r}return r(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queue.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queue.size>0||null!=this._onGoingTile},enumerable:!0,configurable:!0}),t.prototype.abort=function(e){this._onGoingTile&&this._onGoingTile.tileId===e&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null),this._queue.delete(e),this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._onGoingTile&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingTile&&this._onGoingTile.tileId===e},t.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())},t.prototype.push=function(e,t){if(!this._queue.has(e)){var r=s.createAbortController();this._queue.set(e,{tileId:e,key:f.TileKey.pool.acquire(e),timestamp:t||this._timestamp,abortController:r}),this._scheduleNext(),this.notifyChange("updating")}},t.prototype.refresh=function(){this._timestamp=Date.now(),this.reset()},t.prototype.reset=function(){var e=this._onGoingTile;if(e){var t=e.tileId;this.push(t,this._timestamp)}this.notifyChange("updating")},t.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext()),this.notifyChange("updating")},t.prototype._finalize=function(){this._onGoingTile=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._isPaused||this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingTile||(this._scheduledNextHandle=u.schedule(this._next))},t.prototype._next=function(){return a(this,void 0,void 0,(function(){var e,t,r,n,a;return i(this,(function(i){switch(i.label){case 0:if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingTile)return this._scheduledNextHandle=null,[2];if(this._scheduledNextHandle=null,e=this._peek(),t=e.abortController.signal,r=e.tileId,n=e.key,f.TileKey.pool.release(n),this._queue.delete(r),this._onGoingTile=e,a=this.process(r,this._timestamp,{signal:t}),this.notifyChange("updating"),!function(e){return e&&"function"==typeof e.then}(a))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a];case 2:return i.sent(),[3,4];case 3:return i.sent(),[3,4];case 4:return this._finalize(),[2]}}))}))},t.prototype._peek=function(){var e=this;if(!this.state)throw new Error("state not set");var t=this.tileInfoView,r=this.state.center,n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=null;return this._queue.forEach((function(o,s){t.getTileCoords(p,o.key);var u=e._timestamp-o.timestamp;if(isNaN(u))(l=c.vec2.distance(p,r))<i&&(i=l,a=o);else if(u===n){var l;(l=c.vec2.distance(p,r))<i&&(i=l,a=o)}else u>n&&(n=u,i=Number.POSITIVE_INFINITY,a=o)})),a},n([l.property({readOnly:!0})],t.prototype,"length",null),n([l.property({constructOnly:!0})],t.prototype,"process",void 0),n([l.property()],t.prototype,"state",void 0),n([l.property({constructOnly:!0})],t.prototype,"tileInfoView",void 0),n([l.property({readOnly:!0})],t.prototype,"updating",null),n([l.subclass("esri.views.2d.layers.features.support.TileUpdateQueue")],t)}(l.declared(o));t.default=h}.apply(null,n))||(e.exports=i)},2032:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(0),r(7),r(6),r(8),r(20),r(9),r(4),r(14),r(181),r(2),r(37),r(880),r(826),r(1025),r(1148)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v,y,m){Object.defineProperty(t,"__esModule",{value:!0});var g=u.getLogger("esri.views.2d.layers.features.controllers.MemoryController"),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="memory",t}return r(t,e),t.prototype.initialize=function(){var e=this;this._tileQueue=new m.default({tileInfoView:this.tileStore.tileScheme,process:function(t,r,n){return e._fetchFeatureSet(t,r,n)}}),this._memorySource=f.openWithPorts(this.service.source,{client:this}),this.refresh(),this._tileQueue.pause(),this.handles.add([c.once(this,"processor",(function(){return e._tileQueue.resume()}))])},t.prototype.destroy=function(){this._memorySource.close(),this._memorySource=null,this._tileQueue.clear(),this._tileQueue.pause()},Object.defineProperty(t.prototype,"updating",{get:function(){return this._tileQueue.updating},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t){return o(this,void 0,void 0,(function(){var r,n=this;return a(this,(function(i){switch(i.label){case 0:return this.validateConfig(e,t),r=this.renderer.getAttributeHash(),this._set("config",e),[4,this.updatePixelBuffer()];case 1:return i.sent(),t?r===this.renderer.getAttributeHash()?[3,3]:[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,5];case 2:i.sent(),i.label=3;case 3:return[4,this.attributeStore.updateFilters(this)];case 4:return i.sent(),this.refresh(),[2];case 5:return"heatmap"===this.renderer.type?[2]:r===this.renderer.getAttributeHash()?[3,8]:[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)];case 6:return i.sent(),[4,l.all(this.tileStore.tiles.map((function(e){return n._updateTileAttrData(e)})))];case 7:i.sent(),i.label=8;case 8:return[4,this.attributeStore.updateFilters(this)];case 9:return i.sent(),[4,this.attributeStore.sendUpdates()];case 10:return i.sent(),[2]}}))}))},t.prototype.invalidate=function(){this.refresh()},t.prototype.onEdits=function(e){this.refresh()},t.prototype.queryFeatures=function(e){return this._memorySource.invoke("queryFeatures",e)},t.prototype.queryFeatureCount=function(e){return this._memorySource.invoke("queryFeatureCount",e)},t.prototype.queryObjectIds=function(e){return this._memorySource.invoke("queryObjectIds",e)},t.prototype.queryExtent=function(e){return this._memorySource.invoke("queryExtent",e)},t.prototype.redraw=function(){this.refresh()},t.prototype.refresh=function(){this._tileQueue.refresh();for(var e=0,t=this.tileStore.tiles;e<t.length;e++){var r=t[e];this._tileQueue.push(r.id,r.updateTimestamp)}},t.prototype.setViewState=function(e){this.inherited(arguments),this._tileQueue.state=e},t.prototype.onTileUpdate=function(e){this._tileQueue.pause();for(var t=0,r=e.removed;t<r.length;t++){var n=r[t];this._tileQueue.abort(n.id)}for(var i=0,a=e.added;i<a.length;i++){n=a[i];this._tileQueue.push(n.id,n.updateTimestamp)}this._tileQueue.resume()},t.prototype._updateTileAttrData=function(e){return o(this,void 0,void 0,(function(){var t,r,n,i,o,s;return a(this,(function(a){switch(a.label){case 0:return[4,this._query(e,this.queryInfo)];case 1:for(t=a.sent(),r=d.convertFromFeatureSet(t,this.service.objectIdField),r=d.hydrateOptimizedFeatureSet(r),n=0,i=r.features;n<i.length;n++)o=i[n],s=this.attributeStore.createLocalId(o.objectId),o.localId=s,this.attributeStore.setAttributeData(s,o,this.geometryInfo,this.viewParams);return[2]}}))}))},t.prototype._fetchFeatureSet=function(e,t,r){var n=this,i=this.tileStore.get(e),a=this.queryInfo;return this._query(i,a,r).then((function(e){return n._wrapPoints(e,a)})).then((function(e){return n._sortFeatures(e,a)})).then((function(e){return e.features.length?e:null})).then((function(e){return i.updateTimestamp=t,n.processor.onTileData(i,{addOrUpdate:e&&e.features,clear:!0,transformParams:e&&v.Utils.getTransformParams(e)},r)})).catch((function(e){return i.updateTimestamp=t,l.isAbortError(e)||(n.processor.onTileError(i,e.message,r),g.error("query-error",{error:e})),l.reject(e)}))},t.prototype._query=function(e,t,r){var n=this,i=this._pixelBuffer*e.resolution,a=e.bounds.slice();a[0]-=i,a[1]-=i,a[2]+=i,a[3]+=i;var o=s.Extent.fromBounds(a,this.spatialReference),u=this._createQuery(o,e.extent,e.resolution,this.queryInfo);return this.queryFeatures(u.toJSON()).then((function(e){return t.returnCentroid?e.features=e.features.filter((function(e){return null!=e.geometry&&null!=e.centroid})):e.features=e.features.filter((function(e){return null!=e.geometry})),e})).then((function(e){return n._applyProcessing(e,r)})).then((function(e){var t=d.convertFromFeatureSet(e,n.service.objectIdField);t=d.hydrateOptimizedFeatureSet(t);for(var r=0;r<e.features.length;r++){var i=e.features[r],a=t.features[r],o=n.attributeStore.getLocalId(a.objectId);null==o&&(o=n.attributeStore.createLocalId(a.objectId)),a.localId=o,i.localId=o,n.attributeStore.setAttributeData(o,a,n.geometryInfo,n.viewParams)}return n.attributeStore.sendUpdates(),e}))},t.prototype._wrapPoints=function(e,t){if(0===e.features.length)return e;var r=t.returnCentroid,n=this._pixelBuffer,a=e.geometryType,o=e.spatialReference,s=e.transform;if("esriGeometryPoint"!==a&&"esriGeometryMultipoint"!==a&&!r||!h.isWrappable(o))return e;var u=e.features,l=h.getInfo(o),c=Math.round((l.valid[1]-l.valid[0])/s.scale[0]);if(c===v.definitions.TILE_SIZE){for(var f=[],p=0,d=u;p<d.length;p++){var y=d[p],m=y.geometry,g=y.attributes;if(m)if(m.x<n){(_={geometry:i({},m),attributes:g}).geometry.x+=c,f.push(_)}else if(m.x>v.definitions.TILE_SIZE-n){var _;(_={geometry:i({},m),attributes:g}).geometry.x-=c,f.push(_)}}u.push.apply(u,f)}else for(var I=0,b=u;I<b.length;I++){(m=b[I].geometry)&&(m.x<-n?m.x+=c:m.x>v.definitions.TILE_SIZE+n&&(m.x-=c))}return e},t.prototype._sortFeatures=function(e,t){var r=t.orderByFields;if(r){var n=r[0].split(" "),i=n[0];"DESC"===n[1]&&e.features.sort((function(e,t){return t.attributes[i]-e.attributes[i]}))}return e},n([p.property()],t.prototype,"_tileQueue",void 0),n([p.property({dependsOn:["_tileQueue.updating"]})],t.prototype,"updating",null),n([p.subclass("esri.views.2d.layers.features.controllers.MemoryController")],t)}(p.declared(y.default));t.default=_}.apply(null,n))||(e.exports=i)},828:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(15),r(57),r(979),r(980),r(981)],void 0===(i=function(e,t,r,n,i,a,o){function s(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function u(e,t,r,n,i,a,o,u,l){if(void 0===r&&(r="0"),void 0===n&&(n="0"),void 0===i&&(i="0"),void 0===a&&(a="0"),void 0===o&&(o=""),void 0===u&&(u="0"),void 0===l&&(l="0"),"+"===o||"-"===o){var c=s(parseInt(e,10),4)+"-"+s(parseInt(t,10),2)+"-"+s(parseInt(r,10),2),f="";parseFloat(a)<10&&(f="0");var p=s(parseInt(n,10),2)+":"+s(parseInt(i,10),2)+":"+(f+parseFloat(a).toString()),h=""+o+s(parseInt(u,10),2)+":"+s(parseInt(l,10),2);return new Date(c+"T"+p+h)}return new Date(parseInt(e,10),parseInt(t,10),parseInt(r,10),parseInt(n,10),parseInt(i,10),parseFloat(a))}function l(e){var t=E.exec(e);if(null!==t)return u(t[1],t[2],t[3],t[4],t[5],t[6]);if(null!==(t=T.exec(e)))return u(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);if(null!==(t=M.exec(e)))return u(t[1],t[2],t[3],t[4],t[5],"0",t[6],t[7],t[8]);if(null!==(t=w.exec(e)))return u(t[1],t[2],t[3],t[4],t[5]);if(null!==(t=x.exec(e)))return u(t[1],t[2],t[3]);throw new Error("SQL Invalid Timestamp")}function c(e){var t=x.exec(e);if(null===t)throw new Error("SQL Invalid Date");var r=t[1],n=t[2],i=t[3];return new Date(parseInt(r,10),parseInt(n,10)-1,parseInt(i,10))}function f(e){return!0===e}function p(e){return Array.isArray(e)?e:[e]}function h(e){return null!==e?!0!==e:null}function d(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function v(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function y(e,t){if(null==e)return null;for(var r=!1,n=0,i=t;n<i.length;n++){var a=i[n];if(null==a)r=null;else if(e===a){r=!0;break}}return r}function m(e,t,r){if(null==e)return null;for(var n=t,i=r,a="",o="-[]/{}()*+?.\\^$|",s=0,u=0;u<n.length;u++){var l=n.charAt(u);switch(s){case 0:l===i?s=1:o.indexOf(l)>=0?a+="\\"+l:a+="%"===l?".*":"_"===l?".":l;break;case 1:o.indexOf(l)>=0?a+="\\"+l:a+=l,s=0}}return new RegExp("^"+a+"$").test(e)}function g(e){return e instanceof Date?e.valueOf():e}function _(e,t,r){if(null==t||null==r)return null;var n=g(t),i=g(r);switch(e){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}function I(e){for(var t=[],r={},n=0,i=e;n<i.length;n++){var a=i[n],o=a.toLowerCase();void 0===r[o]&&(t.push(a),r[o]=1)}return t}function b(e,t,r){if(t instanceof a.SqlInterval)if(r instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+r.getTime());case"-":return t.valueInMilliseconds()-r.getTime();case"*":return t.valueInMilliseconds()*r.getTime();case"/":return t.valueInMilliseconds()/r.getTime()}else if(r instanceof a.SqlInterval)switch(e){case"+":return a.SqlInterval.createFromMilliseconds(t.valueInMilliseconds()+r.valueInMilliseconds());case"-":return a.SqlInterval.createFromMilliseconds(t.valueInMilliseconds()-r.valueInMilliseconds());case"*":return t.valueInMilliseconds()*r.valueInMilliseconds();case"/":return t.valueInMilliseconds()/r.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(r instanceof a.SqlInterval)if(t instanceof Date)switch(e){case"+":return new Date(r.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-r.valueInMilliseconds());case"*":return t.getTime()*r.valueInMilliseconds();case"/":return t.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof r)switch(r=24*r*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}else if(r instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,r=r.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r}}function S(e,t,r,n){var i=n.getAttribute(e,t);return null!=i&&1===r[t]?new Date(i):i}Object.defineProperty(t,"__esModule",{value:!0});var x=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,T=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,M=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,N=function(){function e(){}return e.makeBool=function(e){return f(e)},e.featureValue=function(e,t,r,n){return S(e,t,r,n)},e.equalsNull=function(e){return null===e},e.applyLike=function(e,t,r){return m(e,t,r)},e.ensureArray=function(e){return p(e)},e.applyIn=function(e,t){return y(e,t)},e.currentDate=function(){var e=new Date;return e.setHours(0,0,0,0),e},e.makeSqlInterval=function(e,t,r){return a.SqlInterval.createFromValueAndQualifer(e,t,r)},e.convertInterval=function(e){return e instanceof a.SqlInterval?e.valueInMilliseconds():e},e.currentTimestamp=function(){return new Date},e.compare=function(e,t,r){return _(e,t,r)},e.calculate=function(e,t,r){return b(e,t,r)},e.makeComparable=function(e){return g(e)},e.evaluateFunction=function(e,t){return a.evaluateFunction(e,t)},e.lookup=function(e,t){var r=t[e];return void 0===r?null:r},e.between=function(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]},e.notbetween=function(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]},e.ternaryNot=function(e){return h(e)},e.ternaryAnd=function(e,t){return d(e,t)},e.ternaryOr=function(e,t){return v(e,t)},e}(),A=function(){function e(e,t){this.fieldsIndex=t,this.datefields={},this.parameters={},this.parseTree=o.WhereGrammar.parse(e);var r=this.extractExpressionInfo(t),n=r.isStandardized,i=r.isAggregate,a=r.referencedFieldNames;this.referencedFieldNames=a,this.isStandardized=n,this.isAggregate=i}return e.create=function(t,r){return new e(t,r)},Object.defineProperty(e.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0}),e.prototype.testSet=function(e,r){void 0===r&&(r=t.defaultAttributeAdapter);for(var n={},i=0,a=this.fieldNames;i<a.length;i++){!function(t){n[t]=e.map((function(e){return r.getAttribute(e,t)}))}(a[i])}return!!this.evaluateNode(this.parseTree,{attributes:n},t.defaultAttributeAdapter)},e.prototype.calculateValue=function(e,r){void 0===r&&(r=t.defaultAttributeAdapter);var n=this.evaluateNode(this.parseTree,e,r);return n instanceof a.SqlInterval?n.valueInMilliseconds()/864e5:n},e.prototype.calculateValueCompiled=function(e,n){return void 0===n&&(n=t.defaultAttributeAdapter),null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,n,this.datefields):r("csp-restrictions")?this.calculateValue(e,n):(this.compileMe(),this.parseTree._compiledVersion(e,this.parameters,n,this.datefields))},e.prototype.testFeature=function(e,r){return void 0===r&&(r=t.defaultAttributeAdapter),!!this.evaluateNode(this.parseTree,e,r)},e.prototype.testFeatureCompiled=function(e,n){return void 0===n&&(n=t.defaultAttributeAdapter),void 0===this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,n,this.datefields):r("csp-restrictions")?this.testFeature(e,n):(this.compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,n,this.datefields))},e.prototype.getFunctions=function(){var e=[];return this.visitAll(this.parseTree,(function(t){"function"===t.type&&e.push(t.name.toLowerCase())})),I(e)},e.prototype.getExpressions=function(){var e=new Map;return this.visitAll(this.parseTree,(function(t){if("function"===t.type){var r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){var i=n.column,a=r+"-"+i;e.has(a)||e.set(a,{aggregateType:r,field:i})}}})),n.valuesOfMap(e)},e.prototype.getVariables=function(){var e=[];return this.visitAll(this.parseTree,(function(t){"param"===t.type&&e.push(t.value.toLowerCase())})),I(e)},e.prototype.compileMe=function(){var e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",e).bind(N)},e.prototype.extractExpressionInfo=function(e){var t=this,r=[],n=!0,o=!0;return this.visitAll(this.parseTree,(function(s){switch(s.type){case"column_ref":var u=s.column.toUpperCase();if("CURRENT_DATE"!==u&&"CURRENT_TIMESTAMP"!==u){var l=e.get(s.column),c=l&&l.name;!l||"date"!==l.type&&"esriFieldTypeDate"!==l.type||(t.datefields[l.name]=1),void 0!==c?(r.push(c),s.column=c):r.push(s.column)}break;case"function":var f=s.name,p=s.args.value.length;n&&(n=a.isStandardized(f,p)),o&&(o=i.isAggregate(f,p))}})),{referencedFieldNames:I(r),isStandardized:n,isAggregate:o}},e.prototype.visitAll=function(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(var r=0,n=e.clauses;r<n.length;r++){var i=n[r];this.visitAll(i,t)}"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(var a=0,o=e.value;a<o.length;a++){i=o[a];this.visitAll(i,t)}break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}},e.prototype.evaluateNodeToJavaScript=function(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case_expression":var t="";if("simple"===e.format){var r="this.makeComparable("+this.evaluateNodeToJavaScript(e.operand)+")";t="( ";for(var n=0;n<e.clauses.length;n++)t+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")) ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(n=0;n<e.clauses.length;n++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t;case"param":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expr_list":for(var i="[",a=0,o=e.value;a<o.length;a++){var s=o[a];"["!==i&&(i+=","),i+=this.evaluateNodeToJavaScript(s)}return i+"]";case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary_expr":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")"}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(e.value);case"date":return"(new Date("+c(e.value).getTime().toString()+"))";case"timestamp":return"(new Date("+l(e.value).getTime().toString()+"))";case"column_ref":return"CURRENT_DATE"===e.column.toUpperCase()?"this.currentDate()":"CURRENT_TIMESTAMP"===e.column.toUpperCase()?"this.currentTimestamp()":"this.featureValue(feature,"+JSON.stringify(e.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+")"}throw new Error("Unsupported sql syntax "+e.type)},e.prototype.evaluateNode=function(e,t,r){switch(e.type){case"interval":var n=this.evaluateNode(e.value,t,r);return a.SqlInterval.createFromValueAndQualifer(n,e.qualifier,e.op);case"case_expression":if("simple"===e.format){for(var o=g(this.evaluateNode(e.operand,t,r)),s=0;s<e.clauses.length;s++)if(o===g(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}else{for(s=0;s<e.clauses.length;s++)if(f(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":for(var u=[],I=0,x=e.value;I<x.length;I++){var E=x[I];u.push(this.evaluateNode(E,t,r))}return u;case"unary_expr":return h(this.evaluateNode(e.expr,t,r));case"binary_expr":switch(e.operator){case"AND":return d(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"OR":return v(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t,r);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t,r);case"IN":var T=p(this.evaluateNode(e.right,t,r));return y(this.evaluateNode(e.left,t,r),T);case"NOT IN":T=p(this.evaluateNode(e.right,t,r));return h(y(this.evaluateNode(e.left,t,r),T));case"BETWEEN":var M=this.evaluateNode(e.left,t,r),w=this.evaluateNode(e.right,t,r);return null==M||null==w[0]||null==w[1]?null:M>=g(w[0])&&M<=g(w[1]);case"NOTBETWEEN":M=this.evaluateNode(e.left,t,r),w=this.evaluateNode(e.right,t,r);return null==M||null==w[0]||null==w[1]?null:M<g(w[0])||M>g(w[1]);case"LIKE":return m(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape);case"NOT LIKE":return h(m(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return _(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"-":case"+":case"*":case"/":return b(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r))}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return e.value;case"date":return c(e.value);case"timestamp":return l(e.value);case"column_ref":return"CURRENT_DATE"===e.column.toUpperCase()?((E=new Date).setHours(0,0,0,0),E):"CURRENT_TIMESTAMP"===e.column.toUpperCase()?new Date:S(t,e.column,this.datefields,r);case"function":var N=this.evaluateNode(e.args,t,r);return this.isAggregate?i.aggregateFunction(e.name,N):a.evaluateFunction(e.name,N)}throw new Error("Unsupported sql syntax "+e.type)},e}();t.WhereClause=A,t.defaultAttributeAdapter={getAttribute:function(e,t){return(function(e){return e&&"object"==typeof e.attributes}(e)?e.attributes:e)[t]}}}.apply(null,n))||(e.exports=i)},876:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WEBGL_MAX_STOPS=8,t.WEBGL_MAX_INNER_STOPS=t.WEBGL_MAX_STOPS-2,t.NAN_MAGIC_NUMBER=1e-30,t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.RASTER_TILE_SIZE=256,t.ANGLE_FACTOR_256=256/360,t.DEBUG_LABELS=!1,t.COLLISION_BUCKET_SIZE=128,t.DOT_DENSITY_MAX_FIELDS=8,t.COLLISION_MAX_ZOOM_DELTA=3,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=16,t.COLLISION_BOX_PADDING=16,t.COLLISION_TILE_BOX_SIZE=t.TILE_SIZE/t.COLLISION_BUCKET_SIZE,t.COLLISION_PLACEMENT_PADDING=8,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.GLYPH_SIZE=24,t.TEXT_LINE_HEIGHT=1.2*t.GLYPH_SIZE,t.TEXT_MAX_WIDTH=10*t.GLYPH_SIZE,t.TEXT_SPACING=0,t.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}},t.ATTRIBUTE_STORE_TEXTURE_SIZE=1024,t.TEXTURE_BINDING_SPRITE_ATLAS=0,t.TEXTURE_BINDING_GLYPH_ATLAS=0,t.TEXTURE_BINDING_BITMAP=0,t.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1,t.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2,t.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3,t.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4,t.TEXTURE_BINDING_HIGHLIGHT_0=5,t.TEXTURE_BINDING_HIGHLIGHT_1=6,t.TEXTURE_BINDING_RENDERER_0=5,t.TEXTURE_BINDING_RENDERER_1=6,t.ATTRIBUTE_DATA_FILTER_FLAGS=0,t.ATTRIBUTE_DATA_ANIMATION=1,t.ATTRIBUTE_DATA_VV=2,t.ATTRIBUTE_DATA_DD0=3,t.ATTRIBUTE_DATA_DD1=3,t.MAX_FILTERS=2,t.HIGHLIGHT_FLAG=1,t.FILTER_FLAG_0=2,t.EFFECT_FLAG_0=4,t.THIN_LINE_THRESHOLD=2.5,t.HITTEST_SEARCH_SIZE=24,t.MAX_ANIMATION_TIME_MS=2e3}.apply(null,n))||(e.exports=i)},879:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(889)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.mat4=r}.apply(null,n))||(e.exports=i)},881:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var n=1/Math.LN2;t.positiveMod=r,t.radToByte=function(e){return r(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return r(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*n},t.sqr=function(e){return e*e},t.interpolate=function(e,t,r){return e*(1-r)+t*r},t.between=function(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}}.apply(null,n))||(e.exports=i)},888:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(16),r(19),r(177),r(279),r(74),r(275),r(26),r(168),r(281),r(179),r(56),r(271),r(37),r(37),r(826)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v,y){function m(e,t,r,a,s){var u,l,c=n.pt2px(r.xoffset),f=n.pt2px(r.yoffset),p=w*r.angle,h=w*s;switch(r.type){case"simple-marker":var d=r;u=l=n.pt2px(d.size);break;case"picture-marker":var v=r;u=n.pt2px(v.width),l=n.pt2px(v.height)}var y=i.mat2d.identity(F);i.mat2d.translate(y,y,o.vec2.set(O,e,t)),i.mat2d.rotate(y,y,h-p),i.mat2d.scale(y,y,o.vec2.set(O,a,-a)),i.mat2d.translate(y,y,o.vec2.set(O,c,-f));var m=[0,0];o.vec2.transformMat2d(m,o.vec2.set(O,-.5*u,-.5*l),y);var g=[0,0];o.vec2.transformMat2d(g,o.vec2.set(O,-.5*u,.5*l),y);var _=[0,0];o.vec2.transformMat2d(_,o.vec2.set(O,.5*u,-.5*l),y);var I=[0,0];return o.vec2.transformMat2d(I,o.vec2.set(O,.5*u,.5*l),y),{rings:[[m,_,I,g,m]]}}function g(e,t,r,a,s){var u=y.CIMSymbolHelper.getEnvelope(r.data);if(!u)return null;var l=n.pt2px(u.width),c=n.pt2px(u.height),f=n.pt2px(u.x),p=n.pt2px(u.y),h=0*w,d=w*s,v=i.mat2d.identity(F);i.mat2d.translate(v,v,o.vec2.set(O,e,t)),i.mat2d.rotate(v,v,d-h),i.mat2d.scale(v,v,o.vec2.set(O,a,a));var m=[0,0];o.vec2.transformMat2d(m,o.vec2.set(O,f,p+c),v);var g=[0,0];o.vec2.transformMat2d(g,o.vec2.set(O,f,p),v);var _=[0,0];o.vec2.transformMat2d(_,o.vec2.set(O,f+l,p+c),v);var I=[0,0];return o.vec2.transformMat2d(I,o.vec2.set(O,f+l,p),v),{rings:[[m,_,I,g,m]]}}function _(e,t,r,a,s,u){var l=y.alignmentUtils.getYAnchorDirection(r.verticalAlignment||"baseline"),c="baseline"===(r.verticalAlignment||"baseline"),f=n.pt2px(r.xoffset),p=n.pt2px(r.yoffset),h=n.pt2px(r.font.size)/24,d=4*h,v=c?25*h:a[1]+(1+l)*a[3]*.5,m=w*r.angle,g=w*u,_=i.mat2d.identity(F);i.mat2d.translate(_,_,o.vec2.set(O,e,t)),i.mat2d.rotate(_,_,g-m),i.mat2d.scale(_,_,o.vec2.set(O,s,-s)),i.mat2d.translate(_,_,o.vec2.set(O,f,-p)),i.mat2d.translate(_,_,o.vec2.set(O,-d,-d-v));var I=[0,0];o.vec2.transformMat2d(I,o.vec2.set(O,a[0],a[1]),_);var b=[0,0];o.vec2.transformMat2d(b,o.vec2.set(O,a[0],a[1]+a[3]),_);var S=[0,0];o.vec2.transformMat2d(S,o.vec2.set(O,a[0]+a[2],a[1]),_);var x=[0,0];return o.vec2.transformMat2d(x,o.vec2.set(O,a[0]+a[2],a[1]+a[3]),_),{rings:[[I,S,x,b,I]]}}function I(e,t,r){if(!r||0===r.glyphMosaicItems.length)return e;var i=y.bidiText(t.text),a=i[0],o=i[1],s=y.alignmentUtils.getJustification(t.horizontalAlignment||"center"),u=y.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),l=r.glyphMosaicItems,c=new y.TextShapingNew([l],y.definitions.TEXT_MAX_WIDTH,y.definitions.TEXT_LINE_HEIGHT,y.definitions.TEXT_SPACING,[0,.5*-A],.5*(1-u),0,s).getShaping(a,o),f=y.fontUtils.getFontDecorationTop(t.font.decoration);isNaN(f)||y.TextShapingNew.addDecoration(c,f);var p=y.TextShapingNew.getBox(c),h=n.pt2px(t.font.size)/k;return e[0]=h*p.x,e[1]=h*p.y,e[2]=h*p.width,e[3]=h*p.height,e}function b(e,t,r,n,i,a,o){var s;switch(n.type){case"simple-marker":case"picture-marker":s=m(t,r,n,a,0);break;case"text":s=_(t,r,n,i,a,0);break;case"cim":s=g(t,r,n,a,0)}for(var u,l,c=0,f=0;f<s.rings[0].length-1;f++)u=(t-(l=s.rings[0][f])[0])*(t-l[0])+(r-l[1])*(r-l[1]),c=Math.max(c,u);c=Math.sqrt(c);var p=h.normalizeMapX(t-c,o),d=h.normalizeMapX(t+c,o);if(p>d){var y=v.getInfo(o);if(y){var I=y.valid;p=I[0],d=I[1]}}return e[0]=p,e[1]=r-c,e[2]=d,e[3]=r+c,e}function S(e,t){return Math.ceil((e-t)/(2*t))}function x(e,t){var r,n=t.valid,i=n[0],a=n[1],o=2*a,s=0;return e>a?(e-=(r=Math.ceil(Math.abs(e-a)/o))*o,s=r):e<i&&(e+=(r=Math.ceil(Math.abs(e-i)/o))*o,s=-r),{x:e,frameId:s}}function E(e,t){var r=t.xmin,n=t.ymin,i=t.xmax,a=t.ymax;return T(e,r,n)&&T(e,r,a)&&T(e,i,a)&&T(e,i,n)}function T(e,t,r){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax}function M(e,t,r){var n;if(Array.isArray(e)){if((n=e[0])>t){var i=S(n,t);e[0]=n+i*(-2*t)}else if(n<r){i=S(n,r);e[0]=n+i*(-2*r)}}else if((n=e.x)>t){i=S(n,t);e.x+=i*(-2*t)}else if(n<r){i=S(n,r);e.x+=i*(-2*r)}return e}Object.defineProperty(t,"__esModule",{value:!0});var w=Math.PI/180,N=y.definitions.TEXT_MAX_WIDTH,A=y.definitions.TEXT_LINE_HEIGHT,R=y.definitions.TEXT_SPACING,F=a.mat2df32.create(),O=s.vec2f32.create(),C=l.create();t.getBounds=function(e,t,r,n,i,a,o,s){if(!n||!r)return e[0]=e[1]=e[2]=e[3]=0,t[0]=t[1]=t[2]=t[3]=0,e;var u=n;if(!p.isPoint(u)){c.getBoundsXY(e,u);var l=t[0];0===l&&(l=function(e,t){var r=0;switch(e.type){case"simple-fill":case"picture-fill":var n=e.outline;if(!n)return 0;r=n.width;break;case"simple-line":r=e.width;break;case"simple-marker":r=e.size;break;case"picture-marker":r=Math.max(e.width,e.height);break;case"text":var i=[0,0,0,0];I(i,e,t),r=Math.max(i[0],i[1]);break;case"cim":var a=y.CIMSymbolHelper.getEnvelope(e.data);r=Math.sqrt(a.width*a.width+a.height*a.height)}return r}(r,i),t[0]=l);var f=a*l/2;return e[0]-=f,e[1]-=f,e[2]+=f,e[3]+=f,e}var h=u.x,d=u.y;return"text"===r.type&&0===t[2]&&0===t[3]&&I(t,r,i),b(e,h,d,r,t,a,s),e},t.isMarkerSymbol=function(e){return"simple-marker"===e||"picture-marker"===e||"text"===e},t.graphicGeometryToNumber=function(e){switch(r.expect(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var P=s.vec2f32.create(),L=s.vec2f32.create(),z=s.vec2f32.create(),D=s.vec2f32.create(),G=s.vec2f32.create(),B=s.vec2f32.create(),V=s.vec2f32.create();t.isPointOnPolyline=function(e,t,r,n){o.vec2.set(z,t,r);for(var i,a,s,u,l,c,f,p,h,d=e.paths,v=1/0,y=0;y<d.length;y++){var m=d[y];if(!(m.length<2))for(var g=1;g<m.length;g++)i=m[g-1][0],s=m[g-1][1],a=m[g][0],u=m[g][1],l=Math.min(i,a)-n,c=Math.min(s,u)-n,f=Math.max(i,a)+n,p=Math.max(s,u)+n,t<l||t>f||r<c||r>p||(o.vec2.set(P,i,s),o.vec2.set(L,a,u),o.vec2.subtract(D,L,P),o.vec2.subtract(G,P,z),o.vec2.scale(B,D,o.vec2.dot(D,G)/o.vec2.dot(D,D)),o.vec2.subtract(V,G,B),v>(h=o.vec2.dot(V,V))&&(v=h))}return Math.sqrt(v)<=n},t.getMarkerSymbolBounds=m,t.getCIMMarkerBounds=g,t.getTextSymbolBounds=_,t.normalizeCentralMeridian=function(e){var t,r,n,i,a,o,s,u,l=null;if(!e)return null;t=e.spatialReference,r=d.getInfo(t),n=t.isWebMercator,i=U[o=n?102100:4326].maxX,a=U[o].minX,s=U[o].plus180Line,u=U[o].minus180Line;var h,v=e.toJSON();if(!r)return v;if("mesh"===e.type)h=v;else if(p.isPoint(v))h=M(v,i,a);else if(p.isMultipoint(v))v.points=v.points.map((function(e){return M(e,i,a)})),h=v;else if(p.isExtent(v))h=function(e,t){if(!t)return e;var r=function(e,t){var r,n=[],i=e.ymin,a=e.ymax,o=e.xmax-e.xmin,s=e.xmin,u=e.xmax,l=t.valid,c=l[0],f=l[1],p=(r=x(e.xmin,t)).x,h=r.frameId,d=(r=x(e.xmax,t)).x,v=r.frameId,y=p===d&&o>0;if(o>2*f){var m={xmin:s<u?p:d,ymin:i,xmax:f,ymax:a},g={xmin:c,ymin:i,xmax:s<u?d:p,ymax:a},_={xmin:0,ymin:i,xmax:f,ymax:a},I={xmin:c,ymin:i,xmax:0,ymax:a},b=[],S=[];E(m,_)&&b.push(h),E(m,I)&&S.push(h),E(g,_)&&b.push(v),E(g,I)&&S.push(v);for(var T=h+1;T<v;T++)b.push(T),S.push(T);n.push({extent:m,frameIds:[h]},{extent:g,frameIds:[v]},{extent:_,frameIds:b},{extent:I,frameIds:S})}else p>d||y?n.push({extent:{xmin:p,ymin:i,xmax:f,ymax:a},frameIds:[h]},{extent:{xmin:c,ymin:i,xmax:d,ymax:a},frameIds:[v]}):n.push({extent:{xmin:p,ymin:i,xmax:d,ymax:a},frameIds:[h]});return n}(e,t).map((function(e){return e.extent}));return r.length<2?r[0]||e:r.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:r.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}(v,r);else if(p.isPolygon(v)||p.isPolyline(v)){var y=C;c.getBoundsXY(y,v);var m={xmin:y[0],ymin:y[1],xmax:y[2],ymax:y[3]},g=S(m.xmin,a)*(2*i),_=0===g?v:function(e,t){for(var r=function(e){return p.isPolygon(e)?e.rings:e.paths}(e),n=0,i=r;n<i.length;n++)for(var a=i[n],o=0,s=a;o<s.length;o++){s[o][0]+=t}return e}(v,g);m.xmin+=g,m.xmax+=g,f.extentIntersectsPolyline(m,s)&&m.xmax!==i?l=_:f.extentIntersectsPolyline(m,u)&&m.xmin!==a?l=_:h=_}else h=e.clone();return null!==l?(new j).cut(l,i):h};var k=24;t.getTextSymbolSize=I,t.getTextSymbolEstimatedSize=function(e,t,r){var i=y.bidiText(t.text),a=i[0],o=i[1],s=y.alignmentUtils.getJustification(t.horizontalAlignment||"center"),u=y.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),l=new y.TextShapingNew([],N,A,R,[0,.5*-A],.5*(1-u),0,s).getEstimatedShaping(a,o,r),c=y.TextShapingNew.getBox(l),f=n.pt2px(t.font.size)/k;return e[0]=f*c.x,e[1]=f*c.y,e[2]=f*c.width,e[3]=f*c.height,e};var U={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84}}},j=function(){function e(){}return e.prototype.cut=function(e,t){var r;if(e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var n=r.length,i=-2*t,a=0;a<n;a++){var o=r[a];if(o&&o.length>=this.minPts){for(var s=[],u=0,l=o;u<l.length;u++){var c=l[u];s.push([c[0]+i,c[1]])}r.push(s)}}return this.closed?e.rings=r:e.paths=r,e},e}()}.apply(null,n))||(e.exports=i)},889:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(180),r(76)],void 0===(i=function(e,t,r,n){function i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function a(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],p=t[9],h=t[10],d=t[11],v=t[12],y=t[13],m=t[14],g=t[15],_=r[0],I=r[1],b=r[2],S=r[3];return e[0]=_*n+I*s+b*f+S*v,e[1]=_*i+I*u+b*p+S*y,e[2]=_*a+I*l+b*h+S*m,e[3]=_*o+I*c+b*d+S*g,_=r[4],I=r[5],b=r[6],S=r[7],e[4]=_*n+I*s+b*f+S*v,e[5]=_*i+I*u+b*p+S*y,e[6]=_*a+I*l+b*h+S*m,e[7]=_*o+I*c+b*d+S*g,_=r[8],I=r[9],b=r[10],S=r[11],e[8]=_*n+I*s+b*f+S*v,e[9]=_*i+I*u+b*p+S*y,e[10]=_*a+I*l+b*h+S*m,e[11]=_*o+I*c+b*d+S*g,_=r[12],I=r[13],b=r[14],S=r[15],e[12]=_*n+I*s+b*f+S*v,e[13]=_*i+I*u+b*p+S*y,e[14]=_*a+I*l+b*h+S*m,e[15]=_*o+I*c+b*d+S*g,e}function o(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,u=i+i,l=a+a,c=n*s,f=n*u,p=n*l,h=i*u,d=i*l,v=a*l,y=o*s,m=o*u,g=o*l;return e[0]=1-(h+v),e[1]=f+g,e[2]=p-m,e[3]=0,e[4]=f-g,e[5]=1-(c+v),e[6]=d+y,e[7]=0,e[8]=p+m,e[9]=d-y,e[10]=1-(c+h),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function s(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.set=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v,y){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=f,e[11]=p,e[12]=h,e[13]=d,e[14]=v,e[15]=y,e},t.identity=i,t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],p=t[10],h=t[11],d=t[12],v=t[13],y=t[14],m=t[15],g=r*s-n*o,_=r*u-i*o,I=r*l-a*o,b=n*u-i*s,S=n*l-a*s,x=i*l-a*u,E=c*v-f*d,T=c*y-p*d,M=c*m-h*d,w=f*y-p*v,N=f*m-h*v,A=p*m-h*y,R=g*A-_*N+I*w+b*M-S*T+x*E;return R?(R=1/R,e[0]=(s*A-u*N+l*w)*R,e[1]=(i*N-n*A-a*w)*R,e[2]=(v*x-y*S+m*b)*R,e[3]=(p*S-f*x-h*b)*R,e[4]=(u*M-o*A-l*T)*R,e[5]=(r*A-i*M+a*T)*R,e[6]=(y*I-d*x-m*_)*R,e[7]=(c*x-p*I+h*_)*R,e[8]=(o*N-s*M+l*E)*R,e[9]=(n*M-r*N-a*E)*R,e[10]=(d*S-v*I+m*g)*R,e[11]=(f*I-c*S-h*g)*R,e[12]=(s*T-o*w-u*E)*R,e[13]=(r*w-n*T+i*E)*R,e[14]=(v*_-d*b-y*g)*R,e[15]=(c*b-f*_+p*g)*R,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],p=t[10],h=t[11],d=t[12],v=t[13],y=t[14],m=t[15];return e[0]=s*(p*m-h*y)-f*(u*m-l*y)+v*(u*h-l*p),e[1]=-(n*(p*m-h*y)-f*(i*m-a*y)+v*(i*h-a*p)),e[2]=n*(u*m-l*y)-s*(i*m-a*y)+v*(i*l-a*u),e[3]=-(n*(u*h-l*p)-s*(i*h-a*p)+f*(i*l-a*u)),e[4]=-(o*(p*m-h*y)-c*(u*m-l*y)+d*(u*h-l*p)),e[5]=r*(p*m-h*y)-c*(i*m-a*y)+d*(i*h-a*p),e[6]=-(r*(u*m-l*y)-o*(i*m-a*y)+d*(i*l-a*u)),e[7]=r*(u*h-l*p)-o*(i*h-a*p)+c*(i*l-a*u),e[8]=o*(f*m-h*v)-c*(s*m-l*v)+d*(s*h-l*f),e[9]=-(r*(f*m-h*v)-c*(n*m-a*v)+d*(n*h-a*f)),e[10]=r*(s*m-l*v)-o*(n*m-a*v)+d*(n*l-a*s),e[11]=-(r*(s*h-l*f)-o*(n*h-a*f)+c*(n*l-a*s)),e[12]=-(o*(f*y-p*v)-c*(s*y-u*v)+d*(s*p-u*f)),e[13]=r*(f*y-p*v)-c*(n*y-i*v)+d*(n*p-i*f),e[14]=-(r*(s*y-u*v)-o*(n*y-i*v)+d*(n*u-i*s)),e[15]=r*(s*p-u*f)-o*(n*p-i*f)+c*(n*u-i*s),e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],p=e[11],h=e[12],d=e[13],v=e[14],y=e[15];return(t*o-r*a)*(f*y-p*v)-(t*s-n*a)*(c*y-p*d)+(t*u-i*a)*(c*v-f*d)+(r*s-n*o)*(l*y-p*h)-(r*u-i*o)*(l*v-f*h)+(n*u-i*s)*(l*d-c*h)},t.multiply=a,t.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,p=void 0,h=void 0,d=void 0,v=void 0,y=void 0,m=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],u=t[2],l=t[3],c=t[4],f=t[5],p=t[6],h=t[7],d=t[8],v=t[9],y=t[10],m=t[11],e[0]=o,e[1]=s,e[2]=u,e[3]=l,e[4]=c,e[5]=f,e[6]=p,e[7]=h,e[8]=d,e[9]=v,e[10]=y,e[11]=m,e[12]=o*n+c*i+d*a+t[12],e[13]=s*n+f*i+v*a+t[13],e[14]=u*n+p*i+y*a+t[14],e[15]=l*n+h*i+m*a+t[15]),e},t.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,i){var a=i[0],o=i[1],s=i[2],u=Math.sqrt(a*a+o*o+s*s),l=void 0,c=void 0,f=void 0,p=void 0,h=void 0,d=void 0,v=void 0,y=void 0,m=void 0,g=void 0,_=void 0,I=void 0,b=void 0,S=void 0,x=void 0,E=void 0,T=void 0,M=void 0,w=void 0,N=void 0,A=void 0,R=void 0,F=void 0,O=void 0;return u<n.EPSILON?null:(a*=u=1/u,o*=u,s*=u,l=Math.sin(r),f=1-(c=Math.cos(r)),p=t[0],h=t[1],d=t[2],v=t[3],y=t[4],m=t[5],g=t[6],_=t[7],I=t[8],b=t[9],S=t[10],x=t[11],E=a*a*f+c,T=o*a*f+s*l,M=s*a*f-o*l,w=a*o*f-s*l,N=o*o*f+c,A=s*o*f+a*l,R=a*s*f+o*l,F=o*s*f-a*l,O=s*s*f+c,e[0]=p*E+y*T+I*M,e[1]=h*E+m*T+b*M,e[2]=d*E+g*T+S*M,e[3]=v*E+_*T+x*M,e[4]=p*w+y*N+I*A,e[5]=h*w+m*N+b*A,e[6]=d*w+g*N+S*A,e[7]=v*w+_*N+x*A,e[8]=p*R+y*F+I*O,e[9]=h*R+m*F+b*O,e[10]=d*R+g*F+S*O,e[11]=v*R+_*F+x*O,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*n,e[5]=o*i+c*n,e[6]=s*i+f*n,e[7]=u*i+p*n,e[8]=l*i-a*n,e[9]=c*i-o*n,e[10]=f*i-s*n,e[11]=p*i-u*n,e},t.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],f=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*n,e[1]=o*i-c*n,e[2]=s*i-f*n,e[3]=u*i-p*n,e[8]=a*n+l*i,e[9]=o*n+c*i,e[10]=s*n+f*i,e[11]=u*n+p*i,e},t.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*n,e[1]=o*i+c*n,e[2]=s*i+f*n,e[3]=u*i+p*n,e[4]=l*i-a*n,e[5]=c*i-o*n,e[6]=f*i-s*n,e[7]=p*i-u*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var i=r[0],a=r[1],o=r[2],s=Math.sqrt(i*i+a*a+o*o),u=void 0,l=void 0,c=void 0;return s<n.EPSILON?null:(i*=s=1/s,a*=s,o*=s,u=Math.sin(t),c=1-(l=Math.cos(t)),e[0]=i*i*c+l,e[1]=a*i*c+o*u,e[2]=o*i*c-a*u,e[3]=0,e[4]=i*a*c-o*u,e[5]=a*a*c+l,e[6]=o*a*c+i*u,e[7]=0,e[8]=i*o*c+a*u,e[9]=a*o*c-i*u,e[10]=o*o*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=o,t.fromQuat2=function(e,t){var r=u,n=-t[0],i=-t[1],a=-t[2],s=t[3],l=t[4],c=t[5],f=t[6],p=t[7],h=n*n+i*i+a*a+s*s;return h>0?(r[0]=2*(l*s+p*n+c*a-f*i)/h,r[1]=2*(c*s+p*i+f*n-l*a)/h,r[2]=2*(f*s+p*a+l*i-c*n)/h):(r[0]=2*(l*s+p*n+c*a-f*i),r[1]=2*(c*s+p*i+f*n-l*a),r[2]=2*(f*s+p*a+l*i-c*n)),o(e,t,r),e};var u=r.create();t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],l=t[9],c=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(u*u+l*l+c*c),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],u=i+i,l=a+a,c=o+o,f=i*u,p=i*l,h=i*c,d=a*l,v=a*c,y=o*c,m=s*u,g=s*l,_=s*c,I=n[0],b=n[1],S=n[2];return e[0]=(1-(d+y))*I,e[1]=(p+_)*I,e[2]=(h-g)*I,e[3]=0,e[4]=(p-_)*b,e[5]=(1-(f+y))*b,e[6]=(v+m)*b,e[7]=0,e[8]=(h+g)*S,e[9]=(v-m)*S,e[10]=(1-(f+d))*S,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],u=t[3],l=a+a,c=o+o,f=s+s,p=a*l,h=a*c,d=a*f,v=o*c,y=o*f,m=s*f,g=u*l,_=u*c,I=u*f,b=n[0],S=n[1],x=n[2],E=i[0],T=i[1],M=i[2],w=(1-(v+m))*b,N=(h+I)*b,A=(d-_)*b,R=(h-I)*S,F=(1-(p+m))*S,O=(y+g)*S,C=(d+_)*x,P=(y-g)*x,L=(1-(p+v))*x;return e[0]=w,e[1]=N,e[2]=A,e[3]=0,e[4]=R,e[5]=F,e[6]=O,e[7]=0,e[8]=C,e[9]=P,e[10]=L,e[11]=0,e[12]=r[0]+E-(w*E+R*T+C*M),e[13]=r[1]+T-(N*E+F*T+P*M),e[14]=r[2]+M-(A*E+O*T+L*M),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,l=r*o,c=n*o,f=n*s,p=i*o,h=i*s,d=i*u,v=a*o,y=a*s,m=a*u;return e[0]=1-f-d,e[1]=c+m,e[2]=p-y,e[3]=0,e[4]=c-m,e[5]=1-l-d,e[6]=h+v,e[7]=0,e[8]=p+y,e[9]=h-v,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),u=1/(i-n),l=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e},t.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=void 0;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e},t.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(i-a)*l*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},t.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),u=1/(n-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(o+a)*l,e[15]=1,e},t.lookAt=function(e,t,r,a){var o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,p=void 0,h=void 0,d=void 0,v=void 0,y=t[0],m=t[1],g=t[2],_=a[0],I=a[1],b=a[2],S=r[0],x=r[1],E=r[2];return Math.abs(y-S)<n.EPSILON&&Math.abs(m-x)<n.EPSILON&&Math.abs(g-E)<n.EPSILON?i(e):(p=y-S,h=m-x,d=g-E,o=I*(d*=v=1/Math.sqrt(p*p+h*h+d*d))-b*(h*=v),s=b*(p*=v)-_*d,u=_*h-I*p,(v=Math.sqrt(o*o+s*s+u*u))?(o*=v=1/v,s*=v,u*=v):(o=0,s=0,u=0),l=h*u-d*s,c=d*o-p*u,f=p*s-h*o,(v=Math.sqrt(l*l+c*c+f*f))?(l*=v=1/v,c*=v,f*=v):(l=0,c=0,f=0),e[0]=o,e[1]=l,e[2]=p,e[3]=0,e[4]=s,e[5]=c,e[6]=h,e[7]=0,e[8]=u,e[9]=f,e[10]=d,e[11]=0,e[12]=-(o*y+s*m+u*g),e[13]=-(l*y+c*m+f*g),e[14]=-(p*y+h*m+d*g),e[15]=1,e)},t.targetTo=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],u=n[1],l=n[2],c=i-r[0],f=a-r[1],p=o-r[2],h=c*c+f*f+p*p;h>0&&(c*=h=1/Math.sqrt(h),f*=h,p*=h);var d=u*p-l*f,v=l*c-s*p,y=s*f-u*c;return(h=d*d+v*v+y*y)>0&&(d*=h=1/Math.sqrt(h),v*=h,y*=h),e[0]=d,e[1]=v,e[2]=y,e[3]=0,e[4]=f*y-p*v,e[5]=p*d-c*y,e[6]=c*v-f*d,e[7]=0,e[8]=c,e[9]=f,e[10]=p,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=s,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],p=e[9],h=e[10],d=e[11],v=e[12],y=e[13],m=e[14],g=e[15],_=t[0],I=t[1],b=t[2],S=t[3],x=t[4],E=t[5],T=t[6],M=t[7],w=t[8],N=t[9],A=t[10],R=t[11],F=t[12],O=t[13],C=t[14],P=t[15];return Math.abs(r-_)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-I)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(I))&&Math.abs(a-b)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-S)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-x)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(u-E)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(l-T)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-M)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(f-w)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(p-N)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(h-A)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(d-R)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(v-F)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(F))&&Math.abs(y-O)<=n.EPSILON*Math.max(1,Math.abs(y),Math.abs(O))&&Math.abs(m-C)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(g-P)<=n.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))},t.mul=a,t.sub=s}.apply(null,n))||(e.exports=i)},890:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(904)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.mat4f64=r}.apply(null,n))||(e.exports=i)},894:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(15),r(59)],void 0===(i=function(e,t,r,n){var i=r("esri-text-decoder")?new TextDecoder("utf-8"):null,a=r("safari")?6:r("ff")?12:32;return function(){function e(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=e?e.byteLength:0),this._tag=0,this._dataType=99,this.init(e,t,r,n)}return e.prototype.init=function(e,t,r,n){this._data=e,this._dataView=t,this._pos=r,this._end=n},e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),r},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),r},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r},e.prototype.processMessageWithArgs=function(e,t,r,n){var i=this.getMessage(),a=e(i,t,r,n);return i.release(),a},e.prototype.processMessage=function(e){var t=this.getMessage(),r=e(t);return t.release(),r},e.prototype.getMessage=function(){var t=this._getLength(),r=e.pool.acquire();return r.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),r},e.prototype.release=function(){e.pool.release(this)},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*i}return this._pos=r,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,r){if((r=Math.min(this._end,r))-t>a&&i){var n=e.subarray(t,r);return i.decode(n)}for(var o="",s="",u=t;u<r;++u){var l=e[u];128&l?s+="%"+l.toString(16):(o+=decodeURIComponent(s)+String.fromCharCode(l),s="")}return s.length&&(o+=decodeURIComponent(s)),o},e.prototype._toBytes=function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)},e.pool=new n(e,!1,(function(e){e._data=null,e._dataView=null})),e}()}.apply(null,n))||(e.exports=i)},897:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(898)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.mat3f64=r}.apply(null,n))||(e.exports=i)},898:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){return[1,0,0,0,1,0,0,0,1]},t.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},t.fromValues=function(e,t,r,n,i,a,o,s,u){return[e,t,r,n,i,a,o,s,u]},t.createView=function(e,t){return new Float64Array(e,t,9)}}.apply(null,n))||(e.exports=i)},899:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(28),r(168)],void 0===(i=function(e,t,r,n){function i(e){return e}function a(e){return void 0===e&&(e=t.ZERO),i([e[0],e[1],e[2],e[3],e[4],e[5]])}function o(e,t,r,n,i,o,s){return void 0===s&&(s=a()),s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s}function s(e){return e[0]>=e[3]?0:e[3]-e[0]}function u(e){return e[1]>=e[4]?0:e[4]-e[1]}function l(e){return e[2]>=e[5]?0:e[5]-e[2]}function c(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function f(e){return 6===e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,t.fromValues=o,t.fromExtent=function(e,t){return void 0===t&&(t=a()),t[0]=e.xmin,t[1]=e.ymin,t[2]=e.zmin,t[3]=e.xmax,t[4]=e.ymax,t[5]=e.zmax,t},t.toExtent=function(e,t){var n=isFinite(e[2])||isFinite(e[5]);return new r(n?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})},t.fromMinMax=function(e,t,r){return void 0===r&&(r=a()),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t[0],r[4]=t[1],r[5]=t[2],r},t.expandPointInPlace=function(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[3]&&(e[3]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[4]&&(e[4]=t[1]),t[2]<e[2]&&(e[2]=t[2]),t[2]>e[5]&&(e[5]=t[2])},t.expand=function(e,t,r){return void 0===r&&(r=e),f(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r[4]=Math.max(e[4],t[4]),r[5]=Math.max(e[5],t[5])):n.is(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[3]=Math.max(e[3],t[2]),r[4]=Math.max(e[4],t[3])):2===t.length?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[3]=Math.max(e[3],t[0]),r[4]=Math.max(e[4],t[1])):3===t.length&&(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.max(e[3],t[0]),r[4]=Math.max(e[4],t[1]),r[5]=Math.max(e[5],t[2])),r},t.expandWithBuffer=function(e,t,r,n,i){void 0===i&&(i=e);for(var a=e[0],o=e[1],s=e[2],u=e[3],l=e[4],c=e[5],f=0;f<n;f++)a=Math.min(a,t[r+3*f]),o=Math.min(o,t[r+3*f+1]),s=Math.min(s,t[r+3*f+2]),u=Math.max(u,t[r+3*f]),l=Math.max(l,t[r+3*f+1]),c=Math.max(c,t[r+3*f+2]);return i[0]=a,i[1]=o,i[2]=s,i[3]=u,i[4]=l,i[5]=c,i},t.expandWithNestedArray=function(e,t,r,n){void 0===n&&(n=e);var i=t.length,a=e[0],o=e[1],s=e[2],u=e[3],l=e[4],c=e[5];if(r)for(var f=0;f<i;f++){var p=t[f];a=Math.min(a,p[0]),o=Math.min(o,p[1]),s=Math.min(s,p[2]),u=Math.max(u,p[0]),l=Math.max(l,p[1]),c=Math.max(c,p[2])}else for(f=0;f<i;f++){p=t[f];a=Math.min(a,p[0]),o=Math.min(o,p[1]),u=Math.max(u,p[0]),l=Math.max(l,p[1])}return n[0]=a,n[1]=o,n[2]=s,n[3]=u,n[4]=l,n[5]=c,n},t.allFinite=function(e){for(var t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0},t.width=s,t.depth=u,t.height=l,t.diameter=function(e){var t=s(e),r=l(e),n=u(e);return Math.sqrt(t*t+r*r+n*n)},t.center=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=e[0]+s(e)/2,t[1]=e[1]+u(e)/2,t[2]=e[2]+l(e)/2,t},t.size=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=s(e),t[1]=u(e),t[2]=l(e),t},t.maximumDimension=function(e){return Math.max(s(e),l(e),u(e))},t.containsPoint=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]},t.containsPointWithMargin=function(e,t,r){return t[0]>=e[0]-r&&t[1]>=e[1]-r&&t[2]>=e[2]-r&&t[0]<=e[3]+r&&t[1]<=e[4]+r&&t[2]<=e[5]+r},t.contains=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]},t.intersects=function(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])},t.offset=function(e,t,r,n,i){return void 0===i&&(i=e),i[0]=e[0]+t,i[1]=e[1]+r,i[2]=e[2]+n,i[3]=e[3]+t,i[4]=e[4]+r,i[5]=e[5]+n,i},t.setMin=function(e,t,r){return void 0===r&&(r=e),r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r},t.setMax=function(e,t,r){return void 0===r&&(r=e),r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e},t.set=c,t.empty=function(e){return e?c(e,t.NEGATIVE_INFINITY):a(t.NEGATIVE_INFINITY)},t.toRect=function(e,t){return t||(t=n.create()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t},t.fromRect=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e},t.is=f,t.isPoint=function(e){return 0===s(e)&&0===u(e)&&0===l(e)},t.equals=function(e,t,r){if(null==e||null==t)return e===t;if(!f(e)||!f(t))return!1;if(r){for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1}else for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},t.wrap=function(e,t,r,n,i,a){return o(e,t,r,n,i,a,p)},t.POSITIVE_INFINITY=i([-1/0,-1/0,-1/0,1/0,1/0,1/0]),t.NEGATIVE_INFINITY=i([1/0,1/0,1/0,-1/0,-1/0,-1/0]),t.ZERO=i([0,0,0,0,0,0]);var p=a()}.apply(null,n))||(e.exports=i)},900:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(11),r(57),r(959)],void 0===(i=function(e,t,r,n,i,a){function o(e,t){return e?l.get(e,t):null}function s(e,t,r,i){void 0===i&&(i=!0);for(var a=[],l=0,f=t;l<f.length;l++){var p=f[l];if("*"!==p&&!e.has(p))if(i){var h=u(p);try{var d=o(h,e);if(!d)throw new n(c,"invalid SQL expression",{where:h});if(!d.isStandardized)throw new n(c,"expression is not standard",{clause:d});s(e,d.fieldNames,"expression contains missing fields")}catch(e){var v=e&&e.details;if(v&&(v.clause||v.where))throw e;v&&v.missingFields?a.push.apply(a,v.missingFields):a.push(p)}}else a.push(p)}if(a.length)throw new n(c,r,{missingFields:a})}function u(e){return e.split(f)[0]}Object.defineProperty(t,"__esModule",{value:!0});var l=new a.WhereClauseCache(50,500),c="feature-store:unsupported-query",f=" as ",p=i.SetFromValues(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);t.validateWhere=function(e,t){if(!t)return!0;var r=l.get(t,e);if(!r)throw new n(c,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new n(c,"where clause is not standard",{where:t});return s(e,r.fieldNames,"where clause contains missing fields"),!0},t.validateHaving=function(e,t,r){if(!t)return!0;var i=l.get(t,e);if(!i)throw new n(c,"invalid SQL expression",{having:t});if(!i.isAggregate)throw new n(c,"having does not contain a valid aggregate function",{having:t});var a=i.fieldNames;if(s(e,a,"having contains missing fields"),!i.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new n(c,"expressions in having should also exist in outStatistics",{having:t});return!0},t.getWhereClause=o,t.validateFields=s,t.getExpressionFromFieldName=u,t.getAliasFromFieldName=function(e){return e.split(f)[1]},t.hasInvalidFieldType=function(e,t){var r=t.get(e);return!!r&&!p.has(r.type)}}.apply(null,n))||(e.exports=i)},901:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(12),r(16),r(4),r(78),r(182),r(56),r(271),r(37),r(917),r(880),r(877),r(886),r(918)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v,y){function m(e,t,r){if(r){var n=h.quantizeOptimizedGeometry(S,t,e.hasZ,e.hasM,"esriGeometryPoint",r);return h.convertToPoint(n,e.hasZ,e.hasM)}return h.convertToPoint(t,e.hasZ,e.hasM)}function g(e,i,o){return n(this,void 0,void 0,(function(){var n,s,f,p,h,d;return r(this,(function(r){switch(r.label){case 0:return e?(n=e.where,e.where=n=n&&n.trim(),(!n||/^1 *= *1$/.test(n)||i&&i===n)&&(e.where=null),e.geometry?[4,_(e)]:[2,e]):[2,null];case 1:return s=r.sent(),e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel&&(f=e.geometry.spatialReference,(s=u.getGeometryExtent(s)).spatialReference=f),e.geometry=s,[4,v.checkProjectionSupport(s.spatialReference,o)];case 2:return r.sent(),[4,c.normalizeCentralMeridian(l.fromJSON(s))];case 3:if(p=r.sent()[0],a.isNone(p))throw t.QUERY_ENGINE_EMPTY_RESULT;return h=p.toJSON(),[4,v.project(h,h.spatialReference,o)];case 4:if(!(d=r.sent()))throw t.QUERY_ENGINE_EMPTY_RESULT;return d.spatialReference=o,e.geometry=d,[2,e]}}))}))}function _(e){return n(this,void 0,void 0,(function(){var t,n,i,a,u,l,c,p,h;return r(this,(function(r){switch(r.label){case 0:return t=e.geometry,n=e.distance,i=e.units,null==n?[2,o.resolve(t)]:(a=t.spatialReference,u=i&&I.fromJSON(i)||s.getUnitString(a),a&&(f.isGeographic(a)||f.isWebMercator(a))?(c=t,[3,3]):[3,1]);case 1:return[4,v.checkProjectionSupport(a,f.WGS84).then((function(){return v.project(t,f.WGS84)}))];case 2:c=r.sent(),r.label=3;case 3:return l=c,[4,y.getGeodesicBufferOperator()];case 4:return p=r.sent(),[2,(h=p(l,n,u))?h.toJSON():null]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});var I=new i.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});t.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var b=new d.default,S=new d.default,x={esriGeometryPoint:h.convertToPoint,esriGeometryPolyline:h.convertToPolyline,esriGeometryPolygon:h.convertToPolygon,esriGeometryMultipoint:h.convertToMultipoint};t.transformCentroid=m,t.getCentroid=function(e,t,r){return"esriGeometryPolygon"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=p.getCentroidOptimizedGeometry(new d.default,t.geometry,e.hasZ,e.hasM)),m(e,t.centroid,r)):null},t.getGeometry=function(e,t,r,n){var i=t?"coords"in t?t:t.geometry:null;if(!i)return null;if(r){var a=h.generalizeOptimizedGeometry(b,i,e.hasZ,e.hasM,e.geometryType,r);return n?(a=h.quantizeOptimizedGeometry(S,a,e.hasZ,e.hasM,e.geometryType,n),x[e.geometryType](a,e.hasZ,e.hasM)):x[e.geometryType](a,e.hasZ,e.hasM)}if(n){a=h.quantizeOptimizedGeometry(S,i,e.hasZ,e.hasM,e.geometryType,n);return x[e.geometryType](a,e.hasZ,e.hasM)}return x[e.geometryType](i,e.hasZ,e.hasM)},t.normalizeQuery=function(e,t,i){return n(this,void 0,void 0,(function(){var n,a,o,s,u;return r(this,(function(r){if(n=e.outFields,a=e.orderByFields,o=e.groupByFieldsForStatistics,s=e.outStatistics,n)for(u=0;u<n.length;u++)n[u]=n[u].trim();if(a)for(u=0;u<a.length;u++)a[u]=a[u].trim();if(o)for(u=0;u<o.length;u++)o[u]=o[u].trim();if(s)for(u=0;u<s.length;u++)s[u].onStatisticField&&(s[u].onStatisticField=s[u].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),[2,g(e,t,i)]}))}))},t.normalizeFilter=function(e,t,i){return n(this,void 0,void 0,(function(){return r(this,(function(r){return[2,g(e,t,i)]}))}))},t.normalizeQueryLike=g,t.cleanFromGeometryEngine=function(e){return e&&E in e?JSON.parse(JSON.stringify(e,T)):e};var E="_geVersion",T=function(e,t){return e!==E?t:void 0}}.apply(null,n))||(e.exports=i)},904:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},t.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},t.fromValues=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v){return[e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v]},t.createView=function(e,t){return new Float64Array(e,t,16)}}.apply(null,n))||(e.exports=i)},907:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(19),r(826),r(908)],void 0===(i=function(e,t,r,n,i){function a(e){return{value:e.value,size:r.toPt(e.size)}}function o(e){return e.map((function(e){return a(e)}))}function s(e){if("string"==typeof e||"number"==typeof e)return r.toPt(e);var t=e;return{type:"size",expression:t.expression,stops:o(t.stops)}}function u(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(n.Utils.isString(e.field)){if(!e.stops)return null;if(e.stops.length>8)return null;for(var r=e.stops,i=0;i<8;++i){var a=r[Math.min(i,r.length-1)];t.values[i]=a.value,t.opacities[i]=a.opacity}}else{if(!(e.stops&&e.stops.length>=0))return null;var o=e.stops&&e.stops.length>=0&&e.stops[0].opacity;for(i=0;i<8;i++)t.values[i]=1/0,t.opacities[i]=o}return t}Object.defineProperty(t,"__esModule",{value:!0});var l=n.enums.WGLVVFlag;t.getVisualVariableSizeValueRepresentationRatio=function(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e},t.stopToSizeStop=a,t.normalizeSizeStops=o,t.normalizeSizeElement=s,t.getVisualVariablesFields=function(e){var t=e&&e.length>0?{}:null;return t&&e.forEach((function(e){var r=e.type;e.field&&(t[r]=e.field)})),t},t.convertVisualVariables=function(e){var t=e&&e.length>0?{}:null,a=t?{}:null;if(!t)return{vvFields:t,vvRanges:a};for(var c=0,f=e;c<f.length;c++){var p=f[c],h=p.type;if(p.field&&(t[h]=p.field),"size"===h){a.size||(a.size={});var d=p;switch(n.getTypeOfSizeVisualVariable(d)){case l.SIZE_MINMAX_VALUE:a.size.minMaxValue={minDataValue:d.minDataValue,maxDataValue:d.maxDataValue,minSize:s(d.minSize),maxSize:s(d.maxSize)};break;case l.SIZE_SCALE_STOPS:a.size.scaleStops={stops:o(d.stops)};break;case l.SIZE_FIELD_STOPS:for(var v=[],y=[],m=o(d.stops),g=m.length,_=0;_<6;_++){var I=m[Math.min(_,g-1)];v.push(I.value),y.push(r.pt2px(I.size))}a.size.fieldStops={values:v,sizes:y};break;case l.SIZE_UNIT_VALUE:a.size.unitValue={unit:d.valueUnit,valueRepresentation:d.valueRepresentation}}}else if("color"===h){var b=i.convertVisualVariables([p],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null});a.color=b.color;for(_=0;_<32;_+=4)n.color.premultiplyAlpha(a.color.colors,_,!0)}else if("opacity"===h)a.opacity=u(p);else if("rotation"===h){var S=p;a.rotation={type:S.rotationType}}}return{vvFields:t,vvRanges:a}}}.apply(null,n))||(e.exports=i)},908:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(34),r(67),r(280),r(897),r(879),r(890),r(169),r(273),r(282),r(909)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f){function p(e){return null!=e}function h(e){return"number"==typeof e}function d(e){return"string"==typeof e}function v(e,t){e&&e.push(t),m(t)}function y(e){N&&console.warn("[FastSymbolUpdates] "+e)}function m(e){N&&console.info("[FastSymbolUpdates] "+e)}function g(e,t,r,n,i){var a=e.minSize,o=e.maxSize;if(e.expression)return v(i,"Could not convert size info: expression not supported"),!1;if(e.useSymbolValue){var s=n.symbolSize[r];return t.minSize[r]=s,t.maxSize[r]=s,t.offset[r]=t.minSize[r],t.factor[r]=0,t.type[r]=1,!0}if(p(e.field))return p(e.stops)?2===e.stops.length&&h(e.stops[0].size)&&h(e.stops[1].size)?(_(e.stops[0].size,e.stops[1].size,e.stops[0].value,e.stops[1].value,t,r),t.type[r]=1,!0):(v(i,"Could not convert size info: stops only supported with 2 elements"),!1):h(a)&&h(o)&&p(e.minDataValue)&&p(e.maxDataValue)?(_(a,o,e.minDataValue,e.maxDataValue,t,r),t.type[r]=1,!0):null!=c.meterIn[e.valueUnit]?(t.minSize[r]=-1/0,t.maxSize[r]=1/0,t.offset[r]=0,t.factor[r]=1/c.meterIn[e.valueUnit],t.type[r]=1,!0):"unknown"===e.valueUnit?(v(i,"Could not convert size info: proportional size not supported"),!1):(v(i,"Could not convert size info: scale-dependent size not supported"),!1);if(!p(e.field)){if(e.stops&&e.stops[0]&&h(e.stops[0].size))return t.minSize[r]=e.stops[0].size,t.maxSize[r]=e.stops[0].size,t.offset[r]=t.minSize[r],t.factor[r]=0,t.type[r]=1,!0;if(h(a))return t.minSize[r]=a,t.maxSize[r]=a,t.offset[r]=a,t.factor[r]=0,t.type[r]=1,!0}return v(i,"Could not convert size info: unsupported variant of sizeInfo"),!1}function _(e,t,r,n,i,a){var o=Math.abs(n-r)>0?(t-e)/(n-r):0;i.minSize[a]=o>0?e:t,i.maxSize[a]=o>0?t:e,i.offset[a]=e-r*o,i.factor[a]=o}function I(e,t,r,n){if(e.normalizationField||e.valueRepresentation)return v(n,"Could not convert size info: unsupported property"),null;if(!function(e){return null==e||d(e)}(e.field))return v(n,"Could not convert size info: field is not a string"),null;if(t.size){if(e.field)if(t.size.field){if(e.field!==t.size.field)return v(n,"Could not convert size info: multiple fields in use"),null}else t.size.field=e.field}else t.size={field:e.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};var i;switch(e.axis){case"width":return(i=g(e,t.size,0,r,n))?t:null;case"height":return(i=g(e,t.size,2,r,n))?t:null;case"depth":return(i=g(e,t.size,1,r,n))?t:null;case"width-and-depth":return(i=g(e,t.size,0,r,n))&&g(e,t.size,1,r,n),i?t:null;case null:case void 0:case"all":return(i=(i=(i=g(e,t.size,0,r,n))&&g(e,t.size,1,r,n))&&g(e,t.size,2,r,n))?t:null;default:return v(n,'Could not convert size info: unknown axis "'+e.axis+'""'),null}}function b(e,t,r){e[4*t+0]=r.r/255,e[4*t+1]=r.g/255,e[4*t+2]=r.b/255,e[4*t+3]=r.a}function S(e,t,r,n){var i=2===r&&"arithmetic"===e.rotationType;t.offset[r]=i?90:0,t.factor[r]=i?-1:1,t.type[r]=1}function x(e,t,n){if(!e)return null;var i=!t.supportedTypes||!!t.supportedTypes.size,a=!t.supportedTypes||!!t.supportedTypes.color,o=!t.supportedTypes||!!t.supportedTypes.rotation,s=!!t.supportedTypes&&!!t.supportedTypes.opacity;N&&(n=n||[]);var u=e.reduce((function(e,u){if(!e)return e;if(u.valueExpression)return v(n,"Could not convert visual variables: arcade expressions not supported"),null;switch(u.type){case"size":return i?I(u,e,t,n):e;case"color":return a?function(e,t,r){if(e.normalizationField)return v(r,"Could not convert color info: unsupported property"),null;if(d(e.field)){if(!e.stops)return v(r,"Could not convert color info: missing stops or colors"),null;if(e.stops.length>8)return v(r,"Could not convert color info: too many color stops"),null;t.color={field:e.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(var n=e.stops,i=0;i<8;++i){var a=n[Math.min(i,n.length-1)];t.color.values[i]=a.value,b(t.color.colors,i,a.color)}}else{if(!(e.stops&&e.stops.length>=0))return v(r,"Could not convert color info: no field and no colors/stops"),null;var o=e.stops&&e.stops.length>=0&&e.stops[0].color;t.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(i=0;i<8;i++)t.color.values[i]=1/0,b(t.color.colors,i,o)}return t}(u,e,n):e;case"opacity":return s?function(e,t,r){if(e.normalizationField)return v(r,"Could not convert opacity info: unsupported property"),null;if(d(e.field)){if(!e.stops)return v(r,"Could not convert opacity info: missing stops or opacities"),null;if(e.stops.length>8)return v(r,"Could not convert opacity info: too many opacity stops"),null;t.opacity={field:e.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(var n=e.stops,i=0;i<8;++i){var a=n[Math.min(i,n.length-1)];t.opacity.values[i]=a.value,t.opacity.opacityValues[i]=a.opacity}}else{if(!(e.stops&&e.stops.length>=0))return v(r,"Could not convert opacity info: no field and no opacities/stops"),null;var o=e.stops&&e.stops.length>=0&&e.stops[0].opacity;t.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(i=0;i<8;i++)t.opacity.values[i]=1/0,t.opacity.opacityValues[i]=o}return t}(u,e,n):null;case"rotation":return o?function(e,t,r){if(!d(e.field))return v(r,"Could not convert rotation info: field is not a string"),null;if(t.rotation){if(e.field)if(t.rotation.field){if(e.field!==t.rotation.field)return v(r,"Could not convert rotation info: multiple fields in use"),null}else t.rotation.field=e.field}else t.rotation={field:e.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(e.axis){case"tilt":return S(e,t.rotation,0),t;case"roll":return S(e,t.rotation,1),t;case null:case void 0:case"heading":return S(e,t.rotation,2),t;default:return v(r,'Could not convert rotation info: unknown axis "'+e.axis+'""'),null}}(u,e,n):e;default:return r.neverReached(u),null}}),{size:null,color:null,opacity:null,rotation:null});return!(e.length>0&&u)||u.size||u.color||u.opacity||u.rotation?u&&u.size&&!function(e,t,r){for(var n=0;n<3;++n){var i=t.unitInMeters;1===e.type[n]&&(i*=t.modelSize[n],e.type[n]=2),e.minSize[n]=e.minSize[n]/i,e.maxSize[n]=e.maxSize[n]/i,e.offset[n]=e.offset[n]/i,e.factor[n]=e.factor[n]/i}var a;if(0!==e.type[0])a=0;else if(0!==e.type[1])a=1;else{if(0===e.type[2])return v(r,"No size axis contains a valid size or scale"),!1;a=2}for(n=0;n<3;++n)0===e.type[n]&&(e.minSize[n]=e.minSize[a],e.maxSize[n]=e.maxSize[a],e.offset[n]=e.offset[a],e.factor[n]=e.factor[a],e.type[n]=e.type[a]);return!0}(u.size,t,n)?null:u:null}function E(e){return e&&null!=e.size}function T(e,t,r){if(!!e!=!!t)return y("State update failed ({$name} enabled/disabled)"),!1;if(e&&e.field!==t.field)return y("State update failed ({$name} field changed)"),!1;if(e&&"rotation"===r)for(var n=e,i=t,a=0;a<3;a++)if(n.type[a]!==i.type[a]||n.offset[a]!==i.offset[a]||n.factor[a]!==i.factor[a])return!1;return!0}function M(e,t){var r={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},n=E(e);return e&&e.size?(r.vvSizeEnabled=!0,r.vvSizeMinSize=e.size.minSize,r.vvSizeMaxSize=e.size.maxSize,r.vvSizeOffset=e.size.offset,r.vvSizeFactor=e.size.factor):e&&n&&(r.vvSizeValue=t.transformation.scale),e&&n&&(r.vvSymbolAnchor=t.transformation.anchor,r.vvSymbolRotationMatrix=a.mat3f64.create(),o.mat4.identity(R),function(e,t,r,n){void 0===n&&(n=s.mat4f64.create());var i=e||0,a=t||0,u=r||0;0!==i&&o.mat4.rotateZ(n,n,-i/180*Math.PI),0!==a&&o.mat4.rotateX(n,n,a/180*Math.PI),0!==u&&o.mat4.rotateY(n,n,u/180*Math.PI)}(t.transformation.rotation[2],t.transformation.rotation[0],t.transformation.rotation[1],R),i.mat3.fromMat4(r.vvSymbolRotationMatrix,R)),e&&e.color&&(r.vvColorEnabled=!0,r.vvColorValues=e.color.values,r.vvColorColors=e.color.colors),e&&e.opacity&&(r.vvOpacityEnabled=!0,r.vvOpacityValues=e.opacity.values,r.vvOpacityOpacities=e.opacity.opacityValues),r}Object.defineProperty(t,"__esModule",{value:!0});var w,N=!1,A=!1;t.convertVisualVariables=x,t.initFastSymbolUpdatesState=function(e,t){if(A)return y("State not initialized, fast updates disabled (globally disabled)"),{enabled:!1};if(!e)return y("State not initialized, fast updates disabled (no renderer)"),{enabled:!1};if(f.DISABLE_FAST_UPDATES)return y("State not initialized, fast updates disabled (DISABLE_FAST_SYMBOL_UPDATES set)"),{enabled:!1};var r=x(e.visualVariables,t);return r?(m("State initialized, fast updates enabled"),{enabled:!0,visualVariables:r,materialParameters:M(r,t),requiresShaderTransformation:E(r)}):(y("State not initialized, fast updates disabled (conversion failed)"),{enabled:!1})},t.updateFastSymbolUpdatesState=function(e,t,r){if(!t||!e.enabled)return!1;var n=e.visualVariables,i=x(t.visualVariables,r);return i?!!(T(n.size,i.size,"size")&&T(n.color,i.color,"color")&&T(n.rotation,i.rotation,"rotation")&&T(n.opacity,i.opacity,"opacity"))&&(e.visualVariables=i,e.materialParameters=M(i,r),e.requiresShaderTransformation=E(i),m("State updated"),!0):(y("State update failed (conversion failed)"),!1)},t.getMaterialParams=M,function(e){var t=s.mat4f64.create(),r=l.vec3f64.create();e.evaluateModelTransform=function(e,i,a){if(!e.vvSizeEnabled)return a;o.mat4.copy(t,a);var s=e.vvSymbolRotationMatrix;o.mat4.set(R,s[0],s[1],s[2],0,s[3],s[4],s[5],0,s[6],s[7],s[8],0,0,0,0,1),o.mat4.multiply(t,t,R);for(var u=0;u<3;++u){var l=e.vvSizeOffset[u]+i[0]*e.vvSizeFactor[u];r[u]=n.clamp(l,e.vvSizeMinSize[u],e.vvSizeMaxSize[u])}return o.mat4.scale(t,t,r),o.mat4.translate(t,t,e.vvSymbolAnchor),t},e.evaluateModelTransformScale=function(e,t,r){if(!t.vvSizeEnabled)return u.vec3.set(e,1,1,1);for(var i=0;i<3;++i){var a=t.vvSizeOffset[i]+r[0]*t.vvSizeFactor[i];e[i]=n.clamp(a,t.vvSizeMinSize[i],t.vvSizeMaxSize[i])}return e}}(w||(w={}));var R=s.mat4f64.create();t.evaluateModelTransform=w.evaluateModelTransform,t.evaluateModelTransformScale=w.evaluateModelTransformScale}.apply(null,n))||(e.exports=i)},909:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(0),r(10),r(2)],void 0===(i=function(e,t,r,n,i,a){return new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,t.SCENEVIEW_LOCKING_LOG=!1,t.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1,t.HIGHLIGHTS_VISUALIZE_BLOCKS=!1,t.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1,t.DECONFLICTOR_SHOW_OUTLINES=!1,t.DECONFLICTOR_SHOW_GRID=!1,t.LABELS_SHOW_BORDER=!1,t.OVERLAY_DRAW_TEST_TEXTURE=!1,t.OVERLAY_SHOW_CENTER=!1,t.TESTS_DISABLE_UPDATE_THRESHOLDS=!1,t.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1,t.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1,t.DRAW_MESH_GEOMETRY_NORMALS=!1,t.FEATURE_TILE_FETCH_SHOW_TILES=!1,t.FEATURE_TILE_TREE_SHOW_TILES=!1,t.TERRAIN_TILE_TREE_SHOW_TILES=!1,t.I3S_TREE_SHOW_TILES=!1,t.ENABLE_PROFILE_DEPTH_RANGE=!1,t.DISABLE_FAST_UPDATES=!1,t.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,t.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,t.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,t}return r(t,e),n([a.property()],t.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),n([a.property()],t.prototype,"SCENEVIEW_LOCKING_LOG",void 0),n([a.property()],t.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0),n([a.property()],t.prototype,"HIGHLIGHTS_VISUALIZE_BLOCKS",void 0),n([a.property()],t.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0),n([a.property()],t.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0),n([a.property()],t.prototype,"DECONFLICTOR_SHOW_GRID",void 0),n([a.property()],t.prototype,"LABELS_SHOW_BORDER",void 0),n([a.property()],t.prototype,"OVERLAY_DRAW_TEST_TEXTURE",void 0),n([a.property()],t.prototype,"OVERLAY_SHOW_CENTER",void 0),n([a.property()],t.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0),n([a.property()],t.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0),n([a.property()],t.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0),n([a.property()],t.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),n([a.property()],t.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),n([a.property()],t.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),n([a.property()],t.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),n([a.property()],t.prototype,"I3S_TREE_SHOW_TILES",void 0),n([a.property()],t.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0),n([a.property()],t.prototype,"DISABLE_FAST_UPDATES",void 0),n([a.property()],t.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),n([a.property()],t.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),n([a.property()],t.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),n([a.subclass("esri.views.3d.support.DebugFlags")],t)}(a.declared(i)))}.apply(null,n))||(e.exports=i)},913:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(11),r(15),r(9),r(67),r(16),r(4),r(274),r(92),r(827),r(826),r(930),r(876),r(907),r(51)],void 0===(i=function(e,t,n,i,a,o,s,u,l,c,f,p,h,d,v,y,m){Object.defineProperty(t,"__esModule",{value:!0});var g=(h.enums.PixelType,s.getLogger("esri.views.layers.2d.features.support.AttributeStore")),_=d.debug.createDebugLogger(d.debug.DEBUG_ATTR_UPDATES,g),I=function(e,t){return function(r,n,i){var a;try{a=t(r,n,i)}catch(e){a=NaN}return(null===a||isNaN(a)||a===1/0)&&e||a}},b={sharedArrayBuffer:o("esri-shared-array-buffer"),oesTextureFloat:o("esri-webgl-texture-float"),maxTextureSize:o("esri-webgl-max-texture-size"),atomics:o("esri-atomics")},S=function(){function e(e,t,r,n){this.texelSize=4;var i=n.pixelType,a=n.layout,o=n.textureOnly;this.textureOnly=o||!1,this.pixelType=i,this._ctype=t,this.layout=a,this._resetRange(),this._shared=e,o||(this.data=this._initData(i,r,e,t))}return Object.defineProperty(e.prototype,"buffer",{get:function(){return l.andThen(this.data,(function(e){return e.buffer}))},enumerable:!0,configurable:!0}),e.prototype.getData=function(e,t){return l.expect(this.data)[e*this.texelSize+t]},e.prototype.setData=function(e,t,r,n){void 0===n&&(n=!0);var i=1<<t;0!=(this.layout&i)?(this.data[e*this.texelSize+t]=r,this.dirtyStart=Math.min(this.dirtyStart,e),this.dirtyEnd=Math.max(this.dirtyEnd,e)):g.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")},e.prototype.lock=function(){o("esri-2d-debug")&&5121===this.pixelType?g.error("AttributeStore-Bad-Type","Tried to lock non integer array type with float array"):this._shared&&b.atomics&&Atomics.store(this.data,0,1)},e.prototype.unlock=function(){o("esri-2d-debug")&&5121===this.pixelType?g.error("AttributeStore-Bad-Type","Tried to unlock non integer array type with float array"):this._shared&&b.atomics&&Atomics.store(this.data,0,0)},e.prototype.expand=function(e){if(!this.textureOnly){var t=this._initData(this.pixelType,e,this._shared,this._ctype),r=l.expect(this.data);t.set(r),this.data=t}},e.prototype.toMessage=function(){var e=this.dirtyStart,t=this.dirtyEnd,r=this.texelSize;if(e>t)return null;this._resetRange();var n=!(this._shared||"local"===this._ctype),i=this.pixelType,a=this.layout,o=l.expect(this.data);return o.slice?{start:e,end:t,data:n&&o.slice(e*r,(t+1)*r)||null,pixelType:i,layout:a}:n?{start:e,end:t,data:new(d.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,e*r,(t+1)*r)),pixelType:i,layout:a}:{start:e,end:t,data:null,pixelType:i,layout:a}},e.prototype._initData=function(e,t,r,n){for(var i=r&&"local"!==n?SharedArrayBuffer:ArrayBuffer,a=d.Utils.getPixelArrayCtor(e),o=new a(new i(t*t*4*a.BYTES_PER_ELEMENT)),s=0;s<o.length;s+=4)o[s+1]=255;return o},e.prototype._resetRange=function(){this.dirtyStart=4294967295,this.dirtyEnd=0},e}(),x=function(){function e(e){this._attributeComputeMap=new Map,this._blocks=new Array,this._idMap=new Map,this._localToObjectId=new Map,this._filters=new Array(d.definitions.MAX_FILTERS),this._freeList=[],this._abortController=c.createAbortController(),this._hasScaleExpr=!1,this._size=32,this._idCounter=1,this._idsToHighlight=new Set;var t=b.oesTextureFloat?5126:5121;_("Creating AttributeStore "+(b.sharedArrayBuffer?"with":"without")+" shared memory"),o("esri-2d-debug")&&b.sharedArrayBuffer&&!b.atomics&&g.warn("Browser supports SharedArrayBuffer but not Atomics. Rendering may be impacted"),this._client=e,this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:t,layout:15},{pixelType:t,layout:15}],this._blocks=this._blockDescriptors.map((function(e){return null}))}return e.prototype.destroy=function(){this._abortController.abort()},Object.defineProperty(e.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0}),e.prototype.createLocalId=function(e){if(!this._idMap.has(e)){var t=this._getFreeId();this._idMap.set(e,-1===t?0:t),this._localToObjectId.set(t,e)}return this._idMap.get(e)},e.prototype.freeLocalId=function(e){var t=this._idMap.get(e);this._idMap.delete(e),this._localToObjectId.delete(t),this._freeList.push(t)},e.prototype.getFeatureId=function(e){return this._localToObjectId.get(e)},e.prototype.getLocalId=function(e){return this._idMap.has(e)?this._idMap.get(e):null},e.prototype.setHighlight=function(e){return i(this,void 0,void 0,(function(){var t,r,i,a,o,s,u=this;return n(this,(function(n){switch(n.label){case 0:for(1,this._getBlock(0).lock(),this._idsToHighlight.forEach((function(e){var t=u.getLocalId(e);if(t){var r=u._getBlock(0).getData(t,0);u._getBlock(0).setData(t,0,-2&r)}})),this._idsToHighlight.clear(),t=0,r=e;t<r.length;t++)i=r[t],this._idsToHighlight.add(i);for(a=0;a<e.length;a++)null!=(o=this.getLocalId(e[a]))&&(s=this._getBlock(0).getData(o,0),this._getBlock(0).setData(o,0,1|s));return this._getBlock(0).unlock(),[4,this.sendUpdates()];case 1:return n.sent(),[2]}}))}))},e.prototype.addHighlight=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2]}))}))},e.prototype.removeHighlight=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2]}))}))},e.prototype.updateFilters=function(e){return i(this,void 0,void 0,(function(){var t,r,i,a,o,s,u=this;return n(this,(function(n){switch(n.label){case 0:return t=e.config,r=e.service,i=e.spatialReference,a=t.filters,o=t.definitionExpression,s=a.map((function(t,n){return u._updateFilter(e,t,n,r,o,i)})),[4,c.all(s)];case 1:return n.sent(),[2]}}))}))},e.prototype.setAttributeBindings=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){switch(this._hasScaleExpr=!1,e.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":return[2,this._bindVVEvaluators(e.visualVariables,t)];case"dot-density":return[2,this._bindDDEvaluators(e.attributes,t)];case"heatmap":break;default:g.error(new a("attribute-store","Found invalid renderer type: "+e))}return[2]}))}))},e.prototype.setData=function(e,t,r,n){this._getBlock(t).setData(e,r,n)},e.prototype.setAttributeData=function(e,t,r,n){var i=this,a=e;this._getBlock(0).setData(a,0,this._getFilterFlags(t));var o=this._attributeComputeMap,s=b.oesTextureFloat?1:2;o.forEach((function(e,o){var l=o*s%4,c=Math.floor(o*s/4),f=i._getBlock(c+y.ATTRIBUTE_DATA_VV),p=e(t,{$view:n},r);if(b.oesTextureFloat)f.setData(a,l,p);else if(p===d.definitions.NAN_MAGIC_NUMBER)f.setData(a,l,255),f.setData(a,l+1,255);else{var h=u.clamp(Math.round(p),-32767,32766)+32768,v=255&h,m=(65280&h)>>8;f.setData(a,l,v),f.setData(a,l+1,m)}}))},e.prototype.sendUpdates=function(){var e=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=c.createResolver(),this._nextUpdate.promise;var t={blocks:this._blocks.map((function(e){return l.isSome(e)?e.toMessage():null}))};return this._currUpdate=this._createResources().then((function(){var r=e._client.update(t,e._signal).then((function(){if(e._currUpdate=null,e._nextUpdate){var t=e._nextUpdate;e._nextUpdate=null,e.sendUpdates().then((function(){return t.resolve()}))}}));return e._client.render(),r})),this._currUpdate},e.prototype._createResources=function(){var e=this;if(l.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(y.ATTRIBUTE_DATA_ANIMATION),_("Initializing AttributeStore");var t={shared:b.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:l.mapMany(this._blocks,(function(e){return{textureOnly:e.textureOnly,buffer:e.buffer,pixelType:e.pixelType}}))},r=this._client.initialize(t,this._signal);return this._createResourcesPromise=r,r.then((function(){return l.isNone(e._createResourcesPromise)?e._createResources():void 0})),r},e.prototype._getBlock=function(e){var t=this._blocks[e];if(l.isSome(t))return t;_("Initializing AttributeBlock at index "+e);var r=b.sharedArrayBuffer,n=this._client.type,i=new S(r,n,this._size,this._blockDescriptors[e]);return this._blocks[e]=i,this._createResourcesPromise=null,i},e.prototype._expand=function(){if(this._size<b.maxTextureSize){var e=this._size<<=1;return _("Expanding block size to",e,this._blocks),l.forEachSome(this._blocks,(function(t){return t.expand(e)})),this._createResourcesPromise=null,this._size=e,0}return g.error(new a("mapview-limitations","Maximum number of onscreen features exceeded.")),-1},e.prototype._getFreeId=function(){return this._freeList.length?this._freeList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++},e.prototype._updateFilter=function(e,t,r,a,o,s){return i(this,void 0,void 0,(function(){var i,u,c,f,p,h,d,v=this;return n(this,(function(n){switch(n.label){case 0:return i=this._filters[r],(l.isSome(i)&&i.hash)===JSON.stringify(t)?[2]:(u=1<<r+1,l.isNone(t)?(this._filters[r]=null,this._idMap.forEach((function(e){var t=v._getBlock(0).getData(e,0);v._getBlock(0).setData(e,0,t|u)})),[2]):[4,e.queryObjectIds(t)]);case 1:return c=n.sent(),t.hiddenIds&&t.hiddenIds.length&&(c=c.filter((function(e){return-1===t.hiddenIds.indexOf(e)}))),f=c.map((function(e){return v._idMap.get(e)})),[4,this._getFilter(r,a)];case 2:for(n.sent().update(t,o,s),this._getBlock(0).lock(),this._idMap.forEach((function(e){var t=v._getBlock(0).getData(e,0);v._getBlock(0).setData(e,0,t&~u)})),p=0;p<f.length;p++)null!=(h=f[p])&&(d=this._getBlock(0).getData(h,0),this._getBlock(0).setData(h,0,d|u));return this._getBlock(0).unlock(),[2]}}))}))},e.prototype._getFilter=function(e,t){return i(this,void 0,void 0,(function(){var i,a,o;return n(this,(function(n){switch(n.label){case 0:return i=this._filters[e],l.isSome(i)?[2,i]:[4,new Promise((function(e,t){Promise.all([r.e(5),r.e(66)]).then(function(){var t=[r(968)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:return a=n.sent().default,o=new a({geometryType:t.geometryType,hasM:!1,hasZ:!1,timeInfo:t.timeInfo,fieldsIndex:new f(t.fields)}),this._filters[e]=o,[2,o]}}))}))},e.prototype._getFilterFlags=function(e){for(var t=0,r=0;r<this._filters.length;r++){var n=this._filters[r];t|=(l.isNone(n)||n.check(e)?1:0)<<r}var i=this.getFeatureId(e.localId);return t<<1|(this._idsToHighlight.has(i)?1:0)},e.prototype._bindVVEvaluators=function(e,t){return i(this,void 0,void 0,(function(){var r=this;return n(this,(function(a){switch(a.label){case 0:return this._attributeComputeMap.clear(),l.isSome(e)?[4,c.all(e.map((function(e){return i(r,void 0,void 0,(function(){var r,i;return n(this,(function(n){switch(n.label){case 0:return r=d.Utils.getVVType(e.type),[4,this._createGetValueFunction(e,t)];case 1:return i=n.sent(),l.isSome(i)&&this._attributeComputeMap.set(r,i),[2]}}))}))})))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},e.prototype._bindDDEvaluators=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,o=this;return n(this,(function(n){switch(n.label){case 0:return this._attributeComputeMap.clear(),e.length>d.definitions.DOT_DENSITY_MAX_FIELDS&&g.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+d.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+e.length),[4,c.all(e.map((function(e){return o._createNormalizedFunction(e,t)})))];case 1:for(r=n.sent().map((function(e){return I(0,e)})),i=0;i<d.definitions.DOT_DENSITY_MAX_FIELDS;i++)(a=i<e.length&&r[i])?this._attributeComputeMap.set(i,a):this._attributeComputeMap.has(i)&&this._attributeComputeMap.delete(i);return[2]}}))}))},e.prototype._createGetValueFunction=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,o,s,u,l;return n(this,(function(n){switch(n.label){case 0:return"size"!==e.type?[3,2]:(r=d.getTypeOfSizeVisualVariable(e))===d.enums.WGLVVFlag.SIZE_SCALE_STOPS?[2,null]:(i=r===d.enums.WGLVVFlag.SIZE_UNIT_VALUE,a=i&&function(t){return m.getVisualVariableSizeValueRepresentationRatio(t,e.valueRepresentation)},o=I,s=[d.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(e,t,a)]);case 1:return[2,o.apply(void 0,s.concat([n.sent()]))];case 2:return u=I,l=[d.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(e,t)];case 3:return[2,u.apply(void 0,l.concat([n.sent()]))]}}))}))},e.prototype._createNormalizedFunction=function(e,t,r){return i(this,void 0,void 0,(function(){var i,o,s;return n(this,(function(n){switch(n.label){case 0:return(i=e.field)?"string"==typeof i?(o=e.normalizationField)?[2,function(e){if(e.attributes[i]&&e.attributes[o]){var t=e.attributes[i]/e.attributes[o];return r?r(t):t}}]:[2,r?function(e){return r(e.attributes[i])}:function(e){return e.attributes[i]}]:(g.error(new a("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof i)),[2,function(e){}]):e.valueExpression?(this._hasScaleExpr=this._hasScaleExpr||-1!==e.valueExpression.indexOf("scale"),[4,p.createVVExpression(e.valueExpression,t.spatialReference,t.fields)]):[3,2];case 1:return s=n.sent(),[2,v.callWithOptimizedFeature.bind(null,s)];case 2:return g.error("Unable to create a normalized function for visual variable: "+e),[2,function(e){}]}}))}))},e}();t.default=x}.apply(null,n))||(e.exports=i)},915:function(e,t,r){var n,i;n=[r(24),r(22)],void 0===(i=function(e,t){var r={};return t.setObject("dojo.regexp",r),r.escapeString=function(e,t){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(function(e){return t&&-1!=t.indexOf(e)?e:"\\"+e}))},r.buildGroupRE=function(e,t,n){if(!(e instanceof Array))return t(e);for(var i=[],a=0;a<e.length;a++)i.push(t(e[a]));return r.group(i.join("|"),n)},r.group=function(e,t){return"("+(t?"?:":"")+e+")"},r}.apply(null,n))||(e.exports=i)},917:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function n(e,t,n,i,a,o){for(var s=r(a,o),u=n,l=n+s,c=0,f=0,p=0,h=0,d=0,v=0,y=i-1;v<y;v++,u+=s,l+=s){var m=t[u],g=t[u+1],_=t[u+2],I=t[l],b=t[l+1],S=t[l+2],x=m*b-I*g;h+=x,c+=(m+I)*x,f+=(g+b)*x,a&&(p+=(_+S)*(x=m*S-I*_),d+=x),m<e[0]&&(e[0]=m),m>e[1]&&(e[1]=m),g<e[2]&&(e[2]=g),g>e[3]&&(e[3]=g),a&&(_<e[4]&&(e[4]=_),_>e[5]&&(e[5]=_))}if(h>0&&(h*=-1),d>0&&(d*=-1),!h)return null;var E=[c,f,.5*h];return a&&(E[3]=p,E[4]=.5*d),E}function i(e,t,n,i,l){for(var c=r(i,l),f=t,p=t+c,h=0,d=0,v=0,y=0,m=0,g=n-1;m<g;m++,f+=c,p+=c){var _=e[f],I=e[f+1],b=e[f+2],S=e[p],x=e[p+1],E=e[p+2],T=i?o(_,I,b,S,x,E):a(_,I,S,x);if(T)if(h+=T,i){d+=T*(M=u(_,I,b,S,x,E))[0],v+=T*M[1],y+=T*M[2]}else{var M;d+=T*(M=s(_,I,S,x))[0],v+=T*M[1]}}return h>0?i?[d/h,v/h,y/h]:[d/h,v/h]:n>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function a(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function o(e,t,r,n,i,a){var o=n-e,s=i-t,u=a-r;return Math.sqrt(o*o+s*s+u*u)}function s(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function u(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCentroidOptimizedGeometry=function(e,t,a,o){if(!t||!t.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);for(var s=e.coords,u=[],l=a?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],c=t.lengths,f=t.coords,p=r(a,o),h=0,d=0,v=c;d<v.length;d++){var y=v[d],m=n(l,f,h,y,a,o);m&&u.push(m),h+=y*p}if(u.sort((function(e,t){var r=e[2]-t[2];return 0===r&&a&&(r=e[4]-t[4]),r})),u.length){var g=6*u[0][2];s[0]=u[0][0]/g,s[1]=u[0][1]/g,a&&(g=6*u[0][4],s[2]=0!==g?u[0][3]/g:0),(s[0]<l[0]||s[0]>l[1]||s[1]<l[2]||s[1]>l[3]||a&&(s[2]<l[4]||s[2]>l[5]))&&(s.length=0)}if(!s.length){var _=t.lengths[0]?i(f,0,c[0],a,o):null;if(!_)return null;s[0]=_[0],s[1]=_[1],a&&_.length>2&&(s[2]=_[2])}return e},t.lineCentroid=i}.apply(null,n))||(e.exports=i)},918:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(11),r(4),r(93),r(179),r(56),r(37),r(960),r(880),r(877),r(886),r(901)],void 0===(i=function(e,t,n,i,a,o,s,u,l,c,f,p,h,d,v){function y(){return o.create((function(e){return Promise.resolve().then(function(){var t=[r(289)];e.apply(null,t)}.bind(this)).catch(r.oe)}))}Object.defineProperty(t,"__esModule",{value:!0});var m="feature-store:unsupported-query",g={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},_={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.importGeometryEngine=y,t.getGeodesicBufferOperator=function(){return y().then((function(e){return e.geodesicBuffer}))},t.getSpatialQueryOperator=function(e,t,r){if(l.isPolygon(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var n=p.convertFromPolygon(new h.default,t,!1,!1);return o.resolve((function(e){return f.polygonContainsPoint(n,!1,!1,e)}))}if(l.isPolygon(t)&&"esriGeometryMultipoint"===r.geometryType){var i=p.convertFromPolygon(new h.default,t,!1,!1);if("esriSpatialRelContains"===e)return o.resolve((function(e){return f.polygonContainsMultipoint(i,!1,!1,e,r.hasZ,r.hasM)}))}if(l.isExtent(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return o.resolve((function(e){return s.extentContainsPoint(t,v.getGeometry(r,e))}));if(l.isExtent(t)&&"esriGeometryMultipoint"===r.geometryType&&"esriSpatialRelContains"===e)return o.resolve((function(e){return s.extentContainsMultipoint(t,v.getGeometry(r,e))}));if(l.isExtent(t)&&"esriSpatialRelIntersects"===e){var a=u.getExtentIntersector(r.geometryType);return o.resolve((function(e){return a(t,v.getGeometry(r,e))}))}return y().then((function(n){var i=n[g[e]].bind(null,t);return function(e){return i(v.getGeometry(r,e))}}))},t.checkSpatialQuerySupport=function(e,t,r){return i(this,void 0,void 0,(function(){var i,o;return n(this,(function(n){if(i=e.spatialRel,!(o=e.geometry))return[2];if(!function(e){return!0===_.spatialRelationship[e]}(i))throw new a(m,"Unsupported query spatial relationship",{query:e});if(!c.isValid(o.spatialReference)||!c.isValid(r))return[2];if(!function(e){return!0===_.queryGeometry[l.getJsonType(e)]}(o))throw new a(m,"Unsupported query geometry type",{query:e});if(!function(e){return!0===_.layerGeometry[e]}(t))throw new a(m,"Unsupported layer geometry type",{query:e});return e.outSR?[2,d.checkProjectionSupport(e.geometry&&e.geometry.spatialReference,e.outSR)]:[2]}))}))},t.canQueryWithRBush=function(e){if(l.isExtent(e))return!0;if(l.isPolygon(e)){for(var t=0,r=e.rings;t<r.length;t++){var n=r[t];if(5!==n.length)return!1;if(n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1}return!0}return!1}}.apply(null,n))||(e.exports=i)},922:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t,r,n,i){if(null!=n&&null!=i&&n===i){var a=n;return function(n){return a>=e.getAttribute(n,t)&&a<=e.getAttribute(n,r)}}return null!=n&&null!=i?function(a){return function(e,t,r,n){return!(r>t||n<e)}(n,i,e.getAttribute(a,t),e.getAttribute(a,r))}:null!=n?function(t){return!(e.getAttribute(t,r)<n)}:null!=i?function(r){return!(e.getAttribute(r,t)>i)}:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeExtent=function(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),s=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==s||isNaN(s)||(o=Math.max(o,s))}));else{var s=n||i;t.forEach((function(e){var t=r.getAttribute(e,s);null==t||isNaN(t)||(a=Math.min(a,t),o=Math.max(o,t))}))}return{start:a,end:o}},t.getTimeOperator=function(e,t,n){if(!t||!e)return null;var i=e.startTimeField,a=e.endTimeField;if(!i&&!a)return null;var o=t.start,s=t.end;return null==o&&null==s?null:i&&a?r(n,i,a,o,s):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){return e.getAttribute(i,t)>=r&&e.getAttribute(i,t)<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(n,i||a,o,s)}}.apply(null,n))||(e.exports=i)},938:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(18),r(11),r(50),r(15),r(9),r(16),r(895),r(899),r(168),r(880),r(958)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d){Object.defineProperty(t,"__esModule",{value:!0});var v=[],y=u.getLogger("esri.layers.graphics.data.FeatureStore"),m={minX:0,minY:0,maxX:0,maxY:0},g=function(){function e(e,t,r){this._geometryInfo=e,this._onFeatureAdd=t,this._onFeatureRemove=r,this._featuresById=new Map,this._boundsByFeature=new Map,this._featuresByBounds=new Map,this._index=c(9,s("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this.events=new o,this.featureAdapter=d.optimizedFeatureQueryEngineAdapter}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var e=p.create(p.NEGATIVE_INFINITY);return this._boundsByFeature.forEach((function(t){t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]))})),e},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this._add(e,v),this._index.load(v),this._emitChanged(),v.length=0},e.prototype.addMany=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this._add(n,v)}this._index.load(v),this._emitChanged(),v.length=0},e.prototype.clear=function(){this._featuresById.clear(),this._boundsByFeature.clear(),this._featuresByBounds.clear(),this._index.clear(),this._emitChanged()},e.prototype.removeById=function(e){var t=this._featuresById.get(e);if(!t)return null;var r=this._boundsByFeature.get(t);return r&&(this._index.remove(r),this._featuresByBounds.delete(r)),this._boundsByFeature.delete(t),this._featuresById.delete(e),this._emitChanged(),t},e.prototype.removeIf=function(e,t){var r=this;this._featuresById.forEach((function(n,i){t(n)&&(r._remove(n),e.push(n))})),this._emitChanged()},e.prototype.removeManyById=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t],i=this._featuresById.get(n);if(i){var a=this._boundsByFeature.get(i);a&&(this._index.remove(a),this._featuresByBounds.delete(a)),this._boundsByFeature.delete(i)}this._featuresById.delete(n)}this._emitChanged()},e.prototype.forEachBounds=function(e,t,r){for(var n=0,i=e;n<i.length;n++){var a=i[n],o=this._boundsByFeature.get(a);o&&t(f.fromRect(r,o))}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.has=function(e){return this._featuresById.has(e)},e.prototype.forEach=function(e){this._featuresById.forEach((function(t){return e(t)}))},e.prototype.forEachInBounds=function(e,t){for(var r=0,n=function(e,t){return m.minX=t[0],m.minY=t[1],m.maxX=t[2],m.maxY=t[3],e.search(m)}(this._index,e);r<n.length;r++){var i=n[r];t(this._featuresByBounds.get(i))}},e.prototype.transferById=function(e,t){var r=this._featuresById.get(t);r&&(this._remove(r),e.add(r),this._emitChanged())},e.prototype.transferByIds=function(e,t){for(var r=[],n=0,i=t;n<i.length;n++){var a=i[n],o=this._featuresById.get(a);o&&(this._remove(o),r.push(o))}e.addMany(r),this._emitChanged()},e.prototype.transferIdRange=function(e,t,r){for(var n=[],i=t;i<r;i++){var a=this._featuresById.get(i);a&&(this._remove(a),n.push(a))}e.addMany(n),this._emitChanged()},e.prototype.transferIf=function(e,t){var r=this,n=[];this._featuresById.forEach((function(e,i){t(e)&&(r._remove(e),n.push(e))})),e.addMany(n),this._emitChanged()},e.prototype.transferAll=function(e){var t=this,r=[];this._featuresById.forEach((function(e,n){t._remove(e),r.push(e)})),e.addMany(r),this._emitChanged()},e.prototype._emitChanged=function(){this.events.emit("changed",void 0)},e.prototype._add=function(e,t){if(e){var r=e.objectId;if(null==r)return void y.error(new a("featurestore:invalid-feature","feature id is missing",{feature:e}));var n,i=this._featuresById.get(r);if(i?(n=this._boundsByFeature.get(i),e.localId=i.localId,n&&(this._index.remove(n),this._boundsByFeature.delete(i),this._featuresByBounds.delete(n))):l.isSome(this._onFeatureAdd)&&this._onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsByFeature.set(e,null),void this._featuresById.set(r,e);n=h.getBoundsOptimizedGeometry(n||p.create(),e.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(e,n),this._featuresByBounds.set(n,e),this._featuresById.set(r,e),t.push(n)}},e.prototype._remove=function(e){var t;e&&(l.isSome(this._onFeatureRemove)&&this._onFeatureRemove(e),(t=this._boundsByFeature.get(e))&&(this._index.remove(t),this._boundsByFeature.delete(e),this._featuresByBounds.delete(t)),this._featuresById.delete(e.objectId))},e}();t.default=g}.apply(null,n))||(e.exports=i)},939:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(6),r(8),r(11),r(57),r(5),r(9),r(283),r(4),r(78),r(899),r(168),r(281),r(56),r(37),r(900),r(886),r(945),r(983),r(918),r(922),r(901),r(274),r(985)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v,y,m,g,_,I,b,S,x,E,T){Object.defineProperty(t,"__esModule",{value:!0});var M=u.getLogger("esri.layers.graphics.data.QueryEngine"),w=function(e,t,r,n,i){void 0===t&&(t=null),this.attributes=e,this.geometry=r,this.centroid=n,this.filterFlags=i,this.groupId=-1,this.localId=t};t.Feature=w;var N=new Set,A=new l.MemCacheStorage(2e6),R=0,F=function(){function e(e){var t=this;this.capabilities={query:_.queryCapabilities},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.cacheSpatialQueries=e.cacheSpatialQueries||!1,this.gdbVersion=e.gdbVersion,this.historicMoment=e.historicMoment,this.featureStore=e.featureStore,this._changeHandle=this.featureStore.events.on("changed",(function(){return t.clearCache()})),this.timeInfo=e.timeInfo,this.cacheSpatialQueries&&(this._geometryQueryCache=new l.MemCache(R+++"$$",A)),this.fieldsIndex=new E(e.fields),e.scheduler&&e.task&&(this._frameQueue=new T.PromiseQueue,this._frameTask=e.scheduler.registerTask(e.task,(function(e){return t._update(e)}),(function(){return t._frameQueue.length>0})))}return e.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()},Object.defineProperty(e.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullExtent",{get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:x.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:(this._timeExtent=S.getTimeExtent(this.timeInfo,this.featureStore),this._timeExtent):null},enumerable:!0,configurable:!0}),e.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null},e.prototype.executeQuery=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,r,i;return n(this,(function(n){switch(n.label){case 0:t=s.clone(e),n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,x.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return t=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=n.sent(),[3,15];case 14:if((i=n.sent())!==x.QUERY_ENGINE_EMPTY_RESULT)throw i;return r=new I.default([],null,this),[3,15];case 15:return[2,r.createQueryResponse(t)]}}))}))},e.prototype.executeQueryForCount=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,r,i;return n(this,(function(n){switch(n.label){case 0:(t=s.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,x.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return t=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return[2,(r=n.sent()).size];case 14:if((i=n.sent())!==x.QUERY_ENGINE_EMPTY_RESULT)throw i;return[2,0];case 15:return[2]}}))}))},e.prototype.executeQueryForExtent=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,r,i,a,o,u,l,c;return n(this,(function(n){switch(n.label){case 0:t=s.clone(e),i=t.outSR,n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,x.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return(t=n.sent()).returnGeometry=!0,t.returnCentroid=!1,t.outSR=null,[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=n.sent(),(a=r.size)?(p.set(C,p.NEGATIVE_INFINITY),this.featureStore.forEachBounds(r.items,(function(e){return p.expand(C,e)}),O),o={xmin:C[0],ymin:C[1],xmax:C[3],ymax:C[4],spatialReference:x.cleanFromGeometryEngine(this.spatialReference)},this.hasZ&&isFinite(C[2])&&isFinite(C[5])&&(o.zmin=C[2],o.zmax=C[5]),(u=g.project(o,r.spatialReference,i)).spatialReference=x.cleanFromGeometryEngine(i||this.spatialReference),u.xmax-u.xmin==0&&(l=f.getMetersPerUnitForSR(u.spatialReference),u.xmin-=l,u.xmax+=l),u.ymax-u.ymin==0&&(l=f.getMetersPerUnitForSR(u.spatialReference),u.ymin-=l,u.ymax+=l),this.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0&&(l=f.getMetersPerUnitForSR(u.spatialReference),u.zmin-=l,u.zmax+=l),[2,{count:a,extent:u}]):[2,{count:a,extent:null}];case 14:if((c=n.sent())===x.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw c;case 15:return[2]}}))}))},e.prototype.executeQueryForIds=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){return n(this,(function(r){return[2,this.executeQueryForIdSet(e,t).then((function(e){return o.valuesOfSet(e)}))]}))}))},e.prototype.executeQueryForIdSet=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,r,i,a,o,u,l,c;return n(this,(function(n){switch(n.label){case 0:(t=s.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,n.label=1;case 1:return n.trys.push([1,13,,14]),[4,this._schedule()];case 2:return n.sent(),[4,x.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._executeGeometryQuery(t)];case 5:return r=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeTimeQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeAttributesQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:for(n.sent(),i=r.items,a=new Set,o=0,u=i;o<u.length;o++)l=u[o],a.add(r.featureAdapter.getObjectId(l));return[2,a];case 13:if((c=n.sent())===x.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw c;case 14:return[2]}}))}))},e.prototype.executeQueryForLatestObservations=function(e,t){var r=this;return this.timeInfo?this.executeQuery(e,t).then((function(e){return r._filterLatest(e,r.timeInfo)})):void M.error(new a("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))},e.prototype._schedule=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){return this._frameQueue?[2,this._frameQueue.push(e).then((function(e){return e}))]:[2,e]}))}))},e.prototype._reschedule=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){return this._frameQueue?[2,this._frameQueue.unshift(e).then((function(e){return e}))]:[2,e]}))}))},e.prototype._update=function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null},e.prototype._filterLatest=function(e,t){for(var n=t.trackIdField,i=t.startTimeField,a=t.endTimeField||i,o=new Map,s=[],u=0,l=e.features;u<l.length;u++){var c=l[u],f=c.attributes[n],p=c.attributes[a];(!o.has(f)||o.get(f).attributes[a]<p)&&o.set(f,c)}return o.forEach((function(e){return s.push(e)})),r({},e,{features:s})},e.prototype._getAll=function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new I.default(e,null,this)}return this._allItems},e.prototype._executeGeometryQuery=function(e){return i(this,void 0,void 0,(function(){var t,r,a,o,s,u,l,c,f,p,h,d,v,m,g,_,S,x,E,T,M,w,N,A=this;return n(this,(function(R){switch(R.label){case 0:if(t=e.geometry,r=e.outSR,a=e.spatialRel,o=y.isValid(r)&&!y.equals(this.spatialReference,r),(s=this.cacheSpatialQueries?o?JSON.stringify({geometry:t,spatialRelationship:a,outSpatialReference:r}):JSON.stringify({geometry:t,spatialRelationship:a}):null)&&void 0!==(u=this._geometryQueryCache.get(s)))return[2,u];if(l=function(t){return i(A,void 0,void 0,(function(){var i;return n(this,(function(n){switch(n.label){case 0:return o&&(e.returnGeometry||e.returnCentroid)?[4,t.project(r)]:[3,2];case 1:return i=n.sent(),s&&this._geometryQueryCache.put(s,i,i.size||1),[2,i];case 2:return s&&this._geometryQueryCache.put(s,t,t.size||1),[2,t]}}))}))},!t)return[2,l(this._getAll())];if(c=this.featureAdapter,"esriSpatialRelDisjoint"!==a)return[3,5];if(!(f=this._searchFeatures(this._getQueryBBoxes(t))).length)return[2,l(this._getAll())];for(d=new Set,v=0,m=f;v<m.length;v++)g=m[v],d.add(c.getObjectId(g));return[4,this._reschedule(d)];case 1:return d=R.sent(),_=0,p=new Array(d.size),this.featureStore.forEach((function(e){return p[_++]=e})),h=d,[4,this._reschedule()];case 2:return R.sent(),[4,b.getSpatialQueryOperator(a,t,this)];case 3:return S=R.sent(),x=function(e){return!h.has(c.getObjectId(e))||S(c.getGeometry(e))},E=I.default.bind,[4,this._runSpatialFilter(p,x)];case 4:return M=new(E.apply(I.default,[void 0,R.sent(),t,this])),[2,l(M)];case 5:return(T=this._searchFeatures(this._getQueryBBoxes(t))).length?this._canExecuteSoloPass(t,e)?[2,l(new I.default(T,t,this))]:[4,b.getSpatialQueryOperator(a,t,this)]:(M=new I.default([],t,this),s&&this._geometryQueryCache.put(s,M,M.size||1),[2,M]);case 6:return w=R.sent(),[4,this._runSpatialFilter(T,(function(e){return w(c.getGeometry(e))}))];case 7:return N=R.sent(),[2,l(new I.default(N,t,this))]}}))}))},e.prototype._runSpatialFilter=function(e,t){return i(this,void 0,void 0,(function(){var r,a,o,s=this;return n(this,(function(u){return t?this._budget?(r=0,a=new Array,o=function(){return i(s,void 0,void 0,(function(){var i;return n(this,(function(n){switch(n.label){case 0:return r<e.length?(i=e[r],t(i)&&a.push(i),this._budget.done?[4,this._reschedule()]:[3,2]):[3,3];case 1:return n.sent(),[2,o()];case 2:return++r,[3,0];case 3:return[2]}}))}))},[2,this._reschedule().then((function(){return o()})).then((function(){return a}))]):[2,e.filter((function(e){return t(e)}))]:[2,e]}))}))},e.prototype._canExecuteSoloPass=function(e,t){var r=this.geometryType,n=t.spatialRel;return b.canQueryWithRBush(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))},e.prototype._getQueryBBoxes=function(e){if(b.canQueryWithRBush(e)){if(v.isExtent(e))return[h.fromValues(e.xmin,e.ymin,e.xmax,e.ymax)];if(v.isPolygon(e))return e.rings.map((function(e){return h.fromValues(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[d.getBoundsXY(h.create(),e)]},e.prototype._searchFeatures=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this.featureStore.forEachInBounds(n,(function(e){N.add(e)}))}var i=new Array(N.size),a=0;return N.forEach((function(e){return i[a++]=e})),N.clear(),i},e.prototype._checkQuerySupport=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new a("feature-store:unsupported-query","Unsupported query options",{query:e});return[2,c.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),b.checkSpatialQuerySupport(e,this.geometryType,this.spatialReference),g.checkProjectionSupport(this.spatialReference,e.outSR)]).then((function(){return e}))]}))}))},e.prototype._checkAttributesQuerySupport=function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues;if(r&&r.length>0){var i=r.map((function(e){return e.indexOf(" ASC")>-1?e.split(" ASC")[0]:e.indexOf(" DESC")>-1?e.split(" DESC")[0]:e}));m.validateFields(this.fieldsIndex,i,"orderByFields contains missing fields")}if(t&&t.length>0)m.validateFields(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new a("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});m.validateWhere(this.fieldsIndex,e.where)},e.prototype._checkStatisticsQuerySupport=function(e){return i(this,void 0,void 0,(function(){var t,r,i,o,s,u,l,c,f,p,h;return n(this,(function(n){if(t=e.outStatistics,r=e.groupByFieldsForStatistics,i=e.having,o=r&&r.length,s=t&&t.length,i){if(!o||!s)throw new a("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});m.validateHaving(this.fieldsIndex,i,t)}if(s){if(t.some((function(e){return"exceedslimit"===e.statisticType})))return[2];for(u=t.map((function(e){return e.onStatisticField})),m.validateFields(this.fieldsIndex,u,"onStatisticFields contains missing fields"),o&&m.validateFields(this.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields"),l=0,c=t;l<c.length;l++){if(f=c[l],p=f.onStatisticField,"exceedslimit"===(h=f.statisticType))throw new a("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:f,query:e});if((!o||"count"!==h)&&p&&m.hasInvalidFieldType(p,this.fieldsIndex))throw new a("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:f,query:e})}}return[2]}))}))},e}();t.default=F;var O=p.create(),C=p.create()}.apply(null,n))||(e.exports=i)},940:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(283)],void 0===(i=function(e,t,r){return function(){function e(e,t){this._storage=new r.MemCacheStorage,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}return e.prototype.put=function(e,t){this._storage.put(e,t,1,1)},e.prototype.pop=function(e){return this._storage.pop(e)},e.prototype.get=function(e){return this._storage.get(e)},e.prototype.clear=function(){this._storage.clearAll()},e.prototype.destroy=function(){this._storage.clearAll()},e}()}.apply(null,n))||(e.exports=i)},945:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}}.apply(null,n))||(e.exports=i)},958:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(917),r(884),r(877)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.optimizedFeatureQueryEngineAdapter={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new n.default(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=r.getCentroidOptimizedGeometry(new i.default,e.geometry,t.hasZ,t.hasM)),e.centroid}},t.default=t.optimizedFeatureQueryEngineAdapter}.apply(null,n))||(e.exports=i)},959:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(940),r(828)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._cache=new r(e),this._invalidCache=new r(t)}return e.prototype.get=function(e,t){var r=t.uid+":"+e,i=this._cache.get(r);if(i)return i;if(void 0!==this._invalidCache.get(r))return null;try{var a=n.WhereClause.create(e,t);return this._cache.put(r,a),a}catch(e){return this._invalidCache.put(r,null),null}},e}();t.WhereClauseCache=i}.apply(null,n))||(e.exports=i)},960:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function n(e,t,n,a,o){if(!e)return!1;for(var s=r(t,n),u=e.coords,l=!1,c=0,f=0,p=e.lengths;f<p.length;f++){var h=p[f];l=i(l,u,s,c,h,a,o),c+=h*s}return l}function i(e,t,r,n,i,a,o){for(var s=e,u=n,l=n,c=n+i*r;l<c;l+=r){(u=l+r)===c&&(u=n);var f=t[l],p=t[l+1],h=t[u],d=t[u+1];(p<o&&d>=o||d<o&&p>=o)&&f+(o-p)/(d-p)*(h-f)<a&&(s=!s)}return s}Object.defineProperty(t,"__esModule",{value:!0}),t.polygonContainsPoint=function(e,t,r,i){return n(e,t,r,i.coords[0],i.coords[1])},t.polygonContainsMultipoint=function(e,t,i,a,o,s){var u=r(o,s),l=a.coords,c=a.lengths;if(!c)return!1;for(var f=0,p=0;f<c.length;f++,p+=u)if(!n(e,t,i,l[p],l[p+1]))return!1;return!0},t.polygonContainsCoords=n}.apply(null,n))||(e.exports=i)},979:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}function n(e){for(var t=r(e),n=e.length,i=0,a=0,o=e;a<o.length;a++){var s=o[a];i+=Math.pow(s-t,2)}return n>1?i/(n-1):0}Object.defineProperty(t,"__esModule",{value:!0}),t.aggregateFunction=function(e,t){var r=i[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isAggregate=function(e,t){var r=i[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var i={min:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.min.apply(Math,e[0])}},max:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.max.apply(Math,e[0])}},avg:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:r(e[0])}},sum:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}(e[0])}},stddev:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sqrt(n(e[0]))}},count:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].length}},var:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:n(e[0])}}}}.apply(null,n))||(e.exports=i)},980:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(915)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}return e.fixDefaults=function(e){if(null!==e.precision||null!==e.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")},e.createFromMilliseconds=function(t){var r=new e;return r.second=t/1e3,r},e.createFromValueAndQualifer=function(t,r,n){var i=new e;if(i.op="-"===n?"-":"+","interval-period"===r.type){e.fixDefaults(r);var a=new RegExp("^[0-9]{1,}$");if("year"===r.period||"month"===r.period)throw new Error("Year-Month Intervals not supported");if(!a.test(t))throw new Error("Illegal Interval");i[r.period]=parseFloat(t)}else{if(e.fixDefaults(r.start),e.fixDefaults(r.end),"year"===r.start.period||"month"===r.start.period)throw new Error("Year-Month Intervals not supported");if("year"===r.end.period||"month"===r.end.period)throw new Error("Year-Month Intervals not supported");switch(r.start.period){case"day":switch(r.end.period){case"hour":if(!new RegExp("^[0-9]{1,} [0-9]{1,}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]),i[r.end.period]=parseFloat(t.split(" ")[1]);break;case"minute":if(!new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]);var o=t.split(" ")[1].split(":");i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]);break;case"second":if(!new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]);o=t.split(" ")[1].split(":");i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]),i.second=parseFloat(o[2]);break;default:throw"Invalid Interval."}break;case"hour":switch(r.end.period){case"minute":if(!new RegExp("^[0-9]{1,}:[0-9]{1,}$").test(t))throw new Error("Illegal Interval");i.hour=parseFloat(t.split(":")[0]),i.minute=parseFloat(t.split(":")[1]);break;case"second":if(!new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");o=t.split(":");i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]),i.second=parseFloat(o[2]);break;default:throw"Invalid Interval."}break;case"minute":switch(r.end.period){case"second":if(!new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");o=t.split(":");i.minute=parseFloat(o[0]),i.second=parseFloat(o[1]);break;default:throw"Invalid Interval."}break;default:throw"Invalid Interval."}}return i},e.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)},e}();t.SqlInterval=n,t.evaluateFunction=function(e,t){var r=i[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isStandardized=function(e,t){var r=i[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var i={extract:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];if(null==r)return null;if(r instanceof Date)switch(t.toUpperCase()){case"SECOND":return r.getSeconds();case"MINUTE":return r.getMinutes();case"HOUR":return r.getHours();case"DAY":return r.getDate();case"MONTH":return r.getMonth()+1;case"YEAR":return r.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:function(e){if(2===e.length){var t=e[0],r=e[1];return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){t=e[0],r=e[1];var n=e[2];return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];return null==t||null==r?null:r.indexOf(t)+1}},trim:{minParams:2,maxParams:3,evaluate:function(e){var t=3===e.length,n=t?e[1]:" ",i=t?e[2]:e[1];if(null==n||null==i)return null;var a="("+r.escapeString(n)+")";switch(e[0]){case"BOTH":return i.replace(new RegExp("^"+a+"*|"+a+"*$","g"),"");case"LEADING":return i.replace(new RegExp("^"+a+"*","g"),"");case"TRAILING":return i.replace(new RegExp(a+"*$","g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.abs(e[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.ceil(e[0])}},floor:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.floor(e[0])}},log:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])}},log10:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sin(e[0])}},cos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.cos(e[0])}},tan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.tan(e[0])}},asin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.asin(e[0])}},acos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.acos(e[0])}},atan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.atan(e[0])}},sign:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0]>0?1:e[1]<0?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:Math.pow(e[0],e[1])}},mod:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:e[0]%e[1]}},round:{minParams:1,maxParams:2,evaluate:function(e){var t=e[0],r=2===e.length?Math.pow(10,e[1]):1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:function(e){return null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(e){return"string"==typeof e[0]||e[0]instanceof String?e[0].length:0}},concat:{minParams:1,maxParams:1/0,evaluate:function(e){for(var t="",r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toUpperCase()}}}}.apply(null,n))||(e.exports=i)},981:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(982)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.parse=function(e){return r.parse(e)},e}();t.WhereGrammar=n}.apply(null,n))||(e.exports=i)},982:function(e,t,r){var n;void 0===(n=function(){"use strict";function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function a(e){return o[e.type](e)}var o={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=a(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+n(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){function n(e,t){return{type:"literal",text:e,ignoreCase:t}}function i(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function a(e){var r,n=Xi[e];if(n)return n;for(r=e-1;!Xi[r];)r--;for(n={line:(n=Xi[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Xi[e]=n,n}function o(e,t){var r=a(e),n=a(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function s(e){Zi<Ji||(Zi>Ji&&(Ji=Zi,$i=[]),$i.push(e))}function u(){var e,t;return e=Zi,xe()!==Ae?(t=c())!==Ae?xe()!==Ae?(e,e=Oe(t)):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae),e}function l(){var e,t,r,n,i,a,o,s;if(e=Zi,(t=c())!==Ae){for(r=[],n=Zi,(i=xe())!==Ae?(a=Ie())!==Ae?(o=xe())!==Ae?(s=c())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);n!==Ae;)r.push(n),n=Zi,(i=xe())!==Ae?(a=Ie())!==Ae?(o=xe())!==Ae?(s=c())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);r!==Ae?(e,e=t=Ce(t,r)):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}function c(){var e,t,r,n,i,a,o,s;if(e=Zi,(t=f())!==Ae){for(r=[],n=Zi,(i=xe())!==Ae?(a=J())!==Ae?(o=xe())!==Ae?(s=f())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);n!==Ae;)r.push(n),n=Zi,(i=xe())!==Ae?(a=J())!==Ae?(o=xe())!==Ae?(s=f())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);r!==Ae?(e,e=t=Pe(t,r)):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}function f(){var e,t,r,n,i,a,o,s;if(e=Zi,(t=p())!==Ae){for(r=[],n=Zi,(i=xe())!==Ae?(a=X())!==Ae?(o=xe())!==Ae?(s=p())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);n!==Ae;)r.push(n),n=Zi,(i=xe())!==Ae?(a=X())!==Ae?(o=xe())!==Ae?(s=p())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);r!==Ae?(e,e=t=Pe(t,r)):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}function p(){var e,r,n,i,a;return e=Zi,(r=Z())===Ae&&(r=Zi,33===t.charCodeAt(Zi)?(n=Le,Zi++):(n=Ae,0===Ki&&s(ze)),n!==Ae?(i=Zi,Ki++,61===t.charCodeAt(Zi)?(a=De,Zi++):(a=Ae,0===Ki&&s(Ge)),Ki--,a===Ae?i=void 0:(Zi=i,i=Ae),i!==Ae?r=n=[n,i]:(Zi=r,r=Ae)):(Zi=r,r=Ae)),r!==Ae?(n=xe())!==Ae?(i=p())!==Ae?(e,e=r=Be(i)):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae),e===Ae&&(e=function(){var e,t,r;return e=Zi,(t=y())!==Ae&&xe()!==Ae?((r=function(){var e;return(e=function(){var e,t,r,n,i,a,o;if(e=Zi,t=[],r=Zi,(n=xe())!==Ae&&(i=h())!==Ae&&(a=xe())!==Ae&&(o=y())!==Ae?r=n=[n,i,a,o]:(Zi=r,r=Ae),r!==Ae)for(;r!==Ae;)t.push(r),r=Zi,(n=xe())!==Ae&&(i=h())!==Ae&&(a=xe())!==Ae&&(o=y())!==Ae?r=n=[n,i,a,o]:(Zi=r,r=Ae);else t=Ae;return t!==Ae&&(e,t=ke(t)),e=t}())===Ae&&(e=function(){var e,t,r,n;return e=Zi,(t=v())!==Ae&&xe()!==Ae&&(r=be())!==Ae&&xe()!==Ae&&(n=l())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=st(t,n),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=v())!==Ae&&xe()!==Ae&&(r=be())!==Ae&&xe()!==Ae&&(n=Se())!==Ae?(e,t=ut(t),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=v())!==Ae&&xe()!==Ae&&(r=T())!==Ae?(e,t=lt(t,r),e=t):(Zi=e,e=Ae))),e}())===Ae&&(e=function(){var e,t,r,n,i,a;return e=Zi,(t=Z())!==Ae&&xe()!==Ae&&(r=$())!==Ae&&xe()!==Ae&&(n=y())!==Ae&&xe()!==Ae&&(i=X())!==Ae&&xe()!==Ae&&(a=y())!==Ae?(e,t=rt(r,n,a),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=$())!==Ae&&xe()!==Ae&&(r=y())!==Ae&&xe()!==Ae&&(n=X())!==Ae&&xe()!==Ae&&(i=y())!==Ae?(e,t=nt(t,r,i),e=t):(Zi=e,e=Ae)),e}())===Ae&&(e=function(){var e,t,r,n;return e=Zi,(t=H())!==Ae&&xe()!==Ae&&(r=Z())!==Ae&&xe()!==Ae&&(n=y())!==Ae?(e,t=et(t,n),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=H())!==Ae&&xe()!==Ae&&(r=y())!==Ae?(e,t=tt(t,r),e=t):(Zi=e,e=Ae)),e}())===Ae&&(e=function(){var e,t,r,n;return e=Zi,(t=d())!==Ae&&xe()!==Ae&&(r=F())!==Ae&&xe()!==Ae&&W()!==Ae&&xe()!==Ae&&(n=O())!==Ae?(e,t=at(t,r,n),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=d())!==Ae&&xe()!==Ae&&(r=F())!==Ae?(e,t=ot(t,r),e=t):(Zi=e,e=Ae)),e}()),e}())===Ae&&(r=null),r!==Ae?(e,t=Ve(t,r),e=t):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}()),e}function h(){var e;return t.substr(Zi,2)===Ue?(e=Ue,Zi+=2):(e=Ae,0===Ki&&s(je)),e===Ae&&(62===t.charCodeAt(Zi)?(e=qe,Zi++):(e=Ae,0===Ki&&s(Qe)),e===Ae&&(t.substr(Zi,2)===He?(e=He,Zi+=2):(e=Ae,0===Ki&&s(Ye)),e===Ae&&(t.substr(Zi,2)===We?(e=We,Zi+=2):(e=Ae,0===Ki&&s(Ze)),e===Ae&&(60===t.charCodeAt(Zi)?(e=Xe,Zi++):(e=Ae,0===Ki&&s(Je)),e===Ae&&(61===t.charCodeAt(Zi)?(e=De,Zi++):(e=Ae,0===Ki&&s(Ge)),e===Ae&&(t.substr(Zi,2)===$e?(e=$e,Zi+=2):(e=Ae,0===Ki&&s(Ke)))))))),e}function d(){var e,t,r,n,i;return e=Zi,t=Zi,(r=Z())!==Ae?(n=xe())!==Ae?(i=Y())!==Ae?t=r=[r,n,i]:(Zi=t,t=Ae):(Zi=t,t=Ae):(Zi=t,t=Ae),t!==Ae&&(e,t=it(t)),(e=t)===Ae&&(e=Y()),e}function v(){var e,t,r,n,i;return e=Zi,t=Zi,(r=Z())!==Ae?(n=xe())!==Ae?(i=Q())!==Ae?t=r=[r,n,i]:(Zi=t,t=Ae):(Zi=t,t=Ae):(Zi=t,t=Ae),t!==Ae&&(e,t=it(t)),(e=t)===Ae&&(e=Q()),e}function y(){var e,t,r,n,i,a,o,s;if(e=Zi,(t=g())!==Ae){for(r=[],n=Zi,(i=xe())!==Ae?(a=m())!==Ae?(o=xe())!==Ae?(s=g())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);n!==Ae;)r.push(n),n=Zi,(i=xe())!==Ae?(a=m())!==Ae?(o=xe())!==Ae?(s=g())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);r!==Ae?(e,e=t=Pe(t,r)):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}function m(){var e;return 43===t.charCodeAt(Zi)?(e=ct,Zi++):(e=Ae,0===Ki&&s(ft)),e===Ae&&(45===t.charCodeAt(Zi)?(e=pt,Zi++):(e=Ae,0===Ki&&s(ht))),e}function g(){var e,t,r,n,i,a,o,s;if(e=Zi,(t=I())!==Ae){for(r=[],n=Zi,(i=xe())!==Ae?(a=_())!==Ae?(o=xe())!==Ae?(s=I())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);n!==Ae;)r.push(n),n=Zi,(i=xe())!==Ae?(a=_())!==Ae?(o=xe())!==Ae?(s=I())!==Ae?n=i=[i,a,o,s]:(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae):(Zi=n,n=Ae);r!==Ae?(e,e=t=dt(t,r)):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}function _(){var e;return 42===t.charCodeAt(Zi)?(e=vt,Zi++):(e=Ae,0===Ki&&s(yt)),e===Ae&&(47===t.charCodeAt(Zi)?(e=mt,Zi++):(e=Ae,0===Ki&&s(gt))),e}function I(){var e,r;return(e=function(){var e;return(e=O())===Ae&&(e=function(){var e,t,r,n;return e=Zi,(t=function(){var e,t,r,n;return e=Zi,(t=z())!==Ae&&(r=D())!==Ae&&(n=G())!==Ae?(e,t=Er(t,r,n),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=z())!==Ae&&(r=D())!==Ae?(e,t=Tr(t,r),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=z())!==Ae&&(r=G())!==Ae?(e,t=Mr(t,r),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=z())!==Ae&&(e,t=wr(t)),e=t))),e}())!==Ae?(r=Zi,Ki++,n=S(),Ki--,n===Ae?r=void 0:(Zi=r,r=Ae),r!==Ae?(e,t=xr(t),e=t):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e,t;return e=Zi,(t=j())!==Ae&&(e,t=ar()),(e=t)===Ae&&(e=Zi,(t=q())!==Ae&&(e,t=or()),e=t),e}())===Ae&&(e=function(){var e,t;return e=Zi,(t=U())!==Ae&&(e,t=ir()),e=t}())===Ae&&(e=function(){var e,t,r;return e=Zi,(t=oe())!==Ae&&xe()!==Ae&&(r=F())!==Ae?(e,t=nr(r),e=t):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e,t,r;return e=Zi,(t=ae())!==Ae&&xe()!==Ae&&(r=F())!==Ae?(e,t=Gt(r),e=t):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e,r,n,i,a;return e=Zi,(r=ue())!==Ae&&xe()!==Ae?(45===t.charCodeAt(Zi)?(n=pt,Zi++):(n=Ae,0===Ki&&s(ht)),n===Ae&&(43===t.charCodeAt(Zi)?(n=ct,Zi++):(n=Ae,0===Ki&&s(ft))),n!==Ae&&xe()!==Ae&&(i=F())!==Ae&&xe()!==Ae&&(a=w())!==Ae?(e,r=Bt(n,i,a),e=r):(Zi=e,e=Ae)):(Zi=e,e=Ae),e===Ae&&(e=Zi,(r=ue())!==Ae&&xe()!==Ae&&(n=F())!==Ae&&xe()!==Ae&&(i=w())!==Ae?(e,r=Vt(n,i),e=r):(Zi=e,e=Ae)),e}()),e}())===Ae&&(e=function(){var e,t,r,n;return e=Zi,(t=re())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=function(){var e;return(e=le())===Ae&&(e=ce())===Ae&&(e=fe())===Ae&&(e=pe())===Ae&&(e=he())===Ae&&(e=de()),e}())!==Ae&&xe()!==Ae&&K()!==Ae&&xe()!==Ae&&(n=c())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Ot(r,n),e=t):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e,t,r,n,i,a,o,s,u;return e=Zi,(t=te())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=c())!==Ae&&xe()!==Ae&&K()!==Ae&&xe()!==Ae&&(n=c())!==Ae&&xe()!==Ae?(i=Zi,(a=ee())!==Ae&&(o=xe())!==Ae&&(s=c())!==Ae&&(u=xe())!==Ae?i=a=[a,o,s,u]:(Zi=i,i=Ae),i===Ae&&(i=null),i!==Ae&&(a=Se())!==Ae?(e,t=Ct(r,n,i),e=t):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e,t,r,n,i;return e=Zi,(t=ne())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae?((r=M())===Ae&&(r=null),r!==Ae&&xe()!==Ae&&(n=c())!==Ae&&xe()!==Ae&&K()!==Ae&&xe()!==Ae&&(i=c())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Pt(r,n,i),e=t):(Zi=e,e=Ae)):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=ne())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae?((r=M())===Ae&&(r=null),r!==Ae&&xe()!==Ae&&(n=c())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Lt(r,n),e=t):(Zi=e,e=Ae)):(Zi=e,e=Ae)),e}())===Ae&&(e=function(){var e,t,r,n;return e=Zi,(t=ie())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=c())!==Ae&&xe()!==Ae&&Q()!==Ae&&xe()!==Ae&&(n=c())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=zt(r,n),e=t):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e,t,r;return e=Zi,(t=Te())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae?((r=l())===Ae&&(r=null),r!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Dt(t,r),e=t):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e;return(e=function(){var e,t,r,n,i,a;if(e=Zi,(t=ve())!==Ae)if(xe()!==Ae)if((r=c())!==Ae)if(xe()!==Ae){for(n=[],i=P();i!==Ae;)n.push(i),i=P();n!==Ae?(i=xe())!==Ae?(a=ye())!==Ae?(e,t=mr(r,n),e=t):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae)}else Zi=e,e=Ae;else Zi=e,e=Ae;else Zi=e,e=Ae;else Zi=e,e=Ae;if(e===Ae)if(e=Zi,(t=ve())!==Ae)if(xe()!==Ae)if((r=c())!==Ae)if(xe()!==Ae){for(n=[],i=P();i!==Ae;)n.push(i),i=P();n!==Ae?(i=xe())!==Ae?(a=L())!==Ae?xe()!==Ae?ye()!==Ae?(e,t=gr(r,n,a),e=t):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae)}else Zi=e,e=Ae;else Zi=e,e=Ae;else Zi=e,e=Ae;else Zi=e,e=Ae;return e}())===Ae&&(e=function(){var e,t,r,n,i;if(e=Zi,(t=ve())!==Ae)if(xe()!==Ae){for(r=[],n=C();n!==Ae;)r.push(n),n=C();r!==Ae?(n=xe())!==Ae?(i=ye())!==Ae?(e,t=_r(r),e=t):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae)}else Zi=e,e=Ae;else Zi=e,e=Ae;if(e===Ae)if(e=Zi,(t=ve())!==Ae)if(xe()!==Ae){for(r=[],n=C();n!==Ae;)r.push(n),n=C();r!==Ae?(n=xe())!==Ae?(i=L())!==Ae?xe()!==Ae?ye()!==Ae?(e,t=Ir(r,i),e=t):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae)}else Zi=e,e=Ae;else Zi=e,e=Ae;return e}()),e}())===Ae&&(e=function(){var e,t;return e=Zi,(t=function(){var e,t;return e=Zi,(t=function(){var e,t,r,n;if(e=Zi,(t=S())!==Ae){for(r=[],n=E();n!==Ae;)r.push(n),n=E();r!==Ae?(e,t=St(t,r),e=t):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}())!==Ae&&(e,t=bt(t)),e=t}())!==Ae&&(e,t=It(t)),e=t}())===Ae&&(e=T())===Ae&&(e=Zi,be()!==Ae?xe()!==Ae?(r=c())!==Ae?xe()!==Ae?Se()!==Ae?(e,e=_t(r)):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae)),e}function b(){var e,t,r,n;if(e=Zi,(t=S())!==Ae){for(r=[],n=x();n!==Ae;)r.push(n),n=x();r!==Ae?(e,e=t=St(t,r)):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}function S(){var e;return xt.test(t.charAt(Zi))?(e=t.charAt(Zi),Zi++):(e=Ae,0===Ki&&s(Et)),e}function x(){var e;return Tt.test(t.charAt(Zi))?(e=t.charAt(Zi),Zi++):(e=Ae,0===Ki&&s(Mt)),e}function E(){var e;return wt.test(t.charAt(Zi))?(e=t.charAt(Zi),Zi++):(e=Ae,0===Ki&&s(Nt)),e}function T(){var e,r,n,i;return e=Zi,r=Zi,64===t.charCodeAt(Zi)?(n=At,Zi++):(n=Ae,0===Ki&&s(Rt)),n!==Ae?(i=b())!==Ae?r=n=[n,i]:(Zi=r,r=Ae):(Zi=r,r=Ae),r!==Ae&&(e,r=Ft(r)),r}function M(){var e;return(e=function(){var e,r,n,i;return e=Zi,t.substr(Zi,7).toLowerCase()===Un?(r=t.substr(Zi,7),Zi+=7):(r=Ae,0===Ki&&s(jn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,r=qn(),e=r):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e,r,n,i;return e=Zi,t.substr(Zi,8).toLowerCase()===Qn?(r=t.substr(Zi,8),Zi+=8):(r=Ae,0===Ki&&s(Hn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,r=Yn(),e=r):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}())===Ae&&(e=function(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===Wn?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(Zn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,r=Xn(),e=r):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}()),e}function w(){var e,t,r;return e=Zi,(t=function(){var e,t,r;return e=Zi,(t=N())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=R())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Ut(t,r),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=N())!==Ae&&(e,t=jt(t)),e=t),e}())!==Ae?xe()!==Ae?se()!==Ae?xe()!==Ae?(r=function(){var e,t,r,n;return e=Zi,(t=N())!==Ae&&(e,t=qt(t)),(e=t)===Ae&&(e=Zi,(t=de())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=R())!==Ae&&xe()!==Ae&&Ie()!==Ae&&xe()!==Ae&&(n=A())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Qt(r,n),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=de())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=R())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Ht(r),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=de())!==Ae&&(e,t=Yt()),e=t))),e}())!==Ae?(e,e=t=kt(t,r)):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae),e===Ae&&(e=function(){var e,t,r,n;return e=Zi,(t=N())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=A())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Wt(t,r),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=N())!==Ae&&(e,t=jt(t)),(e=t)===Ae&&(e=Zi,(t=de())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=R())!==Ae&&xe()!==Ae&&Ie()!==Ae&&xe()!==Ae&&(n=A())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Qt(r,n),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=de())!==Ae&&xe()!==Ae&&be()!==Ae&&xe()!==Ae&&(r=A())!==Ae&&xe()!==Ae&&Se()!==Ae?(e,t=Zt(r),e=t):(Zi=e,e=Ae),e===Ae&&(e=Zi,(t=de())!==Ae&&(e,t=Xt()),e=t)))),e}()),e}function N(){var e,t;return e=Zi,(t=fe())!==Ae&&(e,t=Jt()),(e=t)===Ae&&(e=Zi,(t=pe())!==Ae&&(e,t=$t()),(e=t)===Ae&&(e=Zi,(t=he())!==Ae&&(e,t=Kt()),(e=t)===Ae&&(e=Zi,(t=ce())!==Ae&&(e,t=er()),(e=t)===Ae&&(e=Zi,(t=le())!==Ae&&(e,t=tr()),e=t)))),e}function A(){var e,t;return e=Zi,(t=B())!==Ae&&(e,t=rr(t)),t}function R(){var e,t;return e=Zi,(t=B())!==Ae&&(e,t=rr(t)),t}function F(){var e;return(e=O())===Ae&&(e=T()),e}function O(){var e,r,n,i,a;if(e=Zi,39===t.charCodeAt(Zi)?(r=sr,Zi++):(r=Ae,0===Ki&&s(ur)),r===Ae&&(t.substr(Zi,2)===lr?(r=lr,Zi+=2):(r=Ae,0===Ki&&s(cr))),r!==Ae){for(n=[],i=Zi,t.substr(Zi,2)===fr?(a=fr,Zi+=2):(a=Ae,0===Ki&&s(pr)),a!==Ae&&(i,a=hr()),(i=a)===Ae&&(dr.test(t.charAt(Zi))?(i=t.charAt(Zi),Zi++):(i=Ae,0===Ki&&s(vr)));i!==Ae;)n.push(i),i=Zi,t.substr(Zi,2)===fr?(a=fr,Zi+=2):(a=Ae,0===Ki&&s(pr)),a!==Ae&&(i,a=hr()),(i=a)===Ae&&(dr.test(t.charAt(Zi))?(i=t.charAt(Zi),Zi++):(i=Ae,0===Ki&&s(vr)));n!==Ae?(39===t.charCodeAt(Zi)?(i=sr,Zi++):(i=Ae,0===Ki&&s(ur)),i!==Ae?(e,e=r=yr(n)):(Zi=e,e=Ae)):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}function C(){var e,t,r;return e=Zi,me()!==Ae?xe()!==Ae?(t=c())!==Ae?xe()!==Ae?ge()!==Ae?xe()!==Ae?(r=c())!==Ae?(e,e=br(t,r)):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae),e}function P(){var e,t,r;return e=Zi,me()!==Ae?xe()!==Ae?(t=c())!==Ae?xe()!==Ae?ge()!==Ae?xe()!==Ae?(r=c())!==Ae?(e,e=br(t,r)):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae),e}function L(){var e,t;return e=Zi,_e()!==Ae?xe()!==Ae?(t=c())!==Ae?(e,e=Sr(t)):(Zi=e,e=Ae):(Zi=e,e=Ae):(Zi=e,e=Ae),e}function z(){var e,r,n;return(e=B())===Ae&&(e=Zi,45===t.charCodeAt(Zi)?(r=pt,Zi++):(r=Ae,0===Ki&&s(ht)),r===Ae&&(43===t.charCodeAt(Zi)?(r=ct,Zi++):(r=Ae,0===Ki&&s(ft))),r!==Ae?(n=B())!==Ae?(e,e=r=Nr(r,n)):(Zi=e,e=Ae):(Zi=e,e=Ae)),e}function D(){var e,r,n;return e=Zi,46===t.charCodeAt(Zi)?(r=Ar,Zi++):(r=Ae,0===Ki&&s(Rr)),r!==Ae?((n=B())===Ae&&(n=null),n!==Ae?(e,e=r=Fr(n)):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function G(){var e,t,r;return e=Zi,(t=k())!==Ae?(r=B())!==Ae?(e,e=t=Or(t,r)):(Zi=e,e=Ae):(Zi=e,e=Ae),e}function B(){var e,t,r;if(e=Zi,t=[],(r=V())!==Ae)for(;r!==Ae;)t.push(r),r=V();else t=Ae;return t!==Ae&&(e,t=Cr(t)),t}function V(){var e;return Pr.test(t.charAt(Zi))?(e=t.charAt(Zi),Zi++):(e=Ae,0===Ki&&s(Lr)),e}function k(){var e,r,n;return e=Zi,zr.test(t.charAt(Zi))?(r=t.charAt(Zi),Zi++):(r=Ae,0===Ki&&s(Dr)),r!==Ae?(Gr.test(t.charAt(Zi))?(n=t.charAt(Zi),Zi++):(n=Ae,0===Ki&&s(Br)),n===Ae&&(n=null),n!==Ae?(e,e=r=Vr(r,n)):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function U(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===kr?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(Ur)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?e=r=[r,n]:(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function j(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===jr?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(qr)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?e=r=[r,n]:(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function q(){var e,r,n,i;return e=Zi,t.substr(Zi,5).toLowerCase()===Qr?(r=t.substr(Zi,5),Zi+=5):(r=Ae,0===Ki&&s(Hr)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?e=r=[r,n]:(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function Q(){var e,r,n,i;return e=Zi,t.substr(Zi,2).toLowerCase()===Yr?(r=t.substr(Zi,2),Zi+=2):(r=Ae,0===Ki&&s(Wr)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Zr()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function H(){var e,r,n,i;return e=Zi,t.substr(Zi,2).toLowerCase()===Xr?(r=t.substr(Zi,2),Zi+=2):(r=Ae,0===Ki&&s(Jr)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=$r()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function Y(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===Kr?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(en)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=tn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function W(){var e,r,n,i;return e=Zi,t.substr(Zi,6).toLowerCase()===rn?(r=t.substr(Zi,6),Zi+=6):(r=Ae,0===Ki&&s(nn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=an()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function Z(){var e,r,n,i;return e=Zi,t.substr(Zi,3).toLowerCase()===on?(r=t.substr(Zi,3),Zi+=3):(r=Ae,0===Ki&&s(sn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=un()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function X(){var e,r,n,i;return e=Zi,t.substr(Zi,3).toLowerCase()===ln?(r=t.substr(Zi,3),Zi+=3):(r=Ae,0===Ki&&s(cn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=fn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function J(){var e,r,n,i;return e=Zi,t.substr(Zi,2).toLowerCase()===pn?(r=t.substr(Zi,2),Zi+=2):(r=Ae,0===Ki&&s(hn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=dn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function $(){var e,r,n,i;return e=Zi,t.substr(Zi,7).toLowerCase()===vn?(r=t.substr(Zi,7),Zi+=7):(r=Ae,0===Ki&&s(yn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=mn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function K(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===gn?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(_n)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=In()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ee(){var e,r,n,i;return e=Zi,t.substr(Zi,3).toLowerCase()===bn?(r=t.substr(Zi,3),Zi+=3):(r=Ae,0===Ki&&s(Sn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=xn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function te(){var e,r,n,i;return e=Zi,t.substr(Zi,9).toLowerCase()===En?(r=t.substr(Zi,9),Zi+=9):(r=Ae,0===Ki&&s(Tn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Mn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function re(){var e,r,n,i;return e=Zi,t.substr(Zi,7).toLowerCase()===wn?(r=t.substr(Zi,7),Zi+=7):(r=Ae,0===Ki&&s(Nn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=An()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ne(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===Rn?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(Fn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=On()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ie(){var e,r,n,i;return e=Zi,t.substr(Zi,8).toLowerCase()===Cn?(r=t.substr(Zi,8),Zi+=8):(r=Ae,0===Ki&&s(Pn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Ln()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ae(){var e,r,n,i;return e=Zi,t.substr(Zi,9).toLowerCase()===zn?(r=t.substr(Zi,9),Zi+=9):(r=Ae,0===Ki&&s(Dn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Gn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function oe(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===Bn?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(Vn)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=kn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function se(){var e,r,n,i;return e=Zi,t.substr(Zi,2).toLowerCase()===Jn?(r=t.substr(Zi,2),Zi+=2):(r=Ae,0===Ki&&s($n)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Kn()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ue(){var e,r,n,i;return e=Zi,t.substr(Zi,8).toLowerCase()===ei?(r=t.substr(Zi,8),Zi+=8):(r=Ae,0===Ki&&s(ti)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=ri()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function le(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===ni?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(ii)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=ai()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ce(){var e,r,n,i;return e=Zi,t.substr(Zi,5).toLowerCase()===oi?(r=t.substr(Zi,5),Zi+=5):(r=Ae,0===Ki&&s(si)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=ui()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function fe(){var e,r,n,i;return e=Zi,t.substr(Zi,3).toLowerCase()===li?(r=t.substr(Zi,3),Zi+=3):(r=Ae,0===Ki&&s(ci)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=fi()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function pe(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===pi?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(hi)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=di()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function he(){var e,r,n,i;return e=Zi,t.substr(Zi,6).toLowerCase()===vi?(r=t.substr(Zi,6),Zi+=6):(r=Ae,0===Ki&&s(yi)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=mi()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function de(){var e,r,n,i;return e=Zi,t.substr(Zi,6).toLowerCase()===gi?(r=t.substr(Zi,6),Zi+=6):(r=Ae,0===Ki&&s(_i)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Ii()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ve(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===bi?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(Si)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=xi()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ye(){var e,r,n,i;return e=Zi,t.substr(Zi,3).toLowerCase()===Ei?(r=t.substr(Zi,3),Zi+=3):(r=Ae,0===Ki&&s(Ti)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Mi()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function me(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===wi?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(Ni)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Ai()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function ge(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===Ri?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(Fi)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Oi()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function _e(){var e,r,n,i;return e=Zi,t.substr(Zi,4).toLowerCase()===Ci?(r=t.substr(Zi,4),Zi+=4):(r=Ae,0===Ki&&s(Pi)),r!==Ae?(n=Zi,Ki++,i=x(),Ki--,i===Ae?n=void 0:(Zi=n,n=Ae),n!==Ae?(e,e=r=Li()):(Zi=e,e=Ae)):(Zi=e,e=Ae),e}function Ie(){var e;return 44===t.charCodeAt(Zi)?(e=zi,Zi++):(e=Ae,0===Ki&&s(Di)),e}function be(){var e;return 40===t.charCodeAt(Zi)?(e=Gi,Zi++):(e=Ae,0===Ki&&s(Bi)),e}function Se(){var e;return 41===t.charCodeAt(Zi)?(e=Vi,Zi++):(e=Ae,0===Ki&&s(ki)),e}function xe(){var e,t;for(e=[],t=Ee();t!==Ae;)e.push(t),t=Ee();return e}function Ee(){var e;return Ui.test(t.charAt(Zi))?(e=t.charAt(Zi),Zi++):(e=Ae,0===Ki&&s(ji)),e}function Te(){var e,r,n,i;if(e=Zi,(r=b())!==Ae&&(e,r=bt(r)),(e=r)===Ae)if(e=Zi,96===t.charCodeAt(Zi)?(r=qi,Zi++):(r=Ae,0===Ki&&s(Qi)),r!==Ae){if(n=[],Hi.test(t.charAt(Zi))?(i=t.charAt(Zi),Zi++):(i=Ae,0===Ki&&s(Yi)),i!==Ae)for(;i!==Ae;)n.push(i),Hi.test(t.charAt(Zi))?(i=t.charAt(Zi),Zi++):(i=Ae,0===Ki&&s(Yi));else n=Ae;n!==Ae?(96===t.charCodeAt(Zi)?(i=qi,Zi++):(i=Ae,0===Ki&&s(Qi)),i!==Ae?(e,e=r=Wi(n)):(Zi=e,e=Ae)):(Zi=e,e=Ae)}else Zi=e,e=Ae;return e}function Me(e,t,r,n){var i={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(i.escape=n),i}function we(e,t){for(var r=e,n=0;n<t.length;n++)r=Me(t[n][1],r,t[n][3]);return r}r=void 0!==r?r:{};var Ne,Ae={},Re={start:u},Fe=u,Oe=function(e){return e},Ce=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r},Pe=function(e,t){return we(e,t)},Le="!",ze=n("!",!1),De="=",Ge=n("=",!1),Be=function(e){return function(e,t){return{type:"unary_expr",operator:e,expr:t}}("NOT",e)},Ve=function(e,t){return""==t||null==t||null==t?e:"arithmetic"==t.type?we(e,t.tail):Me(t.op,e,t.right,t.escape)},ke=function(e){return{type:"arithmetic",tail:e}},Ue=">=",je=n(">=",!1),qe=">",Qe=n(">",!1),He="<=",Ye=n("<=",!1),We="<>",Ze=n("<>",!1),Xe="<",Je=n("<",!1),$e="!=",Ke=n("!=",!1),et=function(e,t){return{op:e+"NOT",right:t}},tt=function(e,t){return{op:e,right:t}},rt=function(e,t,r){return{op:"NOT"+e,right:{type:"expr_list",value:[t,r]}}},nt=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}},it=function(e){return e[0]+" "+e[2]},at=function(e,t,r){return{op:e,right:t,escape:r.value}},ot=function(e,t){return{op:e,right:t,escape:""}},st=function(e,t){return{op:e,right:t}},ut=function(e){return{op:e,right:{type:"expr_list",value:[]}}},lt=function(e,t){return{op:e,right:t}},ct="+",ft=n("+",!1),pt="-",ht=n("-",!1),dt=function(e,t){return we(e,t)},vt="*",yt=n("*",!1),mt="/",gt=n("/",!1),_t=function(e){return e.paren=!0,e},It=function(e){return{type:"column_ref",table:"",column:e}},bt=function(e){return e},St=function(e,t){return e+t.join("")},xt=/^[A-Za-z_\x80-\uFFFF]/,Et=i([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),Tt=/^[A-Za-z0-9_]/,Mt=i([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),wt=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nt=i([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),At="@",Rt=n("@",!1),Ft=function(e){return{type:"param",value:e[1]}},Ot=function(e,t){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},t]}}},Ct=function(e,t,r){return{type:"function",name:"substring",args:{type:"expr_list",value:r?[e,t,r[2]]:[e,t]}}},Pt=function(e,t,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t,r]}}},Lt=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}},zt=function(e,t){return{type:"function",name:"position",args:{type:"expr_list",value:[e,t]}}},Dt=function(e,t){return{type:"function",name:e,args:t||{type:"expr_list",value:[]}}},Gt=function(e){return{type:"timestamp",value:e.value}},Bt=function(e,t,r){return{type:"interval",value:t,qualifier:r,op:e}},Vt=function(e,t){return{type:"interval",value:e,qualifier:t,op:""}},kt=function(e,t){return{type:"interval-qualifier",start:e,end:t}},Ut=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}},jt=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},qt=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},Qt=function(e,t){return{type:"interval-period",period:"second",precision:e,secondary:t}},Ht=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}},Yt=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Wt=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}},Zt=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}},Xt=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Jt=function(){return{type:"string",value:"day"}},$t=function(){return{type:"string",value:"hour"}},Kt=function(){return{type:"string",value:"minute"}},er=function(){return{type:"string",value:"month"}},tr=function(){return{type:"string",value:"year"}},rr=function(e){return parseFloat(e)},nr=function(e){return{type:"date",value:e.value}},ir=function(){return{type:"null",value:null}},ar=function(){return{type:"bool",value:!0}},or=function(){return{type:"bool",value:!1}},sr="'",ur=n("'",!1),lr="N'",cr=n("N'",!1),fr="''",pr=n("''",!1),hr=function(){return"'"},dr=/^[^']/,vr=i(["'"],!0,!1),yr=function(e){return{type:"string",value:e.join("")}},mr=function(e,t){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:null}},gr=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}},_r=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}},Ir=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}},br=function(e,t){return{type:"when_clause",operand:e,value:t}},Sr=function(e){return{type:"else_clause",value:e}},xr=function(e){return{type:"number",value:e}},Er=function(e,t,r){return parseFloat(e+t+r)},Tr=function(e,t){return parseFloat(e+t)},Mr=function(e,t){return parseFloat(e+t)},wr=function(e){return parseFloat(e)},Nr=function(e,t){return e[0]+t},Ar=".",Rr=n(".",!1),Fr=function(e){return"."+(null!=e?e:"")},Or=function(e,t){return e+t},Cr=function(e){return e.join("")},Pr=/^[0-9]/,Lr=i([["0","9"]],!1,!1),zr=/^[eE]/,Dr=i(["e","E"],!1,!1),Gr=/^[+\-]/,Br=i(["+","-"],!1,!1),Vr=function(e,t){return"e"+(null===t?"":t)},kr="null",Ur=n("NULL",!0),jr="true",qr=n("TRUE",!0),Qr="false",Hr=n("FALSE",!0),Yr="in",Wr=n("IN",!0),Zr=function(){return"IN"},Xr="is",Jr=n("IS",!0),$r=function(){return"IS"},Kr="like",en=n("LIKE",!0),tn=function(){return"LIKE"},rn="escape",nn=n("ESCAPE",!0),an=function(){return"ESCAPE"},on="not",sn=n("NOT",!0),un=function(){return"NOT"},ln="and",cn=n("AND",!0),fn=function(){return"AND"},pn="or",hn=n("OR",!0),dn=function(){return"OR"},vn="between",yn=n("BETWEEN",!0),mn=function(){return"BETWEEN"},gn="from",_n=n("FROM",!0),In=function(){return"FROM"},bn="for",Sn=n("FOR",!0),xn=function(){return"FOR"},En="substring",Tn=n("SUBSTRING",!0),Mn=function(){return"SUBSTRING"},wn="extract",Nn=n("EXTRACT",!0),An=function(){return"EXTRACT"},Rn="trim",Fn=n("TRIM",!0),On=function(){return"TRIM"},Cn="position",Pn=n("POSITION",!0),Ln=function(){return"POSITION"},zn="timestamp",Dn=n("TIMESTAMP",!0),Gn=function(){return"TIMESTAMP"},Bn="date",Vn=n("DATE",!0),kn=function(){return"DATE"},Un="leading",jn=n("LEADING",!0),qn=function(){return"LEADING"},Qn="trailing",Hn=n("TRAILING",!0),Yn=function(){return"TRAILING"},Wn="both",Zn=n("BOTH",!0),Xn=function(){return"BOTH"},Jn="to",$n=n("TO",!0),Kn=function(){return"TO"},ei="interval",ti=n("INTERVAL",!0),ri=function(){return"INTERVAL"},ni="year",ii=n("YEAR",!0),ai=function(){return"YEAR"},oi="month",si=n("MONTH",!0),ui=function(){return"MONTH"},li="day",ci=n("DAY",!0),fi=function(){return"DAY"},pi="hour",hi=n("HOUR",!0),di=function(){return"HOUR"},vi="minute",yi=n("MINUTE",!0),mi=function(){return"MINUTE"},gi="second",_i=n("SECOND",!0),Ii=function(){return"SECOND"},bi="case",Si=n("CASE",!0),xi=function(){return"CASE"},Ei="end",Ti=n("END",!0),Mi=function(){return"END"},wi="when",Ni=n("WHEN",!0),Ai=function(){return"WHEN"},Ri="then",Fi=n("THEN",!0),Oi=function(){return"THEN"},Ci="else",Pi=n("ELSE",!0),Li=function(){return"ELSE"},zi=",",Di=n(",",!1),Gi="(",Bi=n("(",!1),Vi=")",ki=n(")",!1),Ui=/^[ \t\n\r]/,ji=i([" ","\t","\n","\r"],!1,!1),qi="`",Qi=n("`",!1),Hi=/^[^`]/,Yi=i(["`"],!0,!1),Wi=function(e){return e.join("")},Zi=0,Xi=[{line:1,column:1}],Ji=0,$i=[],Ki=0;if("startRule"in r){if(!(r.startRule in Re))throw new Error("Can't start parsing from rule \""+r.startRule+'".');Fe=Re[r.startRule]}if((Ne=Fe())!==Ae&&Zi===t.length)return Ne;throw Ne!==Ae&&Zi<t.length&&s({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}($i,Ji<t.length?t.charAt(Ji):null,Ji<t.length?o(Ji,Ji+1):o(Ji,Ji))}}}.apply(null,[]))||(e.exports=n)},983:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(6),r(8),r(57),r(16),r(4),r(885),r(37),r(880),r(984),r(900),r(886),r(922),r(901)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,v){Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter}return Object.defineProperty(e.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),e.prototype.createQueryResponse=function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(l.isValid(e.outSR)&&!l.equals(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=v.cleanFromGeometryEngine(r({spatialReference:e.outSR},h.project(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=v.cleanFromGeometryEngine(r({spatialReference:e.outSR},this.queryGeometry))),t},e.prototype.executeAttributesQuery=function(t){var r=p.getWhereClause(t.where,this.fieldsIndex);if(!r)return s.resolve(this);if(r.isStandardized){for(var n=0,i=[],a=0,o=this.items;a<o.length;a++){var u=o[a];r.testFeature(u,this.featureAdapter)&&(i[n++]=u)}var l=new e(i,this.queryGeometry,this);return l.definitionExpression=t.where,s.resolve(l)}return s.reject(new TypeError("Where clause is not standardized"))},e.prototype.executeObjectIdsQuery=function(t){if(!t.objectIds||!t.objectIds.length)return s.resolve(this);var r=a.SetFromValues(t.objectIds),n=this.featureAdapter.getObjectId;return s.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))},e.prototype.executeTimeQuery=function(t){var r=d.getTimeOperator(this.timeInfo,t.timeExtent,this.featureAdapter);if(!o.isSome(r))return s.resolve(this);var n=this.items.filter(r);return s.resolve(new e(n,this.queryGeometry,this))},e.prototype.project=function(t){return i(this,void 0,void 0,(function(){var r,i,a=this;return n(this,(function(n){switch(n.label){case 0:return!t||l.equals(this.spatialReference,t)?[2,this]:(r=this.featureAdapter,[4,h.projectMany(this.items.map((function(e){return v.getGeometry(a,r.getGeometry(e))})),this.spatialReference,t)]);case 1:return i=n.sent(),[2,new e(i.map((function(e,t){return r.cloneWithGeometry(a.items[t],c.convertFromGeometry(e,a.hasZ,a.hasM))})),this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}}))}))},e.prototype._createFeatureQueryResponse=function(e){var t=this,r=this.items,n=this,i=n.geometryType,a=n.hasM,o=n.hasZ,s=n.objectIdField,l=n.spatialReference,c=e.outFields,f=e.outSR,p=e.quantizationParameters,h=e.resultRecordCount,d=e.resultOffset,y=!1;if(null!=h&&null!=d){var m=d+h;y=r.length>m,r=r.slice(d,Math.min(r.length,m))}return{exceededTransferLimit:y,features:this._createFeatures(e,r),fields:c&&c.map((function(e){return t.fieldsIndex.get(e)})),geometryType:i,hasM:a,hasZ:o,objectIdFieldName:s,spatialReference:v.cleanFromGeometryEngine(f||l),transform:p&&u.toQuantizationTransform(p)||null}},e.prototype._createFeatures=function(e,t){var r=new f.default(e,this.featureAdapter,this.fieldsIndex),n=e.quantizationParameters,i=e.returnGeometry,a=e.returnCentroid,o=e.maxAllowableOffset,s=e.orderByFields,l=[],c=0;if(t.length&&s&&s.length){var p=s[0].split(" "),h=p[0],d=this.fieldsIndex.get(h),y="DESC"===p[1];t.sort((function(e,t){var n=r.getFieldValue(e,h,d),i=r.getFieldValue(t,h,d);if("number"==typeof n&&"number"==typeof i)return y?i-n:n-i;if("string"==typeof n&&"string"==typeof i){var a=n.toUpperCase(),o=i.toUpperCase();return(y?a>o:a<o)?-1:(y?a<o:a>o)?1:0}}))}if(i||a){var m=u.toQuantizationTransform(n);if(i&&!a)for(var g=0,_=t;g<_.length;g++){var I=_[g];l[c++]={attributes:r.getAttributes(I),geometry:v.getGeometry(this,this.featureAdapter.getGeometry(I),o,m)}}else if(!i&&a)for(var b=0,S=t;b<S.length;b++){I=S[b];l[c++]={attributes:r.getAttributes(I),centroid:v.transformCentroid(this,this.featureAdapter.getCentroid(I,this),m)}}else for(var x=0,E=t;x<E.length;x++){I=E[x];l[c++]={attributes:r.getAttributes(I),centroid:v.transformCentroid(this,this.featureAdapter.getCentroid(I,this),m),geometry:v.getGeometry(this,this.featureAdapter.getGeometry(I),o,m)}}}else for(var T=0,M=t;T<M.length;T++){I=M[T];var w=r.getAttributes(I);w&&(l[c++]={attributes:w})}return l},e.prototype._createExceedsLimitQueryResponse=function(e){for(var t=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=0,o=e.outStatistics;a<o.length;a++){var s=o[a];if("exceedslimit"===s.statisticType){r=null!=s.maxPointCount?s.maxPointCount:Number.POSITIVE_INFINITY,n=null!=s.maxRecordCount?s.maxRecordCount:Number.POSITIVE_INFINITY,i=null!=s.maxVertexCount?s.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>n)t=!0;else{var u=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;t=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(r&&r.coords.length||0)}),0)/u>i}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}},e.prototype._createStatisticsQueryResponse=function(e){for(var t=new f.default(e,this.featureAdapter,this.fieldsIndex),r=e.outStatistics,n=[],i=[],a=e.groupByFieldsForStatistics,o=e.having,s=a&&a.length,u=s&&a[0],l=this.fieldsIndex.get(u),c=!l,p={},h={},d={},v={attributes:{}},y=0,m=r;y<m.length;y++){var g=m[y],_=g.outStatisticFieldName,I=g.statisticType,b="exceedslimit"!==I?g.onStatisticField:void 0,S=this.fieldsIndex.get(b),x=s&&(b===u||c)&&"count"===I;if(s){p[b]||(p[b]=this._calculateUniqueValues(t,u,l));var E=p[b];for(var T in E){var M=E[T],w=M.count,N=M.data,A=M.items;if(!o||t.validateItems(A,o)){var R=h[N]||{attributes:{}},F=null;if(x)F=w;else F=(O=this._calculateStatistics(A,t,b,S))[C="var"===I?"variance":I];R.attributes[_]=F,R.attributes[c?"EXPR_1":u]=N,h[N]=R}}}else{d[b]||(d[b]=this._calculateStatistics(this.items,t,b,S));var O=d[b],C="var"===I?"variance":I;v.attributes[_]=O[C]}i.push({name:_,alias:_,type:"esriFieldTypeDouble"})}if(s)for(var P in h)n.push(h[P]);else n.push(v);return{fields:i,features:n}},e.prototype._calculateStatistics=function(e,t,r,n){for(var i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=null,s=null,u=null,l=null,c=[],f=0,p=0;p<e.length;p++){var h=e[p];"string"==typeof(m=t.getFieldValue(h,r,n))?f++:null==m||isNaN(m)||(o+=m,i=Math.min(i,m),a=Math.max(a,m),c.push(m),f++)}if(f){s=o/f;for(var d=0,v=0,y=c;v<y.length;v++){var m=y[v];d+=Math.pow(m-s,2)}l=f>1?d/(f-1):0,u=Math.sqrt(l)}else i=null,a=null;return{avg:s,count:f,max:a,min:i,stddev:u,sum:o,variance:l}},e.prototype._calculateUniqueValues=function(e,t,r){for(var n={},i=0,a=this.items;i<a.length;i++){var o=a[i],s=e.getFieldValue(o,t,r);(null==s||"string"==typeof s&&""===s.trim())&&(s=null),null==n[s]?n[s]={count:1,data:s,items:[o]}:(n[s].count++,n[s].items.push(o))}return n},e}();t.default=y}.apply(null,n))||(e.exports=i)},984:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(16),r(900)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;var i=e.outFields;if(i&&-1===i.indexOf("*")){this.outFields=i;for(var a=0,o=0,s=i;o<s.length;o++){var u=s[o],l=n.getExpressionFromFieldName(u),c=this.fieldsIndex.get(l),f=c?null:n.getWhereClause(l,r),p=c?c.name:n.getAliasFromFieldName(u)||"FIELD_EXP_"+a++;this._fieldDataCache.set(u,{alias:p,clause:f})}}}return e.prototype.getAttributes=function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)},e.prototype.getFieldValue=function(e,t,r){var i=r?r.name:t,a=null;return this._fieldDataCache.has(i)?a=this._fieldDataCache.get(i).clause:r||(a=n.getWhereClause(t,this.fieldsIndex),this._fieldDataCache.set(i,{alias:i,clause:a})),r?this.featureAdapter.getAttribute(e,i):a.calculateValue(e,this.featureAdapter)},e.prototype.validateItem=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)},e.prototype.validateItems=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)},e.prototype._processAttributesForOutFields=function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);for(var r={},n=0,i=t;n<i.length;n++){var a=i[n],o=this._fieldDataCache.get(a),s=o.alias,u=o.clause;r[s]=u?u.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,s)}return r},e.prototype._processAttributesForDistinctValues=function(e){if(r.isNone(e)||!this.returnDistinctValues)return e;var t=this.outFields,n=[];if(t)for(var i=0,a=t;i<a.length;i++){var o=a[i],s=this._fieldDataCache.get(o).alias;n.push(e[s])}else for(var s in e)n.push(e[s]);var u=(t||["*"]).join(",")+"="+n.join(","),l=this._returnDistinctMap.get(u)||0;return this._returnDistinctMap.set(u,++l),l>1?null:e},e}();t.default=i}.apply(null,n))||(e.exports=i)},985:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._deferreds=[],this._values=[]}return e.prototype.push=function(e){var t=this;return r.create((function(r,n){t._deferreds.push({resolve:r,reject:n}),t._values.push(e)}))},e.prototype.unshift=function(e){var t=this;return r.create((function(r,n){t._deferreds.unshift({resolve:r,reject:n}),t._values.unshift(e)}))},Object.defineProperty(e.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0}),e.prototype.process=function(){return 0!==this.length&&(this._deferreds.shift().resolve(this._values.shift()),!0)},e.prototype.cancelAll=function(){for(var e=r.createAbortError(),t=0,n=this._deferreds;t<n.length;t++)n[t].reject(e);this._deferreds.length=0,this._values.length=0},e}();t.PromiseQueue=n}.apply(null,n))||(e.exports=i)}}]);