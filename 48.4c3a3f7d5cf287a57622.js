(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/mapViewDeps":860,"esri/views/2d/engine/webgl/definitions":876,"esri/core/libs/gl-matrix-2/mat4":879,"esri/views/2d/engine/vectorTiles/GeometryUtils":881,"esri/views/2d/layers/graphics/graphicsUtils":888,"esri/core/libs/gl-matrix-2/math/mat4":889,"esri/core/libs/gl-matrix-2/mat4f64":890,"esri/core/pbf":894,"esri/core/libs/rbush/rbush":895,"esri/core/libs/gl-matrix-2/mat3f64":897,"esri/core/libs/gl-matrix-2/factories/mat3f64":898,"esri/core/libs/gl-matrix-2/factories/mat4f64":904,"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":907,"esri/views/3d/layers/support/FastSymbolUpdates":908,"esri/views/3d/support/debugFlags":909,"esri/views/2d/layers/features/support/AttributeStore":913,"esri/core/libs/quickselect/quickselect":914,"esri/views/2d/layers/features/support/Tile":921,"esri/core/MapPool":932,"esri/views/2d/layers/features/support/TileStore":933,"esri/views/2d/engine/FeatureContainer":934,"esri/views/2d/layers/graphics/GraphicsView2D":951,"esri/views/2d/layers/graphics/GraphicContainer":952,"esri/views/2d/layers/graphics/GraphicProcessingQueue":953,"esri/views/2d/layers/graphics/GraphicStore":954,"esri/views/2d/layers/graphics/GraphicStoreItem":955,"esri/views/layers/GraphicsView":956,"esri/core/throttle":1091,"esri/views/navigation/Momentum":1108,"esri/views/navigation/FilteredFiniteDifference":1215,"esri/views/navigation/MomentumEstimator":1216,"esri/views/2d/LabelManager":1746,"esri/views/2d/navigation/MapViewNavigation":1822,"esri/views/2d/navigation/ZoomBox":1823,"esri/views/2d/navigation/actions/Pan":1824,"esri/views/navigation/PanPlanarMomentumEstimator":1825,"esri/views/2d/navigation/actions/Pinch":1826,"esri/views/navigation/RotationMomentumEstimator":1827,"esri/views/navigation/ZoomMomentumEstimator":1828,"esri/views/2d/navigation/actions/Rotate":1829,"esri/views/2d/magnifier/MagnifierView2D":1830})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1091:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){function i(t,e,i,r){var n=null,o=1e3;"number"==typeof e?(o=e,r=i):(n=e,o=i);var a,s=0,u=function(){s=0,t.apply(r,a)},l=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n&&n.apply(r,t),a=t,o?s||(s=setTimeout(u,o)):u()};return l.remove=function(){s&&(clearTimeout(s),s=0)},l.forceUpdate=function(){s&&(clearTimeout(s),u())},l.hasPendingUpdates=function(){return!!s},l}Object.defineProperty(e,"__esModule",{value:!0}),e.throttle=i,e.default=i}.apply(null,r))||(t.exports=n)},1108:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(18)],void 0===(n=function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,i){this._initialVelocity=t,this._stopVelocity=e,this._friction=i,this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}return Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!0,configurable:!0}),t.prototype.isFinished=function(t){return t>this.duration},Object.defineProperty(t.prototype,"friction",{get:function(){return this._friction},enumerable:!0,configurable:!0}),t.prototype.value=function(t){return this.valueFromInitialVelocity(this._initialVelocity,t)},t.prototype.valueDelta=function(t,e){var i=this.value(t);return this.value(t+e)-i},t.prototype.valueFromInitialVelocity=function(t,e){e=Math.min(e,this.duration);var i=1-this.friction;return t*(Math.pow(i,e)-1)/Math.log(i)},t}();e.Momentum=r}.apply(null,r))||(t.exports=n)},1215:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.gain=t}return t.prototype.update=function(t){if(this.hasLastValue){var e=this.computeDelta(t);this.updateDelta(e)}this.lastValue=t},t.prototype.reset=function(){this.lastValue=void 0,this.filteredDelta=void 0},Object.defineProperty(t.prototype,"hasLastValue",{get:function(){return void 0!==this.lastValue},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasFilteredDelta",{get:function(){return void 0!==this.filteredDelta},enumerable:!0,configurable:!0}),t.prototype.computeDelta=function(t){return t-this.lastValue},t.prototype.updateDelta=function(t){this.hasFilteredDelta?this.filteredDelta=(1-this.gain)*this.filteredDelta+this.gain*t:this.filteredDelta=t},t}();e.FilteredFiniteDifference=i}.apply(null,r))||(t.exports=n)},1216:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(18),i(67),i(1215),i(1108)],void 0===(n=function(t,e,i,r,n,o){Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e,i,r){void 0===t&&(t=2.5),void 0===e&&(e=.01),void 0===i&&(i=.95),void 0===r&&(r=12),this.minimumInitialVelocity=t,this.stopVelocity=e,this.friction=i,this.maxVelocity=r,this.value=new n.FilteredFiniteDifference(.8),this.time=new n.FilteredFiniteDifference(.3)}return t.prototype.add=function(t,e){if(this.time.hasLastValue){if(this.time.computeDelta(e)<.01)return;if(this.value.hasFilteredDelta){var i=this.value.computeDelta(t);this.value.filteredDelta*i<0&&this.value.reset()}}this.time.update(e),this.value.update(t)},t.prototype.reset=function(){this.value.reset(),this.time.reset()},t.prototype.evaluateMomentum=function(){if(!this.value.hasFilteredDelta)return null;var t=this.value.filteredDelta/this.time.filteredDelta;return t=r.clamp(t,-this.maxVelocity,this.maxVelocity),Math.abs(t)<this.minimumInitialVelocity?null:this.createMomentum(t,this.stopVelocity,this.friction)},t.prototype.createMomentum=function(t,e,i){return new o.Momentum(t,e,i)},t}();e.MomentumEstimator=a}.apply(null,r))||(t.exports=n)},1746:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(10),i(11),i(116),i(9),i(1091),i(2),i(826)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h){Object.defineProperty(e,"__esModule",{value:!0});var c=64,p=s.getLogger("esri.views.2d.layers.labels.LabelManager"),d=function(t){function e(e){var i=t.call(this)||this;return i._applyVisibilityPassThrottled=u.throttle(i._applyVisibilityPass,c,i),i.lastUpdateId=-1,i.updateRequested=!1,i.view=null,i}return i(e,t),e.prototype.initialize=function(){var t=this;this.collisionEngine=new h.CollisionEngine(this.view.featuresTilingScheme),this._layerViewSorter=new h.LayerViewSorter((function(e,i){t.collisionEngine.registerLayerView(e,i);var r=e.tileRenderer;r&&r.forEachTile((function(i){i.isDirty=!0,t.addTile(e,i)})),t.requestUpdate()}),(function(e){t.collisionEngine.unregisterLayerView(e),t.requestUpdate()})),this.handles.add(this.view.allLayerViews.on("change",(function(e){t._layerViewSorter.update(e)})))},e.prototype.destroy=function(){this._layerViewSorter.destroy(),this._layerViewSorter=null,this.collisionEngine=null,this._applyVisibilityPassThrottled.remove()},Object.defineProperty(e.prototype,"updating",{get:function(){return this.updateRequested},enumerable:!0,configurable:!0}),e.prototype.update=function(t){this._applyVisibilityPassThrottled(t)},e.prototype.viewChange=function(){this.requestUpdate()},e.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate(this))},e.prototype.processUpdate=function(t){this._set("updateParameters",t),this.updateRequested&&(this.update(t),this.updateRequested=!1)},e.prototype.addTile=function(t,e){this.collisionEngine.addTile(t,e)},e.prototype.removeTile=function(t,e){this.collisionEngine.removeTile(t,e)},e.prototype._applyVisibilityPass=function(t){try{var e=this.view.featuresTilingScheme.getClosestInfoForScale(t.state.scale).level;this.collisionEngine.run(t,e)}catch(t){p.error(new o("mapview-labeling","Encountered an error during label decluttering",t))}},r([l.property()],e.prototype,"updateRequested",void 0),r([l.property({readOnly:!0})],e.prototype,"updateParameters",void 0),r([l.property({dependsOn:["updateRequested"]})],e.prototype,"updating",null),r([l.property()],e.prototype,"view",void 0),r([l.subclass("esri.views.2d.layers.labels.LabelManager")],e)}(l.declared(a.HandleOwnerMixin(n)));e.default=d}.apply(null,r))||(t.exports=n)},1822:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(6),i(8),i(97),i(10),i(2),i(38),i(82),i(1823),i(1824),i(1826),i(1829)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h,c,p,d,f){Object.defineProperty(e,"__esModule",{value:!0});var m=new a({targetGeometry:new l}),v=[0,0],_=function(t){function e(e){var i=t.call(this)||this;return i._endTimer=null,i.animationManager=null,i}return i(e,t),e.prototype.initialize=function(){this.pan=new p({navigation:this}),this.rotate=new f({navigation:this}),this.pinch=new d({navigation:this}),this.zoomBox=new c({view:this.view,navigation:this})},e.prototype.destroy=function(){this.zoomBox.destroy(),this.zoomBox=null,this.animationManager=null},Object.defineProperty(e.prototype,"momentumEnabled",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.begin=function(){this._set("interacting",!0)},e.prototype.end=function(){var t=this;this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=0),this._endTimer=setTimeout((function(){t._set("interacting",!1)}),0)},e.prototype.zoom=function(t,e){return void 0===e&&(e=this._getDefaultAnchor()),o(this,void 0,void 0,(function(){return n(this,(function(i){return this.stop(),this.begin(),this.view.constraints.snapToZoom&&this.view.constraints.effectiveLODs?t<1?[2,this.zoomIn(e)]:[2,this.zoomOut(e)]:(this.setViewpoint(e,t,0,[0,0]),[2])}))}))},e.prototype.zoomIn=function(t){return o(this,void 0,void 0,(function(){var e,i;return n(this,(function(r){return e=this.view,i=e.constraints.snapToNextScale(e.scale),[2,this._zoomToScale(i,t)]}))}))},e.prototype.zoomOut=function(t){return o(this,void 0,void 0,(function(){var e,i;return n(this,(function(r){return e=this.view,i=e.constraints.snapToPreviousScale(e.scale),[2,this._zoomToScale(i,t)]}))}))},e.prototype.setViewpoint=function(t,e,i,r){this.begin(),this.view.state.viewpoint=this._scaleRotateTranslateViewpoint(this.view.viewpoint,t,e,i,r),this.end()},e.prototype.continousRotateClockwise=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,(function(t){h.rotateBy(t,t,-1)}))},e.prototype.continousRotateCounterclockwise=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,(function(t){h.rotateBy(t,t,1)}))},e.prototype.resetRotation=function(){this.view.rotation=0},e.prototype.continousPanLeft=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,(function(t){h.translateBy(t,t,[-10,0])}))},e.prototype.continousPanRight=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,(function(t){h.translateBy(t,t,[10,0])}))},e.prototype.continousPanUp=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,(function(t){h.translateBy(t,t,[0,10])}))},e.prototype.continousPanDown=function(){var t=this.get("view.viewpoint");this.animationManager.animateContinous(t,(function(t){h.translateBy(t,t,[0,-10])}))},e.prototype.stop=function(){this.pan.stopMomentumNavigation(),this.animationManager.stop(),this.end(),this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=0,this._set("interacting",!1))},e.prototype._getDefaultAnchor=function(){var t=this.view,e=t.size,i=t.padding,r=i.left,n=i.right,o=i.top,a=i.bottom;return v[0]=.5*(e[0]-n+r),v[1]=.5*(e[1]-a+o),v},e.prototype._zoomToScale=function(t,e){return void 0===e&&(e=this._getDefaultAnchor()),o(this,void 0,void 0,(function(){var i,r,o,a,s,u,l,c;return n(this,(function(n){return i=this.view,r=i.constraints,o=i.scale,a=i.viewpoint,s=i.size,u=i.padding,l=r.canZoomInTo(t),c=r.canZoomOutTo(t),t<o&&!l||t>o&&!c?[2]:[2,this.view.goTo(h.padAndScaleAndRotateBy(m,a,t/o,0,e,s,u),{animate:this.momentumEnabled})]}))}))},e.prototype._scaleRotateTranslateViewpoint=function(t,e,i,r,n){var o=this.view,a=o.size,s=o.padding,u=o.constraints,l=o.scale,c=o.viewpoint,p=l*i,d=u.canZoomInTo(p),f=u.canZoomOutTo(p);return(i<1&&!d||i>1&&!f)&&(i=1),h.translateBy(c,c,n),h.padAndScaleAndRotateBy(t,c,i,r,e,a,s)},r([u.property()],e.prototype,"animationManager",void 0),r([u.property({type:Boolean,readOnly:!0})],e.prototype,"interacting",void 0),r([u.property()],e.prototype,"pan",void 0),r([u.property()],e.prototype,"pinch",void 0),r([u.property()],e.prototype,"rotate",void 0),r([u.property()],e.prototype,"view",void 0),r([u.property()],e.prototype,"zoomBox",void 0),r([u.subclass("esri.views.2d.navigation.MapViewNavigation")],e)}(u.declared(s));e.default=_}.apply(null,r))||(t.exports=n)},1823:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(10),i(19),i(2)],void 0===(n=function(t,e,i,r,n,o,a){var s="esri-zoom-box__container",u="esri-zoom-box__overlay",l="esri-zoom-box__overlay-background",h="esri-zoom-box__outline",c="Shift",p="Ctrl";return function(t){function e(e){var i=t.call(this,e)||this;return i._container=null,i._overlay=null,i._backgroundShape=null,i._boxShape=null,i._box={x:0,y:0,width:0,height:0},i._redraw=i._redraw.bind(i),i}return i(e,t),e.prototype.destroy=function(){this.view=null},Object.defineProperty(e.prototype,"view",{set:function(t){var e=this;this._handles&&this._handles.forEach((function(t){t.remove()})),this._handles=null,this._destroyOverlay(),this._set("view",t),t&&(t.on("drag",[c],(function(t){return e._handleDrag(t,1)})),t.on("drag",[c,p],(function(t){return e._handleDrag(t,-1)})))},enumerable:!0,configurable:!0}),e.prototype._start=function(t,e,i,r){this._createContainer(),this._createOverlay(),this.navigation.begin()},e.prototype._update=function(t,e,i,r){this._box.x=t,this._box.y=e,this._box.width=i,this._box.height=r,this._rafId||(this._rafId=requestAnimationFrame(this._redraw))},e.prototype._end=function(t,e,i,r,n){var a=this.view,s=a.toMap(o.createScreenPoint(t+.5*i,e+.5*r)),u=Math.max(i/a.width,r/a.height);-1===n&&(u=1/u),this._destroyOverlay(),this.navigation.end(),a.goTo({center:s,scale:a.scale*u})},e.prototype._updateBox=function(t,e,i,r){var n=this._boxShape;n.setAttributeNS(null,"x",""+t),n.setAttributeNS(null,"y",""+e),n.setAttributeNS(null,"width",""+i),n.setAttributeNS(null,"height",""+r),n.setAttributeNS(null,"class",h)},e.prototype._updateBackground=function(t,e,i,r){this._backgroundShape.setAttributeNS(null,"d",this._toSVGPath(t,e,i,r,this.view.width,this.view.height))},e.prototype._createContainer=function(){var t=document.createElement("div");t.className=s,this.view.root.appendChild(t),this._container=t},e.prototype._createOverlay=function(){var t=this.view.width,e=this.view.height,i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttributeNS(null,"d","M 0 0 L "+t+" 0 L "+t+" "+e+" L 0 "+e+" Z"),i.setAttributeNS(null,"class",l);var r=document.createElementNS("http://www.w3.org/2000/svg","rect"),n=document.createElementNS("http://www.w3.org/2000/svg","svg");n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.setAttributeNS(null,"class",u),n.appendChild(i),n.appendChild(r),this._container.appendChild(n),this._backgroundShape=i,this._boxShape=r,this._overlay=n},e.prototype._destroyOverlay=function(){this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._container=this._backgroundShape=this._boxShape=this._overlay=null},e.prototype._toSVGPath=function(t,e,i,r,n,o){var a=t+i,s=e+r;return"M 0 0 L "+n+" 0 L "+n+" "+o+" L 0 "+o+" ZM "+t+" "+e+" L "+t+" "+s+" L "+a+" "+s+" L "+a+" "+e+" Z"},e.prototype._handleDrag=function(t,e){var i,r,n,o,a=t.x,s=t.y,u=t.origin.x,l=t.origin.y;switch(a>u?(i=u,n=a-u):(i=a,n=u-a),s>l?(r=l,o=s-l):(r=s,o=l-s),t.action){case"start":this._start(i,r,n,o);break;case"update":this._update(i,r,n,o);break;case"end":this._end(i,r,n,o,e)}t.stopPropagation()},e.prototype._redraw=function(){if(this._rafId&&(this._rafId=null,this._overlay)){var t=this._box,e=t.x,i=t.y,r=t.width,n=t.height;this._updateBox(e,i,r,n),this._updateBackground(e,i,r,n),this._rafId=requestAnimationFrame(this._redraw)}},r([a.property()],e.prototype,"navigation",void 0),r([a.property()],e.prototype,"view",null),r([a.subclass("esri.views.2d.navigation.ZoomBox")],e)}(a.declared(n))}.apply(null,r))||(t.exports=n)},1824:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(20),i(97),i(10),i(19),i(2),i(169),i(273),i(82),i(1825)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h,c,p){return function(t){function e(e){var i=t.call(this)||this;return i.animationTime=0,i.momentumEstimator=new p.PanPlanarMomentumEstimator(500,6,.92),i.momentum=null,i.tmpMomentum=h.vec3f64.create(),i.momentumFinished=!1,i.viewpoint=new o({targetGeometry:new n.Point,scale:0,rotation:0}),i.watch("momentumFinished",(function(t){t&&i.navigation.stop()})),i}return i(e,t),e.prototype.begin=function(t,e){this.navigation.begin(),this.momentumEstimator.reset(),this.addToEstimator(e),this.previousDrag=e},e.prototype.update=function(t,e){this.addToEstimator(e);var i=e.center.x,r=e.center.y,n=this.previousDrag;i=n?n.center.x-i:-i,r=n?r-n.center.y:r,t.viewpoint=c.translateBy(this.viewpoint,t.viewpoint,[i||0,r||0]),this.previousDrag=e},e.prototype.end=function(t,e){this.addToEstimator(e);var i=this.navigation.momentumEnabled;this.momentum=i?this.momentumEstimator.evaluateMomentum():null,this.animationTime=0,this.momentum&&this.onAnimationUpdate(t),this.previousDrag=null,this.navigation.end()},e.prototype.addToEstimator=function(t){var e=t.center.x,i=t.center.y,r=s.createScreenPointArray(-e,i),n=h.vec3f64.fromValues(-e,i,0);this.momentumEstimator.add(r,n,.001*t.timestamp)},e.prototype.onAnimationUpdate=function(t){var e=this;this.navigation.animationManager.animateContinous(t.viewpoint,(function(i,r){e.momentumFinished=!e.momentum||e.momentum.isFinished(e.animationTime);var n=.001*r;if(!e.momentumFinished){var o=e.momentum.valueDelta(e.animationTime,n);l.vec3.scale(e.tmpMomentum,e.momentum.direction,o),t.viewpoint=c.translateBy(i,i,e.tmpMomentum)}e.animationTime+=n}))},e.prototype.stopMomentumNavigation=function(){this.momentum&&(this.momentumEstimator.reset(),this.momentum=null,this.navigation.stop())},r([u.property()],e.prototype,"momentumFinished",void 0),r([u.property()],e.prototype,"viewpoint",void 0),r([u.property()],e.prototype,"navigation",void 0),r([u.subclass("esri.views.2d.navigation.actions.Pan")],e)}(u.declared(a))}.apply(null,r))||(t.exports=n)},1825:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(18),i(169),i(273),i(1215),i(1108)],void 0===(n=function(t,e,i,r,n,o,a){Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e,i,r,n,o){var a=t.call(this,e,i,r)||this;return a.sceneVelocity=n,a.direction=o,a}return i(e,t),e.prototype.value=function(e){return t.prototype.valueFromInitialVelocity.call(this,this.sceneVelocity,e)},e}(a.Momentum);e.PanPlanarMomentum=s;var u=function(){function t(t,e,i){void 0===t&&(t=300),void 0===e&&(e=12),void 0===i&&(i=.84),this.minimumInitialVelocity=t,this.stopVelocity=e,this.friction=i,this.time=new o.FilteredFiniteDifference(.6),this.screen=[new o.FilteredFiniteDifference(.4),new o.FilteredFiniteDifference(.4)],this.scene=[new o.FilteredFiniteDifference(.6),new o.FilteredFiniteDifference(.6),new o.FilteredFiniteDifference(.6)],this.tmpDirection=n.vec3f64.create()}return t.prototype.add=function(t,e,i){this.time.hasLastValue&&this.time.computeDelta(i)<.015||(this.screen[0].update(t[0]),this.screen[1].update(t[1]),this.scene[0].update(e[0]),this.scene[1].update(e[1]),this.scene[2].update(e[2]),this.time.update(i))},t.prototype.reset=function(){this.screen[0].reset(),this.screen[1].reset(),this.scene[0].reset(),this.scene[1].reset(),this.scene[2].reset(),this.time.reset()},t.prototype.evaluateMomentum=function(){if(!this.screen[0].hasFilteredDelta)return null;var t=this.screen[0].filteredDelta,e=this.screen[1].filteredDelta,i=Math.sqrt(t*t+e*e)/this.time.filteredDelta;return Math.abs(i)<this.minimumInitialVelocity?null:this.createMomentum(i,this.stopVelocity,this.friction)},t.prototype.createMomentum=function(t,e,i){r.vec3.set(this.tmpDirection,this.scene[0].filteredDelta,this.scene[1].filteredDelta,this.scene[2].filteredDelta);var n=r.vec3.length(this.tmpDirection);n>0&&r.vec3.scale(this.tmpDirection,this.tmpDirection,1/n);var o=n/this.time.filteredDelta;return new s(t,e,i,o,this.tmpDirection)},t}();e.PanPlanarMomentumEstimator=u}.apply(null,r))||(t.exports=n)},1826:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(20),i(97),i(10),i(2),i(74),i(123),i(82),i(1827),i(1828)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h,c,p){return function(t){function e(e){var i=t.call(this,e)||this;return i._animationTime=0,i._momentumFinished=!1,i._rotationMomentumEstimator=new c.RotationMomentumEstimator(.6,.15,.95),i._rotationDirection=1,i._zoomDirection=1,i._zoomMomentumEstimator=new p.ZoomMomentumEstimator,i._zoomOnly=null,i.zoomMomentum=null,i.rotateMomentum=null,i.viewpoint=new o({targetGeometry:new n.Point,scale:0,rotation:0}),i.watch("_momentumFinished",(function(t){t&&i.navigation.stop()})),i}return i(e,t),e.prototype.begin=function(t,e){this.navigation.begin(),this._rotationMomentumEstimator.reset(),this._zoomMomentumEstimator.reset(),this._zoomOnly=null,this._previousAngle=this._startAngle=e.angle,this._previousRadius=this._startRadius=e.radius,this._previousCenter=e.center,this._updateTimestamp=null,t.constraints.rotationEnabled&&this.addToRotateEstimator(0,e.timestamp),this.addToZoomEstimator(e,1)},e.prototype.update=function(t,e){null===this._updateTimestamp&&(this._updateTimestamp=e.timestamp);var i=e.angle,r=e.radius,n=e.center,o=Math.abs(180*(i-this._startAngle)/Math.PI),a=Math.abs(r-this._startRadius),s=this._startRadius/r;if(this._previousRadius){var u=r/this._previousRadius,l=180*(i-this._previousAngle)/Math.PI;this._rotationDirection=l>=0?1:-1,this._zoomDirection=u>=1?1:-1,t.constraints.rotationEnabled?(null===this._zoomOnly&&e.timestamp-this._updateTimestamp>200&&(this._zoomOnly=a-o>0),null===this._zoomOnly||this._zoomOnly?l=0:this.addToRotateEstimator(i-this._startAngle,e.timestamp)):l=0,this.addToZoomEstimator(e,s),this.navigation.setViewpoint([n.x,n.y],1/u,l,[this._previousCenter.x-n.x,n.y-this._previousCenter.y])}this._previousAngle=i,this._previousRadius=r,this._previousCenter=n},e.prototype.end=function(t,e){this.navigation.momentumEnabled&&(this.rotateMomentum=this._rotationMomentumEstimator.evaluateMomentum(),this.zoomMomentum=this._zoomMomentumEstimator.evaluateMomentum(),this._animationTime=0,(this.rotateMomentum||this.zoomMomentum)&&this.onAnimationUpdate(t)),this.navigation.end()},e.prototype.addToRotateEstimator=function(t,e){this._rotationMomentumEstimator.add(t,.001*e)},e.prototype.addToZoomEstimator=function(t,e){this._zoomMomentumEstimator.add(e,.001*t.timestamp)},e.prototype.canZoomIn=function(t){var e=t.scale,i=t.constraints.effectiveMaxScale;return 0===i||e>i},e.prototype.canZoomOut=function(t){var e=t.scale,i=t.constraints.effectiveMinScale;return 0===i||e<i},e.prototype.onAnimationUpdate=function(t){var e=this;this.navigation.animationManager.animateContinous(t.viewpoint,(function(i,r){var n=!e.canZoomIn(t)&&e._zoomDirection>1||!e.canZoomOut(t)&&e._zoomDirection<1,o=!e.rotateMomentum||e.rotateMomentum.isFinished(e._animationTime),a=n||!e.zoomMomentum||e.zoomMomentum.isFinished(e._animationTime),s=.001*r;if(e._momentumFinished=o&&a,!e._momentumFinished){var c=e.rotateMomentum?Math.abs(e.rotateMomentum.valueDelta(e._animationTime,s))*e._rotationDirection*180/Math.PI:0,p=e.zoomMomentum?Math.abs(e.zoomMomentum.valueDelta(e._animationTime,s)):1,d=l.vec2f64.create(),f=l.vec2f64.create();if(e._previousCenter){u.vec2.set(d,e._previousCenter.x,e._previousCenter.y),h.getPaddingScreenTranslation(f,t.size,t.padding),u.vec2.add(d,d,f);var m=t.constraints,v=t.scale,_=v*p;p<1&&!m.canZoomInTo(_)?(p=v/m.effectiveMaxScale,e.zoomMomentum=null,e.rotateMomentum=null):p>1&&!m.canZoomOutTo(_)&&(p=v/m.effectiveMinScale,e.zoomMomentum=null,e.rotateMomentum=null),h.scaleAndRotateBy(i,t.viewpoint,p,c,d,t.size)}}e._animationTime+=s}))},e.prototype.stopMomentumNavigation=function(){(this.rotateMomentum||this.zoomMomentum)&&(this.rotateMomentum&&(this._rotationMomentumEstimator.reset(),this.rotateMomentum=null),this.zoomMomentum&&(this._zoomMomentumEstimator.reset(),this.zoomMomentum=null),this.navigation.stop())},r([s.property()],e.prototype,"_momentumFinished",void 0),r([s.property()],e.prototype,"viewpoint",void 0),r([s.property()],e.prototype,"navigation",void 0),r([s.subclass("esri.views.2d.navigation.actions.Pinch")],e)}(s.declared(a))}.apply(null,r))||(t.exports=n)},1827:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(18),i(1216)],void 0===(n=function(t,e,i,r){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(e,i,r,n){return void 0===e&&(e=3),void 0===i&&(i=.01),void 0===r&&(r=.95),void 0===n&&(n=12),t.call(this,e,i,r,n)||this}return i(e,t),e.prototype.add=function(e,i){if(this.value.hasLastValue){for(var r=this.value.lastValue,n=e-r;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;e=r+n}t.prototype.add.call(this,e,i)},e}(r.MomentumEstimator);e.RotationMomentumEstimator=n}.apply(null,r))||(t.exports=n)},1828:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(18),i(1108),i(1216)],void 0===(n=function(t,e,i,r,n){Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return i(e,t),e.prototype.value=function(e){var i=t.prototype.value.call(this,e);return Math.exp(i)},e.prototype.valueDelta=function(e,i){var r=t.prototype.value.call(this,e),n=t.prototype.value.call(this,e+i)-r;return Math.exp(n)},e}(r.Momentum);e.ZoomMomentum=o;var a=function(t){function e(e,i,r,n){return void 0===e&&(e=2.5),void 0===i&&(i=.01),void 0===r&&(r=.95),void 0===n&&(n=12),t.call(this,e,i,r,n)||this}return i(e,t),e.prototype.add=function(e,i){t.prototype.add.call(this,Math.log(e),i)},e.prototype.createMomentum=function(t,e,i){return new o(t,e,i)},e}(n.MomentumEstimator);e.ZoomMomentumEstimator=a}.apply(null,r))||(t.exports=n)},1829:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(20),i(97),i(10),i(2),i(74),i(123),i(82)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h){var c=l.vec2f64.create(),p=l.vec2f64.create();return function(t){function e(e){var i=t.call(this,e)||this;return i._previousCenter=l.vec2f64.create(),i.viewpoint=new o({targetGeometry:new n.Point,scale:0,rotation:0}),i}return i(e,t),e.prototype.begin=function(t,e){this.navigation.begin(),u.vec2.set(this._previousCenter,e.center.x,e.center.y)},e.prototype.update=function(t,e){var i=t.state,r=i.size,n=i.padding;u.vec2.set(c,e.center.x,e.center.y),h.getAnchor(p,r,n),t.viewpoint=h.rotateBy(this.viewpoint,t.content.viewpoint,h.angleBetween(p,this._previousCenter,c)),u.vec2.copy(this._previousCenter,c)},e.prototype.end=function(t,e){this.navigation.end()},r([s.property()],e.prototype,"viewpoint",void 0),r([s.property()],e.prototype,"navigation",void 0),r([s.subclass("esri.views.2d.actions.Rotate")],e)}(s.declared(a))}.apply(null,r))||(t.exports=n)},1830:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(18),i(8),i(6),i(41),i(4),i(827),i(826)],void 0===(n=function(t,e,i,r,n,o,a,s,u){Object.defineProperty(e,"__esModule",{value:!0});var l=(s.enums.DataType,s.enums.Usage,s.enums.TextureSamplingMode,s.enums.TextureType,s.enums.TextureWrapMode,s.enums.PrimitiveType,s.enums.PixelFormat,s.enums.PixelType,u.enums.WGLDrawPhase),h=function(e){function h(){var t=e.call(this)||this;return t.visible=!1,t}return i(h,e),h.prototype.destroy=function(){this._readbackTexture&&(this._readbackTexture.dispose(),this._readbackTexture=null,this._maskTexture.dispose(),this._maskTexture=null,this._overlayTexture.dispose(),this._overlayTexture=null,this._vertexArrayObject.dispose(),this._vertexArrayObject=null,this._program.dispose(),this._program=null,this._resourcesPromise=null)},Object.defineProperty(h.prototype,"magnifier",{get:function(){return this._magnifier},set:function(t){var e=this;this._magnifier=t,this._handle&&this._handle.remove(),this._handle=t.watch("version",(function(){e.visible=t.visible})),this.visible=t.visible},enumerable:!0,configurable:!0}),h.prototype.doRender=function(e){var i=this.stage.context;if(this._resourcesPromise){if(e.drawPhase===l.MAP&&this._canRender()){this._updateResources(i);var r=this._magnifier,n=1/r.factor,o=Math.ceil(n*this.overlay.width),a=Math.ceil(n*this.overlay.height),s=e.state.size,u=e.pixelRatio,h=u*s[0],c=u*s[1],p=r.position||{x:.5*s[0],y:.5*s[1]},d=u*p.x,f=c-u*p.y,m=.5*o,v=.5*a;m>d?d=m:d>=h-m&&(d=h-m-1),v>f?f=v:f>=c-v&&(f=c-v-1);var _=d-m,y=f-v,g=this._readbackTexture;i.bindTexture(g,0),i.gl.copyTexImage2D(g.descriptor.target,0,g.descriptor.pixelFormat,_,y,o,a,0);var b=this.stage.background&&this.stage.background.color,x=b?[b.a*b.r/255,b.a*b.g/255,b.a*b.b/255,b.a]:[1,1,1,1],T=(d+r.offsetX)/h*2-1,M=(f-r.offsetY)/c*2-1,S=this.overlay.width/h*2,E=this.overlay.height/c*2,w=this._program;i.bindVAO(this._vertexArrayObject),i.bindTexture(this._overlayTexture,6),i.bindTexture(this._maskTexture,7),i.bindProgram(w),w.setUniform4fv("u_background",x),w.setUniform1i("u_readbackTexture",0),w.setUniform1i("u_overlyTexture",6),w.setUniform1i("u_maskTexture",7),w.setUniform2f("u_drawPos",T,M),w.setUniform1f("u_width",S),w.setUniform1f("u_height",E),i.setStencilTestEnabled(!1),i.drawArrays(5,0,4),i.bindVAO()}}else this._resourcesPromise=this._loadResources(t.toUrl("../../../images/magnifier/mask.png"),t.toUrl("../../../images/magnifier/overlay.png"))},h.prototype._canRender=function(){return this.mask&&this.overlay&&null!=this._magnifier},h.prototype._loadResources=function(t,e){return r(this,void 0,void 0,(function(){var i,r,s;return n(this,(function(n){switch(n.label){case 0:return[4,a.all([o(t,{responseType:"image"}),o(e,{responseType:"image"})])];case 1:return i=n.sent(),r=i[0].data,s=i[1].data,this.mask=r,this.overlay=s,this.requestRender(),[2]}}))}))},h.prototype._updateResources=function(t){if(!this._readbackTexture){var e=1/this._magnifier.factor,i=Math.ceil(e*this.overlay.width),r=Math.ceil(e*this.overlay.height);this._program=u.createMagnifierProgram(t);var n=new Uint16Array([0,1,0,0,1,1,1,0]),o=u.magnifier.attributes;this._vertexArrayObject=new s.VertexArrayObject(t,o,{geometry:[{name:"a_pos",count:2,type:5123,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:s.BufferObject.createVertex(t,35044,n)}),this._overlayTexture=new s.Texture(t,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.overlay),this._maskTexture=new s.Texture(t,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9728,flipped:!0},this.mask),this._readbackTexture=new s.Texture(t,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:i,height:r})}},h}(u.DisplayObject);e.default=h}.apply(null,r))||(t.exports=n)},860:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1746),i(951),i(1822),i(1830)],void 0===(n=function(t,e,i,r,n,o){Object.defineProperty(e,"__esModule",{value:!0}),e.LabelManager=i.default,e.GraphicsView2D=r.default,e.MapViewNavigation=n.default,e.MagnifierView2D=o.default}.apply(null,r))||(t.exports=n)},876:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.WEBGL_MAX_STOPS=8,e.WEBGL_MAX_INNER_STOPS=e.WEBGL_MAX_STOPS-2,e.NAN_MAGIC_NUMBER=1e-30,e.EXTRUDE_SCALE=64,e.PICTURE_FILL_COLOR=4294967295,e.TILE_SIZE=512,e.RASTER_TILE_SIZE=256,e.ANGLE_FACTOR_256=256/360,e.DEBUG_LABELS=!1,e.COLLISION_BUCKET_SIZE=128,e.DOT_DENSITY_MAX_FIELDS=8,e.COLLISION_MAX_ZOOM_DELTA=3,e.COLLISION_EARLY_REJECT_BUCKET_SIZE=16,e.COLLISION_BOX_PADDING=16,e.COLLISION_TILE_BOX_SIZE=e.TILE_SIZE/e.COLLISION_BUCKET_SIZE,e.COLLISION_PLACEMENT_PADDING=8,e.HEURISTIC_GLYPHS_PER_LINE=50,e.HEURISTIC_GLYPHS_PER_FEATURE=10,e.GLYPH_SIZE=24,e.TEXT_LINE_HEIGHT=1.2*e.GLYPH_SIZE,e.TEXT_MAX_WIDTH=10*e.GLYPH_SIZE,e.TEXT_SPACING=0,e.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}},e.ATTRIBUTE_STORE_TEXTURE_SIZE=1024,e.TEXTURE_BINDING_SPRITE_ATLAS=0,e.TEXTURE_BINDING_GLYPH_ATLAS=0,e.TEXTURE_BINDING_BITMAP=0,e.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1,e.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2,e.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3,e.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4,e.TEXTURE_BINDING_HIGHLIGHT_0=5,e.TEXTURE_BINDING_HIGHLIGHT_1=6,e.TEXTURE_BINDING_RENDERER_0=5,e.TEXTURE_BINDING_RENDERER_1=6,e.ATTRIBUTE_DATA_FILTER_FLAGS=0,e.ATTRIBUTE_DATA_ANIMATION=1,e.ATTRIBUTE_DATA_VV=2,e.ATTRIBUTE_DATA_DD0=3,e.ATTRIBUTE_DATA_DD1=3,e.MAX_FILTERS=2,e.HIGHLIGHT_FLAG=1,e.FILTER_FLAG_0=2,e.EFFECT_FLAG_0=4,e.THIN_LINE_THRESHOLD=2.5,e.HITTEST_SEARCH_SIZE=24,e.MAX_ANIMATION_TIME_MS=2e3}.apply(null,r))||(t.exports=n)},879:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(889)],void 0===(n=function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.mat4=i}.apply(null,r))||(t.exports=n)},881:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){function i(t,e){return(t%=e)>=0?t:t+e}Object.defineProperty(e,"__esModule",{value:!0}),e.C_INFINITY=Number.POSITIVE_INFINITY,e.C_PI=Math.PI,e.C_2PI=2*e.C_PI,e.C_PI_BY_2=e.C_PI/2,e.C_RAD_TO_256=128/e.C_PI,e.C_256_TO_RAD=e.C_PI/128,e.C_DEG_TO_256=256/360,e.C_DEG_TO_RAD=e.C_PI/180,e.C_SQRT2=1.414213562,e.C_SQRT2_INV=1/e.C_SQRT2;var r=1/Math.LN2;e.positiveMod=i,e.radToByte=function(t){return i(t*e.C_RAD_TO_256,256)},e.degToByte=function(t){return i(t*e.C_DEG_TO_256,256)},e.log2=function(t){return Math.log(t)*r},e.sqr=function(t){return t*t},e.interpolate=function(t,e,i){return t*(1-i)+e*i},e.between=function(t,e,i){return t>=e&&t<=i||t>=i&&t<=e}}.apply(null,r))||(t.exports=n)},888:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(16),i(19),i(177),i(279),i(74),i(275),i(26),i(168),i(281),i(179),i(56),i(271),i(37),i(37),i(826)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h,c,p,d,f,m,v){function _(t,e,i,o,s){var u,l,h=r.pt2px(i.xoffset),c=r.pt2px(i.yoffset),p=I*i.angle,d=I*s;switch(i.type){case"simple-marker":var f=i;u=l=r.pt2px(f.size);break;case"picture-marker":var m=i;u=r.pt2px(m.width),l=r.pt2px(m.height)}var v=n.mat2d.identity(P);n.mat2d.translate(v,v,a.vec2.set(D,t,e)),n.mat2d.rotate(v,v,d-p),n.mat2d.scale(v,v,a.vec2.set(D,o,-o)),n.mat2d.translate(v,v,a.vec2.set(D,h,-c));var _=[0,0];a.vec2.transformMat2d(_,a.vec2.set(D,-.5*u,-.5*l),v);var y=[0,0];a.vec2.transformMat2d(y,a.vec2.set(D,-.5*u,.5*l),v);var g=[0,0];a.vec2.transformMat2d(g,a.vec2.set(D,.5*u,-.5*l),v);var b=[0,0];return a.vec2.transformMat2d(b,a.vec2.set(D,.5*u,.5*l),v),{rings:[[_,g,b,y,_]]}}function y(t,e,i,o,s){var u=v.CIMSymbolHelper.getEnvelope(i.data);if(!u)return null;var l=r.pt2px(u.width),h=r.pt2px(u.height),c=r.pt2px(u.x),p=r.pt2px(u.y),d=0*I,f=I*s,m=n.mat2d.identity(P);n.mat2d.translate(m,m,a.vec2.set(D,t,e)),n.mat2d.rotate(m,m,f-d),n.mat2d.scale(m,m,a.vec2.set(D,o,o));var _=[0,0];a.vec2.transformMat2d(_,a.vec2.set(D,c,p+h),m);var y=[0,0];a.vec2.transformMat2d(y,a.vec2.set(D,c,p),m);var g=[0,0];a.vec2.transformMat2d(g,a.vec2.set(D,c+l,p+h),m);var b=[0,0];return a.vec2.transformMat2d(b,a.vec2.set(D,c+l,p),m),{rings:[[_,g,b,y,_]]}}function g(t,e,i,o,s,u){var l=v.alignmentUtils.getYAnchorDirection(i.verticalAlignment||"baseline"),h="baseline"===(i.verticalAlignment||"baseline"),c=r.pt2px(i.xoffset),p=r.pt2px(i.yoffset),d=r.pt2px(i.font.size)/24,f=4*d,m=h?25*d:o[1]+(1+l)*o[3]*.5,_=I*i.angle,y=I*u,g=n.mat2d.identity(P);n.mat2d.translate(g,g,a.vec2.set(D,t,e)),n.mat2d.rotate(g,g,y-_),n.mat2d.scale(g,g,a.vec2.set(D,s,-s)),n.mat2d.translate(g,g,a.vec2.set(D,c,-p)),n.mat2d.translate(g,g,a.vec2.set(D,-f,-f-m));var b=[0,0];a.vec2.transformMat2d(b,a.vec2.set(D,o[0],o[1]),g);var x=[0,0];a.vec2.transformMat2d(x,a.vec2.set(D,o[0],o[1]+o[3]),g);var T=[0,0];a.vec2.transformMat2d(T,a.vec2.set(D,o[0]+o[2],o[1]),g);var M=[0,0];return a.vec2.transformMat2d(M,a.vec2.set(D,o[0]+o[2],o[1]+o[3]),g),{rings:[[b,T,M,x,b]]}}function b(t,e,i){if(!i||0===i.glyphMosaicItems.length)return t;var n=v.bidiText(e.text),o=n[0],a=n[1],s=v.alignmentUtils.getJustification(e.horizontalAlignment||"center"),u=v.alignmentUtils.getXAnchorDirection(e.horizontalAlignment||"center"),l=i.glyphMosaicItems,h=new v.TextShapingNew([l],v.definitions.TEXT_MAX_WIDTH,v.definitions.TEXT_LINE_HEIGHT,v.definitions.TEXT_SPACING,[0,.5*-O],.5*(1-u),0,s).getShaping(o,a),c=v.fontUtils.getFontDecorationTop(e.font.decoration);isNaN(c)||v.TextShapingNew.addDecoration(h,c);var p=v.TextShapingNew.getBox(h),d=r.pt2px(e.font.size)/U;return t[0]=d*p.x,t[1]=d*p.y,t[2]=d*p.width,t[3]=d*p.height,t}function x(t,e,i,r,n,o,a){var s;switch(r.type){case"simple-marker":case"picture-marker":s=_(e,i,r,o,0);break;case"text":s=g(e,i,r,n,o,0);break;case"cim":s=y(e,i,r,o,0)}for(var u,l,h=0,c=0;c<s.rings[0].length-1;c++)u=(e-(l=s.rings[0][c])[0])*(e-l[0])+(i-l[1])*(i-l[1]),h=Math.max(h,u);h=Math.sqrt(h);var p=d.normalizeMapX(e-h,a),f=d.normalizeMapX(e+h,a);if(p>f){var v=m.getInfo(a);if(v){var b=v.valid;p=b[0],f=b[1]}}return t[0]=p,t[1]=i-h,t[2]=f,t[3]=i+h,t}function T(t,e){return Math.ceil((t-e)/(2*e))}function M(t,e){var i,r=e.valid,n=r[0],o=r[1],a=2*o,s=0;return t>o?(t-=(i=Math.ceil(Math.abs(t-o)/a))*a,s=i):t<n&&(t+=(i=Math.ceil(Math.abs(t-n)/a))*a,s=-i),{x:t,frameId:s}}function S(t,e){var i=e.xmin,r=e.ymin,n=e.xmax,o=e.ymax;return E(t,i,r)&&E(t,i,o)&&E(t,n,o)&&E(t,n,r)}function E(t,e,i){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax}function w(t,e,i){var r;if(Array.isArray(t)){if((r=t[0])>e){var n=T(r,e);t[0]=r+n*(-2*e)}else if(r<i){n=T(r,i);t[0]=r+n*(-2*i)}}else if((r=t.x)>e){n=T(r,e);t.x+=n*(-2*e)}else if(r<i){n=T(r,i);t.x+=n*(-2*i)}return t}Object.defineProperty(e,"__esModule",{value:!0});var I=Math.PI/180,A=v.definitions.TEXT_MAX_WIDTH,O=v.definitions.TEXT_LINE_HEIGHT,z=v.definitions.TEXT_SPACING,P=o.mat2df32.create(),D=s.vec2f32.create(),R=l.create();e.getBounds=function(t,e,i,r,n,o,a,s){if(!r||!i)return t[0]=t[1]=t[2]=t[3]=0,e[0]=e[1]=e[2]=e[3]=0,t;var u=r;if(!p.isPoint(u)){h.getBoundsXY(t,u);var l=e[0];0===l&&(l=function(t,e){var i=0;switch(t.type){case"simple-fill":case"picture-fill":var r=t.outline;if(!r)return 0;i=r.width;break;case"simple-line":i=t.width;break;case"simple-marker":i=t.size;break;case"picture-marker":i=Math.max(t.width,t.height);break;case"text":var n=[0,0,0,0];b(n,t,e),i=Math.max(n[0],n[1]);break;case"cim":var o=v.CIMSymbolHelper.getEnvelope(t.data);i=Math.sqrt(o.width*o.width+o.height*o.height)}return i}(i,n),e[0]=l);var c=o*l/2;return t[0]-=c,t[1]-=c,t[2]+=c,t[3]+=c,t}var d=u.x,f=u.y;return"text"===i.type&&0===e[2]&&0===e[3]&&b(e,i,n),x(t,d,f,i,e,o,s),t},e.isMarkerSymbol=function(t){return"simple-marker"===t||"picture-marker"===t||"text"===t},e.graphicGeometryToNumber=function(t){switch(i.expect(t.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var L=s.vec2f32.create(),C=s.vec2f32.create(),N=s.vec2f32.create(),G=s.vec2f32.create(),V=s.vec2f32.create(),B=s.vec2f32.create(),F=s.vec2f32.create();e.isPointOnPolyline=function(t,e,i,r){a.vec2.set(N,e,i);for(var n,o,s,u,l,h,c,p,d,f=t.paths,m=1/0,v=0;v<f.length;v++){var _=f[v];if(!(_.length<2))for(var y=1;y<_.length;y++)n=_[y-1][0],s=_[y-1][1],o=_[y][0],u=_[y][1],l=Math.min(n,o)-r,h=Math.min(s,u)-r,c=Math.max(n,o)+r,p=Math.max(s,u)+r,e<l||e>c||i<h||i>p||(a.vec2.set(L,n,s),a.vec2.set(C,o,u),a.vec2.subtract(G,C,L),a.vec2.subtract(V,L,N),a.vec2.scale(B,G,a.vec2.dot(G,V)/a.vec2.dot(G,G)),a.vec2.subtract(F,V,B),m>(d=a.vec2.dot(F,F))&&(m=d))}return Math.sqrt(m)<=r},e.getMarkerSymbolBounds=_,e.getCIMMarkerBounds=y,e.getTextSymbolBounds=g,e.normalizeCentralMeridian=function(t){var e,i,r,n,o,a,s,u,l=null;if(!t)return null;e=t.spatialReference,i=f.getInfo(e),r=e.isWebMercator,n=k[a=r?102100:4326].maxX,o=k[a].minX,s=k[a].plus180Line,u=k[a].minus180Line;var d,m=t.toJSON();if(!i)return m;if("mesh"===t.type)d=m;else if(p.isPoint(m))d=w(m,n,o);else if(p.isMultipoint(m))m.points=m.points.map((function(t){return w(t,n,o)})),d=m;else if(p.isExtent(m))d=function(t,e){if(!e)return t;var i=function(t,e){var i,r=[],n=t.ymin,o=t.ymax,a=t.xmax-t.xmin,s=t.xmin,u=t.xmax,l=e.valid,h=l[0],c=l[1],p=(i=M(t.xmin,e)).x,d=i.frameId,f=(i=M(t.xmax,e)).x,m=i.frameId,v=p===f&&a>0;if(a>2*c){var _={xmin:s<u?p:f,ymin:n,xmax:c,ymax:o},y={xmin:h,ymin:n,xmax:s<u?f:p,ymax:o},g={xmin:0,ymin:n,xmax:c,ymax:o},b={xmin:h,ymin:n,xmax:0,ymax:o},x=[],T=[];S(_,g)&&x.push(d),S(_,b)&&T.push(d),S(y,g)&&x.push(m),S(y,b)&&T.push(m);for(var E=d+1;E<m;E++)x.push(E),T.push(E);r.push({extent:_,frameIds:[d]},{extent:y,frameIds:[m]},{extent:g,frameIds:x},{extent:b,frameIds:T})}else p>f||v?r.push({extent:{xmin:p,ymin:n,xmax:c,ymax:o},frameIds:[d]},{extent:{xmin:h,ymin:n,xmax:f,ymax:o},frameIds:[m]}):r.push({extent:{xmin:p,ymin:n,xmax:f,ymax:o},frameIds:[d]});return r}(t,e).map((function(t){return t.extent}));return i.length<2?i[0]||t:i.length>2?(t.xmin=e.valid[0],t.xmax=e.valid[1],t):{rings:i.map((function(t){return[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]}))}}(m,i);else if(p.isPolygon(m)||p.isPolyline(m)){var v=R;h.getBoundsXY(v,m);var _={xmin:v[0],ymin:v[1],xmax:v[2],ymax:v[3]},y=T(_.xmin,o)*(2*n),g=0===y?m:function(t,e){for(var i=function(t){return p.isPolygon(t)?t.rings:t.paths}(t),r=0,n=i;r<n.length;r++)for(var o=n[r],a=0,s=o;a<s.length;a++){s[a][0]+=e}return t}(m,y);_.xmin+=y,_.xmax+=y,c.extentIntersectsPolyline(_,s)&&_.xmax!==n?l=g:c.extentIntersectsPolyline(_,u)&&_.xmin!==o?l=g:d=g}else d=t.clone();return null!==l?(new H).cut(l,n):d};var U=24;e.getTextSymbolSize=b,e.getTextSymbolEstimatedSize=function(t,e,i){var n=v.bidiText(e.text),o=n[0],a=n[1],s=v.alignmentUtils.getJustification(e.horizontalAlignment||"center"),u=v.alignmentUtils.getXAnchorDirection(e.horizontalAlignment||"center"),l=new v.TextShapingNew([],A,O,z,[0,.5*-O],.5*(1-u),0,s).getEstimatedShaping(o,a,i),h=v.TextShapingNew.getBox(l),c=r.pt2px(e.font.size)/U;return t[0]=c*h.x,t[1]=c*h.y,t[2]=c*h.width,t[3]=c*h.height,t};var k={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84}}},H=function(){function t(){}return t.prototype.cut=function(t,e){var i;if(t.rings)this.closed=!0,i=t.rings,this.minPts=4;else{if(!t.paths)return null;this.closed=!1,i=t.paths,this.minPts=2}for(var r=i.length,n=-2*e,o=0;o<r;o++){var a=i[o];if(a&&a.length>=this.minPts){for(var s=[],u=0,l=a;u<l.length;u++){var h=l[u];s.push([h[0]+n,h[1]])}i.push(s)}}return this.closed?t.rings=i:t.paths=i,t},t}()}.apply(null,r))||(t.exports=n)},889:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(180),i(76)],void 0===(n=function(t,e,i,r){function n(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],h=e[7],c=e[8],p=e[9],d=e[10],f=e[11],m=e[12],v=e[13],_=e[14],y=e[15],g=i[0],b=i[1],x=i[2],T=i[3];return t[0]=g*r+b*s+x*c+T*m,t[1]=g*n+b*u+x*p+T*v,t[2]=g*o+b*l+x*d+T*_,t[3]=g*a+b*h+x*f+T*y,g=i[4],b=i[5],x=i[6],T=i[7],t[4]=g*r+b*s+x*c+T*m,t[5]=g*n+b*u+x*p+T*v,t[6]=g*o+b*l+x*d+T*_,t[7]=g*a+b*h+x*f+T*y,g=i[8],b=i[9],x=i[10],T=i[11],t[8]=g*r+b*s+x*c+T*m,t[9]=g*n+b*u+x*p+T*v,t[10]=g*o+b*l+x*d+T*_,t[11]=g*a+b*h+x*f+T*y,g=i[12],b=i[13],x=i[14],T=i[15],t[12]=g*r+b*s+x*c+T*m,t[13]=g*n+b*u+x*p+T*v,t[14]=g*o+b*l+x*d+T*_,t[15]=g*a+b*h+x*f+T*y,t}function a(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3],s=r+r,u=n+n,l=o+o,h=r*s,c=r*u,p=r*l,d=n*u,f=n*l,m=o*l,v=a*s,_=a*u,y=a*l;return t[0]=1-(d+m),t[1]=c+y,t[2]=p-_,t[3]=0,t[4]=c-y,t[5]=1-(h+m),t[6]=f+v,t[7]=0,t[8]=p+_,t[9]=f-v,t[10]=1-(h+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function s(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}Object.defineProperty(e,"__esModule",{value:!0}),e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.set=function(t,e,i,r,n,o,a,s,u,l,h,c,p,d,f,m,v){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t[9]=h,t[10]=c,t[11]=p,t[12]=d,t[13]=f,t[14]=m,t[15]=v,t},e.identity=n,e.transpose=function(t,e){if(t===e){var i=e[1],r=e[2],n=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=n,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],p=e[10],d=e[11],f=e[12],m=e[13],v=e[14],_=e[15],y=i*s-r*a,g=i*u-n*a,b=i*l-o*a,x=r*u-n*s,T=r*l-o*s,M=n*l-o*u,S=h*m-c*f,E=h*v-p*f,w=h*_-d*f,I=c*v-p*m,A=c*_-d*m,O=p*_-d*v,z=y*O-g*A+b*I+x*w-T*E+M*S;return z?(z=1/z,t[0]=(s*O-u*A+l*I)*z,t[1]=(n*A-r*O-o*I)*z,t[2]=(m*M-v*T+_*x)*z,t[3]=(p*T-c*M-d*x)*z,t[4]=(u*w-a*O-l*E)*z,t[5]=(i*O-n*w+o*E)*z,t[6]=(v*b-f*M-_*g)*z,t[7]=(h*M-p*b+d*g)*z,t[8]=(a*A-s*w+l*S)*z,t[9]=(r*w-i*A-o*S)*z,t[10]=(f*T-m*b+_*y)*z,t[11]=(c*b-h*T-d*y)*z,t[12]=(s*E-a*I-u*S)*z,t[13]=(i*I-r*E+n*S)*z,t[14]=(m*g-f*x-v*y)*z,t[15]=(h*x-c*g+p*y)*z,t):null},e.adjoint=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],h=e[8],c=e[9],p=e[10],d=e[11],f=e[12],m=e[13],v=e[14],_=e[15];return t[0]=s*(p*_-d*v)-c*(u*_-l*v)+m*(u*d-l*p),t[1]=-(r*(p*_-d*v)-c*(n*_-o*v)+m*(n*d-o*p)),t[2]=r*(u*_-l*v)-s*(n*_-o*v)+m*(n*l-o*u),t[3]=-(r*(u*d-l*p)-s*(n*d-o*p)+c*(n*l-o*u)),t[4]=-(a*(p*_-d*v)-h*(u*_-l*v)+f*(u*d-l*p)),t[5]=i*(p*_-d*v)-h*(n*_-o*v)+f*(n*d-o*p),t[6]=-(i*(u*_-l*v)-a*(n*_-o*v)+f*(n*l-o*u)),t[7]=i*(u*d-l*p)-a*(n*d-o*p)+h*(n*l-o*u),t[8]=a*(c*_-d*m)-h*(s*_-l*m)+f*(s*d-l*c),t[9]=-(i*(c*_-d*m)-h*(r*_-o*m)+f*(r*d-o*c)),t[10]=i*(s*_-l*m)-a*(r*_-o*m)+f*(r*l-o*s),t[11]=-(i*(s*d-l*c)-a*(r*d-o*c)+h*(r*l-o*s)),t[12]=-(a*(c*v-p*m)-h*(s*v-u*m)+f*(s*p-u*c)),t[13]=i*(c*v-p*m)-h*(r*v-n*m)+f*(r*p-n*c),t[14]=-(i*(s*v-u*m)-a*(r*v-n*m)+f*(r*u-n*s)),t[15]=i*(s*p-u*c)-a*(r*p-n*c)+h*(r*u-n*s),t},e.determinant=function(t){var e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],h=t[9],c=t[10],p=t[11],d=t[12],f=t[13],m=t[14],v=t[15];return(e*a-i*o)*(c*v-p*m)-(e*s-r*o)*(h*v-p*f)+(e*u-n*o)*(h*m-c*f)+(i*s-r*a)*(l*v-p*d)-(i*u-n*a)*(l*m-c*d)+(r*u-n*s)*(l*f-h*d)},e.multiply=o,e.translate=function(t,e,i){var r=i[0],n=i[1],o=i[2],a=void 0,s=void 0,u=void 0,l=void 0,h=void 0,c=void 0,p=void 0,d=void 0,f=void 0,m=void 0,v=void 0,_=void 0;return e===t?(t[12]=e[0]*r+e[4]*n+e[8]*o+e[12],t[13]=e[1]*r+e[5]*n+e[9]*o+e[13],t[14]=e[2]*r+e[6]*n+e[10]*o+e[14],t[15]=e[3]*r+e[7]*n+e[11]*o+e[15]):(a=e[0],s=e[1],u=e[2],l=e[3],h=e[4],c=e[5],p=e[6],d=e[7],f=e[8],m=e[9],v=e[10],_=e[11],t[0]=a,t[1]=s,t[2]=u,t[3]=l,t[4]=h,t[5]=c,t[6]=p,t[7]=d,t[8]=f,t[9]=m,t[10]=v,t[11]=_,t[12]=a*r+h*n+f*o+e[12],t[13]=s*r+c*n+m*o+e[13],t[14]=u*r+p*n+v*o+e[14],t[15]=l*r+d*n+_*o+e[15]),t},e.scale=function(t,e,i){var r=i[0],n=i[1],o=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,i,n){var o=n[0],a=n[1],s=n[2],u=Math.sqrt(o*o+a*a+s*s),l=void 0,h=void 0,c=void 0,p=void 0,d=void 0,f=void 0,m=void 0,v=void 0,_=void 0,y=void 0,g=void 0,b=void 0,x=void 0,T=void 0,M=void 0,S=void 0,E=void 0,w=void 0,I=void 0,A=void 0,O=void 0,z=void 0,P=void 0,D=void 0;return u<r.EPSILON?null:(o*=u=1/u,a*=u,s*=u,l=Math.sin(i),c=1-(h=Math.cos(i)),p=e[0],d=e[1],f=e[2],m=e[3],v=e[4],_=e[5],y=e[6],g=e[7],b=e[8],x=e[9],T=e[10],M=e[11],S=o*o*c+h,E=a*o*c+s*l,w=s*o*c-a*l,I=o*a*c-s*l,A=a*a*c+h,O=s*a*c+o*l,z=o*s*c+a*l,P=a*s*c-o*l,D=s*s*c+h,t[0]=p*S+v*E+b*w,t[1]=d*S+_*E+x*w,t[2]=f*S+y*E+T*w,t[3]=m*S+g*E+M*w,t[4]=p*I+v*A+b*O,t[5]=d*I+_*A+x*O,t[6]=f*I+y*A+T*O,t[7]=m*I+g*A+M*O,t[8]=p*z+v*P+b*D,t[9]=d*z+_*P+x*D,t[10]=f*z+y*P+T*D,t[11]=m*z+g*P+M*D,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],h=e[9],c=e[10],p=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+l*r,t[5]=a*n+h*r,t[6]=s*n+c*r,t[7]=u*n+p*r,t[8]=l*n-o*r,t[9]=h*n-a*r,t[10]=c*n-s*r,t[11]=p*n-u*r,t},e.rotateY=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],h=e[9],c=e[10],p=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-l*r,t[1]=a*n-h*r,t[2]=s*n-c*r,t[3]=u*n-p*r,t[8]=o*r+l*n,t[9]=a*r+h*n,t[10]=s*r+c*n,t[11]=u*r+p*n,t},e.rotateZ=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],h=e[5],c=e[6],p=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+l*r,t[1]=a*n+h*r,t[2]=s*n+c*r,t[3]=u*n+p*r,t[4]=l*n-o*r,t[5]=h*n-a*r,t[6]=c*n-s*r,t[7]=p*n-u*r,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,i){var n=i[0],o=i[1],a=i[2],s=Math.sqrt(n*n+o*o+a*a),u=void 0,l=void 0,h=void 0;return s<r.EPSILON?null:(n*=s=1/s,o*=s,a*=s,u=Math.sin(e),h=1-(l=Math.cos(e)),t[0]=n*n*h+l,t[1]=o*n*h+a*u,t[2]=a*n*h-o*u,t[3]=0,t[4]=n*o*h-a*u,t[5]=o*o*h+l,t[6]=a*o*h+n*u,t[7]=0,t[8]=n*a*h+o*u,t[9]=o*a*h-n*u,t[10]=a*a*h+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=a,e.fromQuat2=function(t,e){var i=u,r=-e[0],n=-e[1],o=-e[2],s=e[3],l=e[4],h=e[5],c=e[6],p=e[7],d=r*r+n*n+o*o+s*s;return d>0?(i[0]=2*(l*s+p*r+h*o-c*n)/d,i[1]=2*(h*s+p*n+c*r-l*o)/d,i[2]=2*(c*s+p*o+l*n-h*r)/d):(i[0]=2*(l*s+p*r+h*o-c*n),i[1]=2*(h*s+p*n+c*r-l*o),i[2]=2*(c*s+p*o+l*n-h*r)),a(t,e,i),t};var u=i.create();e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[4],a=e[5],s=e[6],u=e[8],l=e[9],h=e[10];return t[0]=Math.sqrt(i*i+r*r+n*n),t[1]=Math.sqrt(o*o+a*a+s*s),t[2]=Math.sqrt(u*u+l*l+h*h),t},e.getRotation=function(t,e){var i=e[0]+e[5]+e[10],r=0;return i>0?(r=2*Math.sqrt(i+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,i,r){var n=e[0],o=e[1],a=e[2],s=e[3],u=n+n,l=o+o,h=a+a,c=n*u,p=n*l,d=n*h,f=o*l,m=o*h,v=a*h,_=s*u,y=s*l,g=s*h,b=r[0],x=r[1],T=r[2];return t[0]=(1-(f+v))*b,t[1]=(p+g)*b,t[2]=(d-y)*b,t[3]=0,t[4]=(p-g)*x,t[5]=(1-(c+v))*x,t[6]=(m+_)*x,t[7]=0,t[8]=(d+y)*T,t[9]=(m-_)*T,t[10]=(1-(c+f))*T,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,i,r,n){var o=e[0],a=e[1],s=e[2],u=e[3],l=o+o,h=a+a,c=s+s,p=o*l,d=o*h,f=o*c,m=a*h,v=a*c,_=s*c,y=u*l,g=u*h,b=u*c,x=r[0],T=r[1],M=r[2],S=n[0],E=n[1],w=n[2],I=(1-(m+_))*x,A=(d+b)*x,O=(f-g)*x,z=(d-b)*T,P=(1-(p+_))*T,D=(v+y)*T,R=(f+g)*M,L=(v-y)*M,C=(1-(p+m))*M;return t[0]=I,t[1]=A,t[2]=O,t[3]=0,t[4]=z,t[5]=P,t[6]=D,t[7]=0,t[8]=R,t[9]=L,t[10]=C,t[11]=0,t[12]=i[0]+S-(I*S+z*E+R*w),t[13]=i[1]+E-(A*S+P*E+L*w),t[14]=i[2]+w-(O*S+D*E+C*w),t[15]=1,t},e.fromQuat=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=i+i,s=r+r,u=n+n,l=i*a,h=r*a,c=r*s,p=n*a,d=n*s,f=n*u,m=o*a,v=o*s,_=o*u;return t[0]=1-c-f,t[1]=h+_,t[2]=p-v,t[3]=0,t[4]=h-_,t[5]=1-l-f,t[6]=d+m,t[7]=0,t[8]=p+v,t[9]=d-m,t[10]=1-l-c,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,i,r,n,o,a){var s=1/(i-e),u=1/(n-r),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+e)*s,t[9]=(n+r)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t},e.perspective=function(t,e,i,r,n){var o=1/Math.tan(e/2),a=void 0;return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(a=1/(r-n),t[10]=(n+r)*a,t[14]=2*n*r*a):(t[10]=-1,t[14]=-2*r),t},e.perspectiveFromFieldOfView=function(t,e,i,r){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(n+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(n-o)*l*.5,t[10]=r/(i-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*i/(i-r),t[15]=0,t},e.ortho=function(t,e,i,r,n,o,a){var s=1/(e-i),u=1/(r-n),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*s,t[13]=(n+r)*u,t[14]=(a+o)*l,t[15]=1,t},e.lookAt=function(t,e,i,o){var a=void 0,s=void 0,u=void 0,l=void 0,h=void 0,c=void 0,p=void 0,d=void 0,f=void 0,m=void 0,v=e[0],_=e[1],y=e[2],g=o[0],b=o[1],x=o[2],T=i[0],M=i[1],S=i[2];return Math.abs(v-T)<r.EPSILON&&Math.abs(_-M)<r.EPSILON&&Math.abs(y-S)<r.EPSILON?n(t):(p=v-T,d=_-M,f=y-S,a=b*(f*=m=1/Math.sqrt(p*p+d*d+f*f))-x*(d*=m),s=x*(p*=m)-g*f,u=g*d-b*p,(m=Math.sqrt(a*a+s*s+u*u))?(a*=m=1/m,s*=m,u*=m):(a=0,s=0,u=0),l=d*u-f*s,h=f*a-p*u,c=p*s-d*a,(m=Math.sqrt(l*l+h*h+c*c))?(l*=m=1/m,h*=m,c*=m):(l=0,h=0,c=0),t[0]=a,t[1]=l,t[2]=p,t[3]=0,t[4]=s,t[5]=h,t[6]=d,t[7]=0,t[8]=u,t[9]=c,t[10]=f,t[11]=0,t[12]=-(a*v+s*_+u*y),t[13]=-(l*v+h*_+c*y),t[14]=-(p*v+d*_+f*y),t[15]=1,t)},e.targetTo=function(t,e,i,r){var n=e[0],o=e[1],a=e[2],s=r[0],u=r[1],l=r[2],h=n-i[0],c=o-i[1],p=a-i[2],d=h*h+c*c+p*p;d>0&&(h*=d=1/Math.sqrt(d),c*=d,p*=d);var f=u*p-l*c,m=l*h-s*p,v=s*c-u*h;return(d=f*f+m*m+v*v)>0&&(f*=d=1/Math.sqrt(d),m*=d,v*=d),t[0]=f,t[1]=m,t[2]=v,t[3]=0,t[4]=c*v-p*m,t[5]=p*f-h*v,t[6]=h*m-c*f,t[7]=0,t[8]=h,t[9]=c,t[10]=p,t[11]=0,t[12]=n,t[13]=o,t[14]=a,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t},e.subtract=s,e.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t},e.multiplyScalarAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t[9]=e[9]+i[9]*r,t[10]=e[10]+i[10]*r,t[11]=e[11]+i[11]*r,t[12]=e[12]+i[12]*r,t[13]=e[13]+i[13]*r,t[14]=e[14]+i[14]*r,t[15]=e[15]+i[15]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var i=t[0],n=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],h=t[7],c=t[8],p=t[9],d=t[10],f=t[11],m=t[12],v=t[13],_=t[14],y=t[15],g=e[0],b=e[1],x=e[2],T=e[3],M=e[4],S=e[5],E=e[6],w=e[7],I=e[8],A=e[9],O=e[10],z=e[11],P=e[12],D=e[13],R=e[14],L=e[15];return Math.abs(i-g)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(n-b)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(o-x)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-T)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-M)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-S)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(l-E)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(h-w)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(c-I)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(p-A)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(d-O)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(f-z)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(z))&&Math.abs(m-P)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(v-D)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(D))&&Math.abs(_-R)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(R))&&Math.abs(y-L)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(L))},e.mul=o,e.sub=s}.apply(null,r))||(t.exports=n)},890:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(904)],void 0===(n=function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.mat4f64=i}.apply(null,r))||(t.exports=n)},894:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(15),i(59)],void 0===(n=function(t,e,i,r){var n=i("esri-text-decoder")?new TextDecoder("utf-8"):null,o=i("safari")?6:i("ff")?12:32;return function(){function t(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=t?t.byteLength:0),this._tag=0,this._dataType=99,this.init(t,e,i,r)}return t.prototype.init=function(t,e,i,r){this._data=t,this._dataView=e,this._pos=i,this._end=r},t.prototype.clone=function(){return new t(this._data,this._dataView,this._pos,this._end)},t.prototype.pos=function(){return this._pos},t.prototype.next=function(t){for(;;){if(this._pos===this._end)return!1;var e=this._decodeVarint();if(this._tag=e>>3,this._dataType=7&e,!t||t===this._tag)break;this.skip()}return!0},t.prototype.empty=function(){return this._pos>=this._end},t.prototype.tag=function(){return this._tag},t.prototype.getInt32=function(){return this._decodeVarint()},t.prototype.getInt64=function(){return this._decodeVarint()},t.prototype.getUInt32=function(){var t=4294967295;return t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?t:(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?t:void 0))))},t.prototype.getUInt64=function(){return this._decodeVarint()},t.prototype.getSInt32=function(){var t=this.getUInt32();return t>>>1^-(1&t)|0},t.prototype.getSInt64=function(){return this._decodeSVarint()},t.prototype.getBool=function(){var t=0!==this._data[this._pos];return this._skip(1),t},t.prototype.getEnum=function(){return this._decodeVarint()},t.prototype.getFixed64=function(){var t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+4294967296*t.getUint32(e+4,!0);return this._skip(8),i},t.prototype.getSFixed64=function(){var t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+4294967296*t.getInt32(e+4,!0);return this._skip(8),i},t.prototype.getDouble=function(){var t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t},t.prototype.getFixed32=function(){var t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t},t.prototype.getSFixed32=function(){var t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t},t.prototype.getFloat=function(){var t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t},t.prototype.getString=function(){var t=this._getLength(),e=this._pos,i=this._toString(this._data,e,e+t);return this._skip(t),i},t.prototype.getBytes=function(){var t=this._getLength(),e=this._pos,i=this._toBytes(this._data,e,e+t);return this._skip(t),i},t.prototype.processMessageWithArgs=function(t,e,i,r){var n=this.getMessage(),o=t(n,e,i,r);return n.release(),o},t.prototype.processMessage=function(t){var e=this.getMessage(),i=t(e);return e.release(),i},t.prototype.getMessage=function(){var e=this._getLength(),i=t.pool.acquire();return i.init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),i},t.prototype.release=function(){t.pool.release(this)},t.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},t.prototype._skip=function(t){if(this._pos+t>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=t},t.prototype._decodeVarint=function(){var t,e=this._data,i=this._pos,r=0;if(this._end-i>=10)do{if(r|=127&(t=e[i++]),0==(128&t))break;if(r|=(127&(t=e[i++]))<<7,0==(128&t))break;if(r|=(127&(t=e[i++]))<<14,0==(128&t))break;if(r|=(127&(t=e[i++]))<<21,0==(128&t))break;if(r+=268435456*(127&(t=e[i++])),0==(128&t))break;if(r+=34359738368*(127&(t=e[i++])),0==(128&t))break;if(r+=4398046511104*(127&(t=e[i++])),0==(128&t))break;if(r+=562949953421312*(127&(t=e[i++])),0==(128&t))break;if(r+=72057594037927940*(127&(t=e[i++])),0==(128&t))break;if(r+=0x8000000000000000*(127&(t=e[i++])),0==(128&t))break;throw new Error("Varint too long!")}while(0);else{for(var n=1;i!==this._end&&0!=(128&(t=e[i]));)++i,r+=(127&t)*n,n*=128;if(i===this._end)throw new Error("Varint overrun!");++i,r+=t*n}return this._pos=i,r},t.prototype._decodeSVarint=function(){var t=this._decodeVarint();return t%2?-(t+1)/2:t/2},t.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},t.prototype._toString=function(t,e,i){if((i=Math.min(this._end,i))-e>o&&n){var r=t.subarray(e,i);return n.decode(r)}for(var a="",s="",u=e;u<i;++u){var l=t[u];128&l?s+="%"+l.toString(16):(a+=decodeURIComponent(s)+String.fromCharCode(l),s="")}return s.length&&(a+=decodeURIComponent(s)),a},t.prototype._toBytes=function(t,e,i){return i=Math.min(this._end,i),new Uint8Array(t.buffer,e,i-e)},t.pool=new r(t,!1,(function(t){t._data=null,t._dataView=null})),t}()}.apply(null,r))||(t.exports=n)},895:function(t,e,i){var r,n;r=[i(914)],void 0===(n=function(t){"use strict";function e(t,i){if(!(this instanceof e))return new e(t,i);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this.toBBox=i:this._initFormat(i)),this.clear()}function i(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return-1}function r(t,e){n(t,0,t.children.length,e,t)}function n(t,e,i,r,n){n||(n=f(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,s=e;s<i;s++)a=t.children[s],o(n,t.leaf?r(a):a);return n}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function a(t,e){return t.minX-e.minX}function s(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function c(t,e){var i=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,o-r)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(e,i,r,n,o){for(var a,s=[i,r];s.length;)(r=s.pop())-(i=s.pop())<=n||(a=i+Math.ceil((r-i)/n/2)*n,t(e,a,i,r,o),s.push(i,a,a,r))}return e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],r=this.toBBox;if(!d(t,e))return i;for(var n,o,a,s,u=[];e;){for(n=0,o=e.children.length;n<o;n++)a=e.children[n],d(t,s=e.leaf?r(a):a)&&(e.leaf?i.push(a):p(t,s)?this._all(a,i):u.push(a));e=u.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!d(t,e))return!1;for(var r,n,o,a,s=[];e;){for(r=0,n=e.children.length;r<n;r++)if(o=e.children[r],d(t,a=e.leaf?i(o):o)){if(e.leaf||p(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=f([]),this},remove:function(t,e){if(!t)return this;for(var r,n,o,a,s=this.data,u=this.toBBox(t),l=[],h=[];s||l.length;){if(s||(s=l.pop(),n=l[l.length-1],r=h.pop(),a=!0),s.leaf&&-1!==(o=i(t,s.children,e)))return s.children.splice(o,1),l.push(s),this._condense(l),this;a||s.leaf||!p(s,u)?n?(r++,s=n.children[r],a=!1):s=null:(l.push(s),h.push(r),r=0,n=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:a,compareMinY:s,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var o,a=i-e+1,s=this._maxEntries;if(a<=s)return r(o=f(t.slice(e,i+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(o=f([])).leaf=!1,o.height=n;var u,l,h,c,p=Math.ceil(a/s),d=p*Math.ceil(Math.sqrt(s));for(m(t,e,i,d,this.compareMinX),u=e;u<=i;u+=d)for(m(t,u,h=Math.min(u+d-1,i),p,this.compareMinY),l=u;l<=h;l+=p)c=Math.min(l+p-1,h),o.children.push(this._build(t,l,c,n-1));return r(o,this.toBBox),o},_chooseSubtree:function(t,e,i,r){for(var n,o,a,s,l,c,p,d;r.push(e),!e.leaf&&r.length-1!==i;){for(p=d=1/0,n=0,o=e.children.length;n<o;n++)l=u(a=e.children[n]),(c=h(t,a)-l)<d?(d=c,p=l<p?l:p,s=a):c===d&&l<p&&(p=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,i){var r=this.toBBox,n=i?t:r(t),a=[],s=this._chooseSubtree(n,this.data,e,a);for(s.children.push(t),o(s,n);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(n,a,e)},_split:function(t,e){var i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var a=this._chooseSplitIndex(i,o,n),s=f(i.children.splice(a,i.children.length-a));s.height=i.height,s.leaf=i.leaf,r(i,this.toBBox),r(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var r,o,a,s,l,h,p,d;for(h=p=1/0,r=e;r<=i-e;r++)s=c(o=n(t,0,r,this.toBBox),a=n(t,r,i,this.toBBox)),l=u(o)+u(a),s<h?(h=s,d=r,p=l<p?l:p):s===h&&l<p&&(p=l,d=r);return d},_chooseSplitAxis:function(t,e,i){var r=t.leaf?this.compareMinX:a,n=t.leaf?this.compareMinY:s;this._allDistMargin(t,e,i,r)<this._allDistMargin(t,e,i,n)&&t.children.sort(r)},_allDistMargin:function(t,e,i,r){t.children.sort(r);var a,s,u=this.toBBox,h=n(t,0,e,u),c=n(t,i-e,i,u),p=l(h)+l(c);for(a=e;a<i-e;a++)s=t.children[a],o(h,t.leaf?u(s):s),p+=l(h);for(a=i-e-1;a>=e;a--)s=t.children[a],o(c,t.leaf?u(s):s),p+=l(c);return p},_adjustParentBBoxes:function(t,e,i){for(var r=i;r>=0;r--)o(e[r],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():r(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}},e}.apply(null,r))||(t.exports=n)},897:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(898)],void 0===(n=function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.mat3f64=i}.apply(null,r))||(t.exports=n)},898:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){return[1,0,0,0,1,0,0,0,1]},e.clone=function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},e.fromValues=function(t,e,i,r,n,o,a,s,u){return[t,e,i,r,n,o,a,s,u]},e.createView=function(t,e){return new Float64Array(t,e,9)}}.apply(null,r))||(t.exports=n)},904:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},e.clone=function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},e.fromValues=function(t,e,i,r,n,o,a,s,u,l,h,c,p,d,f,m){return[t,e,i,r,n,o,a,s,u,l,h,c,p,d,f,m]},e.createView=function(t,e){return new Float64Array(t,e,16)}}.apply(null,r))||(t.exports=n)},907:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(19),i(826),i(908)],void 0===(n=function(t,e,i,r,n){function o(t){return{value:t.value,size:i.toPt(t.size)}}function a(t){return t.map((function(t){return o(t)}))}function s(t){if("string"==typeof t||"number"==typeof t)return i.toPt(t);var e=t;return{type:"size",expression:e.expression,stops:a(e.stops)}}function u(t){var e={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(r.Utils.isString(t.field)){if(!t.stops)return null;if(t.stops.length>8)return null;for(var i=t.stops,n=0;n<8;++n){var o=i[Math.min(n,i.length-1)];e.values[n]=o.value,e.opacities[n]=o.opacity}}else{if(!(t.stops&&t.stops.length>=0))return null;var a=t.stops&&t.stops.length>=0&&t.stops[0].opacity;for(n=0;n<8;n++)e.values[n]=1/0,e.opacities[n]=a}return e}Object.defineProperty(e,"__esModule",{value:!0});var l=r.enums.WGLVVFlag;e.getVisualVariableSizeValueRepresentationRatio=function(t,e){if(!t||!e)return t;switch(e){case"radius":case"distance":return 2*t;case"diameter":case"width":return t;case"area":return Math.sqrt(t)}return t},e.stopToSizeStop=o,e.normalizeSizeStops=a,e.normalizeSizeElement=s,e.getVisualVariablesFields=function(t){var e=t&&t.length>0?{}:null;return e&&t.forEach((function(t){var i=t.type;t.field&&(e[i]=t.field)})),e},e.convertVisualVariables=function(t){var e=t&&t.length>0?{}:null,o=e?{}:null;if(!e)return{vvFields:e,vvRanges:o};for(var h=0,c=t;h<c.length;h++){var p=c[h],d=p.type;if(p.field&&(e[d]=p.field),"size"===d){o.size||(o.size={});var f=p;switch(r.getTypeOfSizeVisualVariable(f)){case l.SIZE_MINMAX_VALUE:o.size.minMaxValue={minDataValue:f.minDataValue,maxDataValue:f.maxDataValue,minSize:s(f.minSize),maxSize:s(f.maxSize)};break;case l.SIZE_SCALE_STOPS:o.size.scaleStops={stops:a(f.stops)};break;case l.SIZE_FIELD_STOPS:for(var m=[],v=[],_=a(f.stops),y=_.length,g=0;g<6;g++){var b=_[Math.min(g,y-1)];m.push(b.value),v.push(i.pt2px(b.size))}o.size.fieldStops={values:m,sizes:v};break;case l.SIZE_UNIT_VALUE:o.size.unitValue={unit:f.valueUnit,valueRepresentation:f.valueRepresentation}}}else if("color"===d){var x=n.convertVisualVariables([p],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null});o.color=x.color;for(g=0;g<32;g+=4)r.color.premultiplyAlpha(o.color.colors,g,!0)}else if("opacity"===d)o.opacity=u(p);else if("rotation"===d){var T=p;o.rotation={type:T.rotationType}}}return{vvFields:e,vvRanges:o}}}.apply(null,r))||(t.exports=n)},908:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(34),i(67),i(280),i(897),i(879),i(890),i(169),i(273),i(282),i(909)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h,c){function p(t){return null!=t}function d(t){return"number"==typeof t}function f(t){return"string"==typeof t}function m(t,e){t&&t.push(e),_(e)}function v(t){A&&console.warn("[FastSymbolUpdates] "+t)}function _(t){A&&console.info("[FastSymbolUpdates] "+t)}function y(t,e,i,r,n){var o=t.minSize,a=t.maxSize;if(t.expression)return m(n,"Could not convert size info: expression not supported"),!1;if(t.useSymbolValue){var s=r.symbolSize[i];return e.minSize[i]=s,e.maxSize[i]=s,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=1,!0}if(p(t.field))return p(t.stops)?2===t.stops.length&&d(t.stops[0].size)&&d(t.stops[1].size)?(g(t.stops[0].size,t.stops[1].size,t.stops[0].value,t.stops[1].value,e,i),e.type[i]=1,!0):(m(n,"Could not convert size info: stops only supported with 2 elements"),!1):d(o)&&d(a)&&p(t.minDataValue)&&p(t.maxDataValue)?(g(o,a,t.minDataValue,t.maxDataValue,e,i),e.type[i]=1,!0):null!=h.meterIn[t.valueUnit]?(e.minSize[i]=-1/0,e.maxSize[i]=1/0,e.offset[i]=0,e.factor[i]=1/h.meterIn[t.valueUnit],e.type[i]=1,!0):"unknown"===t.valueUnit?(m(n,"Could not convert size info: proportional size not supported"),!1):(m(n,"Could not convert size info: scale-dependent size not supported"),!1);if(!p(t.field)){if(t.stops&&t.stops[0]&&d(t.stops[0].size))return e.minSize[i]=t.stops[0].size,e.maxSize[i]=t.stops[0].size,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=1,!0;if(d(o))return e.minSize[i]=o,e.maxSize[i]=o,e.offset[i]=o,e.factor[i]=0,e.type[i]=1,!0}return m(n,"Could not convert size info: unsupported variant of sizeInfo"),!1}function g(t,e,i,r,n,o){var a=Math.abs(r-i)>0?(e-t)/(r-i):0;n.minSize[o]=a>0?t:e,n.maxSize[o]=a>0?e:t,n.offset[o]=t-i*a,n.factor[o]=a}function b(t,e,i,r){if(t.normalizationField||t.valueRepresentation)return m(r,"Could not convert size info: unsupported property"),null;if(!function(t){return null==t||f(t)}(t.field))return m(r,"Could not convert size info: field is not a string"),null;if(e.size){if(t.field)if(e.size.field){if(t.field!==e.size.field)return m(r,"Could not convert size info: multiple fields in use"),null}else e.size.field=t.field}else e.size={field:t.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};var n;switch(t.axis){case"width":return(n=y(t,e.size,0,i,r))?e:null;case"height":return(n=y(t,e.size,2,i,r))?e:null;case"depth":return(n=y(t,e.size,1,i,r))?e:null;case"width-and-depth":return(n=y(t,e.size,0,i,r))&&y(t,e.size,1,i,r),n?e:null;case null:case void 0:case"all":return(n=(n=(n=y(t,e.size,0,i,r))&&y(t,e.size,1,i,r))&&y(t,e.size,2,i,r))?e:null;default:return m(r,'Could not convert size info: unknown axis "'+t.axis+'""'),null}}function x(t,e,i){t[4*e+0]=i.r/255,t[4*e+1]=i.g/255,t[4*e+2]=i.b/255,t[4*e+3]=i.a}function T(t,e,i,r){var n=2===i&&"arithmetic"===t.rotationType;e.offset[i]=n?90:0,e.factor[i]=n?-1:1,e.type[i]=1}function M(t,e,r){if(!t)return null;var n=!e.supportedTypes||!!e.supportedTypes.size,o=!e.supportedTypes||!!e.supportedTypes.color,a=!e.supportedTypes||!!e.supportedTypes.rotation,s=!!e.supportedTypes&&!!e.supportedTypes.opacity;A&&(r=r||[]);var u=t.reduce((function(t,u){if(!t)return t;if(u.valueExpression)return m(r,"Could not convert visual variables: arcade expressions not supported"),null;switch(u.type){case"size":return n?b(u,t,e,r):t;case"color":return o?function(t,e,i){if(t.normalizationField)return m(i,"Could not convert color info: unsupported property"),null;if(f(t.field)){if(!t.stops)return m(i,"Could not convert color info: missing stops or colors"),null;if(t.stops.length>8)return m(i,"Could not convert color info: too many color stops"),null;e.color={field:t.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(var r=t.stops,n=0;n<8;++n){var o=r[Math.min(n,r.length-1)];e.color.values[n]=o.value,x(e.color.colors,n,o.color)}}else{if(!(t.stops&&t.stops.length>=0))return m(i,"Could not convert color info: no field and no colors/stops"),null;var a=t.stops&&t.stops.length>=0&&t.stops[0].color;e.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(n=0;n<8;n++)e.color.values[n]=1/0,x(e.color.colors,n,a)}return e}(u,t,r):t;case"opacity":return s?function(t,e,i){if(t.normalizationField)return m(i,"Could not convert opacity info: unsupported property"),null;if(f(t.field)){if(!t.stops)return m(i,"Could not convert opacity info: missing stops or opacities"),null;if(t.stops.length>8)return m(i,"Could not convert opacity info: too many opacity stops"),null;e.opacity={field:t.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(var r=t.stops,n=0;n<8;++n){var o=r[Math.min(n,r.length-1)];e.opacity.values[n]=o.value,e.opacity.opacityValues[n]=o.opacity}}else{if(!(t.stops&&t.stops.length>=0))return m(i,"Could not convert opacity info: no field and no opacities/stops"),null;var a=t.stops&&t.stops.length>=0&&t.stops[0].opacity;e.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(n=0;n<8;n++)e.opacity.values[n]=1/0,e.opacity.opacityValues[n]=a}return e}(u,t,r):null;case"rotation":return a?function(t,e,i){if(!f(t.field))return m(i,"Could not convert rotation info: field is not a string"),null;if(e.rotation){if(t.field)if(e.rotation.field){if(t.field!==e.rotation.field)return m(i,"Could not convert rotation info: multiple fields in use"),null}else e.rotation.field=t.field}else e.rotation={field:t.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(t.axis){case"tilt":return T(t,e.rotation,0),e;case"roll":return T(t,e.rotation,1),e;case null:case void 0:case"heading":return T(t,e.rotation,2),e;default:return m(i,'Could not convert rotation info: unknown axis "'+t.axis+'""'),null}}(u,t,r):t;default:return i.neverReached(u),null}}),{size:null,color:null,opacity:null,rotation:null});return!(t.length>0&&u)||u.size||u.color||u.opacity||u.rotation?u&&u.size&&!function(t,e,i){for(var r=0;r<3;++r){var n=e.unitInMeters;1===t.type[r]&&(n*=e.modelSize[r],t.type[r]=2),t.minSize[r]=t.minSize[r]/n,t.maxSize[r]=t.maxSize[r]/n,t.offset[r]=t.offset[r]/n,t.factor[r]=t.factor[r]/n}var o;if(0!==t.type[0])o=0;else if(0!==t.type[1])o=1;else{if(0===t.type[2])return m(i,"No size axis contains a valid size or scale"),!1;o=2}for(r=0;r<3;++r)0===t.type[r]&&(t.minSize[r]=t.minSize[o],t.maxSize[r]=t.maxSize[o],t.offset[r]=t.offset[o],t.factor[r]=t.factor[o],t.type[r]=t.type[o]);return!0}(u.size,e,r)?null:u:null}function S(t){return t&&null!=t.size}function E(t,e,i){if(!!t!=!!e)return v("State update failed ({$name} enabled/disabled)"),!1;if(t&&t.field!==e.field)return v("State update failed ({$name} field changed)"),!1;if(t&&"rotation"===i)for(var r=t,n=e,o=0;o<3;o++)if(r.type[o]!==n.type[o]||r.offset[o]!==n.offset[o]||r.factor[o]!==n.factor[o])return!1;return!0}function w(t,e){var i={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},r=S(t);return t&&t.size?(i.vvSizeEnabled=!0,i.vvSizeMinSize=t.size.minSize,i.vvSizeMaxSize=t.size.maxSize,i.vvSizeOffset=t.size.offset,i.vvSizeFactor=t.size.factor):t&&r&&(i.vvSizeValue=e.transformation.scale),t&&r&&(i.vvSymbolAnchor=e.transformation.anchor,i.vvSymbolRotationMatrix=o.mat3f64.create(),a.mat4.identity(z),function(t,e,i,r){void 0===r&&(r=s.mat4f64.create());var n=t||0,o=e||0,u=i||0;0!==n&&a.mat4.rotateZ(r,r,-n/180*Math.PI),0!==o&&a.mat4.rotateX(r,r,o/180*Math.PI),0!==u&&a.mat4.rotateY(r,r,u/180*Math.PI)}(e.transformation.rotation[2],e.transformation.rotation[0],e.transformation.rotation[1],z),n.mat3.fromMat4(i.vvSymbolRotationMatrix,z)),t&&t.color&&(i.vvColorEnabled=!0,i.vvColorValues=t.color.values,i.vvColorColors=t.color.colors),t&&t.opacity&&(i.vvOpacityEnabled=!0,i.vvOpacityValues=t.opacity.values,i.vvOpacityOpacities=t.opacity.opacityValues),i}Object.defineProperty(e,"__esModule",{value:!0});var I,A=!1,O=!1;e.convertVisualVariables=M,e.initFastSymbolUpdatesState=function(t,e){if(O)return v("State not initialized, fast updates disabled (globally disabled)"),{enabled:!1};if(!t)return v("State not initialized, fast updates disabled (no renderer)"),{enabled:!1};if(c.DISABLE_FAST_UPDATES)return v("State not initialized, fast updates disabled (DISABLE_FAST_SYMBOL_UPDATES set)"),{enabled:!1};var i=M(t.visualVariables,e);return i?(_("State initialized, fast updates enabled"),{enabled:!0,visualVariables:i,materialParameters:w(i,e),requiresShaderTransformation:S(i)}):(v("State not initialized, fast updates disabled (conversion failed)"),{enabled:!1})},e.updateFastSymbolUpdatesState=function(t,e,i){if(!e||!t.enabled)return!1;var r=t.visualVariables,n=M(e.visualVariables,i);return n?!!(E(r.size,n.size,"size")&&E(r.color,n.color,"color")&&E(r.rotation,n.rotation,"rotation")&&E(r.opacity,n.opacity,"opacity"))&&(t.visualVariables=n,t.materialParameters=w(n,i),t.requiresShaderTransformation=S(n),_("State updated"),!0):(v("State update failed (conversion failed)"),!1)},e.getMaterialParams=w,function(t){var e=s.mat4f64.create(),i=l.vec3f64.create();t.evaluateModelTransform=function(t,n,o){if(!t.vvSizeEnabled)return o;a.mat4.copy(e,o);var s=t.vvSymbolRotationMatrix;a.mat4.set(z,s[0],s[1],s[2],0,s[3],s[4],s[5],0,s[6],s[7],s[8],0,0,0,0,1),a.mat4.multiply(e,e,z);for(var u=0;u<3;++u){var l=t.vvSizeOffset[u]+n[0]*t.vvSizeFactor[u];i[u]=r.clamp(l,t.vvSizeMinSize[u],t.vvSizeMaxSize[u])}return a.mat4.scale(e,e,i),a.mat4.translate(e,e,t.vvSymbolAnchor),e},t.evaluateModelTransformScale=function(t,e,i){if(!e.vvSizeEnabled)return u.vec3.set(t,1,1,1);for(var n=0;n<3;++n){var o=e.vvSizeOffset[n]+i[0]*e.vvSizeFactor[n];t[n]=r.clamp(o,e.vvSizeMinSize[n],e.vvSizeMaxSize[n])}return t}}(I||(I={}));var z=s.mat4f64.create();e.evaluateModelTransform=I.evaluateModelTransform,e.evaluateModelTransformScale=I.evaluateModelTransformScale}.apply(null,r))||(t.exports=n)},909:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(10),i(2)],void 0===(n=function(t,e,i,r,n,o){return new(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,e.SCENEVIEW_LOCKING_LOG=!1,e.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1,e.HIGHLIGHTS_VISUALIZE_BLOCKS=!1,e.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1,e.DECONFLICTOR_SHOW_OUTLINES=!1,e.DECONFLICTOR_SHOW_GRID=!1,e.LABELS_SHOW_BORDER=!1,e.OVERLAY_DRAW_TEST_TEXTURE=!1,e.OVERLAY_SHOW_CENTER=!1,e.TESTS_DISABLE_UPDATE_THRESHOLDS=!1,e.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1,e.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1,e.DRAW_MESH_GEOMETRY_NORMALS=!1,e.FEATURE_TILE_FETCH_SHOW_TILES=!1,e.FEATURE_TILE_TREE_SHOW_TILES=!1,e.TERRAIN_TILE_TREE_SHOW_TILES=!1,e.I3S_TREE_SHOW_TILES=!1,e.ENABLE_PROFILE_DEPTH_RANGE=!1,e.DISABLE_FAST_UPDATES=!1,e.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,e.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,e.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,e}return i(e,t),r([o.property()],e.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),r([o.property()],e.prototype,"SCENEVIEW_LOCKING_LOG",void 0),r([o.property()],e.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0),r([o.property()],e.prototype,"HIGHLIGHTS_VISUALIZE_BLOCKS",void 0),r([o.property()],e.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0),r([o.property()],e.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0),r([o.property()],e.prototype,"DECONFLICTOR_SHOW_GRID",void 0),r([o.property()],e.prototype,"LABELS_SHOW_BORDER",void 0),r([o.property()],e.prototype,"OVERLAY_DRAW_TEST_TEXTURE",void 0),r([o.property()],e.prototype,"OVERLAY_SHOW_CENTER",void 0),r([o.property()],e.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0),r([o.property()],e.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0),r([o.property()],e.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0),r([o.property()],e.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),r([o.property()],e.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),r([o.property()],e.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),r([o.property()],e.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),r([o.property()],e.prototype,"I3S_TREE_SHOW_TILES",void 0),r([o.property()],e.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0),r([o.property()],e.prototype,"DISABLE_FAST_UPDATES",void 0),r([o.property()],e.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),r([o.property()],e.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),r([o.property()],e.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),r([o.subclass("esri.views.3d.support.DebugFlags")],e)}(o.declared(n)))}.apply(null,r))||(t.exports=n)},913:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(6),i(8),i(11),i(15),i(9),i(67),i(16),i(4),i(274),i(92),i(827),i(826),i(930),i(876),i(907),i(51)],void 0===(n=function(t,e,r,n,o,a,s,u,l,h,c,p,d,f,m,v,_){Object.defineProperty(e,"__esModule",{value:!0});var y=(d.enums.PixelType,s.getLogger("esri.views.layers.2d.features.support.AttributeStore")),g=f.debug.createDebugLogger(f.debug.DEBUG_ATTR_UPDATES,y),b=function(t,e){return function(i,r,n){var o;try{o=e(i,r,n)}catch(t){o=NaN}return(null===o||isNaN(o)||o===1/0)&&t||o}},x={sharedArrayBuffer:a("esri-shared-array-buffer"),oesTextureFloat:a("esri-webgl-texture-float"),maxTextureSize:a("esri-webgl-max-texture-size"),atomics:a("esri-atomics")},T=function(){function t(t,e,i,r){this.texelSize=4;var n=r.pixelType,o=r.layout,a=r.textureOnly;this.textureOnly=a||!1,this.pixelType=n,this._ctype=e,this.layout=o,this._resetRange(),this._shared=t,a||(this.data=this._initData(n,i,t,e))}return Object.defineProperty(t.prototype,"buffer",{get:function(){return l.andThen(this.data,(function(t){return t.buffer}))},enumerable:!0,configurable:!0}),t.prototype.getData=function(t,e){return l.expect(this.data)[t*this.texelSize+e]},t.prototype.setData=function(t,e,i,r){void 0===r&&(r=!0);var n=1<<e;0!=(this.layout&n)?(this.data[t*this.texelSize+e]=i,this.dirtyStart=Math.min(this.dirtyStart,t),this.dirtyEnd=Math.max(this.dirtyEnd,t)):y.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")},t.prototype.lock=function(){a("esri-2d-debug")&&5121===this.pixelType?y.error("AttributeStore-Bad-Type","Tried to lock non integer array type with float array"):this._shared&&x.atomics&&Atomics.store(this.data,0,1)},t.prototype.unlock=function(){a("esri-2d-debug")&&5121===this.pixelType?y.error("AttributeStore-Bad-Type","Tried to unlock non integer array type with float array"):this._shared&&x.atomics&&Atomics.store(this.data,0,0)},t.prototype.expand=function(t){if(!this.textureOnly){var e=this._initData(this.pixelType,t,this._shared,this._ctype),i=l.expect(this.data);e.set(i),this.data=e}},t.prototype.toMessage=function(){var t=this.dirtyStart,e=this.dirtyEnd,i=this.texelSize;if(t>e)return null;this._resetRange();var r=!(this._shared||"local"===this._ctype),n=this.pixelType,o=this.layout,a=l.expect(this.data);return a.slice?{start:t,end:e,data:r&&a.slice(t*i,(e+1)*i)||null,pixelType:n,layout:o}:r?{start:t,end:e,data:new(f.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,t*i,(e+1)*i)),pixelType:n,layout:o}:{start:t,end:e,data:null,pixelType:n,layout:o}},t.prototype._initData=function(t,e,i,r){for(var n=i&&"local"!==r?SharedArrayBuffer:ArrayBuffer,o=f.Utils.getPixelArrayCtor(t),a=new o(new n(e*e*4*o.BYTES_PER_ELEMENT)),s=0;s<a.length;s+=4)a[s+1]=255;return a},t.prototype._resetRange=function(){this.dirtyStart=4294967295,this.dirtyEnd=0},t}(),M=function(){function t(t){this._attributeComputeMap=new Map,this._blocks=new Array,this._idMap=new Map,this._localToObjectId=new Map,this._filters=new Array(f.definitions.MAX_FILTERS),this._freeList=[],this._abortController=h.createAbortController(),this._hasScaleExpr=!1,this._size=32,this._idCounter=1,this._idsToHighlight=new Set;var e=x.oesTextureFloat?5126:5121;g("Creating AttributeStore "+(x.sharedArrayBuffer?"with":"without")+" shared memory"),a("esri-2d-debug")&&x.sharedArrayBuffer&&!x.atomics&&y.warn("Browser supports SharedArrayBuffer but not Atomics. Rendering may be impacted"),this._client=t,this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:e,layout:15},{pixelType:e,layout:15}],this._blocks=this._blockDescriptors.map((function(t){return null}))}return t.prototype.destroy=function(){this._abortController.abort()},Object.defineProperty(t.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0}),t.prototype.createLocalId=function(t){if(!this._idMap.has(t)){var e=this._getFreeId();this._idMap.set(t,-1===e?0:e),this._localToObjectId.set(e,t)}return this._idMap.get(t)},t.prototype.freeLocalId=function(t){var e=this._idMap.get(t);this._idMap.delete(t),this._localToObjectId.delete(e),this._freeList.push(e)},t.prototype.getFeatureId=function(t){return this._localToObjectId.get(t)},t.prototype.getLocalId=function(t){return this._idMap.has(t)?this._idMap.get(t):null},t.prototype.setHighlight=function(t){return n(this,void 0,void 0,(function(){var e,i,n,o,a,s,u=this;return r(this,(function(r){switch(r.label){case 0:for(1,this._getBlock(0).lock(),this._idsToHighlight.forEach((function(t){var e=u.getLocalId(t);if(e){var i=u._getBlock(0).getData(e,0);u._getBlock(0).setData(e,0,-2&i)}})),this._idsToHighlight.clear(),e=0,i=t;e<i.length;e++)n=i[e],this._idsToHighlight.add(n);for(o=0;o<t.length;o++)null!=(a=this.getLocalId(t[o]))&&(s=this._getBlock(0).getData(a,0),this._getBlock(0).setData(a,0,1|s));return this._getBlock(0).unlock(),[4,this.sendUpdates()];case 1:return r.sent(),[2]}}))}))},t.prototype.addHighlight=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2]}))}))},t.prototype.removeHighlight=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2]}))}))},t.prototype.updateFilters=function(t){return n(this,void 0,void 0,(function(){var e,i,n,o,a,s,u=this;return r(this,(function(r){switch(r.label){case 0:return e=t.config,i=t.service,n=t.spatialReference,o=e.filters,a=e.definitionExpression,s=o.map((function(e,r){return u._updateFilter(t,e,r,i,a,n)})),[4,h.all(s)];case 1:return r.sent(),[2]}}))}))},t.prototype.setAttributeBindings=function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(i){switch(this._hasScaleExpr=!1,t.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":return[2,this._bindVVEvaluators(t.visualVariables,e)];case"dot-density":return[2,this._bindDDEvaluators(t.attributes,e)];case"heatmap":break;default:y.error(new o("attribute-store","Found invalid renderer type: "+t))}return[2]}))}))},t.prototype.setData=function(t,e,i,r){this._getBlock(e).setData(t,i,r)},t.prototype.setAttributeData=function(t,e,i,r){var n=this,o=t;this._getBlock(0).setData(o,0,this._getFilterFlags(e));var a=this._attributeComputeMap,s=x.oesTextureFloat?1:2;a.forEach((function(t,a){var l=a*s%4,h=Math.floor(a*s/4),c=n._getBlock(h+v.ATTRIBUTE_DATA_VV),p=t(e,{$view:r},i);if(x.oesTextureFloat)c.setData(o,l,p);else if(p===f.definitions.NAN_MAGIC_NUMBER)c.setData(o,l,255),c.setData(o,l+1,255);else{var d=u.clamp(Math.round(p),-32767,32766)+32768,m=255&d,_=(65280&d)>>8;c.setData(o,l,m),c.setData(o,l+1,_)}}))},t.prototype.sendUpdates=function(){var t=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=h.createResolver(),this._nextUpdate.promise;var e={blocks:this._blocks.map((function(t){return l.isSome(t)?t.toMessage():null}))};return this._currUpdate=this._createResources().then((function(){var i=t._client.update(e,t._signal).then((function(){if(t._currUpdate=null,t._nextUpdate){var e=t._nextUpdate;t._nextUpdate=null,t.sendUpdates().then((function(){return e.resolve()}))}}));return t._client.render(),i})),this._currUpdate},t.prototype._createResources=function(){var t=this;if(l.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(v.ATTRIBUTE_DATA_ANIMATION),g("Initializing AttributeStore");var e={shared:x.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:l.mapMany(this._blocks,(function(t){return{textureOnly:t.textureOnly,buffer:t.buffer,pixelType:t.pixelType}}))},i=this._client.initialize(e,this._signal);return this._createResourcesPromise=i,i.then((function(){return l.isNone(t._createResourcesPromise)?t._createResources():void 0})),i},t.prototype._getBlock=function(t){var e=this._blocks[t];if(l.isSome(e))return e;g("Initializing AttributeBlock at index "+t);var i=x.sharedArrayBuffer,r=this._client.type,n=new T(i,r,this._size,this._blockDescriptors[t]);return this._blocks[t]=n,this._createResourcesPromise=null,n},t.prototype._expand=function(){if(this._size<x.maxTextureSize){var t=this._size<<=1;return g("Expanding block size to",t,this._blocks),l.forEachSome(this._blocks,(function(e){return e.expand(t)})),this._createResourcesPromise=null,this._size=t,0}return y.error(new o("mapview-limitations","Maximum number of onscreen features exceeded.")),-1},t.prototype._getFreeId=function(){return this._freeList.length?this._freeList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++},t.prototype._updateFilter=function(t,e,i,o,a,s){return n(this,void 0,void 0,(function(){var n,u,h,c,p,d,f,m=this;return r(this,(function(r){switch(r.label){case 0:return n=this._filters[i],(l.isSome(n)&&n.hash)===JSON.stringify(e)?[2]:(u=1<<i+1,l.isNone(e)?(this._filters[i]=null,this._idMap.forEach((function(t){var e=m._getBlock(0).getData(t,0);m._getBlock(0).setData(t,0,e|u)})),[2]):[4,t.queryObjectIds(e)]);case 1:return h=r.sent(),e.hiddenIds&&e.hiddenIds.length&&(h=h.filter((function(t){return-1===e.hiddenIds.indexOf(t)}))),c=h.map((function(t){return m._idMap.get(t)})),[4,this._getFilter(i,o)];case 2:for(r.sent().update(e,a,s),this._getBlock(0).lock(),this._idMap.forEach((function(t){var e=m._getBlock(0).getData(t,0);m._getBlock(0).setData(t,0,e&~u)})),p=0;p<c.length;p++)null!=(d=c[p])&&(f=this._getBlock(0).getData(d,0),this._getBlock(0).setData(d,0,f|u));return this._getBlock(0).unlock(),[2]}}))}))},t.prototype._getFilter=function(t,e){return n(this,void 0,void 0,(function(){var n,o,a;return r(this,(function(r){switch(r.label){case 0:return n=this._filters[t],l.isSome(n)?[2,n]:[4,new Promise((function(t,e){Promise.all([i.e(5),i.e(66)]).then(function(){var e=[i(968)];t.apply(null,e)}.bind(this)).catch(e.bind(this))}))];case 1:return o=r.sent().default,a=new o({geometryType:e.geometryType,hasM:!1,hasZ:!1,timeInfo:e.timeInfo,fieldsIndex:new c(e.fields)}),this._filters[t]=a,[2,a]}}))}))},t.prototype._getFilterFlags=function(t){for(var e=0,i=0;i<this._filters.length;i++){var r=this._filters[i];e|=(l.isNone(r)||r.check(t)?1:0)<<i}var n=this.getFeatureId(t.localId);return e<<1|(this._idsToHighlight.has(n)?1:0)},t.prototype._bindVVEvaluators=function(t,e){return n(this,void 0,void 0,(function(){var i=this;return r(this,(function(o){switch(o.label){case 0:return this._attributeComputeMap.clear(),l.isSome(t)?[4,h.all(t.map((function(t){return n(i,void 0,void 0,(function(){var i,n;return r(this,(function(r){switch(r.label){case 0:return i=f.Utils.getVVType(t.type),[4,this._createGetValueFunction(t,e)];case 1:return n=r.sent(),l.isSome(n)&&this._attributeComputeMap.set(i,n),[2]}}))}))})))]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))},t.prototype._bindDDEvaluators=function(t,e){return n(this,void 0,void 0,(function(){var i,n,o,a=this;return r(this,(function(r){switch(r.label){case 0:return this._attributeComputeMap.clear(),t.length>f.definitions.DOT_DENSITY_MAX_FIELDS&&y.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+f.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+t.length),[4,h.all(t.map((function(t){return a._createNormalizedFunction(t,e)})))];case 1:for(i=r.sent().map((function(t){return b(0,t)})),n=0;n<f.definitions.DOT_DENSITY_MAX_FIELDS;n++)(o=n<t.length&&i[n])?this._attributeComputeMap.set(n,o):this._attributeComputeMap.has(n)&&this._attributeComputeMap.delete(n);return[2]}}))}))},t.prototype._createGetValueFunction=function(t,e){return n(this,void 0,void 0,(function(){var i,n,o,a,s,u,l;return r(this,(function(r){switch(r.label){case 0:return"size"!==t.type?[3,2]:(i=f.getTypeOfSizeVisualVariable(t))===f.enums.WGLVVFlag.SIZE_SCALE_STOPS?[2,null]:(n=i===f.enums.WGLVVFlag.SIZE_UNIT_VALUE,o=n&&function(e){return _.getVisualVariableSizeValueRepresentationRatio(e,t.valueRepresentation)},a=b,s=[f.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(t,e,o)]);case 1:return[2,a.apply(void 0,s.concat([r.sent()]))];case 2:return u=b,l=[f.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(t,e)];case 3:return[2,u.apply(void 0,l.concat([r.sent()]))]}}))}))},t.prototype._createNormalizedFunction=function(t,e,i){return n(this,void 0,void 0,(function(){var n,a,s;return r(this,(function(r){switch(r.label){case 0:return(n=t.field)?"string"==typeof n?(a=t.normalizationField)?[2,function(t){if(t.attributes[n]&&t.attributes[a]){var e=t.attributes[n]/t.attributes[a];return i?i(e):e}}]:[2,i?function(t){return i(t.attributes[n])}:function(t){return t.attributes[n]}]:(y.error(new o("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof n)),[2,function(t){}]):t.valueExpression?(this._hasScaleExpr=this._hasScaleExpr||-1!==t.valueExpression.indexOf("scale"),[4,p.createVVExpression(t.valueExpression,e.spatialReference,e.fields)]):[3,2];case 1:return s=r.sent(),[2,m.callWithOptimizedFeature.bind(null,s)];case 2:return y.error("Unable to create a normalized function for visual variable: "+t),[2,function(t){}]}}))}))},t}();e.default=M}.apply(null,r))||(t.exports=n)},914:function(t,e,i){var r;void 0===(r=function(){"use strict";function t(i,r,n,o,a){for(;o>n;){if(o-n>600){var s=o-n+1,u=r-n+1,l=Math.log(s),h=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*h*(s-h)/s)*(u-s/2<0?-1:1);t(i,r,Math.max(n,Math.floor(r-u*h/s+c)),Math.min(o,Math.floor(r+(s-u)*h/s+c)),a)}var p=i[r],d=n,f=o;for(e(i,n,r),a(i[o],p)>0&&e(i,n,o);d<f;){for(e(i,d,f),d++,f--;a(i[d],p)<0;)d++;for(;a(i[f],p)>0;)f--}0===a(i[n],p)?e(i,n,f):e(i,++f,o),f<=r&&(n=f+1),r<=f&&(o=f-1)}}function e(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function i(t,e){return t<e?-1:t>e?1:0}return function(e,r,n,o,a){t(e,r,n||0,o||e.length-1,a||i)}}.apply(null,[]))||(t.exports=r)},921:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(95),i(28),i(168),i(288),i(89)],void 0===(n=function(t,e,i,r,n,o,a){function s(t,e){var i=t.bounds,r=e.bounds;return t.key.id!==e.key.id&&t.key.world===e.key.world&&i[0]<=r[0]&&i[1]<=r[1]&&i[2]>=r[2]&&i[3]>=r[3]}Object.defineProperty(e,"__esModule",{value:!0}),e.isParentOf=s,e.isChildOf=function(t,e){return s(e,t)};var u=function(){function t(t,e){this.bounds=n.create(),this.key=new a(0,0,0,0),this.objectIds=new Set,this.key.set(e);var i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level,this.needsClear=!0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extent",{get:function(){return r.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.tileInfoView,this.id)},t.prototype.createChildTiles=function(){for(var e=this.key.getChildKeys(),r=i.acquire(),n=0;n<e.length;n++)r[n]=new t(this.tileInfoView,e[n]);return r},t.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},t}();e.Tile=u,e.default=u}.apply(null,r))||(t.exports=n)},932:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(59)],void 0===(n=function(t,e,i){var r=function(){function t(t,e){void 0===t&&(t=50),void 0===e&&(e=50),this._pool=new i(Map,!1,(function(t){return t.clear()}),e,t)}return t.prototype.acquire=function(){return this._pool.acquire()},t.prototype.release=function(t){this._pool.release(t)},t.acquire=function(){return n.acquire()},t.release=function(t){return n.release(t)},t}(),n=new r(100);return r}.apply(null,r))||(t.exports=n)},933:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(18),i(0),i(50),i(15),i(895),i(921),i(185),i(89)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l){Object.defineProperty(e,"__esModule",{value:!0});var h={added:[],removed:[]},c=new Set,p=new l(0,0,0,0),d=function(t){function e(e){var i=t.call(this)||this;return i._tiles=new Map,i._index=a(9,o("csp-restrictions")?function(t){return{minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),i.tiles=[],i.tileScheme=e,i}return i(e,t),e.prototype.destroy=function(){this._tiles.clear()},e.prototype.has=function(t){return this._tiles.has(t)},e.prototype.get=function(t){return this._tiles.get(t)},e.prototype.findByKey=function(t){return this._tiles.get(t.id)},e.prototype.intersections=function(t,e){var i="string"==typeof t?this.get(t):t;if(!i)return[];for(var r=e*i.resolution,n=i.bounds[0]-r,o=i.bounds[1]-r,a=i.bounds[2]+r,s=i.bounds[3]+r,u=[],l=0,h=this._index.search({minX:n,minY:o,maxX:a,maxY:s});l<h.length;l++){var c=h[l],p=c.bounds.slice();p[0]=Math.max(p[0],n),p[1]=Math.max(p[1],o),p[2]=Math.min(p[2],a),p[3]=Math.min(p[3],s),p[2]-p[0]>0&&p[3]-p[1]>0&&u.push({bounds:p,tile:c})}return u},e.prototype.boundsIntersections=function(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})},e.prototype.setViewState=function(t){var e=this.tileScheme.getTileCoverage(t,0);if(e){var i=e.spans,r=e.lodInfo,n=r.level;if(i.length>0)for(var o=0,a=i;o<a.length;o++)for(var l=a[o],d=l.row,f=l.colFrom,m=l.colTo,v=f;v<=m;v++){var _=p.set(n,d,r.normalizeCol(v),r.getWorldForColumn(v)).id;if(c.add(_),!this.has(_)){var y=new s.default(this.tileScheme,_);this._tiles.set(_,y),this._index.insert(y),this.tiles.push(y),h.added.push(y)}}for(var g=this.tiles.length-1;g>=0;g--){y=this.tiles[g];c.has(y.id)||(this._tiles.delete(y.id),this.tiles.splice(g,1),this._index.remove(y),h.removed.push(y))}(h.added.length||h.removed.length)&&this.emit("update",h),u.pool.release(e),c.clear(),h.added.length=0,h.removed.length=0}},e}(n);e.default=d}.apply(null,r))||(t.exports=n)},934:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(6),i(8),i(18),i(7),i(4),i(4),i(168),i(826)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l){Object.defineProperty(e,"__esModule",{value:!0});var h=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._rendererInfo=new l.WGLRendererInfo,r.attributeView=new l.AttributeStoreView,r}return n(e,t),e.prototype.destroy=function(){this.removeAllChildren(),this.children.forEach((function(t){return t.destroy()})),this.attributeView.destroy()},e.prototype.whenAttached=function(){var t=this;return this.attached?a.resolve():a.create((function(e){return t.once("attached",(function(){return e()}))}))},e.prototype.setRendererInfo=function(t,e,i){this._rendererInfo.setInfo(t,e,i),this.requestRender()},e.prototype.getMaterialItems=function(t,e){return r(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:return t&&0!==t.length?[4,this.whenAttached()]:[2,null];case 1:return i.sent(),r=this.stage.painter.textureManager,n=t.map((function(t){return r.rasterizeItem(t.symbol,t.glyphIds,e)})),[4,s.all(n)];case 2:return o=i.sent(),[2,o.map((function(e,i){return{id:t[i].id,mosaicItem:e}}))]}}))}))},e.prototype.onTileData=function(t,e){if(e.addOrUpdate&&"tileDisplayData"in e.addOrUpdate)t.setData(e,this.hasLabels,this.labelsVisible);else{var i=e.addOrUpdate&&l.TileData.decode(e.addOrUpdate),r=o({},e,{addOrUpdate:i});t.setData(r,this.hasLabels,this.labelsVisible)}this.contains(t)||this.addChild(t),this.requestRender()},e.prototype.onTileError=function(t){t.clear(),this.contains(t)||this.addChild(t)},e.prototype.renderChildren=function(e){this._rendererInfo.update(e.state),this.attributeView.bindTextures(this.stage.context),t.prototype.renderChildren.call(this,e)},e.prototype.createTile=function(t){var e=this._tileInfoView.getTileBounds(u.create(),t);return new l.WGLTile(t,e)},e.prototype.destroyTile=function(t){this.removeChild(t),t.destroy()},e.prototype.attach=function(){return this._initializeExtensions(),t.prototype.attach.call(this)},e.prototype.createRenderParams=function(e){return o({},t.prototype.createRenderParams.call(this,e),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})},e.prototype._initializeExtensions=function(){var t=this.stage.context.capabilities;t.textureFloat,t.vao},e}(l.TileContainer);e.FeatureContainer=h}.apply(null,r))||(t.exports=n)},951:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(7),i(6),i(8),i(10),i(45),i(116),i(175),i(57),i(932),i(16),i(4),i(4),i(19),i(2),i(90),i(168),i(184),i(56),i(37),i(886),i(296),i(297),i(826),i(876),i(913),i(933),i(952),i(953),i(954),i(888),i(956)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h,c,p,d,f,m,v,_,y,g,b,x,T,M,S,E,w,I,A,O,z,P,D,R,L){function C(t,e,i){if(i.has(t))return i.get(t);var r={tile:e,addedOrModified:[],removed:[]};return i.set(t,r),r}Object.defineProperty(e,"__esModule",{value:!0});var N=function(t){function e(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=t.apply(this,e)||this;return r._tiles=new Map,r._graphicStoreUpdate=!1,r._graphicsSet=new Set,r._matcher=f.resolve(null),r._tileUpdateSet=new Set,r._tilesToUpdate=new Map,r._graphicIdToAbortController=new Map,r._attached=!1,r._highlightIds=new Map,r._updatingGraphicsTimer=null,r.lastUpdateId=-1,r.updateRequested=!1,r.graphicUpdateHandler=r.graphicUpdateHandler.bind(r),r.addOrUpdateGraphic=r.addOrUpdateGraphic.bind(r),r._processAnalyzedGraphics=r._processAnalyzedGraphics.bind(r),r._graphicsChangeHandler=r._graphicsChangeHandler.bind(r),r}return i(e,t),e.prototype.initialize=function(){var t=this;this._tileStore=new O.default(this.view.featuresTilingScheme),this.container=new z.default(this.view.featuresTilingScheme,null),this._attributeStore=new A.default({type:"local",initialize:function(e){return f.resolve(t.container.attributeView.initialize(e))},update:function(e){return u.safeCast(t.container.attributeView.requestUpdate(e))},render:function(){return t.container.requestRender()}});this._graphicStore=new D.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,(function(e){var i=t._attributeStore.createLocalId(e.uid);t._attributeStore.setData(i,0,0,e.visible?I.FILTER_FLAG_0:0)}),(function(e){t._attributeStore.freeLocalId(e.uid)})),this._graphicProcessingQueue=new P.default({process:this.addOrUpdateGraphic});var e=new w.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),!0),i=this._tileStore.tileScheme.tileInfo;this.renderer&&(this._matcher=w.createMatcher(this.renderer,e,null)),this._meshFactory=new w.WGLMeshFactory(null,this.uid,null,e,null,i),this.watch("renderer",(function(i){i&&(t._matcher=w.createMatcher(t.renderer,e,null))})),this._tileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",(function(){t.graphics.items.length>0&&t._graphicsChangeHandler({target:t.graphics,added:t.graphics.items,removed:[],moved:[]}),t.handles.add(t.graphics.on("change",t._graphicsChangeHandler),"graphics"),t._attached=!0,t.notifyChange("updating")})),this.container.on("detach",(function(){t._graphicProcessingQueue&&t._graphicProcessingQueue.clear()}))},e.prototype.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating")),this.container.dispose(),this._set("graphics",null),this._graphicProcessingQueue&&(this._graphicProcessingQueue.destroy(),this._graphicProcessingQueue=null),this._graphicStore.clear(),this._tileStore.destroy(),this._attributeStore=null},Object.defineProperty(e.prototype,"updating",{get:function(){return!this._attached||null!==this._updatingGraphicsTimer||this._graphicProcessingQueue.updating||this._tileUpdateSet.size>0||this._tilesToUpdate.size>0},enumerable:!0,configurable:!0}),e.prototype.install=function(t){t.addChild(this.container)},e.prototype.uninstall=function(t){t.removeChild(this.container)},e.prototype.hitTest=function(t,e){if(!this.view||!this.view.position)return f.resolve();var i=this.view.toMap(v.createScreenPoint(t,e));return this.searchFeatures(i).then((function(t){return t&&t.length?t[0]:null}))},e.prototype.searchFeatures=function(t,e){var i=this;return void 0===e&&(e=2),f.create((function(r){r(i._graphicStore.hitTest(t.x,t.y,e,i.view.state.resolution,i.view.state.rotation))}))},e.prototype.update=function(t){var e=t.state,i=this.view.featuresTilingScheme.getClosestInfoForScale(e.scale).level;this._graphicStore.updateLevel(i),this._tileStore.setViewState(e),this._graphicStoreUpdate=!0,this.updateRequested=!1},e.prototype.viewChange=function(){this.requestUpdate()},e.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate(this))},e.prototype.processUpdate=function(t){this.updateRequested&&(this.updateRequested=!1,this.update(t))},e.prototype.graphicUpdateHandler=function(t){var e=t.graphic,i=t.property,r=t.newValue,n=e;switch(i){case"attributes":break;case"geometry":case"symbol":this._graphicProcessingQueue.push(n,"update");break;case"visible":this._setVisible(n.uid,r),this._attributeStore.sendUpdates()}},e.prototype.addHighlight=function(t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(this._highlightIds.has(r)){var n=this._highlightIds.get(r);this._highlightIds.set(r,n+1)}else this._highlightIds.set(r,1)}this._updateHighlight()},e.prototype.removeHighlight=function(t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(this._highlightIds.has(r)){var n=this._highlightIds.get(r)-1;0===n?this._highlightIds.delete(r):this._highlightIds.set(r,n)}}this._updateHighlight()},e.prototype._updateHighlight=function(){this._attributeStore.setHighlight(c.keysOfMap(this._highlightIds))},e.prototype._getIntersectingTiles=function(t){var e=this._graphicStore.getBounds(t);return e&&0!==g.width(e)&&0!==g.height(e)?this._tileStore.boundsIntersections(e):[]},e.prototype._updateTile=function(t){var e=this,i=t.tile,r=this._getGraphicsData(i,t.addedOrModified);return u.safeCast(this._processGraphics(i.key,r)).then((function(r){return e._patchTile(i.key,{addOrUpdate:r,remove:t.removed}),r}))},e.prototype._patchTile=function(t,e){if(this._tiles.has(t)){var i=this._tiles.get(t);this.container.onTileData(i,e),this.container.requestRender()}},e.prototype._graphicsChangeHandler=function(t){var e=this;if(!this._graphicStoreUpdate){var i=this.view.state,r=this.view.featuresTilingScheme.getClosestInfoForScale(i.scale).level;this._graphicStore.updateLevel(r),this._tileStore.setViewState(i)}for(var n=t.added,o=t.removed,a=t.moved,s=this._tilesToUpdate,u=[],l=new Array(n.length),h=0;h<n.length;h++){var c=n[h];l[h]=c,this._graphicsSet.add(c),u.push(this.addGraphic(c))}for(var p=0,d=o;p<d.length;p++){var m=d[p];this._abortProcessingGraphic(m.uid);for(var v=0,_=this._getIntersectingTiles(m);v<_.length;v++){var y=_[v];C(y.key.id,y,s).removed.push(this._attributeStore.getLocalId(m.uid))}this._graphicsSet.delete(m),this._graphicStore.remove(m)}for(var g=0,b=a;g<b.length;g++)for(var x=b[g],T=0,M=this._getIntersectingTiles(x);T<M.length;T++){y=M[T];C(y.key.id,y,s).addedOrModified.push(x)}this._flipUpdatingGraphics(),f.all(u).then((function(){for(var t,i=0;i<l.length;i++){t=l[i];for(var r=0,n=e._getIntersectingTiles(t);r<n.length;r++){var o=n[r];C(o.key.id,o,s).addedOrModified.push(t)}}e._graphicStore.updateZ();var a=[];return s.forEach((function(t){return a.push(e._updateTile(t))})),f.all(a).then((function(){s.clear(),e.notifyChange("updating")}))})).catch((function(){s.clear(),e.notifyChange("updating")}))},e.prototype._getSymbolResources=function(t,e){return a(this,void 0,void 0,(function(){var i,r,n,a,s,u,l,h;return o(this,(function(o){switch(o.label){case 0:return this.container.attached?(i=d.isSome(t.symbol)?t.symbol:null)?[3,3]:this.renderer?[4,this.renderer.getSymbolAsync(t,{scale:this.view.scale})]:[3,2]:[2,f.resolve(null)];case 1:return i=o.sent(),[3,3];case 2:i=this._getNullSymbol(t),o.label=3;case 3:return[4,S.expandSymbol(i,e)];case 4:if(i=o.sent(),r=[],"text"===i.type){for(n=new Set,s=(a=i).text,u=0;u<s.length;u++)n.add(s.charCodeAt(u));l=[],n.forEach((function(t){return l.push(t)})),r.push({symbol:a.toJSON(),id:0,glyphIds:l})}else r.push({symbol:i.toJSON(),id:t.uid,glyphIds:null});return[4,this.container.getMaterialItems(r,e).then((function(t){return t&&t.length>0?t[0].mosaicItem:null}))];case 5:return h=o.sent(),[2,{symbol:i,mosaicItem:h}]}}))}))},e.prototype._projectAndNormalizeGeometry=function(t){return a(this,void 0,void 0,(function(){var e,i,r,n=this;return o(this,(function(o){return d.isNone(t.geometry)?[2,f.resolve(null)]:(e=t.geometry,x.isPolygon(e)?(i=e.rings,e.rings=i):x.isPolyline(e)?(r=e.paths,e.paths=r):x.isExtent(e)&&(e=y.fromExtent(e)),[2,M.checkProjectionSupport(e.spatialReference,this.view.spatialReference).then((function(){var t=R.normalizeCentralMeridian(e),i=M.project(t,e.spatialReference,n.view.spatialReference);return b.closeRingsAndFixWinding(i),i}))])}))}))},e.prototype._onTileUpdate=function(t){var e=T.getInfo(this.view.spatialReference);if(t.added&&t.added.length>0)for(var i=0,r=t.added;i<r.length;i++){var n=r[i];this._addNewTile(n,e)}if(t.removed&&t.removed.length>0)for(var o=0,a=t.removed;o<a.length;o++){var s=a[o];this._removeTile(s.key)}},e.prototype.addOrUpdateGraphic=function(t,e,i){return this._addOrUpdateGraphic(t,e,i)},e.prototype.addGraphic=function(t){var e=this;this._abortProcessingGraphic(t.uid);var i=m.createAbortController();this._graphicIdToAbortController.set(t.uid,i);var r={signal:i.signal};return this._addOrUpdateGraphic(t,"add",r).then((function(){e._graphicIdToAbortController.delete(t.uid)})).catch((function(i){if(e._graphicIdToAbortController.delete(t.uid),!f.isAbortError(i))throw i}))},e.prototype._addOrUpdateGraphic=function(t,e,i){var r=this,n=this._projectAndNormalizeGeometry(t),o=this._getSymbolResources(t,i);return f.all([n,o]).then((function(n){var o=n[0],a=n[1];return"add"===e?r._addProjectedGraphic(t,a,o):r._updateGraphic(t,a,o,i)}))},e.prototype._addProjectedGraphic=function(t,e,i){this._graphicsSet.has(t)&&this._graphicStore.add(t,e,i)},e.prototype._updateGraphic=function(t,e,i,r){var n=this;if(!this._graphicStore.has(t)||f.isAborted(r))return f.resolve();for(var o=this._graphicStore.update(t,e,i),a=o.oldBounds,s=o.newBounds,l=0===g.width(a)&&0===g.height(a),h=0===g.width(s)&&0===g.height(s),c=l?[]:this._tileStore.boundsIntersections(a),d=h?[]:this._tileStore.boundsIntersections(s),m=p.acquire(),v=0,_=c;v<_.length;v++){var y=_[v];m.set(y.key,{addOrUpdate:null,remove:[this._attributeStore.getLocalId(t.uid)]})}for(var b=0,x=d;b<x.length;b++){y=x[b];var T=this._getGraphicData(y,t);if(m.has(y.key)){var M=m.get(y.key);M.remove.length=0,M.addOrUpdate=T}else m.set(y.key,{addOrUpdate:T,remove:null})}var S=[];return m.forEach((function(t,e){var i=u.safeCast(n._processGraphics(e,t.addOrUpdate,r)).then((function(i){n._patchTile(e,{addOrUpdate:i,remove:t.remove})}));S.push(i)})),p.release(m),f.all(S).then((function(){}))},e.prototype._addTile=function(t,e){var i=g.create();this.view.featuresTilingScheme.getTileBounds(i,t);var r=new w.WGLTile(t,i,!0),n={clear:!0,addOrUpdate:e,remove:[]};this._tiles.set(t,r),this.container.addChild(r),r.setData(n,!1,!1)},e.prototype._addNewTile=function(t,e){var i=this,r=this._graphicStore.queryTileData(t);if(e)for(var n=Math.round((e.valid[1]-e.valid[0])/t.resolution),o=0,a=r;o<a.length;o++){var s=a[o];s.geometry&&x.isPoint(s.geometry)&&this._wrapPoints(s,n)}var u=t.key;this._tileUpdateSet.add(t.key),this.notifyChange("updating"),this._processGraphics(u,r).then((function(t){i._addTile(u,t),i._tileUpdateSet.delete(u),i.notifyChange("updating")})).catch((function(t){if(i._tileUpdateSet.delete(u),i.notifyChange("updating"),!f.isAbortError(t))throw t}))},e.prototype._removeTile=function(t){if(this._tiles.has(t)){var e=this._tiles.get(t);this.container.removeChild(e),e.destroy(),this._tiles.delete(t)}},e.prototype._setVisible=function(t,e){var i=this._attributeStore.getLocalId(t);this._attributeStore.setData(i,0,0,e?I.FILTER_FLAG_0:0)},e.prototype._getGraphicsData=function(t,e){var i=T.getInfo(this.view.spatialReference),r=this._graphicStore.getGraphicsData(t,e);if(i)for(var n=Math.round((i.valid[1]-i.valid[0])/t.resolution),o=0,a=r;o<a.length;o++){var s=a[o];s.geometry&&x.isPoint(s.geometry)&&this._wrapPoints(s,n)}return r.sort((function(t,e){return t.insertAfter-e.insertAfter})),r},e.prototype._getGraphicData=function(t,e){var i=this._graphicStore.getGraphicData(t,e),r=[i],n=T.getInfo(this.view.spatialReference);if(n){var o=Math.round((n.valid[1]-n.valid[0])/t.resolution);i.geometry&&x.isPoint(i.geometry)&&this._wrapPoints(i,o)}return r},e.prototype._wrapPoints=function(t,e){var i=t.geometry;512===e?i.x<20?t.geometry={points:[[i.x,i.y],[e,0]]}:i.x>492&&(t.geometry={points:[[i.x,i.y],[-e,0]]}):i.x<-20?t.geometry={points:[[i.x,i.y],[e,0]]}:i.x>532&&(t.geometry={points:[[i.x,i.y],[-e,0]]})},e.prototype._processGraphics=function(t,e,i){return a(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return e&&e.length&&this._meshFactory?(r=this._meshFactory,[4,u.safeCast(this._matcher.then((function(t){return r.analyze(e,!0,t,null,null,i)})))]):[2,null];case 1:return n=o.sent(),this._attributeStore.sendUpdates(),[2,this._processAnalyzedGraphics(t,n)]}}))}))},e.prototype._processAnalyzedGraphics=function(t,e){for(var i=this._meshFactory,r=i.createMeshData(e.length),n=this._attributeStore,o=0,a=e;o<a.length;o++){var s=a[o];s.insertAfter=-1===s.insertAfter?-1:n.getLocalId(s.insertAfter),s.localId=n.getLocalId(s.attributes[this.uid]),i.write(r,s,null,null,t.level)}return w.TileData.fromMeshData(r)},e.prototype._abortProcessingGraphic=function(t){this._graphicIdToAbortController.has(t)&&this._graphicIdToAbortController.get(t).abort()},e.prototype._getNullSymbol=function(t){var e=t.geometry;return x.isPolyline(e)?E.errorPolylineSymbol2D:x.isPolygon(e)||x.isExtent(e)?E.errorPolygonSymbol2D:E.errorPointSymbol2D},e.prototype._flipUpdatingGraphics=function(){var t=this;this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=setTimeout((function(){t._updatingGraphicsTimer=null,t.notifyChange("updating")}),160),this.notifyChange("updating")},r([_.property()],e.prototype,"_graphicProcessingQueue",void 0),r([_.property({constructOnly:!0})],e.prototype,"graphics",void 0),r([_.property({dependsOn:["_graphicProcessingQueue.updating"]})],e.prototype,"updating",null),r([_.property()],e.prototype,"view",void 0),r([_.property()],e.prototype,"updateRequested",void 0),r([_.subclass("esri.views.2d.layers.support.GraphicsView2D")],e)}(_.declared(L.GraphicsView(l.HandleOwnerMixin(h.IdentifiableMixin(s)))));e.default=N}.apply(null,r))||(t.exports=n)},952:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(7),i(18),i(6),i(8),i(934)],void 0===(n=function(t,e,i,r,n,o,a){Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"hasLabels",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelsVisible",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype._renderGraphics=function(t,e){for(var i=0,r=this.children;i<r.length;i++){var n=r[i];n.isReady&&n.hasData&&(n.commitChanges(t),t.context.setStencilFunction(514,n.stencilRef,255),n._displayList.replay(t,n,e))}},e.prototype.renderChildren=function(e){var i=e.painter;if(this.children.some((function(t){return t.hasData}))){t.prototype.renderChildren.call(this,e),this._renderGraphics(e);var r=i.effects.highlight;r.bind(e),this._renderGraphics(e,r.defines),r.draw(e),r.unbind(e)}},e}(a.FeatureContainer);e.default=s}.apply(null,r))||(t.exports=n)},953:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(10),i(4),i(29),i(2)],void 0===(n=function(t,e,i,r,n,o,a,s){Object.defineProperty(e,"__esModule",{value:!0});var u=function(t){function e(e){var i=t.call(this,e)||this;return i._queue=new Map,i._queueArray=[],i._onGoingGraphic=null,i._onGoingPromise=null,i._scheduledNextHandle=null,i._next=i._next.bind(i),i._finalize=i._finalize.bind(i),i}return i(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this._queueArray.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this._queueArray.length>0||null!==this._onGoingPromise},enumerable:!0,configurable:!0}),e.prototype.cancel=function(t){if(this._onGoingGraphic&&this._onGoingGraphic.graphic===t&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._queue.has(t)){var e=this._queue.get(t);this._queue.delete(t);var i=this._queueArray.indexOf(e);this._queueArray.slice(i,1)}this._scheduleNext(),this.notifyChange("updating")},e.prototype.clear=function(){this._queue.clear(),this._queueArray.length=0,this._onGoingPromise&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._cancelNext(),this.notifyChange("updating")},e.prototype.has=function(t){return this._queue.has(t)},e.prototype.isOngoing=function(t){return this._onGoingGraphic&&this._onGoingGraphic.graphic===t},e.prototype.push=function(t,e){if(!this._queue.has(t)){var i={graphic:t,addOrUpdate:e};this._queueArray.push(i),this._queue.set(t,i),this._scheduleNext(),this.notifyChange("updating")}},e.prototype.refresh=function(){this.reset()},e.prototype.reset=function(){var t=this._onGoingGraphic;if(t){var e=t.graphic,i=t.addOrUpdate;this.push(e,i)}},e.prototype._finalize=function(){this._onGoingGraphic=null,this._ongoingAbortController=null,this._onGoingPromise=null,this.notifyChange("updating"),this._scheduleNext()},e.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},e.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=a.schedule(this._next))},e.prototype._next=function(){if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=null;else{this._scheduledNextHandle=null;var t=this._peek(),e=t.graphic,i=t.addOrUpdate,r=o.createAbortController();this._queue.delete(e),this._onGoingGraphic=t,this._onGoingPromise=this.process(e,i,{signal:r.signal}),this._ongoingAbortController=r,this._onGoingPromise.then(this._finalize,this._finalize),this.notifyChange("updating")}},e.prototype._peek=function(){return 0===this._queueArray.length?null:this._queueArray.pop()},r([s.property({readOnly:!0})],e.prototype,"length",null),r([s.property({readOnly:!0})],e.prototype,"updating",null),r([s.property({constructOnly:!0})],e.prototype,"process",void 0),r([s.subclass("esri.views.2d.layers.graphics.GraphicProcessingQueue")],e)}(s.declared(n));e.default=u}.apply(null,r))||(t.exports=n)},954:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(7),i(15),i(19),i(895),i(168),i(93),i(182),i(56),i(271),i(955),i(888)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,h,c,p){function d(t,e,i,r,n){return f.minX=e,f.minY=i,f.maxX=r,f.maxY=n,t.search(f)}Object.defineProperty(e,"__esModule",{value:!0});var f={minX:0,minY:0,maxX:0,maxY:0},m=a.create(),v=[],_=function(){function t(t,e,i,n,a,s){this._graphics=n,this._onAdd=a,this._onRemove=s,this._index=o(9,r("csp-restrictions")?function(t){return{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this._itemByGraphic=new Map,this._currentLevel=-1/0,this._tileInfoView=t,this._uidFieldName=i;var u=t.getClosestInfoForScale(e);u&&(this._currentLevel=u.level,this._resolution=this._tileInfoView.getTileResolution(u.level))}return t.prototype.hitTest=function(t,e,i,r,o){t=h.normalizeMapX(t,this._tileInfoView.spatialReference);var c=.5*r*i;m[0]=t-c,m[1]=e-c,m[2]=t+c,m[3]=e+c;var f=.5*r*(i+50),v=d(this._index,t-f,e-f,t+f,e+f);if(!v||0===v.length)return[];for(var _,y={x:t,y:e},g=[],b=0,x=v;b<x.length;b++){var T=x[b];if(T.graphic.visible)switch(l.getJsonType(T.geometry)){case"esriGeometryPoint":var M=T.symbol;if(!M)continue;var S=T.geometry,E=void 0;switch(M.type){case"text":E=p.getTextSymbolBounds(S.x,S.y,M,T.size,this._resolution,o);break;case"cim":E=p.getCIMMarkerBounds(S.x,S.y,M,this._resolution,o);break;default:E=p.getMarkerSymbolBounds(S.x,S.y,M,this._resolution,o)}s.polygonContainsPoint(E,y)&&g.push(T);break;case"esriGeometryPolyline":var w=T.symbol;if(!w)continue;_=1.5*r*window.devicePixelRatio*n.pt2px(w.width),p.isPointOnPolyline(T.geometry,t,e,_)&&g.push(T);break;case"esriGeometryEnvelope":var I=T.geometry,A=a.fromValues(I.xmin,I.ymin,I.xmax,I.ymax);a.intersects(A,m)&&g.push(T);break;case"esriGeometryPolygon":if(s.polygonContainsPoint(T.geometry,y)){g.push(T);break}var O=u.getPolygonExtent(T.geometry);if(Math.abs(O.ymax-O.ymin)<5*r||Math.abs(O.xmax-O.xmin)<5*r){var z=a.fromValues(O.xmin,O.ymin,O.xmax,O.ymax);a.intersects(z,m)&&g.push(T)}break;case"esriGeometryMultipoint":var P=T.symbol;if(!P)continue;for(var D=T.geometry.points,R=void 0,L=0;L<D.length;L++){if("text"===P.type){var C=P;R=p.getTextSymbolBounds(D[L][0],D[L][1],C,T.size,this._resolution,o)}else R=p.getMarkerSymbolBounds(D[L][0],D[L][1],P,this._resolution,o);if(s.polygonContainsPoint(R,y)){g.push(T);break}}}}return g.sort((function(t,e){var i=p.graphicGeometryToNumber(t.graphic),r=p.graphicGeometryToNumber(e.graphic);return i===r?e.zorder-t.zorder:i-r})),g.map((function(t){return t.graphic}))},t.prototype.getGraphicsData=function(t,e){var r=d(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);if(0===r.length||0===e.length)return[];r.sort((function(t,e){return t.zorder-e.zorder})),r[0].insertAfter=-1;for(var n=1;n<r.length;n++)r[n].insertAfter=r[n-1].graphic.uid;r.sort((function(t,e){return t.graphic.uid-e.graphic.uid})),e.sort((function(t,e){return t.uid-e.uid}));for(var o,a=0,s=0,u=[],l={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},h=0,p=e;h<p.length;h++){var f=p[h];for(s=-2;a<r.length;)if(o=r[a],a++,f.uid===o.graphic.uid){s=o.insertAfter;break}if(o.geometry&&-2!==s){var m=o.getGeometryQuantized(l),v=i({},o.graphic.attributes);v[this._uidFieldName]=f.uid,u.push({centroid:c.default.getCentroidQuantized(o,l,this._scale),geometry:m,attributes:v,symbol:o.symbol,insertAfter:s})}}return u},t.prototype.getGraphicData=function(t,e){var r=this._itemByGraphic.get(e);if(!r)return null;var n=d(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);n.sort((function(t,e){return t.zorder-e.zorder}));var o=n.indexOf(r),a=0===o||-1===o?-1:n[o-1].graphic.uid,s={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},u=r.getGeometryQuantized(s),l=i({},r.graphic.attributes);return l[this._uidFieldName]=e.uid,{centroid:c.default.getCentroidQuantized(r,s,this._scale),geometry:u,attributes:l,symbol:r.symbol,insertAfter:a}},t.prototype.queryTileData=function(t){var e=50*t.resolution,i=a.pad(t.bounds,e,a.create()),r=d(this._index,i[0],i[1],i[2],i[3]),n=[];return this._createTileGraphics(n,r,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]}),n},t.prototype.has=function(t){return this._itemByGraphic.has(t)},t.prototype.getBounds=function(t){return this._itemByGraphic.has(t)?this._itemByGraphic.get(t).bounds:null},t.prototype.add=function(t,e,i){if(t){this._onAdd(t);var r=c.default.acquire(t,e,i,this._resolution,this._scale,this._tileInfoView.spatialReference);return this._itemByGraphic.set(t,r),i&&this._index.insert(r),r.bounds}},t.prototype.remove=function(t){if(this._itemByGraphic.has(t)){this._onRemove(t);var e=this._itemByGraphic.get(t);this._index.remove(e),this._itemByGraphic.delete(t)}},t.prototype.updateZ=function(){for(var t,e,i=this._graphics.items,r=0;r<i.length;r++)e=i[r],(t=this._itemByGraphic.get(e))&&(t.zorder=r)},t.prototype.update=function(t,e,i){var r=this._itemByGraphic.get(t),n=a.clone(r.bounds);return r.size[0]=r.size[1]=0,this._index.remove(r),r.set(t,e,i,this._resolution,this._scale,this._tileInfoView.spatialReference),i&&this._index.insert(r),{oldBounds:n,newBounds:r.bounds}},t.prototype.updateLevel=function(t){var e=this;if(this._currentLevel!==t){this._currentLevel=t;var i=this._tileInfoView.getTileResolution(t);this._resolution=i,this._scale=this._tileInfoView.getTileScale({level:t,row:0,col:0,world:0}),this._index.clear(),v.length=0,this._itemByGraphic.forEach((function(t){t.updateBounds(t.symbol,e._resolution,e._scale,e._tileInfoView.spatialReference),t.geometry&&v.push(t)})),this._index.load(v)}},t.prototype.clear=function(){this._itemByGraphic.clear(),this._index.clear()},t.prototype._createTileGraphics=function(t,e,r){var n=this._uidFieldName;e.sort((function(t,e){return t.zorder-e.zorder}));for(var o,a,s,u,l=0;l<e.length;l++){o=(s=e[l]).graphic,a=s.getGeometryQuantized(r),u=0===l?-1:e[l-1].graphic.uid;var h=i({},s.graphic.attributes);h[n]=o.uid,t.push({centroid:c.default.getCentroidQuantized(s,r,this._scale),geometry:a,attributes:h,symbol:s.symbol,insertAfter:u})}},t}();e.default=_}.apply(null,r))||(t.exports=n)},955:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(16),i(168),i(298),i(56),i(885),i(880),i(877),i(888)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l){function h(t){t.coords.length=0,t.lengths.length=0}Object.defineProperty(e,"__esModule",{value:!0});var c=new u.default,p=new u.default,d=function(){function t(){this.bounds=r.create(),this.graphic=null,this.size=[0,0,0,0]}return t.acquire=function(e,i,r,n,o,a){var s;return void 0===e&&(e=null),0===t._pool.length?s=new t:(s=t._pool.pop(),this._set.delete(s)),s.acquire(e,i,r,n,o,a),s},t.release=function(t){t&&!this._set.has(t)&&(t.release(),this._pool.push(t),this._set.add(t))},t.getCentroidQuantized=function(t,e,r){if(o.isPolygon(t.geometry)){var s=t.symbol;if(i.isNone(s))return null;if(l.isMarkerSymbol(s.type)){var u=n.polygonCentroid(t.geometry);return a.quantizePoint(e,{},{x:u[0],y:u[1]},!1,!1)}}return null},t.prototype.acquire=function(t,e,i,r,n,o){void 0===t&&(t=null),t&&this.set(t,e,i,r,n,o)},t.prototype.release=function(){this.graphic=null,this.symbol=null,this.geometry=null},t.prototype.set=function(t,e,i,r,n,o){this.graphic=t,this.geometry=i,this.symbol=e.symbol,l.getBounds(this.bounds,this.size,e.symbol,i,e.mosaicItem,r,n,o)},t.prototype.updateBounds=function(t,e,i,r){l.getBounds(this.bounds,this.size,t,this.geometry,null,e,i,r)},t.prototype.getGeometryQuantized=function(t){if(o.isPolygon(this.geometry)){var e=this.geometry.rings;if(1===e.length&&2===e[0].length)return a.quantizeGeometry(t,{paths:[[e[0][0],e[0][1]]]})}else if(o.isPolyline(this.geometry))return h(c),h(p),s.convertFromPolyline(c,this.geometry),s.generalizeOptimizedGeometry(p,c,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",t.scale[0]),s.quantizeOptimizedGeometry(c,p,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",t),s.convertToPolyline(c,this.geometry.hasZ,this.geometry.hasM);return a.quantizeGeometry(t,this.geometry)},t._pool=[],t._set=new Set,t}();e.default=d}.apply(null,r))||(t.exports=n)},956:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(2)],void 0===(n=function(t,e,i,r,n){Object.defineProperty(e,"__esModule",{value:!0}),e.GraphicsView=function(t){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.graphics=null,e.renderer=null,e.view=null,e}return i(e,t),r([n.property()],e.prototype,"graphics",void 0),r([n.property()],e.prototype,"renderer",void 0),r([n.property()],e.prototype,"updating",void 0),r([n.property()],e.prototype,"view",void 0),r([n.subclass("esri.views.layers.GraphicsView")],e)}(n.declared(t))}}.apply(null,r))||(t.exports=n)}}]);