(function(){(this||window).webpackJsonp.registerAbsMids({"esri/core/libs/rbush/rbush":630,"esri/geometry/support/aaBoundingBox":634,"esri/layers/graphics/data/attributeSupport":635,"esri/layers/graphics/data/utils":636,"esri/core/libs/quickselect/quickselect":649,"esri/layers/graphics/centroid":652,"esri/layers/graphics/data/spatialQuerySupport":653,"esri/layers/graphics/data/timeSupport":657,"esri/layers/graphics/data/FeatureStore":673,"esri/layers/graphics/data/QueryEngine":674,"esri/core/ItemCache":675,"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":693,"esri/core/sql/WhereClauseCache":694,"esri/layers/graphics/contains":695,"esri/layers/graphics/data/QueryEngineResult":719,"esri/layers/graphics/data/AttributesBuilder":720,"esri/layers/support/PromiseQueue":721,"esri/layers/graphics/sources/support/clientSideDefaults":860})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{630:function(e,t,r){var i,n;i=[r(649)],void 0===(n=function(e){"use strict";function t(e,r){if(!(this instanceof t))return new t(e,r);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),r&&("function"==typeof r?this.toBBox=r:this._initFormat(r)),this.clear()}function r(e,t,r){if(!r)return t.indexOf(e);for(var i=0;i<t.length;i++)if(r(e,t[i]))return i;return-1}function i(e,t){n(e,0,e.children.length,t,e)}function n(e,t,r,i,n){n||(n=p(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,o=t;o<r;o++)a=e.children[o],s(n,e.leaf?i(a):a);return n}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function a(e,t){return e.minX-t.minX}function o(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function l(e){return e.maxX-e.minX+(e.maxY-e.minY)}function h(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function c(e,t){var r=Math.max(e.minX,t.minX),i=Math.max(e.minY,t.minY),n=Math.min(e.maxX,t.maxX),s=Math.min(e.maxY,t.maxY);return Math.max(0,n-r)*Math.max(0,s-i)}function f(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,r,i,n,s){for(var a,o=[r,i];o.length;)(i=o.pop())-(r=o.pop())<=n||(a=r+Math.ceil((i-r)/n/2)*n,e(t,a,r,i,s),o.push(r,a,a,i))}return t.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],i=this.toBBox;if(!d(e,t))return r;for(var n,s,a,o,u=[];t;){for(n=0,s=t.children.length;n<s;n++)a=t.children[n],d(e,o=t.leaf?i(a):a)&&(t.leaf?r.push(a):f(e,o)?this._all(a,r):u.push(a));t=u.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!d(e,t))return!1;for(var i,n,s,a,o=[];t;){for(i=0,n=t.children.length;i<n;i++)if(s=t.children[i],d(e,a=t.leaf?r(s):s)){if(t.leaf||f(e,a))return!0;o.push(s)}t=o.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=p([]),this},remove:function(e,t){if(!e)return this;for(var i,n,s,a,o=this.data,u=this.toBBox(e),l=[],h=[];o||l.length;){if(o||(o=l.pop(),n=l[l.length-1],i=h.pop(),a=!0),o.leaf&&-1!==(s=r(e,o.children,t)))return o.children.splice(s,1),l.push(o),this._condense(l),this;a||o.leaf||!f(o,u)?n?(i++,o=n.children[i],a=!1):o=null:(l.push(o),h.push(i),i=0,n=o,o=o.children[0])}return this},toBBox:function(e){return e},compareMinX:a,compareMinY:o,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,n){var s,a=r-t+1,o=this._maxEntries;if(a<=o)return i(s=p(e.slice(t,r+1)),this.toBBox),s;n||(n=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,n-1))),(s=p([])).leaf=!1,s.height=n;var u,l,h,c,f=Math.ceil(a/o),d=f*Math.ceil(Math.sqrt(o));for(m(e,t,r,d,this.compareMinX),u=t;u<=r;u+=d)for(m(e,u,h=Math.min(u+d-1,r),f,this.compareMinY),l=u;l<=h;l+=f)c=Math.min(l+f-1,h),s.children.push(this._build(e,l,c,n-1));return i(s,this.toBBox),s},_chooseSubtree:function(e,t,r,i){for(var n,s,a,o,l,c,f,d;i.push(t),!t.leaf&&i.length-1!==r;){for(f=d=1/0,n=0,s=t.children.length;n<s;n++)l=u(a=t.children[n]),(c=h(e,a)-l)<d?(d=c,f=l<f?l:f,o=a):c===d&&l<f&&(f=l,o=a);t=o||t.children[0]}return t},_insert:function(e,t,r){var i=this.toBBox,n=r?e:i(e),a=[],o=this._chooseSubtree(n,this.data,t,a);for(o.children.push(e),s(o,n);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(n,a,t)},_split:function(e,t){var r=e[t],n=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,n);var a=this._chooseSplitIndex(r,s,n),o=p(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,i(r,this.toBBox),i(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(e,t){this.data=p([e,t]),this.data.height=e.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){var i,s,a,o,l,h,f,d;for(h=f=1/0,i=t;i<=r-t;i++)o=c(s=n(e,0,i,this.toBBox),a=n(e,i,r,this.toBBox)),l=u(s)+u(a),o<h?(h=o,d=i,f=l<f?l:f):o===h&&l<f&&(f=l,d=i);return d},_chooseSplitAxis:function(e,t,r){var i=e.leaf?this.compareMinX:a,n=e.leaf?this.compareMinY:o;this._allDistMargin(e,t,r,i)<this._allDistMargin(e,t,r,n)&&e.children.sort(i)},_allDistMargin:function(e,t,r,i){e.children.sort(i);var a,o,u=this.toBBox,h=n(e,0,t,u),c=n(e,r-t,r,u),f=l(h)+l(c);for(a=t;a<r-t;a++)o=e.children[a],s(h,e.leaf?u(o):o),f+=l(h);for(a=r-t-1;a>=t;a--)o=e.children[a],s(c,e.leaf?u(o):o),f+=l(c);return f},_adjustParentBBoxes:function(e,t,r){for(var i=r;i>=0;i--)s(t[i],e)},_condense:function(e){for(var t,r=e.length-1;r>=0;r--)0===e[r].children.length?r>0?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():i(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}},t}.apply(null,i))||(e.exports=n)},634:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(33),r(171)],void 0===(n=function(e,t,r,i){function n(e){return e}function s(e){return void 0===e&&(e=t.ZERO),n([e[0],e[1],e[2],e[3],e[4],e[5]])}function a(e,t,r,i,n,a,o){return void 0===o&&(o=s()),o[0]=e,o[1]=t,o[2]=r,o[3]=i,o[4]=n,o[5]=a,o}function o(e){return e[0]>=e[3]?0:e[3]-e[0]}function u(e){return e[1]>=e[4]?0:e[4]-e[1]}function l(e){return e[2]>=e[5]?0:e[5]-e[2]}function h(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function c(e){return 6===e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.create=s,t.fromValues=a,t.fromExtent=function(e,t){return void 0===t&&(t=s()),t[0]=e.xmin,t[1]=e.ymin,t[2]=e.zmin,t[3]=e.xmax,t[4]=e.ymax,t[5]=e.zmax,t},t.toExtent=function(e,t){var i=isFinite(e[2])||isFinite(e[5]);return new r(i?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})},t.fromMinMax=function(e,t,r){return void 0===r&&(r=s()),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t[0],r[4]=t[1],r[5]=t[2],r},t.expandPointInPlace=function(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[3]&&(e[3]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[4]&&(e[4]=t[1]),t[2]<e[2]&&(e[2]=t[2]),t[2]>e[5]&&(e[5]=t[2])},t.expand=function(e,t,r){return void 0===r&&(r=e),c(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r[4]=Math.max(e[4],t[4]),r[5]=Math.max(e[5],t[5])):i.is(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[3]=Math.max(e[3],t[2]),r[4]=Math.max(e[4],t[3])):2===t.length?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[3]=Math.max(e[3],t[0]),r[4]=Math.max(e[4],t[1])):3===t.length&&(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.max(e[3],t[0]),r[4]=Math.max(e[4],t[1]),r[5]=Math.max(e[5],t[2])),r},t.expandWithBuffer=function(e,t,r,i,n){void 0===n&&(n=e);for(var s=e[0],a=e[1],o=e[2],u=e[3],l=e[4],h=e[5],c=0;c<i;c++)s=Math.min(s,t[r+3*c]),a=Math.min(a,t[r+3*c+1]),o=Math.min(o,t[r+3*c+2]),u=Math.max(u,t[r+3*c]),l=Math.max(l,t[r+3*c+1]),h=Math.max(h,t[r+3*c+2]);return n[0]=s,n[1]=a,n[2]=o,n[3]=u,n[4]=l,n[5]=h,n},t.expandWithNestedArray=function(e,t,r,i){void 0===i&&(i=e);var n=t.length,s=e[0],a=e[1],o=e[2],u=e[3],l=e[4],h=e[5];if(r)for(var c=0;c<n;c++){var f=t[c];s=Math.min(s,f[0]),a=Math.min(a,f[1]),o=Math.min(o,f[2]),u=Math.max(u,f[0]),l=Math.max(l,f[1]),h=Math.max(h,f[2])}else for(c=0;c<n;c++){f=t[c];s=Math.min(s,f[0]),a=Math.min(a,f[1]),u=Math.max(u,f[0]),l=Math.max(l,f[1])}return i[0]=s,i[1]=a,i[2]=o,i[3]=u,i[4]=l,i[5]=h,i},t.allFinite=function(e){for(var t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0},t.width=o,t.depth=u,t.height=l,t.diameter=function(e){var t=o(e),r=l(e),i=u(e);return Math.sqrt(t*t+r*r+i*i)},t.center=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=e[0]+o(e)/2,t[1]=e[1]+u(e)/2,t[2]=e[2]+l(e)/2,t},t.size=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=o(e),t[1]=u(e),t[2]=l(e),t},t.maximumDimension=function(e){return Math.max(o(e),l(e),u(e))},t.containsPoint=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]},t.containsPointWithMargin=function(e,t,r){return t[0]>=e[0]-r&&t[1]>=e[1]-r&&t[2]>=e[2]-r&&t[0]<=e[3]+r&&t[1]<=e[4]+r&&t[2]<=e[5]+r},t.contains=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]},t.intersects=function(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])},t.offset=function(e,t,r,i,n){return void 0===n&&(n=e),n[0]=e[0]+t,n[1]=e[1]+r,n[2]=e[2]+i,n[3]=e[3]+t,n[4]=e[4]+r,n[5]=e[5]+i,n},t.setMin=function(e,t,r){return void 0===r&&(r=e),r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r},t.setMax=function(e,t,r){return void 0===r&&(r=e),r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e},t.set=h,t.empty=function(e){return e?h(e,t.NEGATIVE_INFINITY):s(t.NEGATIVE_INFINITY)},t.toRect=function(e,t){return t||(t=i.create()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t},t.fromRect=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e},t.is=c,t.isPoint=function(e){return 0===o(e)&&0===u(e)&&0===l(e)},t.equals=function(e,t,r){if(null==e||null==t)return e===t;if(!c(e)||!c(t))return!1;if(r){for(var i=0;i<e.length;i++)if(!r(e[i],t[i]))return!1}else for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},t.wrap=function(e,t,r,i,n,s){return a(e,t,r,i,n,s,f)},t.POSITIVE_INFINITY=n([-1/0,-1/0,-1/0,1/0,1/0,1/0]),t.NEGATIVE_INFINITY=n([1/0,1/0,1/0,-1/0,-1/0,-1/0]),t.ZERO=n([0,0,0,0,0,0]);var f=s()}.apply(null,i))||(e.exports=n)},635:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(11),r(57),r(694)],void 0===(n=function(e,t,r,i,n,s){function a(e,t){return e?l.get(e,t):null}function o(e,t,r,n){void 0===n&&(n=!0);for(var s=[],l=0,c=t;l<c.length;l++){var f=c[l];if("*"!==f&&!e.has(f))if(n){var d=u(f);try{var p=a(d,e);if(!p)throw new i(h,"invalid SQL expression",{where:d});if(!p.isStandardized)throw new i(h,"expression is not standard",{clause:p});o(e,p.fieldNames,"expression contains missing fields")}catch(e){var m=e&&e.details;if(m&&(m.clause||m.where))throw e;m&&m.missingFields?s.push.apply(s,m.missingFields):s.push(f)}}else s.push(f)}if(s.length)throw new i(h,r,{missingFields:s})}function u(e){return e.split(c)[0]}Object.defineProperty(t,"__esModule",{value:!0});var l=new s.WhereClauseCache(50,500),h="feature-store:unsupported-query",c=" as ",f=n.SetFromValues(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);t.validateWhere=function(e,t){if(!t)return!0;var r=l.get(t,e);if(!r)throw new i(h,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new i(h,"where clause is not standard",{where:t});return o(e,r.fieldNames,"where clause contains missing fields"),!0},t.validateHaving=function(e,t,r){if(!t)return!0;var n=l.get(t,e);if(!n)throw new i(h,"invalid SQL expression",{having:t});if(!n.isAggregate)throw new i(h,"having does not contain a valid aggregate function",{having:t});var s=n.fieldNames;if(o(e,s,"having contains missing fields"),!n.getExpressions().every((function(t){var i=t.aggregateType,n=t.field,s=e.has(n)&&e.get(n).name;return r.some((function(t){var r=t.onStatisticField,n=t.statisticType;return(e.has(r)&&e.get(r).name)===s&&n.toLowerCase().trim()===i}))})))throw new i(h,"expressions in having should also exist in outStatistics",{having:t});return!0},t.getWhereClause=a,t.validateFields=o,t.getExpressionFromFieldName=u,t.getAliasFromFieldName=function(e){return e.split(c)[1]},t.hasInvalidFieldType=function(e,t){var r=t.get(e);return!!r&&!f.has(r.type)}}.apply(null,i))||(e.exports=n)},636:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(6),r(8),r(12),r(16),r(4),r(78),r(185),r(56),r(271),r(37),r(652),r(615),r(612),r(621),r(653)],void 0===(n=function(e,t,r,i,n,s,a,o,u,l,h,c,f,d,p,m,y){function g(e,t,r){if(r){var i=d.quantizeOptimizedGeometry(b,t,e.hasZ,e.hasM,"esriGeometryPoint",r);return d.convertToPoint(i,e.hasZ,e.hasM)}return d.convertToPoint(t,e.hasZ,e.hasM)}function v(e,n,a){return i(this,void 0,void 0,(function(){var i,o,c,f,d,p;return r(this,(function(r){switch(r.label){case 0:return e?(i=e.where,e.where=i=i&&i.trim(),(!i||/^1 *= *1$/.test(i)||n&&n===i)&&(e.where=null),e.geometry?[4,_(e)]:[2,e]):[2,null];case 1:return o=r.sent(),e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel&&(c=e.geometry.spatialReference,(o=u.getGeometryExtent(o)).spatialReference=c),e.geometry=o,[4,m.checkProjectionSupport(o.spatialReference,a)];case 2:return r.sent(),[4,h.normalizeCentralMeridian(l.fromJSON(o))];case 3:if(f=r.sent()[0],s.isNone(f))throw t.QUERY_ENGINE_EMPTY_RESULT;return d=f.toJSON(),[4,m.project(d,d.spatialReference,a)];case 4:if(!(p=r.sent()))throw t.QUERY_ENGINE_EMPTY_RESULT;return p.spatialReference=a,e.geometry=p,[2,e]}}))}))}function _(e){return i(this,void 0,void 0,(function(){var t,i,n,s,u,l,h,f,d;return r(this,(function(r){switch(r.label){case 0:return t=e.geometry,i=e.distance,n=e.units,null==i?[2,a.resolve(t)]:(s=t.spatialReference,u=n&&x.fromJSON(n)||o.getUnitString(s),s&&(c.isGeographic(s)||c.isWebMercator(s))?(h=t,[3,3]):[3,1]);case 1:return[4,m.checkProjectionSupport(s,c.WGS84).then((function(){return m.project(t,c.WGS84)}))];case 2:h=r.sent(),r.label=3;case 3:return l=h,[4,y.getGeodesicBufferOperator()];case 4:return f=r.sent(),[2,(d=f(l,i,u))?d.toJSON():null]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});var x=new n.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});t.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var I=new p.default,b=new p.default,S={esriGeometryPoint:d.convertToPoint,esriGeometryPolyline:d.convertToPolyline,esriGeometryPolygon:d.convertToPolygon,esriGeometryMultipoint:d.convertToMultipoint};t.transformCentroid=g,t.getCentroid=function(e,t,r){return"esriGeometryPolygon"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=f.getCentroidOptimizedGeometry(new p.default,t.geometry,e.hasZ,e.hasM)),g(e,t.centroid,r)):null},t.getGeometry=function(e,t,r,i){var n=t?"coords"in t?t:t.geometry:null;if(!n)return null;if(r){var s=d.generalizeOptimizedGeometry(I,n,e.hasZ,e.hasM,e.geometryType,r);return i?(s=d.quantizeOptimizedGeometry(b,s,e.hasZ,e.hasM,e.geometryType,i),S[e.geometryType](s,e.hasZ,e.hasM)):S[e.geometryType](s,e.hasZ,e.hasM)}if(i){s=d.quantizeOptimizedGeometry(b,n,e.hasZ,e.hasM,e.geometryType,i);return S[e.geometryType](s,e.hasZ,e.hasM)}return S[e.geometryType](n,e.hasZ,e.hasM)},t.normalizeQuery=function(e,t,n){return i(this,void 0,void 0,(function(){var i,s,a,o,u;return r(this,(function(r){if(i=e.outFields,s=e.orderByFields,a=e.groupByFieldsForStatistics,o=e.outStatistics,i)for(u=0;u<i.length;u++)i[u]=i[u].trim();if(s)for(u=0;u<s.length;u++)s[u]=s[u].trim();if(a)for(u=0;u<a.length;u++)a[u]=a[u].trim();if(o)for(u=0;u<o.length;u++)o[u].onStatisticField&&(o[u].onStatisticField=o[u].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),[2,v(e,t,n)]}))}))},t.normalizeFilter=function(e,t,n){return i(this,void 0,void 0,(function(){return r(this,(function(r){return[2,v(e,t,n)]}))}))},t.normalizeQueryLike=v,t.cleanFromGeometryEngine=function(e){return e&&M in e?JSON.parse(JSON.stringify(e,F)):e};var M="_geVersion",F=function(e,t){return e!==M?t:void 0}}.apply(null,i))||(e.exports=n)},649:function(e,t,r){var i;void 0===(i=function(){"use strict";function e(r,i,n,s,a){for(;s>n;){if(s-n>600){var o=s-n+1,u=i-n+1,l=Math.log(o),h=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*h*(o-h)/o)*(u-o/2<0?-1:1);e(r,i,Math.max(n,Math.floor(i-u*h/o+c)),Math.min(s,Math.floor(i+(o-u)*h/o+c)),a)}var f=r[i],d=n,p=s;for(t(r,n,i),a(r[s],f)>0&&t(r,n,s);d<p;){for(t(r,d,p),d++,p--;a(r[d],f)<0;)d++;for(;a(r[p],f)>0;)p--}0===a(r[n],f)?t(r,n,p):t(r,++p,s),p<=i&&(n=p+1),i<=p&&(s=p-1)}}function t(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function r(e,t){return e<t?-1:e>t?1:0}return function(t,i,n,s,a){e(t,i,n||0,s||t.length-1,a||r)}}.apply(null,[]))||(e.exports=i)},652:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function i(e,t,i,n,s,a){for(var o=r(s,a),u=i,l=i+o,h=0,c=0,f=0,d=0,p=0,m=0,y=n-1;m<y;m++,u+=o,l+=o){var g=t[u],v=t[u+1],_=t[u+2],x=t[l],I=t[l+1],b=t[l+2],S=g*I-x*v;d+=S,h+=(g+x)*S,c+=(v+I)*S,s&&(f+=(_+b)*(S=g*b-x*_),p+=S),g<e[0]&&(e[0]=g),g>e[1]&&(e[1]=g),v<e[2]&&(e[2]=v),v>e[3]&&(e[3]=v),s&&(_<e[4]&&(e[4]=_),_>e[5]&&(e[5]=_))}if(d>0&&(d*=-1),p>0&&(p*=-1),!d)return null;var M=[h,c,.5*d];return s&&(M[3]=f,M[4]=.5*p),M}function n(e,t,i,n,l){for(var h=r(n,l),c=t,f=t+h,d=0,p=0,m=0,y=0,g=0,v=i-1;g<v;g++,c+=h,f+=h){var _=e[c],x=e[c+1],I=e[c+2],b=e[f],S=e[f+1],M=e[f+2],F=n?a(_,x,I,b,S,M):s(_,x,b,S);if(F)if(d+=F,n){p+=F*(E=u(_,x,I,b,S,M))[0],m+=F*E[1],y+=F*E[2]}else{var E;p+=F*(E=o(_,x,b,S))[0],m+=F*E[1]}}return d>0?n?[p/d,m/d,y/d]:[p/d,m/d]:i>0?n?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function s(e,t,r,i){var n=r-e,s=i-t;return Math.sqrt(n*n+s*s)}function a(e,t,r,i,n,s){var a=i-e,o=n-t,u=s-r;return Math.sqrt(a*a+o*o+u*u)}function o(e,t,r,i){return[e+.5*(r-e),t+.5*(i-t)]}function u(e,t,r,i,n,s){return[e+.5*(i-e),t+.5*(n-t),r+.5*(s-r)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCentroidOptimizedGeometry=function(e,t,s,a){if(!t||!t.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);for(var o=e.coords,u=[],l=s?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],h=t.lengths,c=t.coords,f=r(s,a),d=0,p=0,m=h;p<m.length;p++){var y=m[p],g=i(l,c,d,y,s,a);g&&u.push(g),d+=y*f}if(u.sort((function(e,t){var r=e[2]-t[2];return 0===r&&s&&(r=e[4]-t[4]),r})),u.length){var v=6*u[0][2];o[0]=u[0][0]/v,o[1]=u[0][1]/v,s&&(v=6*u[0][4],o[2]=0!==v?u[0][3]/v:0),(o[0]<l[0]||o[0]>l[1]||o[1]<l[2]||o[1]>l[3]||s&&(o[2]<l[4]||o[2]>l[5]))&&(o.length=0)}if(!o.length){var _=t.lengths[0]?n(c,0,h[0],s,a):null;if(!_)return null;o[0]=_[0],o[1]=_[1],s&&_.length>2&&(o[2]=_[2])}return e},t.lineCentroid=n}.apply(null,i))||(e.exports=n)},653:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(6),r(8),r(11),r(4),r(94),r(182),r(56),r(37),r(695),r(615),r(612),r(621),r(636)],void 0===(n=function(e,t,i,n,s,a,o,u,l,h,c,f,d,p,m){function y(){return a.create((function(e){return r.e(9).then(function(){var t=[r(703)];e.apply(null,t)}.bind(this)).catch(r.oe)}))}Object.defineProperty(t,"__esModule",{value:!0});var g="feature-store:unsupported-query",v={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},_={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.importGeometryEngine=y,t.getGeodesicBufferOperator=function(){return y().then((function(e){return e.geodesicBuffer}))},t.getSpatialQueryOperator=function(e,t,r){if(l.isPolygon(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var i=f.convertFromPolygon(new d.default,t,!1,!1);return a.resolve((function(e){return c.polygonContainsPoint(i,!1,!1,e)}))}if(l.isPolygon(t)&&"esriGeometryMultipoint"===r.geometryType){var n=f.convertFromPolygon(new d.default,t,!1,!1);if("esriSpatialRelContains"===e)return a.resolve((function(e){return c.polygonContainsMultipoint(n,!1,!1,e,r.hasZ,r.hasM)}))}if(l.isExtent(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return a.resolve((function(e){return o.extentContainsPoint(t,m.getGeometry(r,e))}));if(l.isExtent(t)&&"esriGeometryMultipoint"===r.geometryType&&"esriSpatialRelContains"===e)return a.resolve((function(e){return o.extentContainsMultipoint(t,m.getGeometry(r,e))}));if(l.isExtent(t)&&"esriSpatialRelIntersects"===e){var s=u.getExtentIntersector(r.geometryType);return a.resolve((function(e){return s(t,m.getGeometry(r,e))}))}return y().then((function(i){var n=i[v[e]].bind(null,t);return function(e){return n(m.getGeometry(r,e))}}))},t.checkSpatialQuerySupport=function(e,t,r){return n(this,void 0,void 0,(function(){var n,a;return i(this,(function(i){if(n=e.spatialRel,!(a=e.geometry))return[2];if(!function(e){return!0===_.spatialRelationship[e]}(n))throw new s(g,"Unsupported query spatial relationship",{query:e});if(!h.isValid(a.spatialReference)||!h.isValid(r))return[2];if(!function(e){return!0===_.queryGeometry[l.getJsonType(e)]}(a))throw new s(g,"Unsupported query geometry type",{query:e});if(!function(e){return!0===_.layerGeometry[e]}(t))throw new s(g,"Unsupported layer geometry type",{query:e});return e.outSR?[2,p.checkProjectionSupport(e.geometry&&e.geometry.spatialReference,e.outSR)]:[2]}))}))},t.canQueryWithRBush=function(e){if(l.isExtent(e))return!0;if(l.isPolygon(e)){for(var t=0,r=e.rings;t<r.length;t++){var i=r[t];if(5!==i.length)return!1;if(i[0][0]!==i[1][0]||i[0][0]!==i[4][0]||i[2][0]!==i[3][0]||i[0][1]!==i[3][1]||i[0][1]!==i[4][1]||i[1][1]!==i[2][1])return!1}return!0}return!1}}.apply(null,i))||(e.exports=n)},657:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e,t,r,i,n){if(null!=i&&null!=n&&i===n){var s=i;return function(i){return s>=e.getAttribute(i,t)&&s<=e.getAttribute(i,r)}}return null!=i&&null!=n?function(s){return function(e,t,r,i){return!(r>t||i<e)}(i,n,e.getAttribute(s,t),e.getAttribute(s,r))}:null!=i?function(t){return!(e.getAttribute(t,r)<i)}:null!=n?function(r){return!(e.getAttribute(r,t)>n)}:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeExtent=function(e,t){if(!e)return null;var r=t.featureAdapter,i=e.startTimeField,n=e.endTimeField,s=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;if(i&&n)t.forEach((function(e){var t=r.getAttribute(e,i),o=r.getAttribute(e,n);null==t||isNaN(t)||(s=Math.min(s,t)),null==o||isNaN(o)||(a=Math.max(a,o))}));else{var o=i||n;t.forEach((function(e){var t=r.getAttribute(e,o);null==t||isNaN(t)||(s=Math.min(s,t),a=Math.max(a,t))}))}return{start:s,end:a}},t.getTimeOperator=function(e,t,i){if(!t||!e)return null;var n=e.startTimeField,s=e.endTimeField;if(!n&&!s)return null;var a=t.start,o=t.end;return null==a&&null==o?null:n&&s?r(i,n,s,a,o):function(e,t,r,i){return null!=r&&null!=i&&r===i?function(i){return e.getAttribute(i,t)===r}:null!=r&&null!=i?function(n){return e.getAttribute(n,t)>=r&&e.getAttribute(n,t)<=i}:null!=r?function(i){return e.getAttribute(i,t)>=r}:null!=i?function(r){return e.getAttribute(r,t)<=i}:void 0}(i,n||s,a,o)}}.apply(null,i))||(e.exports=n)},673:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(6),r(8),r(18),r(11),r(48),r(15),r(9),r(16),r(630),r(634),r(171),r(615),r(693)],void 0===(n=function(e,t,r,i,n,s,a,o,u,l,h,c,f,d,p){Object.defineProperty(t,"__esModule",{value:!0});var m=[],y=u.getLogger("esri.layers.graphics.data.FeatureStore"),g={minX:0,minY:0,maxX:0,maxY:0},v=function(){function e(e,t,r){this._geometryInfo=e,this._onFeatureAdd=t,this._onFeatureRemove=r,this._featuresById=new Map,this._boundsByFeature=new Map,this._featuresByBounds=new Map,this._index=h(9,o("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this.events=new a,this.featureAdapter=p.optimizedFeatureQueryEngineAdapter}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var e=f.create(f.NEGATIVE_INFINITY);return this._boundsByFeature.forEach((function(t){t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]))})),e},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this._add(e,m),this._index.load(m),this._emitChanged(),m.length=0},e.prototype.addMany=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this._add(i,m)}this._index.load(m),this._emitChanged(),m.length=0},e.prototype.clear=function(){this._featuresById.clear(),this._boundsByFeature.clear(),this._featuresByBounds.clear(),this._index.clear(),this._emitChanged()},e.prototype.removeById=function(e){var t=this._featuresById.get(e);if(!t)return null;var r=this._boundsByFeature.get(t);return r&&(this._index.remove(r),this._featuresByBounds.delete(r)),this._boundsByFeature.delete(t),this._featuresById.delete(e),this._emitChanged(),t},e.prototype.removeIf=function(e,t){var r=this;this._featuresById.forEach((function(i,n){t(i)&&(r._remove(i),e.push(i))})),this._emitChanged()},e.prototype.removeManyById=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],n=this._featuresById.get(i);if(n){var s=this._boundsByFeature.get(n);s&&(this._index.remove(s),this._featuresByBounds.delete(s)),this._boundsByFeature.delete(n)}this._featuresById.delete(i)}this._emitChanged()},e.prototype.forEachBounds=function(e,t,r){for(var i=0,n=e;i<n.length;i++){var s=n[i],a=this._boundsByFeature.get(s);a&&t(c.fromRect(r,a))}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.has=function(e){return this._featuresById.has(e)},e.prototype.forEach=function(e){this._featuresById.forEach((function(t){return e(t)}))},e.prototype.forEachInBounds=function(e,t){for(var r=0,i=function(e,t){return g.minX=t[0],g.minY=t[1],g.maxX=t[2],g.maxY=t[3],e.search(g)}(this._index,e);r<i.length;r++){var n=i[r];t(this._featuresByBounds.get(n))}},e.prototype.transferById=function(e,t){var r=this._featuresById.get(t);r&&(this._remove(r),e.add(r),this._emitChanged())},e.prototype.transferByIds=function(e,t){for(var r=[],i=0,n=t;i<n.length;i++){var s=n[i],a=this._featuresById.get(s);a&&(this._remove(a),r.push(a))}e.addMany(r),this._emitChanged()},e.prototype.transferIdRange=function(e,t,r){for(var i=[],n=t;n<r;n++){var s=this._featuresById.get(n);s&&(this._remove(s),i.push(s))}e.addMany(i),this._emitChanged()},e.prototype.transferIf=function(e,t){var r=this,i=[];this._featuresById.forEach((function(e,n){t(e)&&(r._remove(e),i.push(e))})),e.addMany(i),this._emitChanged()},e.prototype.transferAll=function(e){var t=this,r=[];this._featuresById.forEach((function(e,i){t._remove(e),r.push(e)})),e.addMany(r),this._emitChanged()},e.prototype._emitChanged=function(){this.events.emit("changed",void 0)},e.prototype._add=function(e,t){if(e){var r=e.objectId;if(null==r)return void y.error(new s("featurestore:invalid-feature","feature id is missing",{feature:e}));var i,n=this._featuresById.get(r);if(n?(i=this._boundsByFeature.get(n),e.localId=n.localId,i&&(this._index.remove(i),this._boundsByFeature.delete(n),this._featuresByBounds.delete(i))):l.isSome(this._onFeatureAdd)&&this._onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsByFeature.set(e,null),void this._featuresById.set(r,e);i=d.getBoundsOptimizedGeometry(i||f.create(),e.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(e,i),this._featuresByBounds.set(i,e),this._featuresById.set(r,e),t.push(i)}},e.prototype._remove=function(e){var t;e&&(l.isSome(this._onFeatureRemove)&&this._onFeatureRemove(e),(t=this._boundsByFeature.get(e))&&(this._index.remove(t),this._boundsByFeature.delete(e),this._featuresByBounds.delete(t)),this._featuresById.delete(e.objectId))},e}();t.default=v}.apply(null,i))||(e.exports=n)},674:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(6),r(8),r(11),r(57),r(5),r(9),r(283),r(4),r(78),r(634),r(171),r(281),r(56),r(37),r(635),r(621),r(680),r(719),r(653),r(657),r(636),r(274),r(721)],void 0===(n=function(e,t,r,i,n,s,a,o,u,l,h,c,f,d,p,m,y,g,v,_,x,I,b,S,M,F){Object.defineProperty(t,"__esModule",{value:!0});var E=u.getLogger("esri.layers.graphics.data.QueryEngine"),R=function(e,t,r,i,n){void 0===t&&(t=null),this.attributes=e,this.geometry=r,this.centroid=i,this.filterFlags=n,this.groupId=-1,this.localId=t};t.Feature=R;var T=new Set,N=new l.MemCacheStorage(2e6),w=0,B=function(){function e(e){var t=this;this.capabilities={query:_.queryCapabilities},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.cacheSpatialQueries=e.cacheSpatialQueries||!1,this.gdbVersion=e.gdbVersion,this.historicMoment=e.historicMoment,this.featureStore=e.featureStore,this._changeHandle=this.featureStore.events.on("changed",(function(){return t.clearCache()})),this.timeInfo=e.timeInfo,this.cacheSpatialQueries&&(this._geometryQueryCache=new l.MemCache(w+++"$$",N)),this.fieldsIndex=new M(e.fields),e.scheduler&&e.task&&(this._frameQueue=new F.PromiseQueue,this._frameTask=e.scheduler.registerTask(e.task,(function(e){return t._update(e)}),(function(){return t._frameQueue.length>0})))}return e.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()},Object.defineProperty(e.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullExtent",{get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:S.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:(this._timeExtent=b.getTimeExtent(this.timeInfo,this.featureStore),this._timeExtent):null},enumerable:!0,configurable:!0}),e.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null},e.prototype.executeQuery=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var t,r,n;return i(this,(function(i){switch(i.label){case 0:t=o.clone(e),i.label=1;case 1:return i.trys.push([1,14,,15]),[4,this._schedule()];case 2:return i.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=i.sent(),[4,this._reschedule()];case 4:return i.sent(),[4,this._checkQuerySupport(t)];case 5:return t=i.sent(),[4,this._reschedule()];case 6:return i.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=i.sent(),[4,this._reschedule()];case 8:return i.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=i.sent(),[4,this._reschedule()];case 10:return i.sent(),[4,r.executeTimeQuery(t)];case 11:return r=i.sent(),[4,this._reschedule()];case 12:return i.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=i.sent(),[3,15];case 14:if((n=i.sent())!==S.QUERY_ENGINE_EMPTY_RESULT)throw n;return r=new x.default([],null,this),[3,15];case 15:return[2,r.createQueryResponse(t)]}}))}))},e.prototype.executeQueryForCount=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var t,r,n;return i(this,(function(i){switch(i.label){case 0:(t=o.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,i.label=1;case 1:return i.trys.push([1,14,,15]),[4,this._schedule()];case 2:return i.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=i.sent(),[4,this._reschedule()];case 4:return i.sent(),[4,this._checkQuerySupport(t)];case 5:return t=i.sent(),[4,this._reschedule()];case 6:return i.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=i.sent(),[4,this._reschedule()];case 8:return i.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=i.sent(),[4,this._reschedule()];case 10:return i.sent(),[4,r.executeTimeQuery(t)];case 11:return r=i.sent(),[4,this._reschedule()];case 12:return i.sent(),[4,r.executeAttributesQuery(t)];case 13:return[2,(r=i.sent()).size];case 14:if((n=i.sent())!==S.QUERY_ENGINE_EMPTY_RESULT)throw n;return[2,0];case 15:return[2]}}))}))},e.prototype.executeQueryForExtent=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var t,r,n,s,a,u,l,h;return i(this,(function(i){switch(i.label){case 0:t=o.clone(e),n=t.outSR,i.label=1;case 1:return i.trys.push([1,14,,15]),[4,this._schedule()];case 2:return i.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=i.sent(),[4,this._reschedule()];case 4:return i.sent(),[4,this._checkQuerySupport(t)];case 5:return(t=i.sent()).returnGeometry=!0,t.returnCentroid=!1,t.outSR=null,[4,this._reschedule()];case 6:return i.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=i.sent(),[4,this._reschedule()];case 8:return i.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=i.sent(),[4,this._reschedule()];case 10:return i.sent(),[4,r.executeTimeQuery(t)];case 11:return r=i.sent(),[4,this._reschedule()];case 12:return i.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=i.sent(),(s=r.size)?(f.set(P,f.NEGATIVE_INFINITY),this.featureStore.forEachBounds(r.items,(function(e){return f.expand(P,e)}),G),a={xmin:P[0],ymin:P[1],xmax:P[3],ymax:P[4],spatialReference:S.cleanFromGeometryEngine(this.spatialReference)},this.hasZ&&isFinite(P[2])&&isFinite(P[5])&&(a.zmin=P[2],a.zmax=P[5]),(u=v.project(a,r.spatialReference,n)).spatialReference=S.cleanFromGeometryEngine(n||this.spatialReference),u.xmax-u.xmin==0&&(l=c.getMetersPerUnitForSR(u.spatialReference),u.xmin-=l,u.xmax+=l),u.ymax-u.ymin==0&&(l=c.getMetersPerUnitForSR(u.spatialReference),u.ymin-=l,u.ymax+=l),this.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0&&(l=c.getMetersPerUnitForSR(u.spatialReference),u.zmin-=l,u.zmax+=l),[2,{count:s,extent:u}]):[2,{count:s,extent:null}];case 14:if((h=i.sent())===S.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw h;case 15:return[2]}}))}))},e.prototype.executeQueryForIds=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.executeQueryForIdSet(e,t).then((function(e){return a.valuesOfSet(e)}))]}))}))},e.prototype.executeQueryForIdSet=function(e,t){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){var t,r,n,s,a,u,l,h;return i(this,(function(i){switch(i.label){case 0:(t=o.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,i.label=1;case 1:return i.trys.push([1,13,,14]),[4,this._schedule()];case 2:return i.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=i.sent(),[4,this._reschedule()];case 4:return i.sent(),[4,this._executeGeometryQuery(t)];case 5:return r=i.sent(),[4,this._reschedule()];case 6:return i.sent(),[4,r.executeObjectIdsQuery(t)];case 7:return r=i.sent(),[4,this._reschedule()];case 8:return i.sent(),[4,r.executeTimeQuery(t)];case 9:return r=i.sent(),[4,this._reschedule()];case 10:return i.sent(),[4,r.executeAttributesQuery(t)];case 11:return r=i.sent(),[4,this._reschedule()];case 12:for(i.sent(),n=r.items,s=new Set,a=0,u=n;a<u.length;a++)l=u[a],s.add(r.featureAdapter.getObjectId(l));return[2,s];case 13:if((h=i.sent())===S.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw h;case 14:return[2]}}))}))},e.prototype.executeQueryForLatestObservations=function(e,t){var r=this;return this.timeInfo?this.executeQuery(e,t).then((function(e){return r._filterLatest(e,r.timeInfo)})):void E.error(new s("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))},e.prototype._schedule=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){return this._frameQueue?[2,this._frameQueue.push(e).then((function(e){return e}))]:[2,e]}))}))},e.prototype._reschedule=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){return this._frameQueue?[2,this._frameQueue.unshift(e).then((function(e){return e}))]:[2,e]}))}))},e.prototype._update=function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null},e.prototype._filterLatest=function(e,t){for(var i=t.trackIdField,n=t.startTimeField,s=t.endTimeField||n,a=new Map,o=[],u=0,l=e.features;u<l.length;u++){var h=l[u],c=h.attributes[i],f=h.attributes[s];(!a.has(c)||a.get(c).attributes[s]<f)&&a.set(c,h)}return a.forEach((function(e){return o.push(e)})),r({},e,{features:o})},e.prototype._getAll=function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new x.default(e,null,this)}return this._allItems},e.prototype._executeGeometryQuery=function(e){return n(this,void 0,void 0,(function(){var t,r,s,a,o,u,l,h,c,f,d,p,m,g,v,_,b,S,M,F,E,R,T,N=this;return i(this,(function(w){switch(w.label){case 0:if(t=e.geometry,r=e.outSR,s=e.spatialRel,a=y.isValid(r)&&!y.equals(this.spatialReference,r),(o=this.cacheSpatialQueries?a?JSON.stringify({geometry:t,spatialRelationship:s,outSpatialReference:r}):JSON.stringify({geometry:t,spatialRelationship:s}):null)&&void 0!==(u=this._geometryQueryCache.get(o)))return[2,u];if(l=function(t){return n(N,void 0,void 0,(function(){var n;return i(this,(function(i){switch(i.label){case 0:return a&&(e.returnGeometry||e.returnCentroid)?[4,t.project(r)]:[3,2];case 1:return n=i.sent(),o&&this._geometryQueryCache.put(o,n,n.size||1),[2,n];case 2:return o&&this._geometryQueryCache.put(o,t,t.size||1),[2,t]}}))}))},!t)return[2,l(this._getAll())];if(h=this.featureAdapter,"esriSpatialRelDisjoint"!==s)return[3,5];if(!(c=this._searchFeatures(this._getQueryBBoxes(t))).length)return[2,l(this._getAll())];for(p=new Set,m=0,g=c;m<g.length;m++)v=g[m],p.add(h.getObjectId(v));return[4,this._reschedule(p)];case 1:return p=w.sent(),_=0,f=new Array(p.size),this.featureStore.forEach((function(e){return f[_++]=e})),d=p,[4,this._reschedule()];case 2:return w.sent(),[4,I.getSpatialQueryOperator(s,t,this)];case 3:return b=w.sent(),S=function(e){return!d.has(h.getObjectId(e))||b(h.getGeometry(e))},M=x.default.bind,[4,this._runSpatialFilter(f,S)];case 4:return E=new(M.apply(x.default,[void 0,w.sent(),t,this])),[2,l(E)];case 5:return(F=this._searchFeatures(this._getQueryBBoxes(t))).length?this._canExecuteSoloPass(t,e)?[2,l(new x.default(F,t,this))]:[4,I.getSpatialQueryOperator(s,t,this)]:(E=new x.default([],t,this),o&&this._geometryQueryCache.put(o,E,E.size||1),[2,E]);case 6:return R=w.sent(),[4,this._runSpatialFilter(F,(function(e){return R(h.getGeometry(e))}))];case 7:return T=w.sent(),[2,l(new x.default(T,t,this))]}}))}))},e.prototype._runSpatialFilter=function(e,t){return n(this,void 0,void 0,(function(){var r,s,a,o=this;return i(this,(function(u){return t?this._budget?(r=0,s=new Array,a=function(){return n(o,void 0,void 0,(function(){var n;return i(this,(function(i){switch(i.label){case 0:return r<e.length?(n=e[r],t(n)&&s.push(n),this._budget.done?[4,this._reschedule()]:[3,2]):[3,3];case 1:return i.sent(),[2,a()];case 2:return++r,[3,0];case 3:return[2]}}))}))},[2,this._reschedule().then((function(){return a()})).then((function(){return s}))]):[2,e.filter((function(e){return t(e)}))]:[2,e]}))}))},e.prototype._canExecuteSoloPass=function(e,t){var r=this.geometryType,i=t.spatialRel;return I.canQueryWithRBush(e)&&("esriSpatialRelEnvelopeIntersects"===i||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===i||"esriSpatialRelContains"===i||"esriSpatialRelWithin"===i))},e.prototype._getQueryBBoxes=function(e){if(I.canQueryWithRBush(e)){if(m.isExtent(e))return[d.fromValues(e.xmin,e.ymin,e.xmax,e.ymax)];if(m.isPolygon(e))return e.rings.map((function(e){return d.fromValues(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[p.getBoundsXY(d.create(),e)]},e.prototype._searchFeatures=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this.featureStore.forEachInBounds(i,(function(e){T.add(e)}))}var n=new Array(T.size),s=0;return T.forEach((function(e){return n[s++]=e})),T.clear(),n},e.prototype._checkQuerySupport=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new s("feature-store:unsupported-query","Unsupported query options",{query:e});return[2,h.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),I.checkSpatialQuerySupport(e,this.geometryType,this.spatialReference),v.checkProjectionSupport(this.spatialReference,e.outSR)]).then((function(){return e}))]}))}))},e.prototype._checkAttributesQuerySupport=function(e){var t=e.outFields,r=e.orderByFields,i=e.returnDistinctValues;if(r&&r.length>0){var n=r.map((function(e){return e.indexOf(" ASC")>-1?e.split(" ASC")[0]:e.indexOf(" DESC")>-1?e.split(" DESC")[0]:e}));g.validateFields(this.fieldsIndex,n,"orderByFields contains missing fields")}if(t&&t.length>0)g.validateFields(this.fieldsIndex,t,"outFields contains missing fields");else if(i)throw new s("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});g.validateWhere(this.fieldsIndex,e.where)},e.prototype._checkStatisticsQuerySupport=function(e){return n(this,void 0,void 0,(function(){var t,r,n,a,o,u,l,h,c,f,d;return i(this,(function(i){if(t=e.outStatistics,r=e.groupByFieldsForStatistics,n=e.having,a=r&&r.length,o=t&&t.length,n){if(!a||!o)throw new s("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});g.validateHaving(this.fieldsIndex,n,t)}if(o){if(t.some((function(e){return"exceedslimit"===e.statisticType})))return[2];for(u=t.map((function(e){return e.onStatisticField})),g.validateFields(this.fieldsIndex,u,"onStatisticFields contains missing fields"),a&&g.validateFields(this.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields"),l=0,h=t;l<h.length;l++){if(c=h[l],f=c.onStatisticField,"exceedslimit"===(d=c.statisticType))throw new s("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:c,query:e});if((!a||"count"!==d)&&f&&g.hasInvalidFieldType(f,this.fieldsIndex))throw new s("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:c,query:e})}}return[2]}))}))},e}();t.default=B;var G=f.create(),P=f.create()}.apply(null,i))||(e.exports=n)},675:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(283)],void 0===(n=function(e,t,r){return function(){function e(e,t){this._storage=new r.MemCacheStorage,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}return e.prototype.put=function(e,t){this._storage.put(e,t,1,1)},e.prototype.pop=function(e){return this._storage.pop(e)},e.prototype.get=function(e){return this._storage.get(e)},e.prototype.clear=function(){this._storage.clearAll()},e.prototype.destroy=function(){this._storage.clearAll()},e}()}.apply(null,i))||(e.exports=n)},693:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(652),r(619),r(612)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.optimizedFeatureQueryEngineAdapter={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new i.default(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=r.getCentroidOptimizedGeometry(new n.default,e.geometry,t.hasZ,t.hasM)),e.centroid}},t.default=t.optimizedFeatureQueryEngineAdapter}.apply(null,i))||(e.exports=n)},694:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(675),r(563)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._cache=new r(e),this._invalidCache=new r(t)}return e.prototype.get=function(e,t){var r=t.uid+":"+e,n=this._cache.get(r);if(n)return n;if(void 0!==this._invalidCache.get(r))return null;try{var s=i.WhereClause.create(e,t);return this._cache.put(r,s),s}catch(e){return this._invalidCache.put(r,null),null}},e}();t.WhereClauseCache=n}.apply(null,i))||(e.exports=n)},695:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function i(e,t,i,s,a){if(!e)return!1;for(var o=r(t,i),u=e.coords,l=!1,h=0,c=0,f=e.lengths;c<f.length;c++){var d=f[c];l=n(l,u,o,h,d,s,a),h+=d*o}return l}function n(e,t,r,i,n,s,a){for(var o=e,u=i,l=i,h=i+n*r;l<h;l+=r){(u=l+r)===h&&(u=i);var c=t[l],f=t[l+1],d=t[u],p=t[u+1];(f<a&&p>=a||p<a&&f>=a)&&c+(a-f)/(p-f)*(d-c)<s&&(o=!o)}return o}Object.defineProperty(t,"__esModule",{value:!0}),t.polygonContainsPoint=function(e,t,r,n){return i(e,t,r,n.coords[0],n.coords[1])},t.polygonContainsMultipoint=function(e,t,n,s,a,o){var u=r(a,o),l=s.coords,h=s.lengths;if(!h)return!1;for(var c=0,f=0;c<h.length;c++,f+=u)if(!i(e,t,n,l[f],l[f+1]))return!1;return!0},t.polygonContainsCoords=i}.apply(null,i))||(e.exports=n)},719:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(6),r(8),r(57),r(16),r(4),r(620),r(37),r(615),r(720),r(635),r(621),r(657),r(636)],void 0===(n=function(e,t,r,i,n,s,a,o,u,l,h,c,f,d,p,m){Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter}return Object.defineProperty(e.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),e.prototype.createQueryResponse=function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(l.isValid(e.outSR)&&!l.equals(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=m.cleanFromGeometryEngine(r({spatialReference:e.outSR},d.project(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=m.cleanFromGeometryEngine(r({spatialReference:e.outSR},this.queryGeometry))),t},e.prototype.executeAttributesQuery=function(t){var r=f.getWhereClause(t.where,this.fieldsIndex);if(!r)return o.resolve(this);if(r.isStandardized){for(var i=0,n=[],s=0,a=this.items;s<a.length;s++){var u=a[s];r.testFeature(u,this.featureAdapter)&&(n[i++]=u)}var l=new e(n,this.queryGeometry,this);return l.definitionExpression=t.where,o.resolve(l)}return o.reject(new TypeError("Where clause is not standardized"))},e.prototype.executeObjectIdsQuery=function(t){if(!t.objectIds||!t.objectIds.length)return o.resolve(this);var r=s.SetFromValues(t.objectIds),i=this.featureAdapter.getObjectId;return o.resolve(new e(this.items.filter((function(e){return r.has(i(e))})),this.queryGeometry,this))},e.prototype.executeTimeQuery=function(t){var r=p.getTimeOperator(this.timeInfo,t.timeExtent,this.featureAdapter);if(!a.isSome(r))return o.resolve(this);var i=this.items.filter(r);return o.resolve(new e(i,this.queryGeometry,this))},e.prototype.project=function(t){return n(this,void 0,void 0,(function(){var r,n,s=this;return i(this,(function(i){switch(i.label){case 0:return!t||l.equals(this.spatialReference,t)?[2,this]:(r=this.featureAdapter,[4,d.projectMany(this.items.map((function(e){return m.getGeometry(s,r.getGeometry(e))})),this.spatialReference,t)]);case 1:return n=i.sent(),[2,new e(n.map((function(e,t){return r.cloneWithGeometry(s.items[t],h.convertFromGeometry(e,s.hasZ,s.hasM))})),this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}}))}))},e.prototype._createFeatureQueryResponse=function(e){var t=this,r=this.items,i=this,n=i.geometryType,s=i.hasM,a=i.hasZ,o=i.objectIdField,l=i.spatialReference,h=e.outFields,c=e.outSR,f=e.quantizationParameters,d=e.resultRecordCount,p=e.resultOffset,y=!1;if(null!=d&&null!=p){var g=p+d;y=r.length>g,r=r.slice(p,Math.min(r.length,g))}return{exceededTransferLimit:y,features:this._createFeatures(e,r),fields:h&&h.map((function(e){return t.fieldsIndex.get(e)})),geometryType:n,hasM:s,hasZ:a,objectIdFieldName:o,spatialReference:m.cleanFromGeometryEngine(c||l),transform:f&&u.toQuantizationTransform(f)||null}},e.prototype._createFeatures=function(e,t){var r=new c.default(e,this.featureAdapter,this.fieldsIndex),i=e.quantizationParameters,n=e.returnGeometry,s=e.returnCentroid,a=e.maxAllowableOffset,o=e.orderByFields,l=[],h=0;if(t.length&&o&&o.length){var f=o[0].split(" "),d=f[0],p=this.fieldsIndex.get(d),y="DESC"===f[1];t.sort((function(e,t){var i=r.getFieldValue(e,d,p),n=r.getFieldValue(t,d,p);if("number"==typeof i&&"number"==typeof n)return y?n-i:i-n;if("string"==typeof i&&"string"==typeof n){var s=i.toUpperCase(),a=n.toUpperCase();return(y?s>a:s<a)?-1:(y?s<a:s>a)?1:0}}))}if(n||s){var g=u.toQuantizationTransform(i);if(n&&!s)for(var v=0,_=t;v<_.length;v++){var x=_[v];l[h++]={attributes:r.getAttributes(x),geometry:m.getGeometry(this,this.featureAdapter.getGeometry(x),a,g)}}else if(!n&&s)for(var I=0,b=t;I<b.length;I++){x=b[I];l[h++]={attributes:r.getAttributes(x),centroid:m.transformCentroid(this,this.featureAdapter.getCentroid(x,this),g)}}else for(var S=0,M=t;S<M.length;S++){x=M[S];l[h++]={attributes:r.getAttributes(x),centroid:m.transformCentroid(this,this.featureAdapter.getCentroid(x,this),g),geometry:m.getGeometry(this,this.featureAdapter.getGeometry(x),a,g)}}}else for(var F=0,E=t;F<E.length;F++){x=E[F];var R=r.getAttributes(x);R&&(l[h++]={attributes:R})}return l},e.prototype._createExceedsLimitQueryResponse=function(e){for(var t=!1,r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,s=0,a=e.outStatistics;s<a.length;s++){var o=a[s];if("exceedslimit"===o.statisticType){r=null!=o.maxPointCount?o.maxPointCount:Number.POSITIVE_INFINITY,i=null!=o.maxRecordCount?o.maxRecordCount:Number.POSITIVE_INFINITY,n=null!=o.maxVertexCount?o.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>i)t=!0;else{var u=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;t=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(r&&r.coords.length||0)}),0)/u>n}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}},e.prototype._createStatisticsQueryResponse=function(e){for(var t=new c.default(e,this.featureAdapter,this.fieldsIndex),r=e.outStatistics,i=[],n=[],s=e.groupByFieldsForStatistics,a=e.having,o=s&&s.length,u=o&&s[0],l=this.fieldsIndex.get(u),h=!l,f={},d={},p={},m={attributes:{}},y=0,g=r;y<g.length;y++){var v=g[y],_=v.outStatisticFieldName,x=v.statisticType,I="exceedslimit"!==x?v.onStatisticField:void 0,b=this.fieldsIndex.get(I),S=o&&(I===u||h)&&"count"===x;if(o){f[I]||(f[I]=this._calculateUniqueValues(t,u,l));var M=f[I];for(var F in M){var E=M[F],R=E.count,T=E.data,N=E.items;if(!a||t.validateItems(N,a)){var w=d[T]||{attributes:{}},B=null;if(S)B=R;else B=(G=this._calculateStatistics(N,t,I,b))[P="var"===x?"variance":x];w.attributes[_]=B,w.attributes[h?"EXPR_1":u]=T,d[T]=w}}}else{p[I]||(p[I]=this._calculateStatistics(this.items,t,I,b));var G=p[I],P="var"===x?"variance":x;m.attributes[_]=G[P]}n.push({name:_,alias:_,type:"esriFieldTypeDouble"})}if(o)for(var A in d)i.push(d[A]);else i.push(m);return{fields:n,features:i}},e.prototype._calculateStatistics=function(e,t,r,i){for(var n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=null,o=null,u=null,l=null,h=[],c=0,f=0;f<e.length;f++){var d=e[f];"string"==typeof(g=t.getFieldValue(d,r,i))?c++:null==g||isNaN(g)||(a+=g,n=Math.min(n,g),s=Math.max(s,g),h.push(g),c++)}if(c){o=a/c;for(var p=0,m=0,y=h;m<y.length;m++){var g=y[m];p+=Math.pow(g-o,2)}l=c>1?p/(c-1):0,u=Math.sqrt(l)}else n=null,s=null;return{avg:o,count:c,max:s,min:n,stddev:u,sum:a,variance:l}},e.prototype._calculateUniqueValues=function(e,t,r){for(var i={},n=0,s=this.items;n<s.length;n++){var a=s[n],o=e.getFieldValue(a,t,r);(null==o||"string"==typeof o&&""===o.trim())&&(o=null),null==i[o]?i[o]={count:1,data:o,items:[a]}:(i[o].count++,i[o].items.push(a))}return i},e}();t.default=y}.apply(null,i))||(e.exports=n)},720:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(16),r(635)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;var n=e.outFields;if(n&&-1===n.indexOf("*")){this.outFields=n;for(var s=0,a=0,o=n;a<o.length;a++){var u=o[a],l=i.getExpressionFromFieldName(u),h=this.fieldsIndex.get(l),c=h?null:i.getWhereClause(l,r),f=h?h.name:i.getAliasFromFieldName(u)||"FIELD_EXP_"+s++;this._fieldDataCache.set(u,{alias:f,clause:c})}}}return e.prototype.getAttributes=function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)},e.prototype.getFieldValue=function(e,t,r){var n=r?r.name:t,s=null;return this._fieldDataCache.has(n)?s=this._fieldDataCache.get(n).clause:r||(s=i.getWhereClause(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:s})),r?this.featureAdapter.getAttribute(e,n):s.calculateValue(e,this.featureAdapter)},e.prototype.validateItem=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:i.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)},e.prototype.validateItems=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:i.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)},e.prototype._processAttributesForOutFields=function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);for(var r={},i=0,n=t;i<n.length;i++){var s=n[i],a=this._fieldDataCache.get(s),o=a.alias,u=a.clause;r[o]=u?u.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,o)}return r},e.prototype._processAttributesForDistinctValues=function(e){if(r.isNone(e)||!this.returnDistinctValues)return e;var t=this.outFields,i=[];if(t)for(var n=0,s=t;n<s.length;n++){var a=s[n],o=this._fieldDataCache.get(a).alias;i.push(e[o])}else for(var o in e)i.push(e[o]);var u=(t||["*"]).join(",")+"="+i.join(","),l=this._returnDistinctMap.get(u)||0;return this._returnDistinctMap.set(u,++l),l>1?null:e},e}();t.default=n}.apply(null,i))||(e.exports=n)},721:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(4)],void 0===(n=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._deferreds=[],this._values=[]}return e.prototype.push=function(e){var t=this;return r.create((function(r,i){t._deferreds.push({resolve:r,reject:i}),t._values.push(e)}))},e.prototype.unshift=function(e){var t=this;return r.create((function(r,i){t._deferreds.unshift({resolve:r,reject:i}),t._values.unshift(e)}))},Object.defineProperty(e.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0}),e.prototype.process=function(){return 0!==this.length&&(this._deferreds.shift().resolve(this._values.shift()),!0)},e.prototype.cancelAll=function(){for(var e=r.createAbortError(),t=0,i=this._deferreds;t<i.length;t++)i[t].reject(e);this._deferreds.length=0,this._values.length=0},e}();t.PromiseQueue=i}.apply(null,i))||(e.exports=n)},860:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(7),r(15),r(5),r(338)],void 0===(n=function(e,t,r,i,n,s){Object.defineProperty(t,"__esModule",{value:!0}),t.createDrawingInfo=function(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.defaultPointSymbolJSON:"esriGeometryPolyline"===e?s.defaultPolylineSymbolJSON:s.defaultPolygonSymbolJSON}}},t.createDefaultAttributesFunction=function(e,t){if(i("csp-restrictions"))return function(){var i;return r(((i={})[t]=null,i),e)};try{var n="this."+t+" = null;";for(var s in e)n+="this."+s+" = "+JSON.stringify(e[s])+";";var a=new Function(n);return function(){return new a}}catch(i){return function(){var i;return r(((i={})[t]=null,i),e)}}},t.createDefaultTemplate=function(e){return void 0===e&&(e={}),[{name:"New Feature",description:"",prototype:{attributes:n.clone(e)}}]}}.apply(null,i))||(e.exports=n)}}]);