(function(){(this||window).webpackJsonp.registerAbsMids({"esri/core/sql/WhereClause":828,"esri/tasks/operations/PBFWorker":829,"esri/views/2d/engine/webgl/definitions":876,"esri/core/libs/gl-matrix-2/mat4":879,"esri/views/2d/engine/vectorTiles/GeometryUtils":881,"esri/tasks/operations/urlUtils":882,"esri/views/2d/layers/graphics/graphicsUtils":888,"esri/core/libs/gl-matrix-2/math/mat4":889,"esri/core/libs/gl-matrix-2/mat4f64":890,"esri/core/pbf":894,"esri/core/libs/gl-matrix-2/mat3f64":897,"esri/core/libs/gl-matrix-2/factories/mat3f64":898,"esri/geometry/support/aaBoundingBox":899,"esri/layers/graphics/data/attributeSupport":900,"esri/layers/graphics/data/utils":901,"esri/core/libs/gl-matrix-2/factories/mat4f64":904,"esri/tasks/operations/query":905,"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":907,"esri/views/3d/layers/support/FastSymbolUpdates":908,"esri/views/3d/support/debugFlags":909,"esri/views/2d/layers/features/support/AttributeStore":913,"dojo/regexp":915,"esri/tasks/operations/pbfQueryUtils":916,"esri/layers/graphics/centroid":917,"esri/layers/graphics/data/spatialQuerySupport":918,"esri/layers/graphics/data/timeSupport":922,"esri/layers/graphics/data/FeatureStore":938,"esri/layers/graphics/data/QueryEngine":939,"esri/core/ItemCache":940,"esri/layers/graphics/data/QueryEngineCapabilities":945,"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":958,"esri/core/sql/WhereClauseCache":959,"esri/layers/graphics/contains":960,"esri/layers/graphics/dehydratedFeatures":975,"esri/layers/graphics/dehydratedFeatureComparison":976,"esri/core/sql/AggregateFunctions":979,"esri/core/sql/StandardizedFunctions":980,"esri/core/sql/WhereGrammar":981,"esri/core/sql/sql92grammar":982,"esri/layers/graphics/data/QueryEngineResult":983,"esri/layers/graphics/data/AttributesBuilder":984,"esri/layers/support/PromiseQueue":985,"esri/tasks/operations/pbfFeatureServiceParser":1013,"esri/tasks/operations/pbfDehydratedFeatureSet":1014,"esri/tasks/operations/pbfOptimizedFeatureSet":1015,"esri/views/2d/layers/features/controllers/BaseController":1025,"esri/views/2d/layers/features/support/pixelBuffering":1026,"esri/layers/graphics/data/executeTileQuery":1147,"esri/views/2d/layers/features/support/TileUpdateQueue":1148,"esri/views/2d/layers/features/controllers/OnDemandController":2027,"esri/views/2d/layers/features/support/DataTile":2028,"esri/views/2d/layers/features/support/DataTileFeaturesIndex":2029,"esri/core/SetPool":2030,"esri/views/support/OrderedQueueProcessor":2031})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[44,4,5,38],{1013:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(11),r(9),r(894),r(1014),r(1015)],void 0===(i=function(e,t,r,n,i,a,o){function s(e){return e>=E.length?null:E[e]}function u(e){return e>=M.length?null:M[e]}function l(e){return e>=w.length?null:w[e]}function c(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function f(e,t,r){for(var n=t.createPointGeometry(r);e.next();)switch(e.tag()){case 3:for(var i=e.getUInt32(),a=e.pos()+i,o=0;e.pos()<a;)t.addCoordinatePoint(n,e.getSInt64(),0,o++);break;case 1:case 2:default:e.skip()}return n}function p(e,t,r){for(var n=t.createGeometry(r),i=2+(r.hasZ?1:0)+(r.hasM?1:0);e.next();)switch(e.tag()){case 2:for(var a=e.getUInt32(),o=e.pos()+a,s=0;e.pos()<o;)t.addLength(n,e.getUInt32(),s++);break;case 3:for(var u=e.getUInt32(),l=(o=e.pos()+u,0),c=0;e.pos()<o;)t.addCoordinate(n,e.getSInt64(),c,l),++l===i&&(c++,l=0);break;case 1:default:e.skip()}return n}function h(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function d(e){for(var t={type:s(0)};e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=s(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=u(e.getEnum());break;case 5:case 6:default:e.skip()}return t}function y(e,t,r,n){for(var i=t.createFeature(r),a=0;e.next();)switch(e.tag()){case 1:var o=n[a++].name;i.attributes[o]=e.processMessage(h);break;case 2:i.geometry=e.processMessageWithArgs(p,t,r);break;case 4:i.centroid=e.processMessageWithArgs(f,t,r);break;default:e.skip()}return i}function v(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function m(e){for(var t=[0,0,0,0];e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip()}return t}function g(e){for(var t={originPosition:l(0)};e.next();)switch(e.tag()){case 1:t.originPosition=l(e.getEnum());break;case 2:t.scale=e.processMessage(v);break;case 3:t.translate=e.processMessage(m);break;default:e.skip()}return t}function _(e){for(var t={};e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip()}return t}function b(e,t){for(var r=t.createSpatialReference();e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:case 3:case 4:default:e.skip()}return r}function I(e,t){var r=t.createFeatureResult();r.geometryType=c(t,0);for(var n=!1;e.next();)switch(e.tag()){case 1:r.objectIdFieldName=e.getString();break;case 3:r.globalIdFieldName=e.getString();break;case 4:r.geohashFieldName=e.getString();break;case 5:r.geometryProperties=e.processMessage(_);break;case 7:r.geometryType=c(t,e.getEnum());break;case 8:r.spatialReference=e.processMessageWithArgs(b,t);break;case 10:r.hasZ=e.getBool();break;case 11:r.hasM=e.getBool();break;case 12:r.transform=e.processMessage(g);break;case 9:var i=e.getBool();r.exceededTransferLimit=i;break;case 13:t.addField(r,e.processMessage(d));break;case 15:n||(t.prepareFeatures(r),n=!0),t.addFeature(r,e.processMessageWithArgs(y,t,r,r.fields));break;case 2:case 6:default:e.skip()}return t.finishFeatureResult(r),r}function x(e,t){for(var r={};e.next();)switch(e.tag()){case 1:r.featureResult=e.processMessageWithArgs(I,t);break;default:e.skip()}return r}function S(e){return e&&"dehydrated"===e.type?new a.Context(e):new o.Context(e)}Object.defineProperty(t,"__esModule",{value:!0});var T=n.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),E=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],M=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],w=["upperLeft","lowerLeft"];t.parseFeatureQuery=function(e,t){var n=S(t);try{for(var a=new i(new Uint8Array(e),new DataView(e)),o={};a.next();)switch(a.tag()){case 2:o.queryResult=a.processMessageWithArgs(x,n);break;default:a.skip()}return o}catch(e){var s=new r("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e});return T.error(s),{queryResult:{featureResult:n.createFeatureResult()}}}}}.apply(null,n))||(e.exports=i)},1014:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(73),r(34),r(26),r(975),r(117)],void 0===(i=function(e,t,r,n,i,a,o){function s(e,t,r,n){return t}function u(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return h(e,t+n,1)}}function l(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return h(e,t+n,1);case 2:return p(e,t,2)}}function c(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return h(e,t+n,1);case 2:return p(e,t,3)}}function f(e,t,r,n){switch(r){case 0:return p(e,t+n,0);case 1:return h(e,t+n,1);case 2:case 3:return p(e,t,3)}}function p(e,t,r){var n=e.translate,i=e.scale;return n[r]+t*i[r]}function h(e,t,r){var n=e.translate,i=e.scale;return n[r]-t*i[r]}Object.defineProperty(t,"__esModule",{value:!0});var d=function(){function e(e){this.options=e,this.geometryTypes=["point","multipoint","polyline","polygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=s,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}return e.prototype.createFeatureResult=function(){return new a.DehydratedFeatureSetClass},e.prototype.finishFeatureResult=function(e){this.options.applyTransform&&(e.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0},e.prototype.createSpatialReference=function(){return new i},e.prototype.addField=function(e,t){e.fields.push(o.fromJSON(t));var r=e.fields.map((function(e){return e.name}));this.AttributesConstructor=function(){for(var e=0,t=r;e<t.length;e++)this[t[e]]=null}},e.prototype.addFeature=function(e,t){var r=this.options.maxStringAttributeLength?this.options.maxStringAttributeLength:0;if(r>0)for(var n in t.attributes){var i=t.attributes[n];"string"==typeof i&&i.length>r&&(t.attributes[n]="")}e.features.push(t)},e.prototype.prepareFeatures=function(e){switch(this.options.applyTransform&&e.transform&&(this.transform=e.transform,this.applyTransform=this.deriveApplyTransform(e)),this.vertexDimension=2,e.hasZ&&this.vertexDimension++,e.hasM&&this.vertexDimension++,e.geometryType){case"point":this.addCoordinate=this.addCoordinatePoint.bind(this),this.createGeometry=this.createPointGeometry.bind(this);break;case"polygon":this.addCoordinate=this.addCoordinatePolygon.bind(this),this.createGeometry=this.createPolygonGeometry.bind(this);break;case"polyline":this.addCoordinate=this.addCoordinatePolyline.bind(this),this.createGeometry=this.createPolylineGeometry.bind(this);break;case"multipoint":this.addCoordinate=this.addCoordinateMultipoint.bind(this),this.createGeometry=this.createMultipointGeometry.bind(this);break;default:n.neverReached(e.geometryType)}},e.prototype.createFeature=function(e){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,new a.DehydratedFeatureClass(r.generateUID(),null,new this.AttributesConstructor)},e.prototype.addLength=function(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t)},e.prototype.createPointGeometry=function(e){var t={type:"point",x:0,y:0,spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM};return t.hasZ&&(t.z=0),t.hasM&&(t.m=0),t},e.prototype.addCoordinatePoint=function(e,t,r,n){switch(t=this.applyTransform(this.transform,t,n,0),n){case 0:e.x=t;break;case 1:e.y=t;break;case 2:e.hasZ?e.z=t:e.m=t;break;case 3:e.m=t}},e.prototype.transformPathLikeValue=function(e,t){var r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)},e.prototype.addCoordinatePolyline=function(e,t,r,n){this.dehydratedAddPointsCoordinate(e.paths,t,r,n)},e.prototype.addCoordinatePolygon=function(e,t,r,n){this.dehydratedAddPointsCoordinate(e.rings,t,r,n)},e.prototype.addCoordinateMultipoint=function(e,t,r){0===r&&e.points.push([]);var n=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(n)},e.prototype.createPolygonGeometry=function(e){return{type:"polygon",rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createPolylineGeometry=function(e){return{type:"polyline",paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.createMultipointGeometry=function(e){return{type:"multipoint",points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}},e.prototype.dehydratedAddPointsCoordinate=function(e,t,r,n){if(null===this.coordinateBuffer){var i=this.lengths.reduce((function(e,t){return e+t}),0);this.coordinateBuffer=new Float64Array(i*this.vertexDimension)}0===n&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);var a=this.transformPathLikeValue(t,n),o=e[e.length-1];0===n&&o.push(new Float64Array(this.coordinateBuffer.buffer,this.coordinateBufferPtr*Float64Array.BYTES_PER_ELEMENT,this.vertexDimension)),this.coordinateBuffer[this.coordinateBufferPtr++]=a},e.prototype.deriveApplyTransform=function(e){var t=e.hasZ,r=e.hasM;return t&&r?f:t?l:r?c:u},e}();t.Context=d}.apply(null,n))||(e.exports=i)},1015:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(884),r(893),r(877)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e){this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"]}return e.prototype.createFeatureResult=function(){return new n.default},e.prototype.prepareFeatures=function(){},e.prototype.finishFeatureResult=function(){},e.prototype.addFeature=function(e,t){e.features.push(t)},e.prototype.createFeature=function(){return new r.default},e.prototype.createSpatialReference=function(){return{wkid:0}},e.prototype.createGeometry=function(){return new i.default},e.prototype.addField=function(e,t){e.fields.push(t)},e.prototype.addCoordinate=function(e,t){e.coords.push(t)},e.prototype.addCoordinatePoint=function(e,t){e.coords.push(t)},e.prototype.addLength=function(e,t){e.lengths.push(t)},e.prototype.createPointGeometry=function(){return new i.default},e}();t.Context=a}.apply(null,n))||(e.exports=i)},1025:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(0),r(6),r(8),r(1),r(7),r(11),r(116),r(15),r(9),r(16),r(4),r(2),r(900),r(938),r(939),r(312),r(274),r(183),r(288),r(272),r(826),r(913),r(1026)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y,v,m,g,_,b,I,x,S,T){Object.defineProperty(t,"__esModule",{value:!0});var E=c.getLogger("esri.views.2d.layers.features.controllers.BaseController");t.needsGeometry=function(e,t){switch(e){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryMultipoint":return!0;case"esriGeometryPolygon":return function(e){var t=e&&e.getSymbols();return"backgroundFillSymbol"in e&&null!=e.backgroundFillSymbol||t.some((function(e){return"simple-fill"===e.type||"picture-fill"===e.type}))}(t);default:return E.error(new s("mapview-invalid-type",e+" is not supported")),!1}};var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._processingInMainThread=!1,t._availableFields=[],t._pixelBuffer=0,t.config=null,t.processor=null,t.remoteClient=null,t.service=null,t.tileStore=null,t.filters=new Array(x.definitions.MAX_FILTERS),t}return a(t,e),t.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))])},t.prototype.startup=function(){return i(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return this._initAttributeStore(),[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)];case 1:return e.sent(),[4,p.all([this.attributeStore.updateFilters(this),this.updatePixelBuffer()])];case 2:return e.sent(),[2]}}))}))},t.prototype.destroy=function(){this.attributeStore.destroy()},Object.defineProperty(t.prototype,"arcadeInfo",{get:function(){return{geometryType:this.service.geometryType,fields:this.service.fields,spatialReference:this.spatialReference}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldsIndex",{get:function(){return new g(this.service.fields)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"geometryInfo",{get:function(){return{geometryType:this.service.geometryType,hasZ:!1,hasM:!1}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"returnCentroid",{get:function(){return this._get("returnCentroid")||function(e,t,r){function n(e){if(!e)return!1;var t=e.type;return"simple-marker"===t||"picture-marker"===t||"text"===t||"web-style"===t||"cim"===t}if("esriGeometryPolygon"===t&&e.labelingInfo)return!0;if("esriGeometryPolygon"!==t)return!1;switch(r.type){case"simple":return n(r.symbol);case"unique-value":return n(r.defaultSymbol)||r.uniqueValueInfos.some((function(e){return n(e.symbol)}));case"class-breaks":return n(r.defaultSymbol)||r.classBreakInfos.some((function(e){return n(e.symbol)}));default:return!0}}(this.config,this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"queryInfo",{get:function(){var e=null;if("heatmap"!==this.renderer.type){var t=this.renderer.visualVariables;t&&t.some((function(t){if("size"===t.type&&t.field&&!t.normalizationField)return e=[t.field+" DESC"],!0}))}return{returnCentroid:this.returnCentroid,returnGeometry:!0,outFields:this.availableFields,orderByFields:e,definitionExpression:this.config.definitionExpression,gdbVersion:this.config.gdbVersion,historicMoment:this.config.historicMoment}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this.config?_.fromJSON(this.config.renderer):(E.error("mapview-controller","Unable to create renderer for undefined configuration"),null)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return m.fromWorker(this.config.processing)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availableFields",{get:function(){var e=this,t=this.config.availableFields.filter((function(t){return-1===e._availableFields.indexOf(t)}));return this._availableFields=this._availableFields.concat(t),this._availableFields},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"viewParams",{get:function(){return{viewingMode:"",scale:this.viewState&&this.viewState.scale||1}},enumerable:!0,configurable:!0}),t.prototype.getObjectId=function(e){return this.attributeStore.getFeatureId(e)},t.prototype.getLocalId=function(e){return this.attributeStore.getLocalId(e)},t.prototype.mapValidLocalIds=function(e){var t=this;return e.map((function(e){return t.attributeStore.getLocalId(e)})).filter((function(e){return null!=e}))},t.prototype.setViewState=function(e){this._set("viewState",e)},t.prototype.updatePixelBuffer=function(){return i(this,void 0,void 0,(function(){var e;return n(this,(function(t){switch(t.label){case 0:return[4,T.computePxBuffer(this.renderer,this.service.geometryType)];case 1:return e=t.sent(),this._pixelBuffer=Math.max(this._pixelBuffer,e),[2]}}))}))},t.prototype.setHighlight=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){return[2,this.attributeStore.setHighlight(e)]}))}))},t.prototype.validateConfig=function(e,t){for(var r=0,n=e.filters;r<n.length;r++){var i=n[r];if(f.isSome(i)&&i.where)try{d.validateWhere(this.fieldsIndex,i.where)}catch(e){throw new s("mapview-bad-filter",e.message,{filter:i,missingFields:e.details})}}},t.prototype.onFeatureAdd=function(e){e.localId=this.attributeStore.createLocalId(e.objectId),this.attributeStore.setAttributeData(e.localId,e,this.geometryInfo,this.viewParams)},t.prototype.onFeatureRemove=function(e){!e.localId&&l("esri-2d-debug")&&console.debug("Feature must have localId"),this.attributeStore.freeLocalId(e.objectId)},t.prototype.enableEvent=function(e){},t.prototype._initAttributeStore=function(){var e=this;this.attributeStore=new S.default(o({type:"remote"},"heatmap"===this.renderer.type?{initialize:function(e,t){return p.resolve()},update:function(e,t){return p.resolve()},render:function(){return p.resolve()}}:{initialize:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",t,{signal:r})},update:function(t,r){return e.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",t,{signal:r})},render:function(){return e.remoteClient.invoke("tileRenderer.featuresView.requestRender")}}))},t.prototype._createQueryEngine=function(e){void 0===e&&(e=this._createFeatureStore());var t=this.queryInfo,r=t.definitionExpression,n=t.gdbVersion,i=t.historicMoment;return new v.default({definitionExpression:r,fields:this.service.fields,geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,gdbVersion:n,historicMoment:null!=i&&new Date(i),featureStore:e,timeInfo:this.service.timeInfo})},t.prototype._createTempQueryEngine=function(e){return void 0===e&&(e=this._createFeatureStore(!1)),this._createQueryEngine(e)},t.prototype._createFeatureStore=function(e){void 0===e&&(e=!0);var t={geometryType:this.service.geometryType,hasM:!1,hasZ:!1};if(e){var r=this.onFeatureAdd.bind(this),n=this.onFeatureRemove.bind(this);return new y.default(t,r,n)}return new y.default(t)},t.prototype._createDefaultQuery=function(e){var t=this,r=new I;r.outSpatialReference=this.spatialReference;var n=e.outFields,i=e.orderByFields,a=this.config,o=a.gdbVersion,s=a.historicMoment,u=a.definitionExpression;return this.processing&&(n=n&&n.filter((function(e){return!t.processing.getField(e)})),i=i&&i.filter((function(e){return!t.processing.getField(e)}))),n=n.length/this.service.fields.length>=.75?["*"]:n,r.gdbVersion=o,r.historicMoment=null!=s?new Date(s):null,r.outFields=n,r.where=u||"1=1",r.returnGeometry=e.returnGeometry,r.returnCentroid=e.returnCentroid,r.orderByFields=i,r.start=e.resultOffset,r.num=e.num,r},t.prototype._createQuery=function(e,t,r,n,i,a){var o=this.service.geometryType,s=this._createDefaultQuery(n);return s.maxRecordCountFactor=i,s.returnExceededLimitFeatures=a,s.resultType="tile",s.geometry=e,this.service.capabilities.query.supportsQuantization?(s.quantizationParameters=new b.default({mode:"view",originPosition:"upper-left",tolerance:r,extent:t}),"esriGeometryPolyline"===o&&(s.maxAllowableOffset=r)):"esriGeometryPolyline"!==o&&"esriGeometryPolygon"!==o||(s.maxAllowableOffset=r),s},t.prototype._applyProcessing=function(e,t){var r=this.processing;if(!r)return p.resolve(e);if(this._processingInMainThread)return this.remoteClient.invoke("executeProcessing",{featureSet:e},t);try{var n=r.process(e,r.options);return n?"then"in n?n:p.resolve(n):p.reject(new s("FeatureLayer","invalid processing.process() method, returns nothing"))}catch(r){return this._processingInMainThread=!0,this.remoteClient.invoke("executeProcessing",{featureSet:e},t)}},t.prototype.hasGeometryFilter=function(){return this.filters.some((function(e){return f.isSome(e)&&!!e.geometry}))},r([h.property({readOnly:!0,dependsOn:["config","service","spatialReference"]})],t.prototype,"arcadeInfo",null),r([h.property()],t.prototype,"config",void 0),r([h.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"fieldsIndex",null),r([h.property({readOnly:!0,dependsOn:["service"]})],t.prototype,"geometryInfo",null),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"returnCentroid",null),r([h.property({readOnly:!0,dependsOn:["config","availableFields"]})],t.prototype,"queryInfo",null),r([h.property({dependsOn:["config"],readOnly:!0})],t.prototype,"renderer",null),r([h.property()],t.prototype,"processor",void 0),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"processing",null),r([h.property({readOnly:!0,dependsOn:["config"]})],t.prototype,"availableFields",null),r([h.property({constructOnly:!0})],t.prototype,"remoteClient",void 0),r([h.property({constructOnly:!0})],t.prototype,"service",void 0),r([h.property({dependsOn:["tileStore"]})],t.prototype,"spatialReference",null),r([h.property({constructOnly:!0})],t.prototype,"tileInfo",void 0),r([h.property({constructOnly:!0})],t.prototype,"tileStore",void 0),r([h.property()],t.prototype,"filters",void 0),r([h.property({readOnly:!0})],t.prototype,"viewState",void 0),r([h.property({readOnly:!0,dependsOn:["viewState"]})],t.prototype,"viewParams",null),r([h.subclass("esri.views.2d.layers.features.controllers.BaseController")],t)}(h.declared(u.HandleOwner));t.default=M}.apply(null,n))||(e.exports=i)},1026:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(4),r(19),r(826),r(888)],void 0===(i=function(e,t,r,n,i,a,o,s){function u(e,t){return null==e?t:e}function l(e,t){return null==e.outline?t:u(e.outline.width,t)}function c(e,t){return n(this,void 0,void 0,(function(){var n,i,a,f,h,d,_,b,I,x,S;return r(this,(function(r){switch(r.label){case 0:return"simple-marker"===e.type?(n=Math.max(u(e.size,12),t),[2,p(e)+n*y]):"picture-marker"===e.type?(i=Math.max(u(e.height,12),t),a=u(e.width,12)*(i/u(e.height,12)),f=a/2,h=i/2,[2,p(e)+Math.sqrt(f*f+h*h)]):"text"===e.type?(s.getTextSymbolEstimatedSize(v,e,o.definitions.AVERAGE_GLYPH_MOSAIC_ITEM),d=v[2]*(u(e.horizontalAlignment,"top")in m?1:.5),_=v[3]*(u(e.horizontalAlignment,"center")in g?1:.5),b=function(e,t){return null==e.font?t:u(e.font.size,t)}(e,9),I=Math.max(b,t)/b,[2,p(e)+Math.sqrt(d*d+_*_)*I]):"simple-line"===e.type?[2,Math.max(u(e.width,.75),t)/2]:"simple-fill"===e.type||"picture-fill"===e.type?[2,Math.max(l(e,.75),t)/2]:"cim"===e.type?(x=o.CIMSymbolHelper.getEnvelope(e.data))?[2,Math.sqrt(x.width*x.width+x.height*x.height)]:[2,0]:"web-style"!==e.type?[3,2]:(S=c,[4,e.fetchCIMSymbol()]);case 1:return[2,S.apply(void 0,[r.sent(),t])];case 2:return[2,void 0]}}))}))}function f(e,t){return n(this,void 0,void 0,(function(){var n,i,a,o,s;return r(this,(function(r){switch(r.label){case 0:return function(e){return e.type in d}(e)?(i=(n=Math).min,o=(a=Math).max,s=[5],[4,c(e,t)]):[2,0];case 1:return[2,i.apply(n,[o.apply(a,s.concat([r.sent()])),75])]}}))}))}function p(e){var t=u(e.xoffset,0),r=u(e.yoffset,0);return Math.sqrt(t*t+r*r)}function h(e,t){return Math.max(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var d={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,"picture-fill":1,cim:1,"web-style":1},y=.707;t.computePxBuffer=function(e,t){return n(this,void 0,void 0,(function(){var n,o,s,u,l,c,p;return r(this,(function(r){switch(r.label){case 0:if("heatmap"===e.type)return[2,Math.round(3*e.blurRadius)];if("dot-density"===e.type)return[2,0];if("dictionary"===e.type)return"esriGeometryPoint"===t||"esriGeometryMultipoint"===t?[2,100]:[2,50];for(n=e.getSymbols(),o=function(e){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;var t=e.getVisualVariablesForType("size");if(!t[0])return 0;var r=t[0];return"stops"===r.transformationType?r.stops.map((function(e){return e.size})).reduce(h,0):"clamped-linear"===r.transformationType?"number"==typeof r.maxSize?r.maxSize:r.maxSize.stops.map((function(e){return e.size})).reduce(h,0):"real-world-size"===r.transformationType?30:void 0}(e),s=[],u=0,l=n;u<l.length;u++)c=l[u],s.push(f(c,o));return[4,i.all(s)];case 1:return p=r.sent(),[2,a.pt2px(p.reduce(h,0))]}}))}))};var v=[0,0,0,0],m={left:1,right:1},g={top:1,bottom:1,baseline:1}}.apply(null,n))||(e.exports=i)},1147:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(6),r(8),r(168),r(37),r(939),r(901)],void 0===(i=function(e,t,r,n,i,a,o,s,u){function l(e,t,r,n,i,a,o,l){o&&!a?n.forEachInBounds(i,(function(n){if(!t.has(n.objectId)){var i=u.getCentroid(r,n,l),a=n.attributes;i&&(t.add(n.objectId),e.push(new s.Feature(a,n.localId,null,i)))}})):a&&!o?n.forEachInBounds(i,(function(n){if(!t.has(n.objectId)){var i=n.attributes,a=u.getGeometry(r,n,0,l);a&&(t.add(n.objectId),e.push(new s.Feature(i,n.localId,a,null)))}})):n.forEachInBounds(i,(function(n){if(!t.has(n.objectId)){var i=n.attributes,a=u.getGeometry(r,n,0,l),o=u.getCentroid(r,n,l);a&&o&&(t.add(n.objectId),e.push(new s.Feature(i,n.localId,a,o)))}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.executeTileQueryForIds=function(e,t,r){var n=r.pixelBuffer*t.resolution,i=a.pad(t.bounds,n,a.create()),o=[];return e.featureStore.forEachInBounds(i,(function(t){return o.push(e.featureAdapter.getObjectId(t))})),o},t.executeTileQuery=function(e,t,r){var n=r.returnGeometry,i=r.returnCentroid,s=r.pixelBuffer,u=new Set,c=[],f=s*t.resolution,p=a.pad(t.bounds,f,a.create());if(l(c,u,e,e.featureStore,p,n,i,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]}),"esriGeometryPoint"===e.geometryType||i){var h=o.getInfo(e.spatialReference);if(h){var d=h.valid,y=d[0],v=d[1];if(p[0]<y){var m=a.fromValues(v-f,p[1],v,p[3]);l(c,u,e,e.featureStore,m,n,i,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[v,t.bounds[3]]})}if(p[2]>v){var g=a.fromValues(y,p[1],y+f,p[3]);l(c,u,e,e.featureStore,g,n,i,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[y-v+t.bounds[0],t.bounds[3]]})}}}return c.sort((function(t,r){return t.attributes[e.objectIdField]-r.attributes[e.objectIdField]})),{features:c,objectIds:u}}}.apply(null,n))||(e.exports=i)},1148:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(0),r(6),r(8),r(10),r(4),r(29),r(2),r(74),r(305)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f){Object.defineProperty(t,"__esModule",{value:!0});var p=[0,0],h=function(e){function t(t){var r=e.call(this,t)||this;return r._queue=new Map,r._isPaused=!1,r._scheduledNextHandle=null,r._timestamp=Date.now(),r.tileInfoView=null,r._next=r._next.bind(r),r._finalize=r._finalize.bind(r),r}return r(t,e),Object.defineProperty(t.prototype,"length",{get:function(){return this._queue.size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updating",{get:function(){return this._queue.size>0||null!=this._onGoingTile},enumerable:!0,configurable:!0}),t.prototype.abort=function(e){this._onGoingTile&&this._onGoingTile.tileId===e&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null),this._queue.delete(e),this._scheduleNext(),this.notifyChange("updating")},t.prototype.clear=function(){this._queue.clear(),this._onGoingTile&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null),this._cancelNext(),this.notifyChange("updating")},t.prototype.has=function(e){return this._queue.has(e)},t.prototype.isOngoing=function(e){return this._onGoingTile&&this._onGoingTile.tileId===e},t.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())},t.prototype.push=function(e,t){if(!this._queue.has(e)){var r=s.createAbortController();this._queue.set(e,{tileId:e,key:f.TileKey.pool.acquire(e),timestamp:t||this._timestamp,abortController:r}),this._scheduleNext(),this.notifyChange("updating")}},t.prototype.refresh=function(){this._timestamp=Date.now(),this.reset()},t.prototype.reset=function(){var e=this._onGoingTile;if(e){var t=e.tileId;this.push(t,this._timestamp)}this.notifyChange("updating")},t.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext()),this.notifyChange("updating")},t.prototype._finalize=function(){this._onGoingTile=null,this.notifyChange("updating"),this._scheduleNext()},t.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},t.prototype._scheduleNext=function(){this._isPaused||this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingTile||(this._scheduledNextHandle=u.schedule(this._next))},t.prototype._next=function(){return a(this,void 0,void 0,(function(){var e,t,r,n,a;return i(this,(function(i){switch(i.label){case 0:if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingTile)return this._scheduledNextHandle=null,[2];if(this._scheduledNextHandle=null,e=this._peek(),t=e.abortController.signal,r=e.tileId,n=e.key,f.TileKey.pool.release(n),this._queue.delete(r),this._onGoingTile=e,a=this.process(r,this._timestamp,{signal:t}),this.notifyChange("updating"),!function(e){return e&&"function"==typeof e.then}(a))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,a];case 2:return i.sent(),[3,4];case 3:return i.sent(),[3,4];case 4:return this._finalize(),[2]}}))}))},t.prototype._peek=function(){var e=this;if(!this.state)throw new Error("state not set");var t=this.tileInfoView,r=this.state.center,n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=null;return this._queue.forEach((function(o,s){t.getTileCoords(p,o.key);var u=e._timestamp-o.timestamp;if(isNaN(u))(l=c.vec2.distance(p,r))<i&&(i=l,a=o);else if(u===n){var l;(l=c.vec2.distance(p,r))<i&&(i=l,a=o)}else u>n&&(n=u,i=Number.POSITIVE_INFINITY,a=o)})),a},n([l.property({readOnly:!0})],t.prototype,"length",null),n([l.property({constructOnly:!0})],t.prototype,"process",void 0),n([l.property()],t.prototype,"state",void 0),n([l.property({constructOnly:!0})],t.prototype,"tileInfoView",void 0),n([l.property({readOnly:!0})],t.prototype,"updating",null),n([l.subclass("esri.views.2d.layers.features.support.TileUpdateQueue")],t)}(l.declared(o));t.default=h}.apply(null,n))||(e.exports=i)},2027:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(0),r(7),r(6),r(8),r(95),r(45),r(11),r(15),r(9),r(4),r(2),r(28),r(880),r(1147),r(905),r(826),r(1025),r(2028),r(2029),r(921),r(1148),r(306),r(2031)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y,v,m,g,_,b,I,x,S,T,E){Object.defineProperty(t,"__esModule",{value:!0});var M=f.getLogger("esri.views.2d.layers.features.controllers.OnDemandController"),w=c("esri-featurelayer-webgl"),F=c("esri-mobile"),N={maxDrillLevel:w&&"object"==typeof w&&null!=w.maxDrillLevel?w.maxDrillLevel:F?1:4,maxRecordCountFactor:w&&"object"==typeof w&&null!=w.maxRecordCountFactor?w.maxRecordCountFactor:F?1:3,enablePBFQuery:!w||"object"!=typeof w||null==w.enablePBFQuery||w.enablePBFQuery},A=new Set,R=[],O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="on-demand",t._queryInfoHash=null,t._dataTileIndex=new I.default,t._editsQueue=new E.OrderedQueueProcessor({concurrency:1,process:function(e,r){return t._processEditsEvent(e,r)}}),t._featuresInFlight=new Map,t}return r(t,e),t.prototype.initialize=function(){var e=this;this._set("queryEngine",this._createQueryEngine()),this._set("featureStore",this.queryEngine.featureStore),this._dataTileIndex.featureStore=this.featureStore,this._dataTileIndex.forEach((function(e){return e.done=!1})),this._fetchQueue=new T({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(t,r){return e._fetchTile(t,e.queryInfo,r)}}),this._patchQueue=new T({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(t,r){return e._fetchTile(t.dataTile,t.queryInfo,r)}}),this._updateQueue=new S.default({tileInfoView:this.tileStore.tileScheme,process:function(t,r,n){return e._updateTile(t,r,n)}})},t.prototype.destroy=function(){this._fetchQueue.clear(),this._patchQueue.clear(),this._updateQueue.clear(),this._editsQueue.destroy(),this.queryEngine.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){return!this.viewState||this._fetchQueue.updating||this._patchQueue.updating||this._updateQueue.updating},enumerable:!0,configurable:!0}),t.prototype.update=function(e,t){return o(this,void 0,void 0,(function(){var r,n,i=this;return a(this,(function(a){switch(a.label){case 0:return this.validateConfig(e,t),r=this.renderer.getAttributeHash(),n=e.availableFields.filter((function(e){return-1===i.availableFields.indexOf(e)})),this._set("config",e),[4,this.updatePixelBuffer()];case 1:return a.sent(),t?r===this.renderer.getAttributeHash()?[3,3]:[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,5];case 2:a.sent(),a.label=3;case 3:return[4,this.attributeStore.updateFilters(this)];case 4:return a.sent(),this.refresh(),[2];case 5:return n.length?[4,this._handleAttributeChange(n)]:[3,7];case 6:a.sent(),a.label=7;case 7:return"heatmap"===this.renderer.type?[2]:r===this.renderer.getAttributeHash()?[3,9]:[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)];case 8:a.sent(),this.featureStore.forEach((function(e){return i.attributeStore.setAttributeData(e.localId,e,i.geometryInfo,i.viewParams)})),a.label=9;case 9:return[4,this.attributeStore.updateFilters(this)];case 10:return a.sent(),[4,this.attributeStore.sendUpdates()];case 11:return a.sent(),[2]}}))}))},t.prototype.invalidate=function(){for(var e=0,t=this.tileStore.tiles;e<t.length;e++){var r=t[e];this._updateQueue.push(r.id,Date.now())}},t.prototype.onEdits=function(e){var t=this;this._fetchQueue.pause(),this._fetchQueue.reset(),this._editsQueue.push(e).then((function(){0===t._editsQueue.length&&t._fetchQueue.resume()}))},t.prototype.queryFeatures=function(e){return u.safeCast(this.queryEngine.executeQuery(e))},t.prototype.queryFeatureCount=function(e){return u.safeCast(this.queryEngine.executeQueryForCount(e))},t.prototype.queryObjectIds=function(e){return u.safeCast(this.queryEngine.executeQueryForIds(e))},t.prototype.queryExtent=function(e){return u.safeCast(this.queryEngine.executeQueryForExtent(e))},t.prototype.redraw=function(){this._updateQueue.pause(),this._manageTiles(this.tileStore.tiles),this._updateQueue.resume()},t.prototype.refresh=function(){this._queryInfoHash=Math.random().toString(),this.queryEngine&&this.queryEngine.destroy(),this.featureStore&&this.featureStore.clear(),this._set("queryEngine",this._createQueryEngine()),this._set("featureStore",this.queryEngine.featureStore),this._dataTileIndex.featureStore=this.featureStore,this._dataTileIndex.forEach((function(e){return e.done=!1})),this._editsQueue.pause(),this._fetchQueue.pause(),this._updateQueue.pause(),this._editsQueue.clear(),this._fetchQueue.clear(),this._updateQueue.clear(),this._manageTiles(this.tileStore.tiles),this._fetchQueue.resume(),this._editsQueue.resume(),this._updateQueue.resume()},t.prototype.setViewState=function(e){var t=this,r=this.viewState&&this.viewState.scale;this.inherited(arguments),this._fetchQueue.state=e,this._updateQueue.state=e,r!==this.viewState.scale&&this.attributeStore.hasScaleExpr&&(this.featureStore.forEach((function(e){return t.attributeStore.setAttributeData(e.localId,e,t.geometryInfo,t.viewParams)})),this.attributeStore.sendUpdates())},t.prototype.onTileUpdate=function(e){this._manageTiles(e.added,e.removed)},t.prototype.onFeatureAdd=function(e){if(this._featuresInFlight.has(e.objectId)){var t=this._featuresInFlight.get(e.objectId).attributes;e.attributes=i({},t,e.attributes),this._featuresInFlight.delete(e.objectId)}e.localId=this.attributeStore.createLocalId(e.objectId),this.attributeStore.setAttributeData(e.localId,e,this.geometryInfo,this.viewParams)},t.prototype._handleAttributeChange=function(e){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this._fetchChangedFields(e)];case 1:return t.sent(),[2]}}))}))},t.prototype._fetchChangedTileFields=function(e,t){return o(this,void 0,void 0,(function(){var r;return a(this,(function(n){return(r=this._dataTileIndex.get(e.id))?(!1,[2,this._fetchChangedTileFieldsDrill(r,t)]):[2]}))}))},t.prototype._fetchChangedTileFieldsDrill=function(e,t,r){return void 0===r&&(r=0),o(this,void 0,void 0,(function(){var n,o,s,u,l,c,f,h,d,y,v=this;return a(this,(function(a){switch(a.label){case 0:return n=i({},this.queryInfo,{returnGeometry:!1,returnCentroid:!1,outFields:t.concat([this.service.objectIdField])}),e.returnExceeded=e.returnExceeded||r>=N.maxDrillLevel,o=e.key,s={key:o,dataTile:e,queryInfo:n},[4,this._patchQueue.push(s)];case 1:return(u=a.sent()).exceededTransferLimit&&r<N.maxDrillLevel?(l=e.tile.createChildTiles(),c=l.map((function(t){var r=new b.default;return r.tile=t,r.displayTile=e.displayTile,r})),[4,p.all(c.map((function(e){return v._fetchChangedTileFieldsDrill(e,t,r+1)})))]):[3,3];case 2:return a.sent(),[2];case 3:for(f=0,h=u.features;f<h.length;f++)d=h[f],this.featureStore.has(d.objectId)?(y=this.featureStore.getFeature(d.objectId)).attributes=i({},y.attributes,d.attributes):this._featuresInFlight.set(d.objectId,d);return[2]}}))}))},t.prototype._fetchChangedTileFieldsPaged=function(e,t,r){return void 0===r&&(r=0),o(this,void 0,void 0,(function(){var n,o,s,u,l,c,f,p,h,d,y;return a(this,(function(a){switch(a.label){case 0:return n=this.service.capabilities.query.supportsMaxRecordCountFactor,o=this.service.tileMaxRecordCount,s=o*(n?1:N.maxRecordCountFactor),u=i({},this.queryInfo,{returnGeometry:!1,returnCentroid:!1,outFields:t.concat([this.service.objectIdField]),resultOffset:r*s,num:s}),e.returnExceeded=!0,l=e.key,c={key:l,dataTile:e,queryInfo:u},[4,this._patchQueue.push(c)];case 1:for(f=a.sent(),p=0,h=f.features;p<h.length;p++)d=h[p],this.featureStore.has(d.objectId)?(y=this.featureStore.getFeature(d.objectId)).attributes=i({},y.attributes,d.attributes):this._featuresInFlight.set(d.objectId,d);return f.exceededTransferLimit?[2,this._fetchChangedTileFieldsPaged(e,t,r+1)]:[2]}}))}))},t.prototype._fetchChangedFields=function(e){return o(this,void 0,void 0,(function(){var t,r,n=this;return a(this,(function(i){switch(i.label){case 0:return t=this.tileStore.tiles,r=t.map((function(t){return n._fetchChangedTileFields(t,e)})),[4,p.all(r)];case 1:return i.sent(),[2]}}))}))},t.prototype._manageTiles=function(e,t){void 0===t&&(t=null);for(var r=this._dataTileIndex,n=this._fetchQueue,i=this._updateQueue,a="esriGeometryPoint"===this.service.geometryType,o=this,s=0,u=e;s<u.length;s++){!function(e){var t=r.get(e.id);t?(t.displayTile=e,a?r.forEach((function(r){x.isChildOf(r,t)&&(r.displayTile=e)})):t.done=!1):((t=new b.default).tile=e.clone(),t.displayTile=e,r.add(t)),o._processDataTile(t)}(f=u[s])}if(t)for(var l=0,c=t;l<c.length;l++){var f=c[l];A.add(f),i.abort(f.id)}r.forEach((function(e){A.has(e.displayTile)&&R.push(e)}));for(var p=0,h=R;p<h.length;p++){var d=h[p];n.abort(d.id),r.delete(d)}R.length=0,A.clear()},t.prototype._processDataTile=function(e){var t=this,r=e.displayTile,n=e.key,i=this._dataTileIndex,a=this._fetchQueue,o=n.id,s=this._queryInfoHash,u=n.level-r.key.level>=N.maxDrillLevel;if(i.add(e),e.done||a.has(o)){if(e.queryInfoHash!==s||e.returnExceeded!==u)if(e.done)e.done=!1;else{if(!a.isOngoing(o))return e.queryInfoHash=s,void(e.returnExceeded=u);a.abort(o)}}else e.queryInfoHash=s,e.returnExceeded=u;e.done?this._invalidateTile(e.displayTile):a.has(o)||a.push(e).then((function(r){return t._handleResponse(e,r)})).catch((function(r){p.isAbortError(r)||M.error(new l("featurelayer-controller:tile-error","Encountered an error when handling tile response",r)),e.done=!0,t._invalidateTile(e.displayTile)}))},t.prototype._handleResponse=function(e,t){if(e.done=!0,y.hydrateOptimizedFeatureSet(t),t.exceededTransferLimit)if(e.returnExceeded)this._dataTileIndex.setTileFeatures(e,t.features),this._deleteChildrenDataTiles(e);else{for(var r=e.tile.createChildTiles(),n=0,i=r;n<i.length;n++){var a=i[n],o=new b.default;o.tile=a,o.displayTile=e.displayTile,this._processDataTile(o)}s.release(r)}else this._dataTileIndex.setTileFeatures(e,t.features),this._deleteChildrenDataTiles(e);this._invalidateTile(e.tile),this.attributeStore.sendUpdates()},t.prototype._deleteChildrenDataTiles=function(e){this._dataTileIndex.forEach((function(t){x.isChildOf(t,e)&&R.push(t)}));for(var t=0,r=R;t<r.length;t++){var n=r[t];this._fetchQueue.abort(n.id),this._dataTileIndex.delete(n)}R.length=0},t.prototype._fetchTile=function(e,t,r){return o(this,void 0,void 0,(function(){var n,i,o,s,u,l,c,f,p,h=this;return a(this,(function(a){return n=new d({xmin:e.bounds[0],ymin:e.bounds[1],xmax:e.bounds[2],ymax:e.bounds[3],spatialReference:this.spatialReference}),i="esriGeometryPoint"===this.service.geometryType?e.tile:e.displayTile,o=i.extent,s=i.resolution,u=e.returnExceeded,l=this._createQuery(n,o,s,t,N.maxRecordCountFactor,u),c=this.service.source,f=N.enablePBFQuery&&this.service.capabilities.query.supportsFormatPBF,p=r.signal,[2,f?m.executeQueryPBF(c,l,{type:"optimized"},{signal:p}).then((function(e){return e.data})):m.executeQuery(c,l,{signal:p}).then((function(e){return y.convertFromFeatureSet(e.data,h.service.objectIdField)}))]}))}))},t.prototype._invalidateTile=function(e){for(var t=this._pixelBuffer,r=this._updateQueue,n=0,i=this.tileStore.intersections(e,t);n<i.length;n++){var a=i[n].tile;r.push(a.id,a.updateTimestamp)}},t.prototype._updateTile=function(e,t,r){var n=this,i=this.tileStore.get(e),a=this.queryInfo,o=a.returnCentroid,s=a.returnGeometry,u={pixelBuffer:this._pixelBuffer,returnGeometry:s,returnCentroid:o},l=v.executeTileQuery(this.queryEngine,i,u),c=l.features,f=l.objectIds,h={geometryType:this.service.geometryType,features:c,fields:this.service.fields,objectIdFieldName:this.service.objectIdField,transform:i.transform};return this._applyProcessing(h,r).then((function(e){var a=[],o=!0;return n._dataTileIndex.forEach((function(e){i.id!==e.id&&x.isChildOf(e,i)&&o&&!e.done&&(o=!1)})),o&&i&&i.objectIds.forEach((function(e){if(!f.has(e)){var t=n.attributeStore.getLocalId(e);a.push(t)}})),f.forEach((function(e){i.objectIds.add(e)})),i.updateTimestamp=t,n.attributeStore.sendUpdates(),n.processor.onTileData(i,{clear:!0,addOrUpdate:e.features,remove:a,transformParams:g.Utils.getTransformParams(e)},r).catch((function(e){p.isAbortError(e)||M.error("update-tile",e)}))}))},t.prototype._processEditsEvent=function(e,t){return o(this,void 0,void 0,(function(){var r,n,o,s,u,l,c,f=this;return a(this,(function(a){switch(a.label){case 0:return r=function(e){return e.objectId},n=e.addedFeatures.concat(e.updatedFeatures).map(r),o=e.deletedFeatures.map(r),s=this._createTempQueryEngine(),u=this._createObjectIdsQuery(n),n.length?[4,m.executeQuery(this.service.source,u)]:[3,2];case 1:l=a.sent().data,c=y.convertFromFeatureSet(l,this.service.objectIdField).features,this._dataTileIndex.addOrUpdateFeatures(c),s.featureStore.addMany(c),a.label=2;case 2:return this._dataTileIndex.deleteFeaturesById(o),this.attributeStore.sendUpdates(),this.tileStore.tiles.map((function(e){var r=v.executeTileQuery(s,e,i({},f.queryInfo,{pixelBuffer:f._pixelBuffer})).features,a=o.concat(n).map((function(e){return f.attributeStore.getLocalId(e)})),u={transform:e.transform,hasZ:!1,hasM:!1};return f.processor.onTileData(e,{addOrUpdate:r,remove:a,transformParams:u},{signal:t}).catch((function(e){p.isAbortError(e)||M.error("update-tile",e)}))})),s.destroy(),[2]}}))}))},t.prototype._createObjectIdsQuery=function(e){var t=this._createDefaultQuery(this.queryInfo);return t.objectIds=e,t},n([h.property()],t.prototype,"_fetchQueue",void 0),n([h.property()],t.prototype,"_patchQueue",void 0),n([h.property()],t.prototype,"_updateQueue",void 0),n([h.property({readOnly:!0})],t.prototype,"queryEngine",void 0),n([h.property({readOnly:!0})],t.prototype,"featureStore",void 0),n([h.property({dependsOn:["viewState","_fetchQueue.updating","_updateQueue.updating","_patchQueue.updating"]})],t.prototype,"updating",null),n([h.subclass("esri.views.2d.layers.features.controllers.OnDemandController")],t)}(h.declared(_.default));t.default=O}.apply(null,n))||(e.exports=i)},2028:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.displayTile=null,this.tile=null,this.done=!1,this.queryInfoHash=null,this.returnExceeded=!1}return Object.defineProperty(e.prototype,"key",{get:function(){return this.tile.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.tile.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.tile.bounds},enumerable:!0,configurable:!0}),e}();t.default=r}.apply(null,n))||(e.exports=i)},2029:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2030),r(938),r(921)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var a=[],o=new Set,s=function(){function e(){this._tileById=new Map,this._tilesToFeatures=new Map,this._featureToTiles=new Map}return e.prototype.destroy=function(){this.clear()},e.prototype.add=function(e){var t=this;if(!this.has(e.id)){var n=e;this._tileById.set(n.id,n),this._tilesToFeatures.set(n,r.default.acquire()),this._tilesToFeatures.forEach((function(e,r){n!==r&&(i.isParentOf(n,r)?e.forEach((function(e){t._link(n,e)})):i.isChildOf(n,r)&&t.featureStore.forEachInBounds(n.bounds,(function(r){e.has(r.objectId)&&t._link(n,r.objectId)})))}))}},e.prototype.clear=function(){this._tilesToFeatures.forEach((function(e){return r.default.release(e)})),this._tilesToFeatures.clear(),this._featureToTiles.forEach((function(e){return r.default.release(e)})),this._featureToTiles.clear(),this._tileById.clear()},e.prototype.delete=function(e){var t=this,r=this.get(e.id);a.length=0,this._tilesToFeatures.get(r).forEach((function(e){var n=t._featureToTiles.get(e);n.has(r)&&1===n.size?a.push(e):t._unlink(r,e)}));for(var n=0,i=a;n<i.length;n++){var o=i[n];this._unlink(r,o)}this.featureStore.removeManyById(a),this._tilesToFeatures.delete(r),this._tileById.delete(r.id),a.length=0},e.prototype.forEach=function(e,t){return this._tileById.forEach(e,t)},e.prototype.get=function(e){return this._tileById.get(e)},e.prototype.has=function(e){return this._tileById.has(e)},e.prototype.setTileFeatures=function(e,t){var n=this,i=this.get(e.id);this._tilesToFeatures.has(i)||(this._tileById.set(i.id,i),this._tilesToFeatures.set(i,r.default.acquire()));for(var s=0,u=t;s<u.length;s++){var l=u[s];o.add(l.objectId)}a.length=0,this._tilesToFeatures.get(i).forEach((function(e){if(!o.has(e)){var t=n._featureToTiles.get(e);t.has(i)&&1===t.size?a.push(e):n._unlink(i,e)}}));for(var c=0,f=a;c<f.length;c++){var p=f[c];this._unlink(i,p)}this.featureStore.removeManyById(a),this.featureStore.addMany(t),o.forEach((function(e){n._link(i,e)})),o.clear(),a.length=0},e.prototype.addOrUpdateFeatures=function(e){for(var t=this,r=new Set,i=new n.default({geometryType:this.featureStore.geometryType,hasM:this.featureStore.hasM,hasZ:this.featureStore.hasZ},null),a=0,o=this.deleteFeaturesById(e.map((function(e){return e.objectId})));a<o.length;a++){var s=o[a];r.add(s)}i.addMany(e),this._tileById.forEach((function(e){i.forEachInBounds(e.bounds,(function(n){t._link(e,n.objectId),r.add(e)}))})),this.featureStore.addMany(e);var u=[];return r.forEach((function(e){return u.push(e)})),u},e.prototype.deleteFeaturesById=function(e){for(var t=this,n=new Set,i=this,a=0,o=e;a<o.length;a++){!function(e){var a=i._featureToTiles.get(e);a&&(a.forEach((function(r){n.add(r),t._tilesToFeatures.get(r).delete(e)})),r.default.release(a),i._featureToTiles.delete(e))}(o[a])}this.featureStore.removeManyById(e);var s=[];return n.forEach((function(e){return s.push(e)})),s},e.prototype._link=function(e,t){this._featureToTiles.get(t)||this._featureToTiles.set(t,r.default.acquire()),this._featureToTiles.get(t).add(e),this._tilesToFeatures.get(e).add(t)},e.prototype._unlink=function(e,t){this._featureToTiles.get(t).delete(e),this._tilesToFeatures.get(e).delete(t),0===this._featureToTiles.get(t).size&&(r.default.release(this._featureToTiles.get(t)),this._featureToTiles.delete(t))},e}();t.default=s}.apply(null,n))||(e.exports=i)},2030:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._pool=[],this._set=new Set}return e.prototype.acquire=function(){if(0===this._pool.length)return new Set;var e=this._pool.pop();return this._set.delete(e),e},e.prototype.release=function(e){e&&!this._set.has(e)&&(e.clear(),this._pool.length<5e4&&(this._pool.push(e),this._set.add(e)))},e.acquire=function(){return n.acquire()},e.release=function(e){return n.release(e)},e}();t.default=r;var n=new r}.apply(null,n))||(e.exports=i)},2031:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(4),r(333)],void 0===(i=function(e,t,r,n,i,a){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){this.item=e,this.promise=t,this.deferred=i.createDeferred(),this.status=0,this.value=null,this.error=null},s=function(){function e(e){this._queue=[],this._queueMap=new Map,this._processor=new a.QueueProcessor(e)}return e.prototype.destroy=function(){this.clear(),this._processor.destroy()},Object.defineProperty(e.prototype,"length",{get:function(){return this._queue.length},enumerable:!0,configurable:!0}),e.prototype.abort=function(e){var t=this._queueMap.get(e);t&&(0===t.status?this._processor.abort(e):(t.status=1,t.error=i.createAbortError()))},e.prototype.clear=function(){this._queue.length=0,this._queueMap.clear(),this._processor.clear()},e.prototype.get=function(e){return n(this,void 0,void 0,(function(){var t;return r(this,(function(r){return[2,(t=this._queueMap.get(e))?t.promise:void 0]}))}))},e.prototype.isOngoing=function(e){return this._processor.isOngoing(e)},e.prototype.has=function(e){return this._queueMap.has(e)},e.prototype.pause=function(){this._processor.pause()},e.prototype.resume=function(){this._processor.resume()},e.prototype.reset=function(){this._processor.reset()},e.prototype.push=function(e){return n(this,void 0,void 0,(function(){var t,n,i=this;return r(this,(function(r){return t=this._processor.push(e),n=new o(e,t),this._queue.push(n),this._queueMap.set(e,n),t.then((function(e){return i._success(n,e)}),(function(e){return i._error(n,e)})),[2,n.deferred.promise]}))}))},e.prototype._success=function(e,t){e.status=2,e.value=t,this._drain()},e.prototype._error=function(e,t){e.status=1,e.error=t,this._drain()},e.prototype._drain=function(){for(;;){var e=this._queue[0];if(!e||0===e.status)return;this._queue.shift(),this._queueMap.delete(e.item),2===e.status?e.deferred.resolve(e.value):e.deferred.reject(e.error)}},e}();t.OrderedQueueProcessor=s}.apply(null,n))||(e.exports=i)},828:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(15),r(56),r(979),r(980),r(981)],void 0===(i=function(e,t,r,n,i,a,o){function s(e,t){return(e+="").length>=t?e:new Array(t-e.length+1).join("0")+e}function u(e,t,r,n,i,a,o,u,l){if(void 0===r&&(r="0"),void 0===n&&(n="0"),void 0===i&&(i="0"),void 0===a&&(a="0"),void 0===o&&(o=""),void 0===u&&(u="0"),void 0===l&&(l="0"),"+"===o||"-"===o){var c=s(parseInt(e,10),4)+"-"+s(parseInt(t,10),2)+"-"+s(parseInt(r,10),2),f="";parseFloat(a)<10&&(f="0");var p=s(parseInt(n,10),2)+":"+s(parseInt(i,10),2)+":"+(f+parseFloat(a).toString()),h=""+o+s(parseInt(u,10),2)+":"+s(parseInt(l,10),2);return new Date(c+"T"+p+h)}return new Date(parseInt(e,10),parseInt(t,10),parseInt(r,10),parseInt(n,10),parseInt(i,10),parseFloat(a))}function l(e){var t=T.exec(e);if(null!==t)return u(t[1],t[2],t[3],t[4],t[5],t[6]);if(null!==(t=E.exec(e)))return u(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);if(null!==(t=M.exec(e)))return u(t[1],t[2],t[3],t[4],t[5],"0",t[6],t[7],t[8]);if(null!==(t=w.exec(e)))return u(t[1],t[2],t[3],t[4],t[5]);if(null!==(t=S.exec(e)))return u(t[1],t[2],t[3]);throw new Error("SQL Invalid Timestamp")}function c(e){var t=S.exec(e);if(null===t)throw new Error("SQL Invalid Date");var r=t[1],n=t[2],i=t[3];return new Date(parseInt(r,10),parseInt(n,10)-1,parseInt(i,10))}function f(e){return!0===e}function p(e){return Array.isArray(e)?e:[e]}function h(e){return null!==e?!0!==e:null}function d(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function y(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function v(e,t){if(null==e)return null;for(var r=!1,n=0,i=t;n<i.length;n++){var a=i[n];if(null==a)r=null;else if(e===a){r=!0;break}}return r}function m(e,t,r){if(null==e)return null;for(var n=t,i=r,a="",o="-[]/{}()*+?.\\^$|",s=0,u=0;u<n.length;u++){var l=n.charAt(u);switch(s){case 0:l===i?s=1:o.indexOf(l)>=0?a+="\\"+l:a+="%"===l?".*":"_"===l?".":l;break;case 1:o.indexOf(l)>=0?a+="\\"+l:a+=l,s=0}}return new RegExp("^"+a+"$").test(e)}function g(e){return e instanceof Date?e.valueOf():e}function _(e,t,r){if(null==t||null==r)return null;var n=g(t),i=g(r);switch(e){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}function b(e){for(var t=[],r={},n=0,i=e;n<i.length;n++){var a=i[n],o=a.toLowerCase();void 0===r[o]&&(t.push(a),r[o]=1)}return t}function I(e,t,r){if(t instanceof a.SqlInterval)if(r instanceof Date)switch(e){case"+":return new Date(t.valueInMilliseconds()+r.getTime());case"-":return t.valueInMilliseconds()-r.getTime();case"*":return t.valueInMilliseconds()*r.getTime();case"/":return t.valueInMilliseconds()/r.getTime()}else if(r instanceof a.SqlInterval)switch(e){case"+":return a.SqlInterval.createFromMilliseconds(t.valueInMilliseconds()+r.valueInMilliseconds());case"-":return a.SqlInterval.createFromMilliseconds(t.valueInMilliseconds()-r.valueInMilliseconds());case"*":return t.valueInMilliseconds()*r.valueInMilliseconds();case"/":return t.valueInMilliseconds()/r.valueInMilliseconds()}else t=t.valueInMilliseconds();else if(r instanceof a.SqlInterval)if(t instanceof Date)switch(e){case"+":return new Date(r.valueInMilliseconds()+t.getTime());case"-":return new Date(t.getTime()-r.valueInMilliseconds());case"*":return t.getTime()*r.valueInMilliseconds();case"/":return t.getTime()/r.valueInMilliseconds()}else r=r.valueInMilliseconds();else if(t instanceof Date&&"number"==typeof r)switch(r=24*r*60*60*1e3,t=t.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}else if(r instanceof Date&&"number"==typeof t)switch(t=24*t*60*60*1e3,r=r.getTime(),e){case"+":return new Date(t+r);case"-":return new Date(t-r);case"*":return new Date(t*r);case"/":return new Date(t/r)}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r}}function x(e,t,r,n){var i=n.getAttribute(e,t);return null!=i&&1===r[t]?new Date(i):i}Object.defineProperty(t,"__esModule",{value:!0});var S=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,T=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,M=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,F=function(){function e(){}return e.makeBool=function(e){return f(e)},e.featureValue=function(e,t,r,n){return x(e,t,r,n)},e.equalsNull=function(e){return null===e},e.applyLike=function(e,t,r){return m(e,t,r)},e.ensureArray=function(e){return p(e)},e.applyIn=function(e,t){return v(e,t)},e.currentDate=function(){var e=new Date;return e.setHours(0,0,0,0),e},e.makeSqlInterval=function(e,t,r){return a.SqlInterval.createFromValueAndQualifer(e,t,r)},e.convertInterval=function(e){return e instanceof a.SqlInterval?e.valueInMilliseconds():e},e.currentTimestamp=function(){return new Date},e.compare=function(e,t,r){return _(e,t,r)},e.calculate=function(e,t,r){return I(e,t,r)},e.makeComparable=function(e){return g(e)},e.evaluateFunction=function(e,t){return a.evaluateFunction(e,t)},e.lookup=function(e,t){var r=t[e];return void 0===r?null:r},e.between=function(e,t){return null==e||null==t[0]||null==t[1]?null:e>=t[0]&&e<=t[1]},e.notbetween=function(e,t){return null==e||null==t[0]||null==t[1]?null:e<t[0]||e>t[1]},e.ternaryNot=function(e){return h(e)},e.ternaryAnd=function(e,t){return d(e,t)},e.ternaryOr=function(e,t){return y(e,t)},e}(),N=function(){function e(e,t){this.fieldsIndex=t,this.datefields={},this.parameters={},this.parseTree=o.WhereGrammar.parse(e);var r=this.extractExpressionInfo(t),n=r.isStandardized,i=r.isAggregate,a=r.referencedFieldNames;this.referencedFieldNames=a,this.isStandardized=n,this.isAggregate=i}return e.create=function(t,r){return new e(t,r)},Object.defineProperty(e.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0}),e.prototype.testSet=function(e,r){void 0===r&&(r=t.defaultAttributeAdapter);for(var n={},i=0,a=this.fieldNames;i<a.length;i++){!function(t){n[t]=e.map((function(e){return r.getAttribute(e,t)}))}(a[i])}return!!this.evaluateNode(this.parseTree,{attributes:n},t.defaultAttributeAdapter)},e.prototype.calculateValue=function(e,r){void 0===r&&(r=t.defaultAttributeAdapter);var n=this.evaluateNode(this.parseTree,e,r);return n instanceof a.SqlInterval?n.valueInMilliseconds()/864e5:n},e.prototype.calculateValueCompiled=function(e,n){return void 0===n&&(n=t.defaultAttributeAdapter),null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,n,this.datefields):r("csp-restrictions")?this.calculateValue(e,n):(this.compileMe(),this.parseTree._compiledVersion(e,this.parameters,n,this.datefields))},e.prototype.testFeature=function(e,r){return void 0===r&&(r=t.defaultAttributeAdapter),!!this.evaluateNode(this.parseTree,e,r)},e.prototype.testFeatureCompiled=function(e,n){return void 0===n&&(n=t.defaultAttributeAdapter),void 0===this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,n,this.datefields):r("csp-restrictions")?this.testFeature(e,n):(this.compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,n,this.datefields))},e.prototype.getFunctions=function(){var e=[];return this.visitAll(this.parseTree,(function(t){"function"===t.type&&e.push(t.name.toLowerCase())})),b(e)},e.prototype.getExpressions=function(){var e=new Map;return this.visitAll(this.parseTree,(function(t){if("function"===t.type){var r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){var i=n.column,a=r+"-"+i;e.has(a)||e.set(a,{aggregateType:r,field:i})}}})),n.valuesOfMap(e)},e.prototype.getVariables=function(){var e=[];return this.visitAll(this.parseTree,(function(t){"param"===t.type&&e.push(t.value.toLowerCase())})),b(e)},e.prototype.compileMe=function(){var e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","datefields",e).bind(F)},e.prototype.extractExpressionInfo=function(e){var t=this,r=[],n=!0,o=!0;return this.visitAll(this.parseTree,(function(s){switch(s.type){case"column_ref":var u=s.column.toUpperCase();if("CURRENT_DATE"!==u&&"CURRENT_TIMESTAMP"!==u){var l=e.get(s.column),c=l&&l.name;!l||"date"!==l.type&&"esriFieldTypeDate"!==l.type||(t.datefields[l.name]=1),void 0!==c?(r.push(c),s.column=c):r.push(s.column)}break;case"function":var f=s.name,p=s.args.value.length;n&&(n=a.isStandardized(f,p)),o&&(o=i.isAggregate(f,p))}})),{referencedFieldNames:b(r),isStandardized:n,isAggregate:o}},e.prototype.visitAll=function(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(var r=0,n=e.clauses;r<n.length;r++){var i=n[r];this.visitAll(i,t)}"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(var a=0,o=e.value;a<o.length;a++){i=o[a];this.visitAll(i,t)}break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}},e.prototype.evaluateNodeToJavaScript=function(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case_expression":var t="";if("simple"===e.format){var r="this.makeComparable("+this.evaluateNodeToJavaScript(e.operand)+")";t="( ";for(var n=0;n<e.clauses.length;n++)t+=" ("+r+" === this.makeComparable("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")) ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(n=0;n<e.clauses.length;n++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[n].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t;case"param":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expr_list":for(var i="[",a=0,o=e.value;a<o.length;a++){var s=o[a];"["!==i&&(i+=","),i+=this.evaluateNodeToJavaScript(s)}return i+"]";case"unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary_expr":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")";case"*":case"-":case"+":case"/":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+")"}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return JSON.stringify(e.value);case"date":return"(new Date("+c(e.value).getTime().toString()+"))";case"timestamp":return"(new Date("+l(e.value).getTime().toString()+"))";case"column_ref":return"CURRENT_DATE"===e.column.toUpperCase()?"this.currentDate()":"CURRENT_TIMESTAMP"===e.column.toUpperCase()?"this.currentTimestamp()":"this.featureValue(feature,"+JSON.stringify(e.column)+",datefields,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+")"}throw new Error("Unsupported sql syntax "+e.type)},e.prototype.evaluateNode=function(e,t,r){switch(e.type){case"interval":var n=this.evaluateNode(e.value,t,r);return a.SqlInterval.createFromValueAndQualifer(n,e.qualifier,e.op);case"case_expression":if("simple"===e.format){for(var o=g(this.evaluateNode(e.operand,t,r)),s=0;s<e.clauses.length;s++)if(o===g(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}else{for(s=0;s<e.clauses.length;s++)if(f(this.evaluateNode(e.clauses[s].operand,t,r)))return this.evaluateNode(e.clauses[s].value,t,r);if(null!==e.else)return this.evaluateNode(e.else,t,r)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":for(var u=[],b=0,S=e.value;b<S.length;b++){var T=S[b];u.push(this.evaluateNode(T,t,r))}return u;case"unary_expr":return h(this.evaluateNode(e.expr,t,r));case"binary_expr":switch(e.operator){case"AND":return d(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"OR":return y(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t,r);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t,r);case"IN":var E=p(this.evaluateNode(e.right,t,r));return v(this.evaluateNode(e.left,t,r),E);case"NOT IN":E=p(this.evaluateNode(e.right,t,r));return h(v(this.evaluateNode(e.left,t,r),E));case"BETWEEN":var M=this.evaluateNode(e.left,t,r),w=this.evaluateNode(e.right,t,r);return null==M||null==w[0]||null==w[1]?null:M>=g(w[0])&&M<=g(w[1]);case"NOTBETWEEN":M=this.evaluateNode(e.left,t,r),w=this.evaluateNode(e.right,t,r);return null==M||null==w[0]||null==w[1]?null:M<g(w[0])||M>g(w[1]);case"LIKE":return m(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape);case"NOT LIKE":return h(m(this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return _(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r));case"-":case"+":case"*":case"/":return I(e.operator,this.evaluateNode(e.left,t,r),this.evaluateNode(e.right,t,r))}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return e.value;case"date":return c(e.value);case"timestamp":return l(e.value);case"column_ref":return"CURRENT_DATE"===e.column.toUpperCase()?((T=new Date).setHours(0,0,0,0),T):"CURRENT_TIMESTAMP"===e.column.toUpperCase()?new Date:x(t,e.column,this.datefields,r);case"function":var F=this.evaluateNode(e.args,t,r);return this.isAggregate?i.aggregateFunction(e.name,F):a.evaluateFunction(e.name,F)}throw new Error("Unsupported sql syntax "+e.type)},e}();t.WhereClause=N,t.defaultAttributeAdapter={getAttribute:function(e,t){return(function(e){return e&&"object"==typeof e.attributes}(e)?e.attributes:e)[t]}}}.apply(null,n))||(e.exports=i)},829:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(18),r(73),r(4),r(284),r(181),r(26),r(117),r(916),r.dj.m(e)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c){Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(){}return e.prototype._parseFeatureQuery=function(e){var t=l.parsePBFFeatureQuery(e.buffer,e.options);if(e.options&&"dehydrated"===e.options.type){var r=t;if(t.spatialReference=r.spatialReference.toJSON(),r.fields)for(var n=0;n<r.fields.length;n++)r.fields[n]=r.fields[n].toJSON()}return i.resolve(t)},e}(),p=function(t){function f(){var r=t.call(this)||this;return r._thread=void 0,o.open(a.getAbsMid("./PBFWorker",e,c),{strategy:"dedicated"}).then((function(e){void 0===r._thread?r._thread=e:e.close()})),r}return r(f,t),f.prototype.destroy=function(){this._thread&&this._thread.close(),this._thread=null},f.prototype.parseFeatureQuery=function(e,t){return e&&0!==e.byteLength?this._thread?this._thread.invoke("_parseFeatureQuery",{buffer:e,options:t},{transferList:[e]}).then((function(e){if(t&&"dehydrated"===t.type){var r=e;if(r.spatialReference=s.fromJSON(r.spatialReference),r.fields)for(var i=0;i<r.fields.length;i++)r.fields[i]=u.fromJSON(r.fields[i]);for(var a=r.spatialReference,o=0,l=r.features;o<l.length;o++){var c=l[o];c.uid=n.generateUID(),c.geometry&&(c.geometry.spatialReference=a)}}return e})):i.resolve(l.parsePBFFeatureQuery(e,t)):i.resolve(null)},f}(f);t.PBFWorker=p,t.default=function(){return new f}}.apply(null,n))||(e.exports=i)},876:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WEBGL_MAX_STOPS=8,t.WEBGL_MAX_INNER_STOPS=t.WEBGL_MAX_STOPS-2,t.NAN_MAGIC_NUMBER=1e-30,t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.RASTER_TILE_SIZE=256,t.ANGLE_FACTOR_256=256/360,t.DEBUG_LABELS=!1,t.COLLISION_BUCKET_SIZE=128,t.DOT_DENSITY_MAX_FIELDS=8,t.COLLISION_MAX_ZOOM_DELTA=3,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=16,t.COLLISION_BOX_PADDING=16,t.COLLISION_TILE_BOX_SIZE=t.TILE_SIZE/t.COLLISION_BUCKET_SIZE,t.COLLISION_PLACEMENT_PADDING=8,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.GLYPH_SIZE=24,t.TEXT_LINE_HEIGHT=1.2*t.GLYPH_SIZE,t.TEXT_MAX_WIDTH=10*t.GLYPH_SIZE,t.TEXT_SPACING=0,t.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}},t.ATTRIBUTE_STORE_TEXTURE_SIZE=1024,t.TEXTURE_BINDING_SPRITE_ATLAS=0,t.TEXTURE_BINDING_GLYPH_ATLAS=0,t.TEXTURE_BINDING_BITMAP=0,t.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1,t.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2,t.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3,t.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4,t.TEXTURE_BINDING_HIGHLIGHT_0=5,t.TEXTURE_BINDING_HIGHLIGHT_1=6,t.TEXTURE_BINDING_RENDERER_0=5,t.TEXTURE_BINDING_RENDERER_1=6,t.ATTRIBUTE_DATA_FILTER_FLAGS=0,t.ATTRIBUTE_DATA_ANIMATION=1,t.ATTRIBUTE_DATA_VV=2,t.ATTRIBUTE_DATA_DD0=3,t.ATTRIBUTE_DATA_DD1=3,t.MAX_FILTERS=2,t.HIGHLIGHT_FLAG=1,t.FILTER_FLAG_0=2,t.EFFECT_FLAG_0=4,t.THIN_LINE_THRESHOLD=2.5,t.HITTEST_SEARCH_SIZE=24,t.MAX_ANIMATION_TIME_MS=2e3}.apply(null,n))||(e.exports=i)},879:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(889)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.mat4=r}.apply(null,n))||(e.exports=i)},881:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var n=1/Math.LN2;t.positiveMod=r,t.radToByte=function(e){return r(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return r(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*n},t.sqr=function(e){return e*e},t.interpolate=function(e,t,r){return e*(1-r)+t*r},t.between=function(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}}.apply(null,n))||(e.exports=i)},882:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.mapParameters=function e(t){var r={};for(var n in t)if("declaredClass"!==n){var i=t[n];if(null!=i&&"function"!=typeof i)if(Array.isArray(i)){r[n]=[];for(var a=0;a<i.length;a++)r[n][a]=e(i[a])}else"object"==typeof i?i.toJSON&&(r[n]=JSON.stringify(i)):r[n]=i}return r}}.apply(null,n))||(e.exports=i)},888:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(16),r(19),r(177),r(279),r(74),r(275),r(26),r(168),r(281),r(179),r(55),r(271),r(37),r(37),r(826)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y,v){function m(e,t,r,a,s){var u,l,c=n.pt2px(r.xoffset),f=n.pt2px(r.yoffset),p=w*r.angle,h=w*s;switch(r.type){case"simple-marker":var d=r;u=l=n.pt2px(d.size);break;case"picture-marker":var y=r;u=n.pt2px(y.width),l=n.pt2px(y.height)}var v=i.mat2d.identity(R);i.mat2d.translate(v,v,o.vec2.set(O,e,t)),i.mat2d.rotate(v,v,h-p),i.mat2d.scale(v,v,o.vec2.set(O,a,-a)),i.mat2d.translate(v,v,o.vec2.set(O,c,-f));var m=[0,0];o.vec2.transformMat2d(m,o.vec2.set(O,-.5*u,-.5*l),v);var g=[0,0];o.vec2.transformMat2d(g,o.vec2.set(O,-.5*u,.5*l),v);var _=[0,0];o.vec2.transformMat2d(_,o.vec2.set(O,.5*u,-.5*l),v);var b=[0,0];return o.vec2.transformMat2d(b,o.vec2.set(O,.5*u,.5*l),v),{rings:[[m,_,b,g,m]]}}function g(e,t,r,a,s){var u=v.CIMSymbolHelper.getEnvelope(r.data);if(!u)return null;var l=n.pt2px(u.width),c=n.pt2px(u.height),f=n.pt2px(u.x),p=n.pt2px(u.y),h=0*w,d=w*s,y=i.mat2d.identity(R);i.mat2d.translate(y,y,o.vec2.set(O,e,t)),i.mat2d.rotate(y,y,d-h),i.mat2d.scale(y,y,o.vec2.set(O,a,a));var m=[0,0];o.vec2.transformMat2d(m,o.vec2.set(O,f,p+c),y);var g=[0,0];o.vec2.transformMat2d(g,o.vec2.set(O,f,p),y);var _=[0,0];o.vec2.transformMat2d(_,o.vec2.set(O,f+l,p+c),y);var b=[0,0];return o.vec2.transformMat2d(b,o.vec2.set(O,f+l,p),y),{rings:[[m,_,b,g,m]]}}function _(e,t,r,a,s,u){var l=v.alignmentUtils.getYAnchorDirection(r.verticalAlignment||"baseline"),c="baseline"===(r.verticalAlignment||"baseline"),f=n.pt2px(r.xoffset),p=n.pt2px(r.yoffset),h=n.pt2px(r.font.size)/24,d=4*h,y=c?25*h:a[1]+(1+l)*a[3]*.5,m=w*r.angle,g=w*u,_=i.mat2d.identity(R);i.mat2d.translate(_,_,o.vec2.set(O,e,t)),i.mat2d.rotate(_,_,g-m),i.mat2d.scale(_,_,o.vec2.set(O,s,-s)),i.mat2d.translate(_,_,o.vec2.set(O,f,-p)),i.mat2d.translate(_,_,o.vec2.set(O,-d,-d-y));var b=[0,0];o.vec2.transformMat2d(b,o.vec2.set(O,a[0],a[1]),_);var I=[0,0];o.vec2.transformMat2d(I,o.vec2.set(O,a[0],a[1]+a[3]),_);var x=[0,0];o.vec2.transformMat2d(x,o.vec2.set(O,a[0]+a[2],a[1]),_);var S=[0,0];return o.vec2.transformMat2d(S,o.vec2.set(O,a[0]+a[2],a[1]+a[3]),_),{rings:[[b,x,S,I,b]]}}function b(e,t,r){if(!r||0===r.glyphMosaicItems.length)return e;var i=v.bidiText(t.text),a=i[0],o=i[1],s=v.alignmentUtils.getJustification(t.horizontalAlignment||"center"),u=v.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),l=r.glyphMosaicItems,c=new v.TextShapingNew([l],v.definitions.TEXT_MAX_WIDTH,v.definitions.TEXT_LINE_HEIGHT,v.definitions.TEXT_SPACING,[0,.5*-N],.5*(1-u),0,s).getShaping(a,o),f=v.fontUtils.getFontDecorationTop(t.font.decoration);isNaN(f)||v.TextShapingNew.addDecoration(c,f);var p=v.TextShapingNew.getBox(c),h=n.pt2px(t.font.size)/j;return e[0]=h*p.x,e[1]=h*p.y,e[2]=h*p.width,e[3]=h*p.height,e}function I(e,t,r,n,i,a,o){var s;switch(n.type){case"simple-marker":case"picture-marker":s=m(t,r,n,a,0);break;case"text":s=_(t,r,n,i,a,0);break;case"cim":s=g(t,r,n,a,0)}for(var u,l,c=0,f=0;f<s.rings[0].length-1;f++)u=(t-(l=s.rings[0][f])[0])*(t-l[0])+(r-l[1])*(r-l[1]),c=Math.max(c,u);c=Math.sqrt(c);var p=h.normalizeMapX(t-c,o),d=h.normalizeMapX(t+c,o);if(p>d){var v=y.getInfo(o);if(v){var b=v.valid;p=b[0],d=b[1]}}return e[0]=p,e[1]=r-c,e[2]=d,e[3]=r+c,e}function x(e,t){return Math.ceil((e-t)/(2*t))}function S(e,t){var r,n=t.valid,i=n[0],a=n[1],o=2*a,s=0;return e>a?(e-=(r=Math.ceil(Math.abs(e-a)/o))*o,s=r):e<i&&(e+=(r=Math.ceil(Math.abs(e-i)/o))*o,s=-r),{x:e,frameId:s}}function T(e,t){var r=t.xmin,n=t.ymin,i=t.xmax,a=t.ymax;return E(e,r,n)&&E(e,r,a)&&E(e,i,a)&&E(e,i,n)}function E(e,t,r){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax}function M(e,t,r){var n;if(Array.isArray(e)){if((n=e[0])>t){var i=x(n,t);e[0]=n+i*(-2*t)}else if(n<r){i=x(n,r);e[0]=n+i*(-2*r)}}else if((n=e.x)>t){i=x(n,t);e.x+=i*(-2*t)}else if(n<r){i=x(n,r);e.x+=i*(-2*r)}return e}Object.defineProperty(t,"__esModule",{value:!0});var w=Math.PI/180,F=v.definitions.TEXT_MAX_WIDTH,N=v.definitions.TEXT_LINE_HEIGHT,A=v.definitions.TEXT_SPACING,R=a.mat2df32.create(),O=s.vec2f32.create(),C=l.create();t.getBounds=function(e,t,r,n,i,a,o,s){if(!n||!r)return e[0]=e[1]=e[2]=e[3]=0,t[0]=t[1]=t[2]=t[3]=0,e;var u=n;if(!p.isPoint(u)){c.getBoundsXY(e,u);var l=t[0];0===l&&(l=function(e,t){var r=0;switch(e.type){case"simple-fill":case"picture-fill":var n=e.outline;if(!n)return 0;r=n.width;break;case"simple-line":r=e.width;break;case"simple-marker":r=e.size;break;case"picture-marker":r=Math.max(e.width,e.height);break;case"text":var i=[0,0,0,0];b(i,e,t),r=Math.max(i[0],i[1]);break;case"cim":var a=v.CIMSymbolHelper.getEnvelope(e.data);r=Math.sqrt(a.width*a.width+a.height*a.height)}return r}(r,i),t[0]=l);var f=a*l/2;return e[0]-=f,e[1]-=f,e[2]+=f,e[3]+=f,e}var h=u.x,d=u.y;return"text"===r.type&&0===t[2]&&0===t[3]&&b(t,r,i),I(e,h,d,r,t,a,s),e},t.isMarkerSymbol=function(e){return"simple-marker"===e||"picture-marker"===e||"text"===e},t.graphicGeometryToNumber=function(e){switch(r.expect(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var P=s.vec2f32.create(),L=s.vec2f32.create(),D=s.vec2f32.create(),z=s.vec2f32.create(),B=s.vec2f32.create(),k=s.vec2f32.create(),G=s.vec2f32.create();t.isPointOnPolyline=function(e,t,r,n){o.vec2.set(D,t,r);for(var i,a,s,u,l,c,f,p,h,d=e.paths,y=1/0,v=0;v<d.length;v++){var m=d[v];if(!(m.length<2))for(var g=1;g<m.length;g++)i=m[g-1][0],s=m[g-1][1],a=m[g][0],u=m[g][1],l=Math.min(i,a)-n,c=Math.min(s,u)-n,f=Math.max(i,a)+n,p=Math.max(s,u)+n,t<l||t>f||r<c||r>p||(o.vec2.set(P,i,s),o.vec2.set(L,a,u),o.vec2.subtract(z,L,P),o.vec2.subtract(B,P,D),o.vec2.scale(k,z,o.vec2.dot(z,B)/o.vec2.dot(z,z)),o.vec2.subtract(G,B,k),y>(h=o.vec2.dot(G,G))&&(y=h))}return Math.sqrt(y)<=n},t.getMarkerSymbolBounds=m,t.getCIMMarkerBounds=g,t.getTextSymbolBounds=_,t.normalizeCentralMeridian=function(e){var t,r,n,i,a,o,s,u,l=null;if(!e)return null;t=e.spatialReference,r=d.getInfo(t),n=t.isWebMercator,i=V[o=n?102100:4326].maxX,a=V[o].minX,s=V[o].plus180Line,u=V[o].minus180Line;var h,y=e.toJSON();if(!r)return y;if("mesh"===e.type)h=y;else if(p.isPoint(y))h=M(y,i,a);else if(p.isMultipoint(y))y.points=y.points.map((function(e){return M(e,i,a)})),h=y;else if(p.isExtent(y))h=function(e,t){if(!t)return e;var r=function(e,t){var r,n=[],i=e.ymin,a=e.ymax,o=e.xmax-e.xmin,s=e.xmin,u=e.xmax,l=t.valid,c=l[0],f=l[1],p=(r=S(e.xmin,t)).x,h=r.frameId,d=(r=S(e.xmax,t)).x,y=r.frameId,v=p===d&&o>0;if(o>2*f){var m={xmin:s<u?p:d,ymin:i,xmax:f,ymax:a},g={xmin:c,ymin:i,xmax:s<u?d:p,ymax:a},_={xmin:0,ymin:i,xmax:f,ymax:a},b={xmin:c,ymin:i,xmax:0,ymax:a},I=[],x=[];T(m,_)&&I.push(h),T(m,b)&&x.push(h),T(g,_)&&I.push(y),T(g,b)&&x.push(y);for(var E=h+1;E<y;E++)I.push(E),x.push(E);n.push({extent:m,frameIds:[h]},{extent:g,frameIds:[y]},{extent:_,frameIds:I},{extent:b,frameIds:x})}else p>d||v?n.push({extent:{xmin:p,ymin:i,xmax:f,ymax:a},frameIds:[h]},{extent:{xmin:c,ymin:i,xmax:d,ymax:a},frameIds:[y]}):n.push({extent:{xmin:p,ymin:i,xmax:d,ymax:a},frameIds:[h]});return n}(e,t).map((function(e){return e.extent}));return r.length<2?r[0]||e:r.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:r.map((function(e){return[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]}))}}(y,r);else if(p.isPolygon(y)||p.isPolyline(y)){var v=C;c.getBoundsXY(v,y);var m={xmin:v[0],ymin:v[1],xmax:v[2],ymax:v[3]},g=x(m.xmin,a)*(2*i),_=0===g?y:function(e,t){for(var r=function(e){return p.isPolygon(e)?e.rings:e.paths}(e),n=0,i=r;n<i.length;n++)for(var a=i[n],o=0,s=a;o<s.length;o++){s[o][0]+=t}return e}(y,g);m.xmin+=g,m.xmax+=g,f.extentIntersectsPolyline(m,s)&&m.xmax!==i?l=_:f.extentIntersectsPolyline(m,u)&&m.xmin!==a?l=_:h=_}else h=e.clone();return null!==l?(new q).cut(l,i):h};var j=24;t.getTextSymbolSize=b,t.getTextSymbolEstimatedSize=function(e,t,r){var i=v.bidiText(t.text),a=i[0],o=i[1],s=v.alignmentUtils.getJustification(t.horizontalAlignment||"center"),u=v.alignmentUtils.getXAnchorDirection(t.horizontalAlignment||"center"),l=new v.TextShapingNew([],F,N,A,[0,.5*-N],.5*(1-u),0,s).getEstimatedShaping(a,o,r),c=v.TextShapingNew.getBox(l),f=n.pt2px(t.font.size)/j;return e[0]=f*c.x,e[1]=f*c.y,e[2]=f*c.width,e[3]=f*c.height,e};var V={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84}}},q=function(){function e(){}return e.prototype.cut=function(e,t){var r;if(e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var n=r.length,i=-2*t,a=0;a<n;a++){var o=r[a];if(o&&o.length>=this.minPts){for(var s=[],u=0,l=o;u<l.length;u++){var c=l[u];s.push([c[0]+i,c[1]])}r.push(s)}}return this.closed?e.rings=r:e.paths=r,e},e}()}.apply(null,n))||(e.exports=i)},889:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(180),r(76)],void 0===(i=function(e,t,r,n){function i(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function a(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],f=t[8],p=t[9],h=t[10],d=t[11],y=t[12],v=t[13],m=t[14],g=t[15],_=r[0],b=r[1],I=r[2],x=r[3];return e[0]=_*n+b*s+I*f+x*y,e[1]=_*i+b*u+I*p+x*v,e[2]=_*a+b*l+I*h+x*m,e[3]=_*o+b*c+I*d+x*g,_=r[4],b=r[5],I=r[6],x=r[7],e[4]=_*n+b*s+I*f+x*y,e[5]=_*i+b*u+I*p+x*v,e[6]=_*a+b*l+I*h+x*m,e[7]=_*o+b*c+I*d+x*g,_=r[8],b=r[9],I=r[10],x=r[11],e[8]=_*n+b*s+I*f+x*y,e[9]=_*i+b*u+I*p+x*v,e[10]=_*a+b*l+I*h+x*m,e[11]=_*o+b*c+I*d+x*g,_=r[12],b=r[13],I=r[14],x=r[15],e[12]=_*n+b*s+I*f+x*y,e[13]=_*i+b*u+I*p+x*v,e[14]=_*a+b*l+I*h+x*m,e[15]=_*o+b*c+I*d+x*g,e}function o(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,u=i+i,l=a+a,c=n*s,f=n*u,p=n*l,h=i*u,d=i*l,y=a*l,v=o*s,m=o*u,g=o*l;return e[0]=1-(h+y),e[1]=f+g,e[2]=p-m,e[3]=0,e[4]=f-g,e[5]=1-(c+y),e[6]=d+v,e[7]=0,e[8]=p+m,e[9]=d-v,e[10]=1-(c+h),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function s(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}Object.defineProperty(t,"__esModule",{value:!0}),t.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.set=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y,v){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=u,e[8]=l,e[9]=c,e[10]=f,e[11]=p,e[12]=h,e[13]=d,e[14]=y,e[15]=v,e},t.identity=i,t.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},t.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],p=t[10],h=t[11],d=t[12],y=t[13],v=t[14],m=t[15],g=r*s-n*o,_=r*u-i*o,b=r*l-a*o,I=n*u-i*s,x=n*l-a*s,S=i*l-a*u,T=c*y-f*d,E=c*v-p*d,M=c*m-h*d,w=f*v-p*y,F=f*m-h*y,N=p*m-h*v,A=g*N-_*F+b*w+I*M-x*E+S*T;return A?(A=1/A,e[0]=(s*N-u*F+l*w)*A,e[1]=(i*F-n*N-a*w)*A,e[2]=(y*S-v*x+m*I)*A,e[3]=(p*x-f*S-h*I)*A,e[4]=(u*M-o*N-l*E)*A,e[5]=(r*N-i*M+a*E)*A,e[6]=(v*b-d*S-m*_)*A,e[7]=(c*S-p*b+h*_)*A,e[8]=(o*F-s*M+l*T)*A,e[9]=(n*M-r*F-a*T)*A,e[10]=(d*x-y*b+m*g)*A,e[11]=(f*b-c*x-h*g)*A,e[12]=(s*E-o*w-u*T)*A,e[13]=(r*w-n*E+i*T)*A,e[14]=(y*_-d*I-v*g)*A,e[15]=(c*I-f*_+p*g)*A,e):null},t.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],f=t[9],p=t[10],h=t[11],d=t[12],y=t[13],v=t[14],m=t[15];return e[0]=s*(p*m-h*v)-f*(u*m-l*v)+y*(u*h-l*p),e[1]=-(n*(p*m-h*v)-f*(i*m-a*v)+y*(i*h-a*p)),e[2]=n*(u*m-l*v)-s*(i*m-a*v)+y*(i*l-a*u),e[3]=-(n*(u*h-l*p)-s*(i*h-a*p)+f*(i*l-a*u)),e[4]=-(o*(p*m-h*v)-c*(u*m-l*v)+d*(u*h-l*p)),e[5]=r*(p*m-h*v)-c*(i*m-a*v)+d*(i*h-a*p),e[6]=-(r*(u*m-l*v)-o*(i*m-a*v)+d*(i*l-a*u)),e[7]=r*(u*h-l*p)-o*(i*h-a*p)+c*(i*l-a*u),e[8]=o*(f*m-h*y)-c*(s*m-l*y)+d*(s*h-l*f),e[9]=-(r*(f*m-h*y)-c*(n*m-a*y)+d*(n*h-a*f)),e[10]=r*(s*m-l*y)-o*(n*m-a*y)+d*(n*l-a*s),e[11]=-(r*(s*h-l*f)-o*(n*h-a*f)+c*(n*l-a*s)),e[12]=-(o*(f*v-p*y)-c*(s*v-u*y)+d*(s*p-u*f)),e[13]=r*(f*v-p*y)-c*(n*v-i*y)+d*(n*p-i*f),e[14]=-(r*(s*v-u*y)-o*(n*v-i*y)+d*(n*u-i*s)),e[15]=r*(s*p-u*f)-o*(n*p-i*f)+c*(n*u-i*s),e},t.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],l=e[8],c=e[9],f=e[10],p=e[11],h=e[12],d=e[13],y=e[14],v=e[15];return(t*o-r*a)*(f*v-p*y)-(t*s-n*a)*(c*v-p*d)+(t*u-i*a)*(c*y-f*d)+(r*s-n*o)*(l*v-p*h)-(r*u-i*o)*(l*y-f*h)+(n*u-i*s)*(l*d-c*h)},t.multiply=a,t.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,p=void 0,h=void 0,d=void 0,y=void 0,v=void 0,m=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],u=t[2],l=t[3],c=t[4],f=t[5],p=t[6],h=t[7],d=t[8],y=t[9],v=t[10],m=t[11],e[0]=o,e[1]=s,e[2]=u,e[3]=l,e[4]=c,e[5]=f,e[6]=p,e[7]=h,e[8]=d,e[9]=y,e[10]=v,e[11]=m,e[12]=o*n+c*i+d*a+t[12],e[13]=s*n+f*i+y*a+t[13],e[14]=u*n+p*i+v*a+t[14],e[15]=l*n+h*i+m*a+t[15]),e},t.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},t.rotate=function(e,t,r,i){var a=i[0],o=i[1],s=i[2],u=Math.sqrt(a*a+o*o+s*s),l=void 0,c=void 0,f=void 0,p=void 0,h=void 0,d=void 0,y=void 0,v=void 0,m=void 0,g=void 0,_=void 0,b=void 0,I=void 0,x=void 0,S=void 0,T=void 0,E=void 0,M=void 0,w=void 0,F=void 0,N=void 0,A=void 0,R=void 0,O=void 0;return u<n.EPSILON?null:(a*=u=1/u,o*=u,s*=u,l=Math.sin(r),f=1-(c=Math.cos(r)),p=t[0],h=t[1],d=t[2],y=t[3],v=t[4],m=t[5],g=t[6],_=t[7],b=t[8],I=t[9],x=t[10],S=t[11],T=a*a*f+c,E=o*a*f+s*l,M=s*a*f-o*l,w=a*o*f-s*l,F=o*o*f+c,N=s*o*f+a*l,A=a*s*f+o*l,R=o*s*f-a*l,O=s*s*f+c,e[0]=p*T+v*E+b*M,e[1]=h*T+m*E+I*M,e[2]=d*T+g*E+x*M,e[3]=y*T+_*E+S*M,e[4]=p*w+v*F+b*N,e[5]=h*w+m*F+I*N,e[6]=d*w+g*F+x*N,e[7]=y*w+_*F+S*N,e[8]=p*A+v*R+b*O,e[9]=h*A+m*R+I*O,e[10]=d*A+g*R+x*O,e[11]=y*A+_*R+S*O,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)},t.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],f=t[10],p=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*n,e[5]=o*i+c*n,e[6]=s*i+f*n,e[7]=u*i+p*n,e[8]=l*i-a*n,e[9]=c*i-o*n,e[10]=f*i-s*n,e[11]=p*i-u*n,e},t.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],f=t[10],p=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*n,e[1]=o*i-c*n,e[2]=s*i-f*n,e[3]=u*i-p*n,e[8]=a*n+l*i,e[9]=o*n+c*i,e[10]=s*n+f*i,e[11]=u*n+p*i,e},t.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],f=t[6],p=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*n,e[1]=o*i+c*n,e[2]=s*i+f*n,e[3]=u*i+p*n,e[4]=l*i-a*n,e[5]=c*i-o*n,e[6]=f*i-s*n,e[7]=p*i-u*n,e},t.fromTranslation=function(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},t.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotation=function(e,t,r){var i=r[0],a=r[1],o=r[2],s=Math.sqrt(i*i+a*a+o*o),u=void 0,l=void 0,c=void 0;return s<n.EPSILON?null:(i*=s=1/s,a*=s,o*=s,u=Math.sin(t),c=1-(l=Math.cos(t)),e[0]=i*i*c+l,e[1]=a*i*c+o*u,e[2]=o*i*c-a*u,e[3]=0,e[4]=i*a*c-o*u,e[5]=a*a*c+l,e[6]=o*a*c+i*u,e[7]=0,e[8]=i*o*c+a*u,e[9]=a*o*c-i*u,e[10]=o*o*c+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)},t.fromXRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromYRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromZRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.fromRotationTranslation=o,t.fromQuat2=function(e,t){var r=u,n=-t[0],i=-t[1],a=-t[2],s=t[3],l=t[4],c=t[5],f=t[6],p=t[7],h=n*n+i*i+a*a+s*s;return h>0?(r[0]=2*(l*s+p*n+c*a-f*i)/h,r[1]=2*(c*s+p*i+f*n-l*a)/h,r[2]=2*(f*s+p*a+l*i-c*n)/h):(r[0]=2*(l*s+p*n+c*a-f*i),r[1]=2*(c*s+p*i+f*n-l*a),r[2]=2*(f*s+p*a+l*i-c*n)),o(e,t,r),e};var u=r.create();t.getTranslation=function(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e},t.getScaling=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],s=t[6],u=t[8],l=t[9],c=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(u*u+l*l+c*c),e},t.getRotation=function(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e},t.fromRotationTranslationScale=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],u=i+i,l=a+a,c=o+o,f=i*u,p=i*l,h=i*c,d=a*l,y=a*c,v=o*c,m=s*u,g=s*l,_=s*c,b=n[0],I=n[1],x=n[2];return e[0]=(1-(d+v))*b,e[1]=(p+_)*b,e[2]=(h-g)*b,e[3]=0,e[4]=(p-_)*I,e[5]=(1-(f+v))*I,e[6]=(y+m)*I,e[7]=0,e[8]=(h+g)*x,e[9]=(y-m)*x,e[10]=(1-(f+d))*x,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},t.fromRotationTranslationScaleOrigin=function(e,t,r,n,i){var a=t[0],o=t[1],s=t[2],u=t[3],l=a+a,c=o+o,f=s+s,p=a*l,h=a*c,d=a*f,y=o*c,v=o*f,m=s*f,g=u*l,_=u*c,b=u*f,I=n[0],x=n[1],S=n[2],T=i[0],E=i[1],M=i[2],w=(1-(y+m))*I,F=(h+b)*I,N=(d-_)*I,A=(h-b)*x,R=(1-(p+m))*x,O=(v+g)*x,C=(d+_)*S,P=(v-g)*S,L=(1-(p+y))*S;return e[0]=w,e[1]=F,e[2]=N,e[3]=0,e[4]=A,e[5]=R,e[6]=O,e[7]=0,e[8]=C,e[9]=P,e[10]=L,e[11]=0,e[12]=r[0]+T-(w*T+A*E+C*M),e[13]=r[1]+E-(F*T+R*E+P*M),e[14]=r[2]+M-(N*T+O*E+L*M),e[15]=1,e},t.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,l=r*o,c=n*o,f=n*s,p=i*o,h=i*s,d=i*u,y=a*o,v=a*s,m=a*u;return e[0]=1-f-d,e[1]=c+m,e[2]=p-v,e[3]=0,e[4]=c-m,e[5]=1-l-d,e[6]=h+y,e[7]=0,e[8]=p+v,e[9]=h-y,e[10]=1-l-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},t.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),u=1/(i-n),l=1/(a-o);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e},t.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=void 0;return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e},t.perspectiveFromFieldOfView=function(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+s),l=2/(i+a);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-s)*u*.5,e[9]=(i-a)*l*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e},t.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),u=1/(n-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(o+a)*l,e[15]=1,e},t.lookAt=function(e,t,r,a){var o=void 0,s=void 0,u=void 0,l=void 0,c=void 0,f=void 0,p=void 0,h=void 0,d=void 0,y=void 0,v=t[0],m=t[1],g=t[2],_=a[0],b=a[1],I=a[2],x=r[0],S=r[1],T=r[2];return Math.abs(v-x)<n.EPSILON&&Math.abs(m-S)<n.EPSILON&&Math.abs(g-T)<n.EPSILON?i(e):(p=v-x,h=m-S,d=g-T,o=b*(d*=y=1/Math.sqrt(p*p+h*h+d*d))-I*(h*=y),s=I*(p*=y)-_*d,u=_*h-b*p,(y=Math.sqrt(o*o+s*s+u*u))?(o*=y=1/y,s*=y,u*=y):(o=0,s=0,u=0),l=h*u-d*s,c=d*o-p*u,f=p*s-h*o,(y=Math.sqrt(l*l+c*c+f*f))?(l*=y=1/y,c*=y,f*=y):(l=0,c=0,f=0),e[0]=o,e[1]=l,e[2]=p,e[3]=0,e[4]=s,e[5]=c,e[6]=h,e[7]=0,e[8]=u,e[9]=f,e[10]=d,e[11]=0,e[12]=-(o*v+s*m+u*g),e[13]=-(l*v+c*m+f*g),e[14]=-(p*v+h*m+d*g),e[15]=1,e)},t.targetTo=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=n[0],u=n[1],l=n[2],c=i-r[0],f=a-r[1],p=o-r[2],h=c*c+f*f+p*p;h>0&&(c*=h=1/Math.sqrt(h),f*=h,p*=h);var d=u*p-l*f,y=l*c-s*p,v=s*f-u*c;return(h=d*d+y*y+v*v)>0&&(d*=h=1/Math.sqrt(h),y*=h,v*=h),e[0]=d,e[1]=y,e[2]=v,e[3]=0,e[4]=f*v-p*y,e[5]=p*d-c*v,e[6]=c*y-f*d,e[7]=0,e[8]=c,e[9]=f,e[10]=p,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e},t.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},t.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},t.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e},t.subtract=s,t.multiplyScalar=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e},t.multiplyScalarAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e},t.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},t.equals=function(e,t){var r=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],l=e[6],c=e[7],f=e[8],p=e[9],h=e[10],d=e[11],y=e[12],v=e[13],m=e[14],g=e[15],_=t[0],b=t[1],I=t[2],x=t[3],S=t[4],T=t[5],E=t[6],M=t[7],w=t[8],F=t[9],N=t[10],A=t[11],R=t[12],O=t[13],C=t[14],P=t[15];return Math.abs(r-_)<=n.EPSILON*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-b)<=n.EPSILON*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(a-I)<=n.EPSILON*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(o-x)<=n.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(s-S)<=n.EPSILON*Math.max(1,Math.abs(s),Math.abs(S))&&Math.abs(u-T)<=n.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(l-E)<=n.EPSILON*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(c-M)<=n.EPSILON*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(f-w)<=n.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(p-F)<=n.EPSILON*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(h-N)<=n.EPSILON*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(d-A)<=n.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(y-R)<=n.EPSILON*Math.max(1,Math.abs(y),Math.abs(R))&&Math.abs(v-O)<=n.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(m-C)<=n.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(g-P)<=n.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))},t.mul=a,t.sub=s}.apply(null,n))||(e.exports=i)},890:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(904)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.mat4f64=r}.apply(null,n))||(e.exports=i)},894:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(15),r(58)],void 0===(i=function(e,t,r,n){var i=r("esri-text-decoder")?new TextDecoder("utf-8"):null,a=r("safari")?6:r("ff")?12:32;return function(){function e(e,t,r,n){void 0===r&&(r=0),void 0===n&&(n=e?e.byteLength:0),this._tag=0,this._dataType=99,this.init(e,t,r,n)}return e.prototype.init=function(e,t,r,n){this._data=e,this._dataView=t,this._pos=r,this._end=n},e.prototype.clone=function(){return new e(this._data,this._dataView,this._pos,this._end)},e.prototype.pos=function(){return this._pos},e.prototype.next=function(e){for(;;){if(this._pos===this._end)return!1;var t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0},e.prototype.empty=function(){return this._pos>=this._end},e.prototype.tag=function(){return this._tag},e.prototype.getInt32=function(){return this._decodeVarint()},e.prototype.getInt64=function(){return this._decodeVarint()},e.prototype.getUInt32=function(){var e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))},e.prototype.getUInt64=function(){return this._decodeVarint()},e.prototype.getSInt32=function(){var e=this.getUInt32();return e>>>1^-(1&e)|0},e.prototype.getSInt64=function(){return this._decodeSVarint()},e.prototype.getBool=function(){var e=0!==this._data[this._pos];return this._skip(1),e},e.prototype.getEnum=function(){return this._decodeVarint()},e.prototype.getFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getUint32(t+4,!0);return this._skip(8),r},e.prototype.getSFixed64=function(){var e=this._dataView,t=this._pos,r=e.getUint32(t,!0)+4294967296*e.getInt32(t+4,!0);return this._skip(8),r},e.prototype.getDouble=function(){var e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e},e.prototype.getFixed32=function(){var e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e},e.prototype.getSFixed32=function(){var e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e},e.prototype.getFloat=function(){var e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e},e.prototype.getString=function(){var e=this._getLength(),t=this._pos,r=this._toString(this._data,t,t+e);return this._skip(e),r},e.prototype.getBytes=function(){var e=this._getLength(),t=this._pos,r=this._toBytes(this._data,t,t+e);return this._skip(e),r},e.prototype.processMessageWithArgs=function(e,t,r,n){var i=this.getMessage(),a=e(i,t,r,n);return i.release(),a},e.prototype.processMessage=function(e){var t=this.getMessage(),r=e(t);return t.release(),r},e.prototype.getMessage=function(){var t=this._getLength(),r=e.pool.acquire();return r.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),r},e.prototype.release=function(){e.pool.release(this)},e.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},e.prototype._skip=function(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e},e.prototype._decodeVarint=function(){var e,t=this._data,r=this._pos,n=0;if(this._end-r>=10)do{if(n|=127&(e=t[r++]),0==(128&e))break;if(n|=(127&(e=t[r++]))<<7,0==(128&e))break;if(n|=(127&(e=t[r++]))<<14,0==(128&e))break;if(n|=(127&(e=t[r++]))<<21,0==(128&e))break;if(n+=268435456*(127&(e=t[r++])),0==(128&e))break;if(n+=34359738368*(127&(e=t[r++])),0==(128&e))break;if(n+=4398046511104*(127&(e=t[r++])),0==(128&e))break;if(n+=562949953421312*(127&(e=t[r++])),0==(128&e))break;if(n+=72057594037927940*(127&(e=t[r++])),0==(128&e))break;if(n+=0x8000000000000000*(127&(e=t[r++])),0==(128&e))break;throw new Error("Varint too long!")}while(0);else{for(var i=1;r!==this._end&&0!=(128&(e=t[r]));)++r,n+=(127&e)*i,i*=128;if(r===this._end)throw new Error("Varint overrun!");++r,n+=e*i}return this._pos=r,n},e.prototype._decodeSVarint=function(){var e=this._decodeVarint();return e%2?-(e+1)/2:e/2},e.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},e.prototype._toString=function(e,t,r){if((r=Math.min(this._end,r))-t>a&&i){var n=e.subarray(t,r);return i.decode(n)}for(var o="",s="",u=t;u<r;++u){var l=e[u];128&l?s+="%"+l.toString(16):(o+=decodeURIComponent(s)+String.fromCharCode(l),s="")}return s.length&&(o+=decodeURIComponent(s)),o},e.prototype._toBytes=function(e,t,r){return r=Math.min(this._end,r),new Uint8Array(e.buffer,t,r-t)},e.pool=new n(e,!1,(function(e){e._data=null,e._dataView=null})),e}()}.apply(null,n))||(e.exports=i)},897:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(898)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.mat3f64=r}.apply(null,n))||(e.exports=i)},898:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){return[1,0,0,0,1,0,0,0,1]},t.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},t.fromValues=function(e,t,r,n,i,a,o,s,u){return[e,t,r,n,i,a,o,s,u]},t.createView=function(e,t){return new Float64Array(e,t,9)}}.apply(null,n))||(e.exports=i)},899:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(28),r(168)],void 0===(i=function(e,t,r,n){function i(e){return e}function a(e){return void 0===e&&(e=t.ZERO),i([e[0],e[1],e[2],e[3],e[4],e[5]])}function o(e,t,r,n,i,o,s){return void 0===s&&(s=a()),s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s}function s(e){return e[0]>=e[3]?0:e[3]-e[0]}function u(e){return e[1]>=e[4]?0:e[4]-e[1]}function l(e){return e[2]>=e[5]?0:e[5]-e[2]}function c(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function f(e){return 6===e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.create=a,t.fromValues=o,t.fromExtent=function(e,t){return void 0===t&&(t=a()),t[0]=e.xmin,t[1]=e.ymin,t[2]=e.zmin,t[3]=e.xmax,t[4]=e.ymax,t[5]=e.zmax,t},t.toExtent=function(e,t){var n=isFinite(e[2])||isFinite(e[5]);return new r(n?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})},t.fromMinMax=function(e,t,r){return void 0===r&&(r=a()),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=t[0],r[4]=t[1],r[5]=t[2],r},t.expandPointInPlace=function(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[3]&&(e[3]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[4]&&(e[4]=t[1]),t[2]<e[2]&&(e[2]=t[2]),t[2]>e[5]&&(e[5]=t[2])},t.expand=function(e,t,r){return void 0===r&&(r=e),f(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r[4]=Math.max(e[4],t[4]),r[5]=Math.max(e[5],t[5])):n.is(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[3]=Math.max(e[3],t[2]),r[4]=Math.max(e[4],t[3])):2===t.length?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[3]=Math.max(e[3],t[0]),r[4]=Math.max(e[4],t[1])):3===t.length&&(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.max(e[3],t[0]),r[4]=Math.max(e[4],t[1]),r[5]=Math.max(e[5],t[2])),r},t.expandWithBuffer=function(e,t,r,n,i){void 0===i&&(i=e);for(var a=e[0],o=e[1],s=e[2],u=e[3],l=e[4],c=e[5],f=0;f<n;f++)a=Math.min(a,t[r+3*f]),o=Math.min(o,t[r+3*f+1]),s=Math.min(s,t[r+3*f+2]),u=Math.max(u,t[r+3*f]),l=Math.max(l,t[r+3*f+1]),c=Math.max(c,t[r+3*f+2]);return i[0]=a,i[1]=o,i[2]=s,i[3]=u,i[4]=l,i[5]=c,i},t.expandWithNestedArray=function(e,t,r,n){void 0===n&&(n=e);var i=t.length,a=e[0],o=e[1],s=e[2],u=e[3],l=e[4],c=e[5];if(r)for(var f=0;f<i;f++){var p=t[f];a=Math.min(a,p[0]),o=Math.min(o,p[1]),s=Math.min(s,p[2]),u=Math.max(u,p[0]),l=Math.max(l,p[1]),c=Math.max(c,p[2])}else for(f=0;f<i;f++){p=t[f];a=Math.min(a,p[0]),o=Math.min(o,p[1]),u=Math.max(u,p[0]),l=Math.max(l,p[1])}return n[0]=a,n[1]=o,n[2]=s,n[3]=u,n[4]=l,n[5]=c,n},t.allFinite=function(e){for(var t=0;t<6;t++)if(!isFinite(e[t]))return!1;return!0},t.width=s,t.depth=u,t.height=l,t.diameter=function(e){var t=s(e),r=l(e),n=u(e);return Math.sqrt(t*t+r*r+n*n)},t.center=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=e[0]+s(e)/2,t[1]=e[1]+u(e)/2,t[2]=e[2]+l(e)/2,t},t.size=function(e,t){return void 0===t&&(t=[0,0,0]),t[0]=s(e),t[1]=u(e),t[2]=l(e),t},t.maximumDimension=function(e){return Math.max(s(e),l(e),u(e))},t.containsPoint=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[0]<=e[3]&&t[1]<=e[4]&&t[2]<=e[5]},t.containsPointWithMargin=function(e,t,r){return t[0]>=e[0]-r&&t[1]>=e[1]-r&&t[2]>=e[2]-r&&t[0]<=e[3]+r&&t[1]<=e[4]+r&&t[2]<=e[5]+r},t.contains=function(e,t){return t[0]>=e[0]&&t[1]>=e[1]&&t[2]>=e[2]&&t[3]<=e[3]&&t[4]<=e[4]&&t[5]<=e[5]},t.intersects=function(e,t){return Math.max(t[0],e[0])<=Math.min(t[3],e[3])&&Math.max(t[1],e[1])<=Math.min(t[4],e[4])&&Math.max(t[2],e[2])<=Math.min(t[5],e[5])},t.offset=function(e,t,r,n,i){return void 0===i&&(i=e),i[0]=e[0]+t,i[1]=e[1]+r,i[2]=e[2]+n,i[3]=e[3]+t,i[4]=e[4]+r,i[5]=e[5]+n,i},t.setMin=function(e,t,r){return void 0===r&&(r=e),r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r},t.setMax=function(e,t,r){return void 0===r&&(r=e),r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e},t.set=c,t.empty=function(e){return e?c(e,t.NEGATIVE_INFINITY):a(t.NEGATIVE_INFINITY)},t.toRect=function(e,t){return t||(t=n.create()),t[0]=e[0],t[1]=e[1],t[2]=e[3],t[3]=e[4],t},t.fromRect=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e},t.is=f,t.isPoint=function(e){return 0===s(e)&&0===u(e)&&0===l(e)},t.equals=function(e,t,r){if(null==e||null==t)return e===t;if(!f(e)||!f(t))return!1;if(r){for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1}else for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},t.wrap=function(e,t,r,n,i,a){return o(e,t,r,n,i,a,p)},t.POSITIVE_INFINITY=i([-1/0,-1/0,-1/0,1/0,1/0,1/0]),t.NEGATIVE_INFINITY=i([1/0,1/0,1/0,-1/0,-1/0,-1/0]),t.ZERO=i([0,0,0,0,0,0]);var p=a()}.apply(null,n))||(e.exports=i)},900:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(11),r(56),r(959)],void 0===(i=function(e,t,r,n,i,a){function o(e,t){return e?l.get(e,t):null}function s(e,t,r,i){void 0===i&&(i=!0);for(var a=[],l=0,f=t;l<f.length;l++){var p=f[l];if("*"!==p&&!e.has(p))if(i){var h=u(p);try{var d=o(h,e);if(!d)throw new n(c,"invalid SQL expression",{where:h});if(!d.isStandardized)throw new n(c,"expression is not standard",{clause:d});s(e,d.fieldNames,"expression contains missing fields")}catch(e){var y=e&&e.details;if(y&&(y.clause||y.where))throw e;y&&y.missingFields?a.push.apply(a,y.missingFields):a.push(p)}}else a.push(p)}if(a.length)throw new n(c,r,{missingFields:a})}function u(e){return e.split(f)[0]}Object.defineProperty(t,"__esModule",{value:!0});var l=new a.WhereClauseCache(50,500),c="feature-store:unsupported-query",f=" as ",p=i.SetFromValues(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);t.validateWhere=function(e,t){if(!t)return!0;var r=l.get(t,e);if(!r)throw new n(c,"invalid SQL expression",{where:t});if(!r.isStandardized)throw new n(c,"where clause is not standard",{where:t});return s(e,r.fieldNames,"where clause contains missing fields"),!0},t.validateHaving=function(e,t,r){if(!t)return!0;var i=l.get(t,e);if(!i)throw new n(c,"invalid SQL expression",{having:t});if(!i.isAggregate)throw new n(c,"having does not contain a valid aggregate function",{having:t});var a=i.fieldNames;if(s(e,a,"having contains missing fields"),!i.getExpressions().every((function(t){var n=t.aggregateType,i=t.field,a=e.has(i)&&e.get(i).name;return r.some((function(t){var r=t.onStatisticField,i=t.statisticType;return(e.has(r)&&e.get(r).name)===a&&i.toLowerCase().trim()===n}))})))throw new n(c,"expressions in having should also exist in outStatistics",{having:t});return!0},t.getWhereClause=o,t.validateFields=s,t.getExpressionFromFieldName=u,t.getAliasFromFieldName=function(e){return e.split(f)[1]},t.hasInvalidFieldType=function(e,t){var r=t.get(e);return!!r&&!p.has(r.type)}}.apply(null,n))||(e.exports=i)},901:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(12),r(16),r(4),r(78),r(182),r(55),r(271),r(37),r(917),r(880),r(877),r(886),r(918)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y,v){function m(e,t,r){if(r){var n=h.quantizeOptimizedGeometry(x,t,e.hasZ,e.hasM,"esriGeometryPoint",r);return h.convertToPoint(n,e.hasZ,e.hasM)}return h.convertToPoint(t,e.hasZ,e.hasM)}function g(e,i,o){return n(this,void 0,void 0,(function(){var n,s,f,p,h,d;return r(this,(function(r){switch(r.label){case 0:return e?(n=e.where,e.where=n=n&&n.trim(),(!n||/^1 *= *1$/.test(n)||i&&i===n)&&(e.where=null),e.geometry?[4,_(e)]:[2,e]):[2,null];case 1:return s=r.sent(),e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel&&(f=e.geometry.spatialReference,(s=u.getGeometryExtent(s)).spatialReference=f),e.geometry=s,[4,y.checkProjectionSupport(s.spatialReference,o)];case 2:return r.sent(),[4,c.normalizeCentralMeridian(l.fromJSON(s))];case 3:if(p=r.sent()[0],a.isNone(p))throw t.QUERY_ENGINE_EMPTY_RESULT;return h=p.toJSON(),[4,y.project(h,h.spatialReference,o)];case 4:if(!(d=r.sent()))throw t.QUERY_ENGINE_EMPTY_RESULT;return d.spatialReference=o,e.geometry=d,[2,e]}}))}))}function _(e){return n(this,void 0,void 0,(function(){var t,n,i,a,u,l,c,p,h;return r(this,(function(r){switch(r.label){case 0:return t=e.geometry,n=e.distance,i=e.units,null==n?[2,o.resolve(t)]:(a=t.spatialReference,u=i&&b.fromJSON(i)||s.getUnitString(a),a&&(f.isGeographic(a)||f.isWebMercator(a))?(c=t,[3,3]):[3,1]);case 1:return[4,y.checkProjectionSupport(a,f.WGS84).then((function(){return y.project(t,f.WGS84)}))];case 2:c=r.sent(),r.label=3;case 3:return l=c,[4,v.getGeodesicBufferOperator()];case 4:return p=r.sent(),[2,(h=p(l,n,u))?h.toJSON():null]}}))}))}Object.defineProperty(t,"__esModule",{value:!0});var b=new i.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});t.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var I=new d.default,x=new d.default,S={esriGeometryPoint:h.convertToPoint,esriGeometryPolyline:h.convertToPolyline,esriGeometryPolygon:h.convertToPolygon,esriGeometryMultipoint:h.convertToMultipoint};t.transformCentroid=m,t.getCentroid=function(e,t,r){return"esriGeometryPolygon"===e.geometryType&&t&&(t.centroid||t.geometry)?(t.centroid||(t.centroid=p.getCentroidOptimizedGeometry(new d.default,t.geometry,e.hasZ,e.hasM)),m(e,t.centroid,r)):null},t.getGeometry=function(e,t,r,n){var i=t?"coords"in t?t:t.geometry:null;if(!i)return null;if(r){var a=h.generalizeOptimizedGeometry(I,i,e.hasZ,e.hasM,e.geometryType,r);return n?(a=h.quantizeOptimizedGeometry(x,a,e.hasZ,e.hasM,e.geometryType,n),S[e.geometryType](a,e.hasZ,e.hasM)):S[e.geometryType](a,e.hasZ,e.hasM)}if(n){a=h.quantizeOptimizedGeometry(x,i,e.hasZ,e.hasM,e.geometryType,n);return S[e.geometryType](a,e.hasZ,e.hasM)}return S[e.geometryType](i,e.hasZ,e.hasM)},t.normalizeQuery=function(e,t,i){return n(this,void 0,void 0,(function(){var n,a,o,s,u;return r(this,(function(r){if(n=e.outFields,a=e.orderByFields,o=e.groupByFieldsForStatistics,s=e.outStatistics,n)for(u=0;u<n.length;u++)n[u]=n[u].trim();if(a)for(u=0;u<a.length;u++)a[u]=a[u].trim();if(o)for(u=0;u<o.length;u++)o[u]=o[u].trim();if(s)for(u=0;u<s.length;u++)s[u].onStatisticField&&(s[u].onStatisticField=s[u].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),[2,g(e,t,i)]}))}))},t.normalizeFilter=function(e,t,i){return n(this,void 0,void 0,(function(){return r(this,(function(r){return[2,g(e,t,i)]}))}))},t.normalizeQueryLike=g,t.cleanFromGeometryEngine=function(e){return e&&T in e?JSON.parse(JSON.stringify(e,E)):e};var T="_geVersion",E=function(e,t){return e!==T?t:void 0}}.apply(null,n))||(e.exports=i)},904:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},t.clone=function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},t.fromValues=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y){return[e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y]},t.createView=function(e,t){return new Float64Array(e,t,16)}}.apply(null,n))||(e.exports=i)},905:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(41),r(45),r(16),r(23),r(55),r(271),r(916),r(829),r(882),r(50)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f){function p(e,t){var r=e.geometry,n=e.toJSON(),i=n;if(r&&(i.geometry=JSON.stringify(r),i.geometryType=s.getJsonType(r),i.inSR=r.spatialReference.wkid||JSON.stringify(r.spatialReference)),n.groupByFieldsForStatistics&&(i.groupByFieldsForStatistics=n.groupByFieldsForStatistics.join(",")),n.objectIds&&(i.objectIds=n.objectIds.join(",")),n.orderByFields&&(i.orderByFields=n.orderByFields.join(",")),!n.outFields||t&&(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)?delete i.outFields:-1!==n.outFields.indexOf("*")?i.outFields="*":i.outFields=n.outFields.join(","),n.outSR?i.outSR=n.outSR.wkid||JSON.stringify(n.outSR):r&&(n.returnGeometry||n.returnCentroid)&&(i.outSR=i.inSR),n.returnGeometry&&delete n.returnGeometry,n.outStatistics&&(i.outStatistics=JSON.stringify(n.outStatistics)),n.pixelSize&&(i.pixelSize=JSON.stringify(n.pixelSize)),n.quantizationParameters&&(i.quantizationParameters=JSON.stringify(n.quantizationParameters)),n.source&&(i.layer=JSON.stringify({source:n.source}),delete n.source),n.timeExtent){var a=n.timeExtent,o=a.start,u=a.end;null==o&&null==u||(i.time=o===u?o:(null==o?"null":o)+","+(null==u?"null":u)),delete n.timeExtent}return i}function h(e,t,s,l,c){void 0===l&&(l={});var h="string"==typeof e?o.urlToObject(e):e,d=t.geometry?[t.geometry]:[];return l.responseType="pbf"===s?"array-buffer":"json",i.safeCast(u.normalizeCentralMeridian(d,null,l)).then((function(e){var i=e&&e[0];a.isSome(i)&&((t=t.clone()).geometry=i);var o=f.mapParameters(r({},h.query,{f:s},c,p(t,c)));return n(h.path+"/query",r({},l,{query:o}))}))}Object.defineProperty(t,"__esModule",{value:!0});var d,y="Layer does not support extent calculation.";t.queryToQueryStringParameters=p,t.executeQuery=function(e,t,r){return h(e,t,"json",r)},t.executeQueryPBF=function(e,t,r,n){return h(e,t,"pbf",n).then((function(e){var t=function(t){var r=e;return r.data=t,r};return r.useWorker?(null==d&&(d=new c.PBFWorker),d).parseFeatureQuery(e.data,r).then((function(e){return t(e)})):t(l.parsePBFFeatureQuery(e.data,r))}))},t.executeQueryForIds=function(e,t,r){return h(e,t,"json",r,{returnIdsOnly:!0})},t.executeQueryForCount=function(e,t,r){return h(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})},t.executeQueryForExtent=function(e,t,r){return h(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}).then((function(e){var t=e.data;if(t.hasOwnProperty("extent"))return e;if(t.features)throw new Error(y);if(t.hasOwnProperty("count"))throw new Error(y);return e}))}}.apply(null,n))||(e.exports=i)},907:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(19),r(826),r(908)],void 0===(i=function(e,t,r,n,i){function a(e){return{value:e.value,size:r.toPt(e.size)}}function o(e){return e.map((function(e){return a(e)}))}function s(e){if("string"==typeof e||"number"==typeof e)return r.toPt(e);var t=e;return{type:"size",expression:t.expression,stops:o(t.stops)}}function u(e){var t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(n.Utils.isString(e.field)){if(!e.stops)return null;if(e.stops.length>8)return null;for(var r=e.stops,i=0;i<8;++i){var a=r[Math.min(i,r.length-1)];t.values[i]=a.value,t.opacities[i]=a.opacity}}else{if(!(e.stops&&e.stops.length>=0))return null;var o=e.stops&&e.stops.length>=0&&e.stops[0].opacity;for(i=0;i<8;i++)t.values[i]=1/0,t.opacities[i]=o}return t}Object.defineProperty(t,"__esModule",{value:!0});var l=n.enums.WGLVVFlag;t.getVisualVariableSizeValueRepresentationRatio=function(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e},t.stopToSizeStop=a,t.normalizeSizeStops=o,t.normalizeSizeElement=s,t.getVisualVariablesFields=function(e){var t=e&&e.length>0?{}:null;return t&&e.forEach((function(e){var r=e.type;e.field&&(t[r]=e.field)})),t},t.convertVisualVariables=function(e){var t=e&&e.length>0?{}:null,a=t?{}:null;if(!t)return{vvFields:t,vvRanges:a};for(var c=0,f=e;c<f.length;c++){var p=f[c],h=p.type;if(p.field&&(t[h]=p.field),"size"===h){a.size||(a.size={});var d=p;switch(n.getTypeOfSizeVisualVariable(d)){case l.SIZE_MINMAX_VALUE:a.size.minMaxValue={minDataValue:d.minDataValue,maxDataValue:d.maxDataValue,minSize:s(d.minSize),maxSize:s(d.maxSize)};break;case l.SIZE_SCALE_STOPS:a.size.scaleStops={stops:o(d.stops)};break;case l.SIZE_FIELD_STOPS:for(var y=[],v=[],m=o(d.stops),g=m.length,_=0;_<6;_++){var b=m[Math.min(_,g-1)];y.push(b.value),v.push(r.pt2px(b.size))}a.size.fieldStops={values:y,sizes:v};break;case l.SIZE_UNIT_VALUE:a.size.unitValue={unit:d.valueUnit,valueRepresentation:d.valueRepresentation}}}else if("color"===h){var I=i.convertVisualVariables([p],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null});a.color=I.color;for(_=0;_<32;_+=4)n.color.premultiplyAlpha(a.color.colors,_,!0)}else if("opacity"===h)a.opacity=u(p);else if("rotation"===h){var x=p;a.rotation={type:x.rotationType}}}return{vvFields:t,vvRanges:a}}}.apply(null,n))||(e.exports=i)},908:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(34),r(66),r(280),r(897),r(879),r(890),r(169),r(273),r(282),r(909)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f){function p(e){return null!=e}function h(e){return"number"==typeof e}function d(e){return"string"==typeof e}function y(e,t){e&&e.push(t),m(t)}function v(e){F&&console.warn("[FastSymbolUpdates] "+e)}function m(e){F&&console.info("[FastSymbolUpdates] "+e)}function g(e,t,r,n,i){var a=e.minSize,o=e.maxSize;if(e.expression)return y(i,"Could not convert size info: expression not supported"),!1;if(e.useSymbolValue){var s=n.symbolSize[r];return t.minSize[r]=s,t.maxSize[r]=s,t.offset[r]=t.minSize[r],t.factor[r]=0,t.type[r]=1,!0}if(p(e.field))return p(e.stops)?2===e.stops.length&&h(e.stops[0].size)&&h(e.stops[1].size)?(_(e.stops[0].size,e.stops[1].size,e.stops[0].value,e.stops[1].value,t,r),t.type[r]=1,!0):(y(i,"Could not convert size info: stops only supported with 2 elements"),!1):h(a)&&h(o)&&p(e.minDataValue)&&p(e.maxDataValue)?(_(a,o,e.minDataValue,e.maxDataValue,t,r),t.type[r]=1,!0):null!=c.meterIn[e.valueUnit]?(t.minSize[r]=-1/0,t.maxSize[r]=1/0,t.offset[r]=0,t.factor[r]=1/c.meterIn[e.valueUnit],t.type[r]=1,!0):"unknown"===e.valueUnit?(y(i,"Could not convert size info: proportional size not supported"),!1):(y(i,"Could not convert size info: scale-dependent size not supported"),!1);if(!p(e.field)){if(e.stops&&e.stops[0]&&h(e.stops[0].size))return t.minSize[r]=e.stops[0].size,t.maxSize[r]=e.stops[0].size,t.offset[r]=t.minSize[r],t.factor[r]=0,t.type[r]=1,!0;if(h(a))return t.minSize[r]=a,t.maxSize[r]=a,t.offset[r]=a,t.factor[r]=0,t.type[r]=1,!0}return y(i,"Could not convert size info: unsupported variant of sizeInfo"),!1}function _(e,t,r,n,i,a){var o=Math.abs(n-r)>0?(t-e)/(n-r):0;i.minSize[a]=o>0?e:t,i.maxSize[a]=o>0?t:e,i.offset[a]=e-r*o,i.factor[a]=o}function b(e,t,r,n){if(e.normalizationField||e.valueRepresentation)return y(n,"Could not convert size info: unsupported property"),null;if(!function(e){return null==e||d(e)}(e.field))return y(n,"Could not convert size info: field is not a string"),null;if(t.size){if(e.field)if(t.size.field){if(e.field!==t.size.field)return y(n,"Could not convert size info: multiple fields in use"),null}else t.size.field=e.field}else t.size={field:e.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};var i;switch(e.axis){case"width":return(i=g(e,t.size,0,r,n))?t:null;case"height":return(i=g(e,t.size,2,r,n))?t:null;case"depth":return(i=g(e,t.size,1,r,n))?t:null;case"width-and-depth":return(i=g(e,t.size,0,r,n))&&g(e,t.size,1,r,n),i?t:null;case null:case void 0:case"all":return(i=(i=(i=g(e,t.size,0,r,n))&&g(e,t.size,1,r,n))&&g(e,t.size,2,r,n))?t:null;default:return y(n,'Could not convert size info: unknown axis "'+e.axis+'""'),null}}function I(e,t,r){e[4*t+0]=r.r/255,e[4*t+1]=r.g/255,e[4*t+2]=r.b/255,e[4*t+3]=r.a}function x(e,t,r,n){var i=2===r&&"arithmetic"===e.rotationType;t.offset[r]=i?90:0,t.factor[r]=i?-1:1,t.type[r]=1}function S(e,t,n){if(!e)return null;var i=!t.supportedTypes||!!t.supportedTypes.size,a=!t.supportedTypes||!!t.supportedTypes.color,o=!t.supportedTypes||!!t.supportedTypes.rotation,s=!!t.supportedTypes&&!!t.supportedTypes.opacity;F&&(n=n||[]);var u=e.reduce((function(e,u){if(!e)return e;if(u.valueExpression)return y(n,"Could not convert visual variables: arcade expressions not supported"),null;switch(u.type){case"size":return i?b(u,e,t,n):e;case"color":return a?function(e,t,r){if(e.normalizationField)return y(r,"Could not convert color info: unsupported property"),null;if(d(e.field)){if(!e.stops)return y(r,"Could not convert color info: missing stops or colors"),null;if(e.stops.length>8)return y(r,"Could not convert color info: too many color stops"),null;t.color={field:e.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(var n=e.stops,i=0;i<8;++i){var a=n[Math.min(i,n.length-1)];t.color.values[i]=a.value,I(t.color.colors,i,a.color)}}else{if(!(e.stops&&e.stops.length>=0))return y(r,"Could not convert color info: no field and no colors/stops"),null;var o=e.stops&&e.stops.length>=0&&e.stops[0].color;t.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(i=0;i<8;i++)t.color.values[i]=1/0,I(t.color.colors,i,o)}return t}(u,e,n):e;case"opacity":return s?function(e,t,r){if(e.normalizationField)return y(r,"Could not convert opacity info: unsupported property"),null;if(d(e.field)){if(!e.stops)return y(r,"Could not convert opacity info: missing stops or opacities"),null;if(e.stops.length>8)return y(r,"Could not convert opacity info: too many opacity stops"),null;t.opacity={field:e.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(var n=e.stops,i=0;i<8;++i){var a=n[Math.min(i,n.length-1)];t.opacity.values[i]=a.value,t.opacity.opacityValues[i]=a.opacity}}else{if(!(e.stops&&e.stops.length>=0))return y(r,"Could not convert opacity info: no field and no opacities/stops"),null;var o=e.stops&&e.stops.length>=0&&e.stops[0].opacity;t.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(i=0;i<8;i++)t.opacity.values[i]=1/0,t.opacity.opacityValues[i]=o}return t}(u,e,n):null;case"rotation":return o?function(e,t,r){if(!d(e.field))return y(r,"Could not convert rotation info: field is not a string"),null;if(t.rotation){if(e.field)if(t.rotation.field){if(e.field!==t.rotation.field)return y(r,"Could not convert rotation info: multiple fields in use"),null}else t.rotation.field=e.field}else t.rotation={field:e.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(e.axis){case"tilt":return x(e,t.rotation,0),t;case"roll":return x(e,t.rotation,1),t;case null:case void 0:case"heading":return x(e,t.rotation,2),t;default:return y(r,'Could not convert rotation info: unknown axis "'+e.axis+'""'),null}}(u,e,n):e;default:return r.neverReached(u),null}}),{size:null,color:null,opacity:null,rotation:null});return!(e.length>0&&u)||u.size||u.color||u.opacity||u.rotation?u&&u.size&&!function(e,t,r){for(var n=0;n<3;++n){var i=t.unitInMeters;1===e.type[n]&&(i*=t.modelSize[n],e.type[n]=2),e.minSize[n]=e.minSize[n]/i,e.maxSize[n]=e.maxSize[n]/i,e.offset[n]=e.offset[n]/i,e.factor[n]=e.factor[n]/i}var a;if(0!==e.type[0])a=0;else if(0!==e.type[1])a=1;else{if(0===e.type[2])return y(r,"No size axis contains a valid size or scale"),!1;a=2}for(n=0;n<3;++n)0===e.type[n]&&(e.minSize[n]=e.minSize[a],e.maxSize[n]=e.maxSize[a],e.offset[n]=e.offset[a],e.factor[n]=e.factor[a],e.type[n]=e.type[a]);return!0}(u.size,t,n)?null:u:null}function T(e){return e&&null!=e.size}function E(e,t,r){if(!!e!=!!t)return v("State update failed ({$name} enabled/disabled)"),!1;if(e&&e.field!==t.field)return v("State update failed ({$name} field changed)"),!1;if(e&&"rotation"===r)for(var n=e,i=t,a=0;a<3;a++)if(n.type[a]!==i.type[a]||n.offset[a]!==i.offset[a]||n.factor[a]!==i.factor[a])return!1;return!0}function M(e,t){var r={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},n=T(e);return e&&e.size?(r.vvSizeEnabled=!0,r.vvSizeMinSize=e.size.minSize,r.vvSizeMaxSize=e.size.maxSize,r.vvSizeOffset=e.size.offset,r.vvSizeFactor=e.size.factor):e&&n&&(r.vvSizeValue=t.transformation.scale),e&&n&&(r.vvSymbolAnchor=t.transformation.anchor,r.vvSymbolRotationMatrix=a.mat3f64.create(),o.mat4.identity(A),function(e,t,r,n){void 0===n&&(n=s.mat4f64.create());var i=e||0,a=t||0,u=r||0;0!==i&&o.mat4.rotateZ(n,n,-i/180*Math.PI),0!==a&&o.mat4.rotateX(n,n,a/180*Math.PI),0!==u&&o.mat4.rotateY(n,n,u/180*Math.PI)}(t.transformation.rotation[2],t.transformation.rotation[0],t.transformation.rotation[1],A),i.mat3.fromMat4(r.vvSymbolRotationMatrix,A)),e&&e.color&&(r.vvColorEnabled=!0,r.vvColorValues=e.color.values,r.vvColorColors=e.color.colors),e&&e.opacity&&(r.vvOpacityEnabled=!0,r.vvOpacityValues=e.opacity.values,r.vvOpacityOpacities=e.opacity.opacityValues),r}Object.defineProperty(t,"__esModule",{value:!0});var w,F=!1,N=!1;t.convertVisualVariables=S,t.initFastSymbolUpdatesState=function(e,t){if(N)return v("State not initialized, fast updates disabled (globally disabled)"),{enabled:!1};if(!e)return v("State not initialized, fast updates disabled (no renderer)"),{enabled:!1};if(f.DISABLE_FAST_UPDATES)return v("State not initialized, fast updates disabled (DISABLE_FAST_SYMBOL_UPDATES set)"),{enabled:!1};var r=S(e.visualVariables,t);return r?(m("State initialized, fast updates enabled"),{enabled:!0,visualVariables:r,materialParameters:M(r,t),requiresShaderTransformation:T(r)}):(v("State not initialized, fast updates disabled (conversion failed)"),{enabled:!1})},t.updateFastSymbolUpdatesState=function(e,t,r){if(!t||!e.enabled)return!1;var n=e.visualVariables,i=S(t.visualVariables,r);return i?!!(E(n.size,i.size,"size")&&E(n.color,i.color,"color")&&E(n.rotation,i.rotation,"rotation")&&E(n.opacity,i.opacity,"opacity"))&&(e.visualVariables=i,e.materialParameters=M(i,r),e.requiresShaderTransformation=T(i),m("State updated"),!0):(v("State update failed (conversion failed)"),!1)},t.getMaterialParams=M,function(e){var t=s.mat4f64.create(),r=l.vec3f64.create();e.evaluateModelTransform=function(e,i,a){if(!e.vvSizeEnabled)return a;o.mat4.copy(t,a);var s=e.vvSymbolRotationMatrix;o.mat4.set(A,s[0],s[1],s[2],0,s[3],s[4],s[5],0,s[6],s[7],s[8],0,0,0,0,1),o.mat4.multiply(t,t,A);for(var u=0;u<3;++u){var l=e.vvSizeOffset[u]+i[0]*e.vvSizeFactor[u];r[u]=n.clamp(l,e.vvSizeMinSize[u],e.vvSizeMaxSize[u])}return o.mat4.scale(t,t,r),o.mat4.translate(t,t,e.vvSymbolAnchor),t},e.evaluateModelTransformScale=function(e,t,r){if(!t.vvSizeEnabled)return u.vec3.set(e,1,1,1);for(var i=0;i<3;++i){var a=t.vvSizeOffset[i]+r[0]*t.vvSizeFactor[i];e[i]=n.clamp(a,t.vvSizeMinSize[i],t.vvSizeMaxSize[i])}return e}}(w||(w={}));var A=s.mat4f64.create();t.evaluateModelTransform=w.evaluateModelTransform,t.evaluateModelTransformScale=w.evaluateModelTransformScale}.apply(null,n))||(e.exports=i)},909:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1),r(0),r(10),r(2)],void 0===(i=function(e,t,r,n,i,a){return new(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,t.SCENEVIEW_LOCKING_LOG=!1,t.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1,t.HIGHLIGHTS_VISUALIZE_BLOCKS=!1,t.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1,t.DECONFLICTOR_SHOW_OUTLINES=!1,t.DECONFLICTOR_SHOW_GRID=!1,t.LABELS_SHOW_BORDER=!1,t.OVERLAY_DRAW_TEST_TEXTURE=!1,t.OVERLAY_SHOW_CENTER=!1,t.TESTS_DISABLE_UPDATE_THRESHOLDS=!1,t.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1,t.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1,t.DRAW_MESH_GEOMETRY_NORMALS=!1,t.FEATURE_TILE_FETCH_SHOW_TILES=!1,t.FEATURE_TILE_TREE_SHOW_TILES=!1,t.TERRAIN_TILE_TREE_SHOW_TILES=!1,t.I3S_TREE_SHOW_TILES=!1,t.ENABLE_PROFILE_DEPTH_RANGE=!1,t.DISABLE_FAST_UPDATES=!1,t.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,t.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,t.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,t}return r(t,e),n([a.property()],t.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),n([a.property()],t.prototype,"SCENEVIEW_LOCKING_LOG",void 0),n([a.property()],t.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0),n([a.property()],t.prototype,"HIGHLIGHTS_VISUALIZE_BLOCKS",void 0),n([a.property()],t.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0),n([a.property()],t.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0),n([a.property()],t.prototype,"DECONFLICTOR_SHOW_GRID",void 0),n([a.property()],t.prototype,"LABELS_SHOW_BORDER",void 0),n([a.property()],t.prototype,"OVERLAY_DRAW_TEST_TEXTURE",void 0),n([a.property()],t.prototype,"OVERLAY_SHOW_CENTER",void 0),n([a.property()],t.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0),n([a.property()],t.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0),n([a.property()],t.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0),n([a.property()],t.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),n([a.property()],t.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),n([a.property()],t.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),n([a.property()],t.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),n([a.property()],t.prototype,"I3S_TREE_SHOW_TILES",void 0),n([a.property()],t.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0),n([a.property()],t.prototype,"DISABLE_FAST_UPDATES",void 0),n([a.property()],t.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),n([a.property()],t.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),n([a.property()],t.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),n([a.subclass("esri.views.3d.support.DebugFlags")],t)}(a.declared(i)))}.apply(null,n))||(e.exports=i)},913:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(11),r(15),r(9),r(66),r(16),r(4),r(274),r(92),r(827),r(826),r(930),r(876),r(907),r(50)],void 0===(i=function(e,t,n,i,a,o,s,u,l,c,f,p,h,d,y,v,m){Object.defineProperty(t,"__esModule",{value:!0});var g=(h.enums.PixelType,s.getLogger("esri.views.layers.2d.features.support.AttributeStore")),_=d.debug.createDebugLogger(d.debug.DEBUG_ATTR_UPDATES,g),b=function(e,t){return function(r,n,i){var a;try{a=t(r,n,i)}catch(e){a=NaN}return(null===a||isNaN(a)||a===1/0)&&e||a}},I={sharedArrayBuffer:o("esri-shared-array-buffer"),oesTextureFloat:o("esri-webgl-texture-float"),maxTextureSize:o("esri-webgl-max-texture-size"),atomics:o("esri-atomics")},x=function(){function e(e,t,r,n){this.texelSize=4;var i=n.pixelType,a=n.layout,o=n.textureOnly;this.textureOnly=o||!1,this.pixelType=i,this._ctype=t,this.layout=a,this._resetRange(),this._shared=e,o||(this.data=this._initData(i,r,e,t))}return Object.defineProperty(e.prototype,"buffer",{get:function(){return l.andThen(this.data,(function(e){return e.buffer}))},enumerable:!0,configurable:!0}),e.prototype.getData=function(e,t){return l.expect(this.data)[e*this.texelSize+t]},e.prototype.setData=function(e,t,r,n){void 0===n&&(n=!0);var i=1<<t;0!=(this.layout&i)?(this.data[e*this.texelSize+t]=r,this.dirtyStart=Math.min(this.dirtyStart,e),this.dirtyEnd=Math.max(this.dirtyEnd,e)):g.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")},e.prototype.lock=function(){o("esri-2d-debug")&&5121===this.pixelType?g.error("AttributeStore-Bad-Type","Tried to lock non integer array type with float array"):this._shared&&I.atomics&&Atomics.store(this.data,0,1)},e.prototype.unlock=function(){o("esri-2d-debug")&&5121===this.pixelType?g.error("AttributeStore-Bad-Type","Tried to unlock non integer array type with float array"):this._shared&&I.atomics&&Atomics.store(this.data,0,0)},e.prototype.expand=function(e){if(!this.textureOnly){var t=this._initData(this.pixelType,e,this._shared,this._ctype),r=l.expect(this.data);t.set(r),this.data=t}},e.prototype.toMessage=function(){var e=this.dirtyStart,t=this.dirtyEnd,r=this.texelSize;if(e>t)return null;this._resetRange();var n=!(this._shared||"local"===this._ctype),i=this.pixelType,a=this.layout,o=l.expect(this.data);return o.slice?{start:e,end:t,data:n&&o.slice(e*r,(t+1)*r)||null,pixelType:i,layout:a}:n?{start:e,end:t,data:new(d.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,e*r,(t+1)*r)),pixelType:i,layout:a}:{start:e,end:t,data:null,pixelType:i,layout:a}},e.prototype._initData=function(e,t,r,n){for(var i=r&&"local"!==n?SharedArrayBuffer:ArrayBuffer,a=d.Utils.getPixelArrayCtor(e),o=new a(new i(t*t*4*a.BYTES_PER_ELEMENT)),s=0;s<o.length;s+=4)o[s+1]=255;return o},e.prototype._resetRange=function(){this.dirtyStart=4294967295,this.dirtyEnd=0},e}(),S=function(){function e(e){this._attributeComputeMap=new Map,this._blocks=new Array,this._idMap=new Map,this._localToObjectId=new Map,this._filters=new Array(d.definitions.MAX_FILTERS),this._freeList=[],this._abortController=c.createAbortController(),this._hasScaleExpr=!1,this._size=32,this._idCounter=1,this._idsToHighlight=new Set;var t=I.oesTextureFloat?5126:5121;_("Creating AttributeStore "+(I.sharedArrayBuffer?"with":"without")+" shared memory"),o("esri-2d-debug")&&I.sharedArrayBuffer&&!I.atomics&&g.warn("Browser supports SharedArrayBuffer but not Atomics. Rendering may be impacted"),this._client=e,this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:t,layout:15},{pixelType:t,layout:15}],this._blocks=this._blockDescriptors.map((function(e){return null}))}return e.prototype.destroy=function(){this._abortController.abort()},Object.defineProperty(e.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0}),e.prototype.createLocalId=function(e){if(!this._idMap.has(e)){var t=this._getFreeId();this._idMap.set(e,-1===t?0:t),this._localToObjectId.set(t,e)}return this._idMap.get(e)},e.prototype.freeLocalId=function(e){var t=this._idMap.get(e);this._idMap.delete(e),this._localToObjectId.delete(t),this._freeList.push(t)},e.prototype.getFeatureId=function(e){return this._localToObjectId.get(e)},e.prototype.getLocalId=function(e){return this._idMap.has(e)?this._idMap.get(e):null},e.prototype.setHighlight=function(e){return i(this,void 0,void 0,(function(){var t,r,i,a,o,s,u=this;return n(this,(function(n){switch(n.label){case 0:for(1,this._getBlock(0).lock(),this._idsToHighlight.forEach((function(e){var t=u.getLocalId(e);if(t){var r=u._getBlock(0).getData(t,0);u._getBlock(0).setData(t,0,-2&r)}})),this._idsToHighlight.clear(),t=0,r=e;t<r.length;t++)i=r[t],this._idsToHighlight.add(i);for(a=0;a<e.length;a++)null!=(o=this.getLocalId(e[a]))&&(s=this._getBlock(0).getData(o,0),this._getBlock(0).setData(o,0,1|s));return this._getBlock(0).unlock(),[4,this.sendUpdates()];case 1:return n.sent(),[2]}}))}))},e.prototype.addHighlight=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2]}))}))},e.prototype.removeHighlight=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(e){return[2]}))}))},e.prototype.updateFilters=function(e){return i(this,void 0,void 0,(function(){var t,r,i,a,o,s,u=this;return n(this,(function(n){switch(n.label){case 0:return t=e.config,r=e.service,i=e.spatialReference,a=t.filters,o=t.definitionExpression,s=a.map((function(t,n){return u._updateFilter(e,t,n,r,o,i)})),[4,c.all(s)];case 1:return n.sent(),[2]}}))}))},e.prototype.setAttributeBindings=function(e,t){return i(this,void 0,void 0,(function(){return n(this,(function(r){switch(this._hasScaleExpr=!1,e.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":return[2,this._bindVVEvaluators(e.visualVariables,t)];case"dot-density":return[2,this._bindDDEvaluators(e.attributes,t)];case"heatmap":break;default:g.error(new a("attribute-store","Found invalid renderer type: "+e))}return[2]}))}))},e.prototype.setData=function(e,t,r,n){this._getBlock(t).setData(e,r,n)},e.prototype.setAttributeData=function(e,t,r,n){var i=this,a=e;this._getBlock(0).setData(a,0,this._getFilterFlags(t));var o=this._attributeComputeMap,s=I.oesTextureFloat?1:2;o.forEach((function(e,o){var l=o*s%4,c=Math.floor(o*s/4),f=i._getBlock(c+v.ATTRIBUTE_DATA_VV),p=e(t,{$view:n},r);if(I.oesTextureFloat)f.setData(a,l,p);else if(p===d.definitions.NAN_MAGIC_NUMBER)f.setData(a,l,255),f.setData(a,l+1,255);else{var h=u.clamp(Math.round(p),-32767,32766)+32768,y=255&h,m=(65280&h)>>8;f.setData(a,l,y),f.setData(a,l+1,m)}}))},e.prototype.sendUpdates=function(){var e=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=c.createResolver(),this._nextUpdate.promise;var t={blocks:this._blocks.map((function(e){return l.isSome(e)?e.toMessage():null}))};return this._currUpdate=this._createResources().then((function(){var r=e._client.update(t,e._signal).then((function(){if(e._currUpdate=null,e._nextUpdate){var t=e._nextUpdate;e._nextUpdate=null,e.sendUpdates().then((function(){return t.resolve()}))}}));return e._client.render(),r})),this._currUpdate},e.prototype._createResources=function(){var e=this;if(l.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(v.ATTRIBUTE_DATA_ANIMATION),_("Initializing AttributeStore");var t={shared:I.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:l.mapMany(this._blocks,(function(e){return{textureOnly:e.textureOnly,buffer:e.buffer,pixelType:e.pixelType}}))},r=this._client.initialize(t,this._signal);return this._createResourcesPromise=r,r.then((function(){return l.isNone(e._createResourcesPromise)?e._createResources():void 0})),r},e.prototype._getBlock=function(e){var t=this._blocks[e];if(l.isSome(t))return t;_("Initializing AttributeBlock at index "+e);var r=I.sharedArrayBuffer,n=this._client.type,i=new x(r,n,this._size,this._blockDescriptors[e]);return this._blocks[e]=i,this._createResourcesPromise=null,i},e.prototype._expand=function(){if(this._size<I.maxTextureSize){var e=this._size<<=1;return _("Expanding block size to",e,this._blocks),l.forEachSome(this._blocks,(function(t){return t.expand(e)})),this._createResourcesPromise=null,this._size=e,0}return g.error(new a("mapview-limitations","Maximum number of onscreen features exceeded.")),-1},e.prototype._getFreeId=function(){return this._freeList.length?this._freeList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++},e.prototype._updateFilter=function(e,t,r,a,o,s){return i(this,void 0,void 0,(function(){var i,u,c,f,p,h,d,y=this;return n(this,(function(n){switch(n.label){case 0:return i=this._filters[r],(l.isSome(i)&&i.hash)===JSON.stringify(t)?[2]:(u=1<<r+1,l.isNone(t)?(this._filters[r]=null,this._idMap.forEach((function(e){var t=y._getBlock(0).getData(e,0);y._getBlock(0).setData(e,0,t|u)})),[2]):[4,e.queryObjectIds(t)]);case 1:return c=n.sent(),t.hiddenIds&&t.hiddenIds.length&&(c=c.filter((function(e){return-1===t.hiddenIds.indexOf(e)}))),f=c.map((function(e){return y._idMap.get(e)})),[4,this._getFilter(r,a)];case 2:for(n.sent().update(t,o,s),this._getBlock(0).lock(),this._idMap.forEach((function(e){var t=y._getBlock(0).getData(e,0);y._getBlock(0).setData(e,0,t&~u)})),p=0;p<f.length;p++)null!=(h=f[p])&&(d=this._getBlock(0).getData(h,0),this._getBlock(0).setData(h,0,d|u));return this._getBlock(0).unlock(),[2]}}))}))},e.prototype._getFilter=function(e,t){return i(this,void 0,void 0,(function(){var i,a,o;return n(this,(function(n){switch(n.label){case 0:return i=this._filters[e],l.isSome(i)?[2,i]:[4,new Promise((function(e,t){Promise.all([r.e(5),r.e(66)]).then(function(){var t=[r(968)];e.apply(null,t)}.bind(this)).catch(t.bind(this))}))];case 1:return a=n.sent().default,o=new a({geometryType:t.geometryType,hasM:!1,hasZ:!1,timeInfo:t.timeInfo,fieldsIndex:new f(t.fields)}),this._filters[e]=o,[2,o]}}))}))},e.prototype._getFilterFlags=function(e){for(var t=0,r=0;r<this._filters.length;r++){var n=this._filters[r];t|=(l.isNone(n)||n.check(e)?1:0)<<r}var i=this.getFeatureId(e.localId);return t<<1|(this._idsToHighlight.has(i)?1:0)},e.prototype._bindVVEvaluators=function(e,t){return i(this,void 0,void 0,(function(){var r=this;return n(this,(function(a){switch(a.label){case 0:return this._attributeComputeMap.clear(),l.isSome(e)?[4,c.all(e.map((function(e){return i(r,void 0,void 0,(function(){var r,i;return n(this,(function(n){switch(n.label){case 0:return r=d.Utils.getVVType(e.type),[4,this._createGetValueFunction(e,t)];case 1:return i=n.sent(),l.isSome(i)&&this._attributeComputeMap.set(r,i),[2]}}))}))})))]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2]}}))}))},e.prototype._bindDDEvaluators=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,o=this;return n(this,(function(n){switch(n.label){case 0:return this._attributeComputeMap.clear(),e.length>d.definitions.DOT_DENSITY_MAX_FIELDS&&g.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+d.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+e.length),[4,c.all(e.map((function(e){return o._createNormalizedFunction(e,t)})))];case 1:for(r=n.sent().map((function(e){return b(0,e)})),i=0;i<d.definitions.DOT_DENSITY_MAX_FIELDS;i++)(a=i<e.length&&r[i])?this._attributeComputeMap.set(i,a):this._attributeComputeMap.has(i)&&this._attributeComputeMap.delete(i);return[2]}}))}))},e.prototype._createGetValueFunction=function(e,t){return i(this,void 0,void 0,(function(){var r,i,a,o,s,u,l;return n(this,(function(n){switch(n.label){case 0:return"size"!==e.type?[3,2]:(r=d.getTypeOfSizeVisualVariable(e))===d.enums.WGLVVFlag.SIZE_SCALE_STOPS?[2,null]:(i=r===d.enums.WGLVVFlag.SIZE_UNIT_VALUE,a=i&&function(t){return m.getVisualVariableSizeValueRepresentationRatio(t,e.valueRepresentation)},o=b,s=[d.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(e,t,a)]);case 1:return[2,o.apply(void 0,s.concat([n.sent()]))];case 2:return u=b,l=[d.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(e,t)];case 3:return[2,u.apply(void 0,l.concat([n.sent()]))]}}))}))},e.prototype._createNormalizedFunction=function(e,t,r){return i(this,void 0,void 0,(function(){var i,o,s;return n(this,(function(n){switch(n.label){case 0:return(i=e.field)?"string"==typeof i?(o=e.normalizationField)?[2,function(e){if(e.attributes[i]&&e.attributes[o]){var t=e.attributes[i]/e.attributes[o];return r?r(t):t}}]:[2,r?function(e){return r(e.attributes[i])}:function(e){return e.attributes[i]}]:(g.error(new a("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof i)),[2,function(e){}]):e.valueExpression?(this._hasScaleExpr=this._hasScaleExpr||-1!==e.valueExpression.indexOf("scale"),[4,p.createVVExpression(e.valueExpression,t.spatialReference,t.fields)]):[3,2];case 1:return s=n.sent(),[2,y.callWithOptimizedFeature.bind(null,s)];case 2:return g.error("Unable to create a normalized function for visual variable: "+e),[2,function(e){}]}}))}))},e}();t.default=S}.apply(null,n))||(e.exports=i)},915:function(e,t,r){var n,i;n=[r(24),r(22)],void 0===(i=function(e,t){var r={};return t.setObject("dojo.regexp",r),r.escapeString=function(e,t){return e.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(function(e){return t&&-1!=t.indexOf(e)?e:"\\"+e}))},r.buildGroupRE=function(e,t,n){if(!(e instanceof Array))return t(e);for(var i=[],a=0;a<e.length;a++)i.push(t(e[a]));return r.group(i.join("|"),n)},r.group=function(e,t){return"("+(t?"?:":"")+e+")"},r}.apply(null,n))||(e.exports=i)},916:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1013)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.parsePBFFeatureQuery=function(e,t){var n=r.parseFeatureQuery(e,t).queryResult.featureResult;if(n&&n.features&&n.features.length&&n.objectIdFieldName)for(var i=n.objectIdFieldName,a=0,o=n.features;a<o.length;a++){var s=o[a];s.attributes&&(s.objectId=s.attributes[i])}return n}}.apply(null,n))||(e.exports=i)},917:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function n(e,t,n,i,a,o){for(var s=r(a,o),u=n,l=n+s,c=0,f=0,p=0,h=0,d=0,y=0,v=i-1;y<v;y++,u+=s,l+=s){var m=t[u],g=t[u+1],_=t[u+2],b=t[l],I=t[l+1],x=t[l+2],S=m*I-b*g;h+=S,c+=(m+b)*S,f+=(g+I)*S,a&&(p+=(_+x)*(S=m*x-b*_),d+=S),m<e[0]&&(e[0]=m),m>e[1]&&(e[1]=m),g<e[2]&&(e[2]=g),g>e[3]&&(e[3]=g),a&&(_<e[4]&&(e[4]=_),_>e[5]&&(e[5]=_))}if(h>0&&(h*=-1),d>0&&(d*=-1),!h)return null;var T=[c,f,.5*h];return a&&(T[3]=p,T[4]=.5*d),T}function i(e,t,n,i,l){for(var c=r(i,l),f=t,p=t+c,h=0,d=0,y=0,v=0,m=0,g=n-1;m<g;m++,f+=c,p+=c){var _=e[f],b=e[f+1],I=e[f+2],x=e[p],S=e[p+1],T=e[p+2],E=i?o(_,b,I,x,S,T):a(_,b,x,S);if(E)if(h+=E,i){d+=E*(M=u(_,b,I,x,S,T))[0],y+=E*M[1],v+=E*M[2]}else{var M;d+=E*(M=s(_,b,x,S))[0],y+=E*M[1]}}return h>0?i?[d/h,y/h,v/h]:[d/h,y/h]:n>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function a(e,t,r,n){var i=r-e,a=n-t;return Math.sqrt(i*i+a*a)}function o(e,t,r,n,i,a){var o=n-e,s=i-t,u=a-r;return Math.sqrt(o*o+s*s+u*u)}function s(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function u(e,t,r,n,i,a){return[e+.5*(n-e),t+.5*(i-t),r+.5*(a-r)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCentroidOptimizedGeometry=function(e,t,a,o){if(!t||!t.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);for(var s=e.coords,u=[],l=a?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],c=t.lengths,f=t.coords,p=r(a,o),h=0,d=0,y=c;d<y.length;d++){var v=y[d],m=n(l,f,h,v,a,o);m&&u.push(m),h+=v*p}if(u.sort((function(e,t){var r=e[2]-t[2];return 0===r&&a&&(r=e[4]-t[4]),r})),u.length){var g=6*u[0][2];s[0]=u[0][0]/g,s[1]=u[0][1]/g,a&&(g=6*u[0][4],s[2]=0!==g?u[0][3]/g:0),(s[0]<l[0]||s[0]>l[1]||s[1]<l[2]||s[1]>l[3]||a&&(s[2]<l[4]||s[2]>l[5]))&&(s.length=0)}if(!s.length){var _=t.lengths[0]?i(f,0,c[0],a,o):null;if(!_)return null;s[0]=_[0],s[1]=_[1],a&&_.length>2&&(s[2]=_[2])}return e},t.lineCentroid=i}.apply(null,n))||(e.exports=i)},918:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(11),r(4),r(93),r(179),r(55),r(37),r(960),r(880),r(877),r(886),r(901)],void 0===(i=function(e,t,n,i,a,o,s,u,l,c,f,p,h,d,y){function v(){return o.create((function(e){return Promise.resolve().then(function(){var t=[r(289)];e.apply(null,t)}.bind(this)).catch(r.oe)}))}Object.defineProperty(t,"__esModule",{value:!0});var m="feature-store:unsupported-query",g={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},_={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};t.importGeometryEngine=v,t.getGeodesicBufferOperator=function(){return v().then((function(e){return e.geodesicBuffer}))},t.getSpatialQueryOperator=function(e,t,r){if(l.isPolygon(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){var n=p.convertFromPolygon(new h.default,t,!1,!1);return o.resolve((function(e){return f.polygonContainsPoint(n,!1,!1,e)}))}if(l.isPolygon(t)&&"esriGeometryMultipoint"===r.geometryType){var i=p.convertFromPolygon(new h.default,t,!1,!1);if("esriSpatialRelContains"===e)return o.resolve((function(e){return f.polygonContainsMultipoint(i,!1,!1,e,r.hasZ,r.hasM)}))}if(l.isExtent(t)&&"esriGeometryPoint"===r.geometryType&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return o.resolve((function(e){return s.extentContainsPoint(t,y.getGeometry(r,e))}));if(l.isExtent(t)&&"esriGeometryMultipoint"===r.geometryType&&"esriSpatialRelContains"===e)return o.resolve((function(e){return s.extentContainsMultipoint(t,y.getGeometry(r,e))}));if(l.isExtent(t)&&"esriSpatialRelIntersects"===e){var a=u.getExtentIntersector(r.geometryType);return o.resolve((function(e){return a(t,y.getGeometry(r,e))}))}return v().then((function(n){var i=n[g[e]].bind(null,t);return function(e){return i(y.getGeometry(r,e))}}))},t.checkSpatialQuerySupport=function(e,t,r){return i(this,void 0,void 0,(function(){var i,o;return n(this,(function(n){if(i=e.spatialRel,!(o=e.geometry))return[2];if(!function(e){return!0===_.spatialRelationship[e]}(i))throw new a(m,"Unsupported query spatial relationship",{query:e});if(!c.isValid(o.spatialReference)||!c.isValid(r))return[2];if(!function(e){return!0===_.queryGeometry[l.getJsonType(e)]}(o))throw new a(m,"Unsupported query geometry type",{query:e});if(!function(e){return!0===_.layerGeometry[e]}(t))throw new a(m,"Unsupported layer geometry type",{query:e});return e.outSR?[2,d.checkProjectionSupport(e.geometry&&e.geometry.spatialReference,e.outSR)]:[2]}))}))},t.canQueryWithRBush=function(e){if(l.isExtent(e))return!0;if(l.isPolygon(e)){for(var t=0,r=e.rings;t<r.length;t++){var n=r[t];if(5!==n.length)return!1;if(n[0][0]!==n[1][0]||n[0][0]!==n[4][0]||n[2][0]!==n[3][0]||n[0][1]!==n[3][1]||n[0][1]!==n[4][1]||n[1][1]!==n[2][1])return!1}return!0}return!1}}.apply(null,n))||(e.exports=i)},922:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t,r,n,i){if(null!=n&&null!=i&&n===i){var a=n;return function(n){return a>=e.getAttribute(n,t)&&a<=e.getAttribute(n,r)}}return null!=n&&null!=i?function(a){return function(e,t,r,n){return!(r>t||n<e)}(n,i,e.getAttribute(a,t),e.getAttribute(a,r))}:null!=n?function(t){return!(e.getAttribute(t,r)<n)}:null!=i?function(r){return!(e.getAttribute(r,t)>i)}:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getTimeExtent=function(e,t){if(!e)return null;var r=t.featureAdapter,n=e.startTimeField,i=e.endTimeField,a=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(n&&i)t.forEach((function(e){var t=r.getAttribute(e,n),s=r.getAttribute(e,i);null==t||isNaN(t)||(a=Math.min(a,t)),null==s||isNaN(s)||(o=Math.max(o,s))}));else{var s=n||i;t.forEach((function(e){var t=r.getAttribute(e,s);null==t||isNaN(t)||(a=Math.min(a,t),o=Math.max(o,t))}))}return{start:a,end:o}},t.getTimeOperator=function(e,t,n){if(!t||!e)return null;var i=e.startTimeField,a=e.endTimeField;if(!i&&!a)return null;var o=t.start,s=t.end;return null==o&&null==s?null:i&&a?r(n,i,a,o,s):function(e,t,r,n){return null!=r&&null!=n&&r===n?function(n){return e.getAttribute(n,t)===r}:null!=r&&null!=n?function(i){return e.getAttribute(i,t)>=r&&e.getAttribute(i,t)<=n}:null!=r?function(n){return e.getAttribute(n,t)>=r}:null!=n?function(r){return e.getAttribute(r,t)<=n}:void 0}(n,i||a,o,s)}}.apply(null,n))||(e.exports=i)},938:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(6),r(8),r(18),r(11),r(49),r(15),r(9),r(16),r(895),r(899),r(168),r(880),r(958)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d){Object.defineProperty(t,"__esModule",{value:!0});var y=[],v=u.getLogger("esri.layers.graphics.data.FeatureStore"),m={minX:0,minY:0,maxX:0,maxY:0},g=function(){function e(e,t,r){this._geometryInfo=e,this._onFeatureAdd=t,this._onFeatureRemove=r,this._featuresById=new Map,this._boundsByFeature=new Map,this._featuresByBounds=new Map,this._index=c(9,s("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this.events=new o,this.featureAdapter=d.optimizedFeatureQueryEngineAdapter}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var e=p.create(p.NEGATIVE_INFINITY);return this._boundsByFeature.forEach((function(t){t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]))})),e},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this._add(e,y),this._index.load(y),this._emitChanged(),y.length=0},e.prototype.addMany=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this._add(n,y)}this._index.load(y),this._emitChanged(),y.length=0},e.prototype.clear=function(){this._featuresById.clear(),this._boundsByFeature.clear(),this._featuresByBounds.clear(),this._index.clear(),this._emitChanged()},e.prototype.removeById=function(e){var t=this._featuresById.get(e);if(!t)return null;var r=this._boundsByFeature.get(t);return r&&(this._index.remove(r),this._featuresByBounds.delete(r)),this._boundsByFeature.delete(t),this._featuresById.delete(e),this._emitChanged(),t},e.prototype.removeIf=function(e,t){var r=this;this._featuresById.forEach((function(n,i){t(n)&&(r._remove(n),e.push(n))})),this._emitChanged()},e.prototype.removeManyById=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t],i=this._featuresById.get(n);if(i){var a=this._boundsByFeature.get(i);a&&(this._index.remove(a),this._featuresByBounds.delete(a)),this._boundsByFeature.delete(i)}this._featuresById.delete(n)}this._emitChanged()},e.prototype.forEachBounds=function(e,t,r){for(var n=0,i=e;n<i.length;n++){var a=i[n],o=this._boundsByFeature.get(a);o&&t(f.fromRect(r,o))}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.has=function(e){return this._featuresById.has(e)},e.prototype.forEach=function(e){this._featuresById.forEach((function(t){return e(t)}))},e.prototype.forEachInBounds=function(e,t){for(var r=0,n=function(e,t){return m.minX=t[0],m.minY=t[1],m.maxX=t[2],m.maxY=t[3],e.search(m)}(this._index,e);r<n.length;r++){var i=n[r];t(this._featuresByBounds.get(i))}},e.prototype.transferById=function(e,t){var r=this._featuresById.get(t);r&&(this._remove(r),e.add(r),this._emitChanged())},e.prototype.transferByIds=function(e,t){for(var r=[],n=0,i=t;n<i.length;n++){var a=i[n],o=this._featuresById.get(a);o&&(this._remove(o),r.push(o))}e.addMany(r),this._emitChanged()},e.prototype.transferIdRange=function(e,t,r){for(var n=[],i=t;i<r;i++){var a=this._featuresById.get(i);a&&(this._remove(a),n.push(a))}e.addMany(n),this._emitChanged()},e.prototype.transferIf=function(e,t){var r=this,n=[];this._featuresById.forEach((function(e,i){t(e)&&(r._remove(e),n.push(e))})),e.addMany(n),this._emitChanged()},e.prototype.transferAll=function(e){var t=this,r=[];this._featuresById.forEach((function(e,n){t._remove(e),r.push(e)})),e.addMany(r),this._emitChanged()},e.prototype._emitChanged=function(){this.events.emit("changed",void 0)},e.prototype._add=function(e,t){if(e){var r=e.objectId;if(null==r)return void v.error(new a("featurestore:invalid-feature","feature id is missing",{feature:e}));var n,i=this._featuresById.get(r);if(i?(n=this._boundsByFeature.get(i),e.localId=i.localId,n&&(this._index.remove(n),this._boundsByFeature.delete(i),this._featuresByBounds.delete(n))):l.isSome(this._onFeatureAdd)&&this._onFeatureAdd(e),!e.geometry||!e.geometry.coords||!e.geometry.coords.length)return this._boundsByFeature.set(e,null),void this._featuresById.set(r,e);n=h.getBoundsOptimizedGeometry(n||p.create(),e.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(e,n),this._featuresByBounds.set(n,e),this._featuresById.set(r,e),t.push(n)}},e.prototype._remove=function(e){var t;e&&(l.isSome(this._onFeatureRemove)&&this._onFeatureRemove(e),(t=this._boundsByFeature.get(e))&&(this._index.remove(t),this._boundsByFeature.delete(e),this._featuresByBounds.delete(t)),this._featuresById.delete(e.objectId))},e}();t.default=g}.apply(null,n))||(e.exports=i)},939:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(6),r(8),r(11),r(56),r(5),r(9),r(283),r(4),r(78),r(899),r(168),r(281),r(55),r(37),r(900),r(886),r(945),r(983),r(918),r(922),r(901),r(274),r(985)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y,v,m,g,_,b,I,x,S,T,E){Object.defineProperty(t,"__esModule",{value:!0});var M=u.getLogger("esri.layers.graphics.data.QueryEngine"),w=function(e,t,r,n,i){void 0===t&&(t=null),this.attributes=e,this.geometry=r,this.centroid=n,this.filterFlags=i,this.groupId=-1,this.localId=t};t.Feature=w;var F=new Set,N=new l.MemCacheStorage(2e6),A=0,R=function(){function e(e){var t=this;this.capabilities={query:_.queryCapabilities},this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.cacheSpatialQueries=e.cacheSpatialQueries||!1,this.gdbVersion=e.gdbVersion,this.historicMoment=e.historicMoment,this.featureStore=e.featureStore,this._changeHandle=this.featureStore.events.on("changed",(function(){return t.clearCache()})),this.timeInfo=e.timeInfo,this.cacheSpatialQueries&&(this._geometryQueryCache=new l.MemCache(A+++"$$",N)),this.fieldsIndex=new T(e.fields),e.scheduler&&e.task&&(this._frameQueue=new E.PromiseQueue,this._frameTask=e.scheduler.registerTask(e.task,(function(e){return t._update(e)}),(function(){return t._frameQueue.length>0})))}return e.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null),this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null),this.fieldsIndex.destroy()},Object.defineProperty(e.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullExtent",{get:function(){var e=this.featureStore.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:S.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:(this._timeExtent=x.getTimeExtent(this.timeInfo,this.featureStore),this._timeExtent):null},enumerable:!0,configurable:!0}),e.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null},e.prototype.executeQuery=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,r,i;return n(this,(function(n){switch(n.label){case 0:t=s.clone(e),n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return t=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=n.sent(),[3,15];case 14:if((i=n.sent())!==S.QUERY_ENGINE_EMPTY_RESULT)throw i;return r=new b.default([],null,this),[3,15];case 15:return[2,r.createQueryResponse(t)]}}))}))},e.prototype.executeQueryForCount=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,r,i;return n(this,(function(n){switch(n.label){case 0:(t=s.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return t=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return[2,(r=n.sent()).size];case 14:if((i=n.sent())!==S.QUERY_ENGINE_EMPTY_RESULT)throw i;return[2,0];case 15:return[2]}}))}))},e.prototype.executeQueryForExtent=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,r,i,a,o,u,l,c;return n(this,(function(n){switch(n.label){case 0:t=s.clone(e),i=t.outSR,n.label=1;case 1:return n.trys.push([1,14,,15]),[4,this._schedule()];case 2:return n.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._checkQuerySupport(t)];case 5:return(t=n.sent()).returnGeometry=!0,t.returnCentroid=!1,t.outSR=null,[4,this._reschedule()];case 6:return n.sent(),[4,this._executeGeometryQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeTimeQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:return n.sent(),[4,r.executeAttributesQuery(t)];case 13:return r=n.sent(),(a=r.size)?(p.set(C,p.NEGATIVE_INFINITY),this.featureStore.forEachBounds(r.items,(function(e){return p.expand(C,e)}),O),o={xmin:C[0],ymin:C[1],xmax:C[3],ymax:C[4],spatialReference:S.cleanFromGeometryEngine(this.spatialReference)},this.hasZ&&isFinite(C[2])&&isFinite(C[5])&&(o.zmin=C[2],o.zmax=C[5]),(u=g.project(o,r.spatialReference,i)).spatialReference=S.cleanFromGeometryEngine(i||this.spatialReference),u.xmax-u.xmin==0&&(l=f.getMetersPerUnitForSR(u.spatialReference),u.xmin-=l,u.xmax+=l),u.ymax-u.ymin==0&&(l=f.getMetersPerUnitForSR(u.spatialReference),u.ymin-=l,u.ymax+=l),this.hasZ&&null!=u.zmin&&null!=u.zmax&&u.zmax-u.zmin==0&&(l=f.getMetersPerUnitForSR(u.spatialReference),u.zmin-=l,u.zmax+=l),[2,{count:a,extent:u}]):[2,{count:a,extent:null}];case 14:if((c=n.sent())===S.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw c;case 15:return[2]}}))}))},e.prototype.executeQueryForIds=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){return n(this,(function(r){return[2,this.executeQueryForIdSet(e,t).then((function(e){return o.valuesOfSet(e)}))]}))}))},e.prototype.executeQueryForIdSet=function(e,t){return void 0===e&&(e={}),i(this,void 0,void 0,(function(){var t,r,i,a,o,u,l,c;return n(this,(function(n){switch(n.label){case 0:(t=s.clone(e)).returnGeometry=!1,t.returnCentroid=!1,t.outSR=null,n.label=1;case 1:return n.trys.push([1,13,,14]),[4,this._schedule()];case 2:return n.sent(),[4,S.normalizeQuery(t,this.definitionExpression,this.spatialReference)];case 3:return t=n.sent(),[4,this._reschedule()];case 4:return n.sent(),[4,this._executeGeometryQuery(t)];case 5:return r=n.sent(),[4,this._reschedule()];case 6:return n.sent(),[4,r.executeObjectIdsQuery(t)];case 7:return r=n.sent(),[4,this._reschedule()];case 8:return n.sent(),[4,r.executeTimeQuery(t)];case 9:return r=n.sent(),[4,this._reschedule()];case 10:return n.sent(),[4,r.executeAttributesQuery(t)];case 11:return r=n.sent(),[4,this._reschedule()];case 12:for(n.sent(),i=r.items,a=new Set,o=0,u=i;o<u.length;o++)l=u[o],a.add(r.featureAdapter.getObjectId(l));return[2,a];case 13:if((c=n.sent())===S.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw c;case 14:return[2]}}))}))},e.prototype.executeQueryForLatestObservations=function(e,t){var r=this;return this.timeInfo?this.executeQuery(e,t).then((function(e){return r._filterLatest(e,r.timeInfo)})):void M.error(new a("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))},e.prototype._schedule=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){return this._frameQueue?[2,this._frameQueue.push(e).then((function(e){return e}))]:[2,e]}))}))},e.prototype._reschedule=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){return this._frameQueue?[2,this._frameQueue.unshift(e).then((function(e){return e}))]:[2,e]}))}))},e.prototype._update=function(e){for(this._budget=e;!e.done&&this._frameQueue&&this._frameQueue.process();)e.madeProgress();this._budget=null},e.prototype._filterLatest=function(e,t){for(var n=t.trackIdField,i=t.startTimeField,a=t.endTimeField||i,o=new Map,s=[],u=0,l=e.features;u<l.length;u++){var c=l[u],f=c.attributes[n],p=c.attributes[a];(!o.has(f)||o.get(f).attributes[a]<p)&&o.set(f,c)}return o.forEach((function(e){return s.push(e)})),r({},e,{features:s})},e.prototype._getAll=function(){if(!this._allItems){var e=[];this.featureStore.forEach((function(t){return e.push(t)})),this._allItems=new b.default(e,null,this)}return this._allItems},e.prototype._executeGeometryQuery=function(e){return i(this,void 0,void 0,(function(){var t,r,a,o,s,u,l,c,f,p,h,d,y,m,g,_,x,S,T,E,M,w,F,N=this;return n(this,(function(A){switch(A.label){case 0:if(t=e.geometry,r=e.outSR,a=e.spatialRel,o=v.isValid(r)&&!v.equals(this.spatialReference,r),(s=this.cacheSpatialQueries?o?JSON.stringify({geometry:t,spatialRelationship:a,outSpatialReference:r}):JSON.stringify({geometry:t,spatialRelationship:a}):null)&&void 0!==(u=this._geometryQueryCache.get(s)))return[2,u];if(l=function(t){return i(N,void 0,void 0,(function(){var i;return n(this,(function(n){switch(n.label){case 0:return o&&(e.returnGeometry||e.returnCentroid)?[4,t.project(r)]:[3,2];case 1:return i=n.sent(),s&&this._geometryQueryCache.put(s,i,i.size||1),[2,i];case 2:return s&&this._geometryQueryCache.put(s,t,t.size||1),[2,t]}}))}))},!t)return[2,l(this._getAll())];if(c=this.featureAdapter,"esriSpatialRelDisjoint"!==a)return[3,5];if(!(f=this._searchFeatures(this._getQueryBBoxes(t))).length)return[2,l(this._getAll())];for(d=new Set,y=0,m=f;y<m.length;y++)g=m[y],d.add(c.getObjectId(g));return[4,this._reschedule(d)];case 1:return d=A.sent(),_=0,p=new Array(d.size),this.featureStore.forEach((function(e){return p[_++]=e})),h=d,[4,this._reschedule()];case 2:return A.sent(),[4,I.getSpatialQueryOperator(a,t,this)];case 3:return x=A.sent(),S=function(e){return!h.has(c.getObjectId(e))||x(c.getGeometry(e))},T=b.default.bind,[4,this._runSpatialFilter(p,S)];case 4:return M=new(T.apply(b.default,[void 0,A.sent(),t,this])),[2,l(M)];case 5:return(E=this._searchFeatures(this._getQueryBBoxes(t))).length?this._canExecuteSoloPass(t,e)?[2,l(new b.default(E,t,this))]:[4,I.getSpatialQueryOperator(a,t,this)]:(M=new b.default([],t,this),s&&this._geometryQueryCache.put(s,M,M.size||1),[2,M]);case 6:return w=A.sent(),[4,this._runSpatialFilter(E,(function(e){return w(c.getGeometry(e))}))];case 7:return F=A.sent(),[2,l(new b.default(F,t,this))]}}))}))},e.prototype._runSpatialFilter=function(e,t){return i(this,void 0,void 0,(function(){var r,a,o,s=this;return n(this,(function(u){return t?this._budget?(r=0,a=new Array,o=function(){return i(s,void 0,void 0,(function(){var i;return n(this,(function(n){switch(n.label){case 0:return r<e.length?(i=e[r],t(i)&&a.push(i),this._budget.done?[4,this._reschedule()]:[3,2]):[3,3];case 1:return n.sent(),[2,o()];case 2:return++r,[3,0];case 3:return[2]}}))}))},[2,this._reschedule().then((function(){return o()})).then((function(){return a}))]):[2,e.filter((function(e){return t(e)}))]:[2,e]}))}))},e.prototype._canExecuteSoloPass=function(e,t){var r=this.geometryType,n=t.spatialRel;return I.canQueryWithRBush(e)&&("esriSpatialRelEnvelopeIntersects"===n||"esriGeometryPoint"===r&&("esriSpatialRelIntersects"===n||"esriSpatialRelContains"===n||"esriSpatialRelWithin"===n))},e.prototype._getQueryBBoxes=function(e){if(I.canQueryWithRBush(e)){if(y.isExtent(e))return[h.fromValues(e.xmin,e.ymin,e.xmax,e.ymax)];if(y.isPolygon(e))return e.rings.map((function(e){return h.fromValues(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))}))}return[d.getBoundsXY(h.create(),e)]},e.prototype._searchFeatures=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this.featureStore.forEachInBounds(n,(function(e){F.add(e)}))}var i=new Array(F.size),a=0;return F.forEach((function(e){return i[a++]=e})),F.clear(),i},e.prototype._checkQuerySupport=function(e){return i(this,void 0,void 0,(function(){return n(this,(function(t){if(e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new a("feature-store:unsupported-query","Unsupported query options",{query:e});return[2,c.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),I.checkSpatialQuerySupport(e,this.geometryType,this.spatialReference),g.checkProjectionSupport(this.spatialReference,e.outSR)]).then((function(){return e}))]}))}))},e.prototype._checkAttributesQuerySupport=function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues;if(r&&r.length>0){var i=r.map((function(e){return e.indexOf(" ASC")>-1?e.split(" ASC")[0]:e.indexOf(" DESC")>-1?e.split(" DESC")[0]:e}));m.validateFields(this.fieldsIndex,i,"orderByFields contains missing fields")}if(t&&t.length>0)m.validateFields(this.fieldsIndex,t,"outFields contains missing fields");else if(n)throw new a("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});m.validateWhere(this.fieldsIndex,e.where)},e.prototype._checkStatisticsQuerySupport=function(e){return i(this,void 0,void 0,(function(){var t,r,i,o,s,u,l,c,f,p,h;return n(this,(function(n){if(t=e.outStatistics,r=e.groupByFieldsForStatistics,i=e.having,o=r&&r.length,s=t&&t.length,i){if(!o||!s)throw new a("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e});m.validateHaving(this.fieldsIndex,i,t)}if(s){if(t.some((function(e){return"exceedslimit"===e.statisticType})))return[2];for(u=t.map((function(e){return e.onStatisticField})),m.validateFields(this.fieldsIndex,u,"onStatisticFields contains missing fields"),o&&m.validateFields(this.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields"),l=0,c=t;l<c.length;l++){if(f=c[l],p=f.onStatisticField,"exceedslimit"===(h=f.statisticType))throw new a("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:f,query:e});if((!o||"count"!==h)&&p&&m.hasInvalidFieldType(p,this.fieldsIndex))throw new a("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:f,query:e})}}return[2]}))}))},e}();t.default=R;var O=p.create(),C=p.create()}.apply(null,n))||(e.exports=i)},940:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(283)],void 0===(i=function(e,t,r){return function(){function e(e,t){this._storage=new r.MemCacheStorage,this._storage.maxSize=e,t&&this._storage.registerRemoveFunc("",t)}return e.prototype.put=function(e,t){this._storage.put(e,t,1,1)},e.prototype.pop=function(e){return this._storage.pop(e)},e.prototype.get=function(e){return this._storage.get(e)},e.prototype.clear=function(){this._storage.clearAll()},e.prototype.destroy=function(){this._storage.clearAll()},e}()}.apply(null,n))||(e.exports=i)},945:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryCapabilities={supportsStatistics:!0,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0}}.apply(null,n))||(e.exports=i)},958:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(917),r(884),r(877)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.optimizedFeatureQueryEngineAdapter={getObjectId:function(e){return e.objectId},getAttributes:function(e){return e.attributes},getAttribute:function(e,t){return e.attributes[t]},cloneWithGeometry:function(e,t){return new n.default(t,e.attributes,null,e.objectId)},getGeometry:function(e){return e.geometry},getCentroid:function(e,t){return e.centroid||(e.centroid=r.getCentroidOptimizedGeometry(new i.default,e.geometry,t.hasZ,t.hasM)),e.centroid}},t.default=t.optimizedFeatureQueryEngineAdapter}.apply(null,n))||(e.exports=i)},959:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(940),r(828)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._cache=new r(e),this._invalidCache=new r(t)}return e.prototype.get=function(e,t){var r=t.uid+":"+e,i=this._cache.get(r);if(i)return i;if(void 0!==this._invalidCache.get(r))return null;try{var a=n.WhereClause.create(e,t);return this._cache.put(r,a),a}catch(e){return this._invalidCache.put(r,null),null}},e}();t.WhereClauseCache=i}.apply(null,n))||(e.exports=i)},960:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e,t){return e?t?4:3:t?3:2}function n(e,t,n,a,o){if(!e)return!1;for(var s=r(t,n),u=e.coords,l=!1,c=0,f=0,p=e.lengths;f<p.length;f++){var h=p[f];l=i(l,u,s,c,h,a,o),c+=h*s}return l}function i(e,t,r,n,i,a,o){for(var s=e,u=n,l=n,c=n+i*r;l<c;l+=r){(u=l+r)===c&&(u=n);var f=t[l],p=t[l+1],h=t[u],d=t[u+1];(p<o&&d>=o||d<o&&p>=o)&&f+(o-p)/(d-p)*(h-f)<a&&(s=!s)}return s}Object.defineProperty(t,"__esModule",{value:!0}),t.polygonContainsPoint=function(e,t,r,i){return n(e,t,r,i.coords[0],i.coords[1])},t.polygonContainsMultipoint=function(e,t,i,a,o,s){var u=r(o,s),l=a.coords,c=a.lengths;if(!c)return!1;for(var f=0,p=0;f<c.length;f++,p+=u)if(!n(e,t,i,l[p],l[p+1]))return!1;return!0},t.polygonContainsCoords=n}.apply(null,n))||(e.exports=i)},975:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(20),r(73),r(34),r(15),r(5),r(16),r(286),r(26),r(899),r(168),r(55),r(885),r(117),r(976)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y){function v(e,t,r,i){return{uid:n.generateUID(),objectId:i&&e.attributes?e.attributes[i]:null,attributes:e.attributes,geometry:m(e.geometry,t,r),visible:!0}}function m(e,t,r){if(!e)return null;switch(t){case"point":var n=e;return{x:n.x,y:n.y,z:n.z,m:n.m,hasZ:null!=n.z,hasM:null!=n.m,type:"point",spatialReference:r};case"polyline":var i=e;return{paths:i.paths,hasZ:!!i.hasZ,hasM:!!i.hasM,type:"polyline",spatialReference:r};case"polygon":var a=e;return{rings:a.rings,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polygon",spatialReference:r};case"multipoint":var o=e;return{points:o.points,hasZ:!!o.hasZ,hasM:!!o.hasM,type:"multipoint",spatialReference:r}}}function g(e,t,r,n){return{x:e,y:t,z:r,hasZ:null!=r,hasM:!1,spatialReference:n,type:"point"}}function _(e){return"declaredClass"in e}function b(e){return"declaredClass"in e}function I(e){return"declaredClass"in e}function x(e){return s.isNone(e)?null:_(e)?e:p.fromJSON(function(e){var t=e.spatialReference.toJSON();switch(e.type){case"point":return{x:e.x,y:e.y,z:e.z,m:e.m,spatialReference:t};case"polygon":var r=e.rings,n=e.hasZ,a=e.hasM;return{rings:E(r),hasZ:n,hasM:a,spatialReference:t};case"polyline":var o=e.paths;n=e.hasZ,a=e.hasM;return{paths:E(o),hasZ:n,hasM:a,spatialReference:t};case"extent":var s=e.xmin,u=e.xmax,l=e.ymin,c=e.ymax,f=e.zmin,p=e.zmax,h=e.mmin,d=e.mmax;n=e.hasZ,a=e.hasM;return{xmin:s,xmax:u,ymin:l,ymax:c,zmin:f,zmax:p,mmin:h,mmax:d,hasZ:n,hasM:a,spatialReference:t};case"multipoint":var y=e.points;n=e.hasZ,a=e.hasM;return{points:w(y)?M(y):y,hasZ:n,hasM:a,spatialReference:t};default:return void i.neverReached(e)}}(e))}function S(e){if(!e)return 0;var t=32;for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];switch(typeof n){case"string":t+=O(n);break;default:case"number":t+=16}}return t}function T(e){if(s.isNone(e))return 0;var t=32;switch(e.type){case"point":t+=42;break;case"polyline":case"polygon":for(var r=0,n=2+(e.hasZ?1:0)+(e.hasM?1:0),a="polyline"===e.type?e.paths:e.rings,o=0,l=a;o<l.length;o++)r+=l[o].length;t+=8*r*n+64,t+=128*r,t+=34,t+=32*(a.length+1);break;case"multipoint":var c=2+(e.hasZ?1:0)+(e.hasM?1:0),f=e.points.length;t+=8*f*c+64,t+=128*f,t+=34,t+=32;break;case"extent":t+=98,e.hasM&&(t+=32),e.hasZ&&(t+=32);break;case"mesh":t+=u.estimateSize(e.vertexAttributes.position),t+=u.estimateSize(e.vertexAttributes.normal),t+=u.estimateSize(e.vertexAttributes.uv),t+=u.estimateSize(e.vertexAttributes.tangent);break;default:i.neverReached(e)}return t}function E(e){return function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];if(0!==n.length)return w(n)}return!1}(e)?e.map((function(e){return M(e)})):e}function M(e){return e.map((function(e){return u.toArray(e)}))}function w(e){return e.length&&(u.isFloat32Array(e[0])||u.isFloat64Array(e[0]))}function F(e,t){switch(c.empty(t),"mesh"===e.type&&(e=e.extent),e.type){case"point":t[0]=t[3]=e.x,t[1]=t[4]=e.y,e.hasZ&&(t[2]=t[5]=e.z);break;case"polyline":for(var r=0;r<e.paths.length;r++)c.expandWithNestedArray(t,e.paths[r],e.hasZ);break;case"polygon":for(r=0;r<e.rings.length;r++)c.expandWithNestedArray(t,e.rings[r],e.hasZ);break;case"multipoint":c.expandWithNestedArray(t,e.points,e.hasZ);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[3]=e.xmax,t[4]=e.ymax,null!=e.zmin&&(t[2]=e.zmin),null!=e.zmax&&(t[5]=e.zmax);break;default:i.neverReached(e)}}function N(e,t){switch(f.empty(t),"mesh"===e.type&&(e=e.extent),e.type){case"point":t[0]=t[2]=e.x,t[1]=t[3]=e.y;break;case"polyline":for(var r=0;r<e.paths.length;r++)f.expandWithNestedArray(t,e.paths[r]);break;case"polygon":for(r=0;r<e.rings.length;r++)f.expandWithNestedArray(t,e.rings[r]);break;case"multipoint":f.expandWithNestedArray(t,e.points);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax;break;default:i.neverReached(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.equals=y.equals;var A=function(e,t,r){this.uid=e,this.geometry=t,this.attributes=r,this.visible=!0,this.objectId=null,this.centroid=null};t.DehydratedFeatureClass=A,t.hasGeometry=function(e){return s.isSome(e.geometry)},t.isFeatureGeometry=function(e){return r.isFeatureGeometryType(e.type)};var R=function(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null};t.DehydratedFeatureSetClass=R,t.isPoint=function(e){return"point"===e.type},t.fromFeatureSetJSON=function(e){var t=r.featureGeometryTypeKebabDictionary.fromJSON(e.geometryType),n=l.fromJSON(e.spatialReference),a=e.transform,o=e.features.map((function(r){var o=v(r,t,n,e.objectIdFieldName),s=o.geometry;if(s&&a)switch(s.type){case"point":o.geometry=h.hydratePoint(a,s,s,s.hasZ,s.hasM);break;case"multipoint":o.geometry=h.hydrateMultipoint(a,s,s,s.hasZ,s.hasM);break;case"polygon":o.geometry=h.hydratePolygon(a,s,s,s.hasZ,s.hasM);break;case"polyline":o.geometry=h.hydratePolyline(a,s,s,s.hasZ,s.hasM);break;default:i.neverReached(s)}return o}));return{geometryType:t,features:o,spatialReference:n,fields:e.fields?e.fields.map((function(e){return d.fromJSON(e)})):null,objectIdFieldName:e.objectIdFieldName,globalIdFieldName:e.globalIdFieldName,geohashFieldName:e.geohashFieldName,geometryProperties:e.geometryProperties,hasZ:e.hasZ,hasM:e.hasM,exceededTransferLimit:e.exceededTransferLimit,transform:null}},t.fromJSONGeometry=m,t.makeDehydratedPoint=g,t.isHydratedGeometry=_,t.isHydratedPoint=b,t.isHydratedGraphic=I,t.hydrateGraphic=function(e,t){if(!e||I(e))return e;var r=new n({layer:t,sourceLayer:t});return r.visible=e.visible,r.symbol=o.clone(e.symbol),r.attributes=o.clone(e.attributes),r.geometry=x(e.geometry),r},t.hydrateGeometry=x,t.clonePoint=function(e,t){if(!e)return null;var r;if(b(e)){if(null==t)return e.clone();if(b(t))return t.copy(e)}return null!=t?((r=t).x=e.x,r.y=e.y,r.spatialReference=e.spatialReference,e.hasZ?(r.z=e.z,r.hasZ=e.hasZ):(r.z=null,r.hasZ=!1),e.hasM?(r.m=e.m,r.hasM=!0):(r.m=null,r.hasM=!1)):(r=g(e.x,e.y,e.z,e.spatialReference),e.hasM&&(r.m=e.m,r.hasM=!0)),r};var O=a("esri-text-decoder")?function(e){return 32+e.length}:function(e){return 32*e.length};t.estimateAttributesObjectSize=S,t.estimateGeometryObjectSize=T,t.estimateSize=function(e){var t=32;return t+=S(e.attributes),(t+=3)+(8+T(e.geometry))},t.numVertices=function(e){if(s.isNone(e))return 0;switch(e.type){case"point":return 1;case"polyline":for(var t=0,r=0,n=e.paths;r<n.length;r++)t+=n[r].length;return t;case"polygon":t=0;for(var a=0,o=e.rings;a<o.length;a++)t+=o[a].length;return t;case"multipoint":return e.points.length;case"extent":return 2;case"mesh":var u=e.vertexAttributes&&e.vertexAttributes.position;return u?u.length/3:0;default:return void i.neverReached(e)}},t.hasVertices=function(e){if(!e)return!1;switch(e.type){case"extent":case"point":return!0;case"polyline":for(var t=0,r=e.paths;t<r.length;t++)if(r[t].length>0)return!0;return!1;case"polygon":for(var n=0,a=e.rings;n<a.length;n++)if(a[n].length>0)return!0;return!1;case"multipoint":return e.points.length>0;case"mesh":return e.vertexAttributes&&e.vertexAttributes.position&&e.vertexAttributes.position.length>0;default:return void i.neverReached(e)}},t.computeAABB=F,t.expandAABB=function(e,t){F(e,C),c.expand(t,C)},t.computeAABR=N,t.expandAABR=function(e,t){N(e,P),f.expand(t,P)},t.getObjectId=function(e,t){return null!=e.objectId?e.objectId:e.attributes&&t?e.attributes[t]:null};var C=c.create(),P=f.create()}.apply(null,n))||(e.exports=i)},976:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(34),r(16)],void 0===(i=function(e,t,r,n){function i(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++){var n=e[r],i=t[r];if(n.length!==i.length)return!1;for(var a=0;a<n.length;a++)if(n[a]!==i[a])return!1}return!0}function a(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!i(e[r],t[r]))return!1;return!0}function o(e,t){return e===t||e&&t&&e.equals(t)}function s(e,t){if(e===t)return!0;if(n.isNone(e)||n.isNone(t))return!1;if(e.type!==t.type)return!1;switch(e.type){case"point":return function(e,t){return!!o(e.spatialReference,t.spatialReference)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.m===t.m}(e,t);case"extent":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!o(e.spatialReference,t.spatialReference)&&e.xmin===t.xmin&&e.ymin===t.ymin&&e.zmin===t.zmin&&e.xmax===t.xmax&&e.ymax===t.ymax&&e.zmax===t.zmax}(e,t);case"polyline":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!o(e.spatialReference,t.spatialReference)&&a(e.paths,t.paths)}(e,t);case"polygon":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!o(e.spatialReference,t.spatialReference)&&a(e.rings,t.rings)}(e,t);case"multipoint":return function(e,t){return e.hasZ===t.hasZ&&e.hasM===t.hasM&&!!o(e.spatialReference,t.spatialReference)&&i(e.points,t.points)}(e,t);case"mesh":return!1;default:return void r.neverReached(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.equals=function(e,t){return e===t||null!=e&&null!=t&&e.objectId===t.objectId&&!!s(e.geometry,t.geometry)&&!!function(e,t){if(e===t)return!0;if(!e||!t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var i=0,a=r;i<a.length;i++){var o=a[i];if(e[o]!==t[o])return!1}return!0}(e.attributes,t.attributes)}}.apply(null,n))||(e.exports=i)},979:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}function n(e){for(var t=r(e),n=e.length,i=0,a=0,o=e;a<o.length;a++){var s=o[a];i+=Math.pow(s-t,2)}return n>1?i/(n-1):0}Object.defineProperty(t,"__esModule",{value:!0}),t.aggregateFunction=function(e,t){var r=i[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isAggregate=function(e,t){var r=i[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var i={min:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.min.apply(Math,e[0])}},max:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.max.apply(Math,e[0])}},avg:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:r(e[0])}},sum:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}(e[0])}},stddev:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sqrt(n(e[0]))}},count:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].length}},var:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:n(e[0])}}}}.apply(null,n))||(e.exports=i)},980:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(915)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0}return e.fixDefaults=function(e){if(null!==e.precision||null!==e.secondary)throw new Error("Primary and Secondary SqlInterval qualifiers not supported")},e.createFromMilliseconds=function(t){var r=new e;return r.second=t/1e3,r},e.createFromValueAndQualifer=function(t,r,n){var i=new e;if(i.op="-"===n?"-":"+","interval-period"===r.type){e.fixDefaults(r);var a=new RegExp("^[0-9]{1,}$");if("year"===r.period||"month"===r.period)throw new Error("Year-Month Intervals not supported");if(!a.test(t))throw new Error("Illegal Interval");i[r.period]=parseFloat(t)}else{if(e.fixDefaults(r.start),e.fixDefaults(r.end),"year"===r.start.period||"month"===r.start.period)throw new Error("Year-Month Intervals not supported");if("year"===r.end.period||"month"===r.end.period)throw new Error("Year-Month Intervals not supported");switch(r.start.period){case"day":switch(r.end.period){case"hour":if(!new RegExp("^[0-9]{1,} [0-9]{1,}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]),i[r.end.period]=parseFloat(t.split(" ")[1]);break;case"minute":if(!new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]);var o=t.split(" ")[1].split(":");i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]);break;case"second":if(!new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");i[r.start.period]=parseFloat(t.split(" ")[0]);o=t.split(" ")[1].split(":");i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]),i.second=parseFloat(o[2]);break;default:throw"Invalid Interval."}break;case"hour":switch(r.end.period){case"minute":if(!new RegExp("^[0-9]{1,}:[0-9]{1,}$").test(t))throw new Error("Illegal Interval");i.hour=parseFloat(t.split(":")[0]),i.minute=parseFloat(t.split(":")[1]);break;case"second":if(!new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");o=t.split(":");i.hour=parseFloat(o[0]),i.minute=parseFloat(o[1]),i.second=parseFloat(o[2]);break;default:throw"Invalid Interval."}break;case"minute":switch(r.end.period){case"second":if(!new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$").test(t))throw new Error("Illegal Interval");o=t.split(":");i.minute=parseFloat(o[0]),i.second=parseFloat(o[1]);break;default:throw"Invalid Interval."}break;default:throw"Invalid Interval."}}return i},e.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)},e}();t.SqlInterval=n,t.evaluateFunction=function(e,t){var r=i[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isStandardized=function(e,t){var r=i[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var i={extract:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];if(null==r)return null;if(r instanceof Date)switch(t.toUpperCase()){case"SECOND":return r.getSeconds();case"MINUTE":return r.getMinutes();case"HOUR":return r.getHours();case"DAY":return r.getDate();case"MONTH":return r.getMonth()+1;case"YEAR":return r.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:function(e){if(2===e.length){var t=e[0],r=e[1];return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){t=e[0],r=e[1];var n=e[2];return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];return null==t||null==r?null:r.indexOf(t)+1}},trim:{minParams:2,maxParams:3,evaluate:function(e){var t=3===e.length,n=t?e[1]:" ",i=t?e[2]:e[1];if(null==n||null==i)return null;var a="("+r.escapeString(n)+")";switch(e[0]){case"BOTH":return i.replace(new RegExp("^"+a+"*|"+a+"*$","g"),"");case"LEADING":return i.replace(new RegExp("^"+a+"*","g"),"");case"TRAILING":return i.replace(new RegExp(a+"*$","g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.abs(e[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.ceil(e[0])}},floor:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.floor(e[0])}},log:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])}},log10:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sin(e[0])}},cos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.cos(e[0])}},tan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.tan(e[0])}},asin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.asin(e[0])}},acos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.acos(e[0])}},atan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.atan(e[0])}},sign:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0]>0?1:e[1]<0?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:Math.pow(e[0],e[1])}},mod:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:e[0]%e[1]}},round:{minParams:1,maxParams:2,evaluate:function(e){var t=e[0],r=2===e.length?Math.pow(10,e[1]):1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:function(e){return null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(e){return"string"==typeof e[0]||e[0]instanceof String?e[0].length:0}},concat:{minParams:1,maxParams:1/0,evaluate:function(e){for(var t="",r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toUpperCase()}}}}.apply(null,n))||(e.exports=i)},981:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(982)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.parse=function(e){return r.parse(e)},e}();t.WhereGrammar=n}.apply(null,n))||(e.exports=i)},982:function(e,t,r){var n;void 0===(n=function(){"use strict";function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function a(e){return o[e.type](e)}var o={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=a(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+n(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,r){function n(e,t){return{type:"literal",text:e,ignoreCase:t}}function i(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function a(e){var r,n=Ji[e];if(n)return n;for(r=e-1;!Ji[r];)r--;for(n={line:(n=Ji[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Ji[e]=n,n}function o(e,t){var r=a(e),n=a(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function s(e){Yi<Xi||(Yi>Xi&&(Xi=Yi,$i=[]),$i.push(e))}function u(){var e,t;return e=Yi,Se()!==Ne?(t=c())!==Ne?Se()!==Ne?(e,e=Oe(t)):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne),e}function l(){var e,t,r,n,i,a,o,s;if(e=Yi,(t=c())!==Ne){for(r=[],n=Yi,(i=Se())!==Ne?(a=be())!==Ne?(o=Se())!==Ne?(s=c())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);n!==Ne;)r.push(n),n=Yi,(i=Se())!==Ne?(a=be())!==Ne?(o=Se())!==Ne?(s=c())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);r!==Ne?(e,e=t=Ce(t,r)):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}function c(){var e,t,r,n,i,a,o,s;if(e=Yi,(t=f())!==Ne){for(r=[],n=Yi,(i=Se())!==Ne?(a=X())!==Ne?(o=Se())!==Ne?(s=f())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);n!==Ne;)r.push(n),n=Yi,(i=Se())!==Ne?(a=X())!==Ne?(o=Se())!==Ne?(s=f())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);r!==Ne?(e,e=t=Pe(t,r)):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}function f(){var e,t,r,n,i,a,o,s;if(e=Yi,(t=p())!==Ne){for(r=[],n=Yi,(i=Se())!==Ne?(a=J())!==Ne?(o=Se())!==Ne?(s=p())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);n!==Ne;)r.push(n),n=Yi,(i=Se())!==Ne?(a=J())!==Ne?(o=Se())!==Ne?(s=p())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);r!==Ne?(e,e=t=Pe(t,r)):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}function p(){var e,r,n,i,a;return e=Yi,(r=Y())===Ne&&(r=Yi,33===t.charCodeAt(Yi)?(n=Le,Yi++):(n=Ne,0===Ki&&s(De)),n!==Ne?(i=Yi,Ki++,61===t.charCodeAt(Yi)?(a=ze,Yi++):(a=Ne,0===Ki&&s(Be)),Ki--,a===Ne?i=void 0:(Yi=i,i=Ne),i!==Ne?r=n=[n,i]:(Yi=r,r=Ne)):(Yi=r,r=Ne)),r!==Ne?(n=Se())!==Ne?(i=p())!==Ne?(e,e=r=ke(i)):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne),e===Ne&&(e=function(){var e,t,r;return e=Yi,(t=v())!==Ne&&Se()!==Ne?((r=function(){var e;return(e=function(){var e,t,r,n,i,a,o;if(e=Yi,t=[],r=Yi,(n=Se())!==Ne&&(i=h())!==Ne&&(a=Se())!==Ne&&(o=v())!==Ne?r=n=[n,i,a,o]:(Yi=r,r=Ne),r!==Ne)for(;r!==Ne;)t.push(r),r=Yi,(n=Se())!==Ne&&(i=h())!==Ne&&(a=Se())!==Ne&&(o=v())!==Ne?r=n=[n,i,a,o]:(Yi=r,r=Ne);else t=Ne;return t!==Ne&&(e,t=je(t)),e=t}())===Ne&&(e=function(){var e,t,r,n;return e=Yi,(t=y())!==Ne&&Se()!==Ne&&(r=Ie())!==Ne&&Se()!==Ne&&(n=l())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=st(t,n),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=y())!==Ne&&Se()!==Ne&&(r=Ie())!==Ne&&Se()!==Ne&&(n=xe())!==Ne?(e,t=ut(t),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=y())!==Ne&&Se()!==Ne&&(r=E())!==Ne?(e,t=lt(t,r),e=t):(Yi=e,e=Ne))),e}())===Ne&&(e=function(){var e,t,r,n,i,a;return e=Yi,(t=Y())!==Ne&&Se()!==Ne&&(r=$())!==Ne&&Se()!==Ne&&(n=v())!==Ne&&Se()!==Ne&&(i=J())!==Ne&&Se()!==Ne&&(a=v())!==Ne?(e,t=rt(r,n,a),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=$())!==Ne&&Se()!==Ne&&(r=v())!==Ne&&Se()!==Ne&&(n=J())!==Ne&&Se()!==Ne&&(i=v())!==Ne?(e,t=nt(t,r,i),e=t):(Yi=e,e=Ne)),e}())===Ne&&(e=function(){var e,t,r,n;return e=Yi,(t=H())!==Ne&&Se()!==Ne&&(r=Y())!==Ne&&Se()!==Ne&&(n=v())!==Ne?(e,t=et(t,n),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=H())!==Ne&&Se()!==Ne&&(r=v())!==Ne?(e,t=tt(t,r),e=t):(Yi=e,e=Ne)),e}())===Ne&&(e=function(){var e,t,r,n;return e=Yi,(t=d())!==Ne&&Se()!==Ne&&(r=R())!==Ne&&Se()!==Ne&&W()!==Ne&&Se()!==Ne&&(n=O())!==Ne?(e,t=at(t,r,n),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=d())!==Ne&&Se()!==Ne&&(r=R())!==Ne?(e,t=ot(t,r),e=t):(Yi=e,e=Ne)),e}()),e}())===Ne&&(r=null),r!==Ne?(e,t=Ge(t,r),e=t):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}()),e}function h(){var e;return t.substr(Yi,2)===Ve?(e=Ve,Yi+=2):(e=Ne,0===Ki&&s(qe)),e===Ne&&(62===t.charCodeAt(Yi)?(e=Qe,Yi++):(e=Ne,0===Ki&&s(Ue)),e===Ne&&(t.substr(Yi,2)===He?(e=He,Yi+=2):(e=Ne,0===Ki&&s(Ze)),e===Ne&&(t.substr(Yi,2)===We?(e=We,Yi+=2):(e=Ne,0===Ki&&s(Ye)),e===Ne&&(60===t.charCodeAt(Yi)?(e=Je,Yi++):(e=Ne,0===Ki&&s(Xe)),e===Ne&&(61===t.charCodeAt(Yi)?(e=ze,Yi++):(e=Ne,0===Ki&&s(Be)),e===Ne&&(t.substr(Yi,2)===$e?(e=$e,Yi+=2):(e=Ne,0===Ki&&s(Ke)))))))),e}function d(){var e,t,r,n,i;return e=Yi,t=Yi,(r=Y())!==Ne?(n=Se())!==Ne?(i=Z())!==Ne?t=r=[r,n,i]:(Yi=t,t=Ne):(Yi=t,t=Ne):(Yi=t,t=Ne),t!==Ne&&(e,t=it(t)),(e=t)===Ne&&(e=Z()),e}function y(){var e,t,r,n,i;return e=Yi,t=Yi,(r=Y())!==Ne?(n=Se())!==Ne?(i=U())!==Ne?t=r=[r,n,i]:(Yi=t,t=Ne):(Yi=t,t=Ne):(Yi=t,t=Ne),t!==Ne&&(e,t=it(t)),(e=t)===Ne&&(e=U()),e}function v(){var e,t,r,n,i,a,o,s;if(e=Yi,(t=g())!==Ne){for(r=[],n=Yi,(i=Se())!==Ne?(a=m())!==Ne?(o=Se())!==Ne?(s=g())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);n!==Ne;)r.push(n),n=Yi,(i=Se())!==Ne?(a=m())!==Ne?(o=Se())!==Ne?(s=g())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);r!==Ne?(e,e=t=Pe(t,r)):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}function m(){var e;return 43===t.charCodeAt(Yi)?(e=ct,Yi++):(e=Ne,0===Ki&&s(ft)),e===Ne&&(45===t.charCodeAt(Yi)?(e=pt,Yi++):(e=Ne,0===Ki&&s(ht))),e}function g(){var e,t,r,n,i,a,o,s;if(e=Yi,(t=b())!==Ne){for(r=[],n=Yi,(i=Se())!==Ne?(a=_())!==Ne?(o=Se())!==Ne?(s=b())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);n!==Ne;)r.push(n),n=Yi,(i=Se())!==Ne?(a=_())!==Ne?(o=Se())!==Ne?(s=b())!==Ne?n=i=[i,a,o,s]:(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne):(Yi=n,n=Ne);r!==Ne?(e,e=t=dt(t,r)):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}function _(){var e;return 42===t.charCodeAt(Yi)?(e=yt,Yi++):(e=Ne,0===Ki&&s(vt)),e===Ne&&(47===t.charCodeAt(Yi)?(e=mt,Yi++):(e=Ne,0===Ki&&s(gt))),e}function b(){var e,r;return(e=function(){var e;return(e=O())===Ne&&(e=function(){var e,t,r,n;return e=Yi,(t=function(){var e,t,r,n;return e=Yi,(t=D())!==Ne&&(r=z())!==Ne&&(n=B())!==Ne?(e,t=Tr(t,r,n),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=D())!==Ne&&(r=z())!==Ne?(e,t=Er(t,r),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=D())!==Ne&&(r=B())!==Ne?(e,t=Mr(t,r),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=D())!==Ne&&(e,t=wr(t)),e=t))),e}())!==Ne?(r=Yi,Ki++,n=x(),Ki--,n===Ne?r=void 0:(Yi=r,r=Ne),r!==Ne?(e,t=Sr(t),e=t):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e,t;return e=Yi,(t=q())!==Ne&&(e,t=ar()),(e=t)===Ne&&(e=Yi,(t=Q())!==Ne&&(e,t=or()),e=t),e}())===Ne&&(e=function(){var e,t;return e=Yi,(t=V())!==Ne&&(e,t=ir()),e=t}())===Ne&&(e=function(){var e,t,r;return e=Yi,(t=oe())!==Ne&&Se()!==Ne&&(r=R())!==Ne?(e,t=nr(r),e=t):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e,t,r;return e=Yi,(t=ae())!==Ne&&Se()!==Ne&&(r=R())!==Ne?(e,t=Bt(r),e=t):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e,r,n,i,a;return e=Yi,(r=ue())!==Ne&&Se()!==Ne?(45===t.charCodeAt(Yi)?(n=pt,Yi++):(n=Ne,0===Ki&&s(ht)),n===Ne&&(43===t.charCodeAt(Yi)?(n=ct,Yi++):(n=Ne,0===Ki&&s(ft))),n!==Ne&&Se()!==Ne&&(i=R())!==Ne&&Se()!==Ne&&(a=w())!==Ne?(e,r=kt(n,i,a),e=r):(Yi=e,e=Ne)):(Yi=e,e=Ne),e===Ne&&(e=Yi,(r=ue())!==Ne&&Se()!==Ne&&(n=R())!==Ne&&Se()!==Ne&&(i=w())!==Ne?(e,r=Gt(n,i),e=r):(Yi=e,e=Ne)),e}()),e}())===Ne&&(e=function(){var e,t,r,n;return e=Yi,(t=re())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=function(){var e;return(e=le())===Ne&&(e=ce())===Ne&&(e=fe())===Ne&&(e=pe())===Ne&&(e=he())===Ne&&(e=de()),e}())!==Ne&&Se()!==Ne&&K()!==Ne&&Se()!==Ne&&(n=c())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Ot(r,n),e=t):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e,t,r,n,i,a,o,s,u;return e=Yi,(t=te())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=c())!==Ne&&Se()!==Ne&&K()!==Ne&&Se()!==Ne&&(n=c())!==Ne&&Se()!==Ne?(i=Yi,(a=ee())!==Ne&&(o=Se())!==Ne&&(s=c())!==Ne&&(u=Se())!==Ne?i=a=[a,o,s,u]:(Yi=i,i=Ne),i===Ne&&(i=null),i!==Ne&&(a=xe())!==Ne?(e,t=Ct(r,n,i),e=t):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e,t,r,n,i;return e=Yi,(t=ne())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne?((r=M())===Ne&&(r=null),r!==Ne&&Se()!==Ne&&(n=c())!==Ne&&Se()!==Ne&&K()!==Ne&&Se()!==Ne&&(i=c())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Pt(r,n,i),e=t):(Yi=e,e=Ne)):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=ne())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne?((r=M())===Ne&&(r=null),r!==Ne&&Se()!==Ne&&(n=c())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Lt(r,n),e=t):(Yi=e,e=Ne)):(Yi=e,e=Ne)),e}())===Ne&&(e=function(){var e,t,r,n;return e=Yi,(t=ie())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=c())!==Ne&&Se()!==Ne&&U()!==Ne&&Se()!==Ne&&(n=c())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Dt(r,n),e=t):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e,t,r;return e=Yi,(t=Ee())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne?((r=l())===Ne&&(r=null),r!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=zt(t,r),e=t):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e;return(e=function(){var e,t,r,n,i,a;if(e=Yi,(t=ye())!==Ne)if(Se()!==Ne)if((r=c())!==Ne)if(Se()!==Ne){for(n=[],i=P();i!==Ne;)n.push(i),i=P();n!==Ne?(i=Se())!==Ne?(a=ve())!==Ne?(e,t=mr(r,n),e=t):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne)}else Yi=e,e=Ne;else Yi=e,e=Ne;else Yi=e,e=Ne;else Yi=e,e=Ne;if(e===Ne)if(e=Yi,(t=ye())!==Ne)if(Se()!==Ne)if((r=c())!==Ne)if(Se()!==Ne){for(n=[],i=P();i!==Ne;)n.push(i),i=P();n!==Ne?(i=Se())!==Ne?(a=L())!==Ne?Se()!==Ne?ve()!==Ne?(e,t=gr(r,n,a),e=t):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne)}else Yi=e,e=Ne;else Yi=e,e=Ne;else Yi=e,e=Ne;else Yi=e,e=Ne;return e}())===Ne&&(e=function(){var e,t,r,n,i;if(e=Yi,(t=ye())!==Ne)if(Se()!==Ne){for(r=[],n=C();n!==Ne;)r.push(n),n=C();r!==Ne?(n=Se())!==Ne?(i=ve())!==Ne?(e,t=_r(r),e=t):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne)}else Yi=e,e=Ne;else Yi=e,e=Ne;if(e===Ne)if(e=Yi,(t=ye())!==Ne)if(Se()!==Ne){for(r=[],n=C();n!==Ne;)r.push(n),n=C();r!==Ne?(n=Se())!==Ne?(i=L())!==Ne?Se()!==Ne?ve()!==Ne?(e,t=br(r,i),e=t):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne)}else Yi=e,e=Ne;else Yi=e,e=Ne;return e}()),e}())===Ne&&(e=function(){var e,t;return e=Yi,(t=function(){var e,t;return e=Yi,(t=function(){var e,t,r,n;if(e=Yi,(t=x())!==Ne){for(r=[],n=T();n!==Ne;)r.push(n),n=T();r!==Ne?(e,t=xt(t,r),e=t):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}())!==Ne&&(e,t=It(t)),e=t}())!==Ne&&(e,t=bt(t)),e=t}())===Ne&&(e=E())===Ne&&(e=Yi,Ie()!==Ne?Se()!==Ne?(r=c())!==Ne?Se()!==Ne?xe()!==Ne?(e,e=_t(r)):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne)),e}function I(){var e,t,r,n;if(e=Yi,(t=x())!==Ne){for(r=[],n=S();n!==Ne;)r.push(n),n=S();r!==Ne?(e,e=t=xt(t,r)):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}function x(){var e;return St.test(t.charAt(Yi))?(e=t.charAt(Yi),Yi++):(e=Ne,0===Ki&&s(Tt)),e}function S(){var e;return Et.test(t.charAt(Yi))?(e=t.charAt(Yi),Yi++):(e=Ne,0===Ki&&s(Mt)),e}function T(){var e;return wt.test(t.charAt(Yi))?(e=t.charAt(Yi),Yi++):(e=Ne,0===Ki&&s(Ft)),e}function E(){var e,r,n,i;return e=Yi,r=Yi,64===t.charCodeAt(Yi)?(n=Nt,Yi++):(n=Ne,0===Ki&&s(At)),n!==Ne?(i=I())!==Ne?r=n=[n,i]:(Yi=r,r=Ne):(Yi=r,r=Ne),r!==Ne&&(e,r=Rt(r)),r}function M(){var e;return(e=function(){var e,r,n,i;return e=Yi,t.substr(Yi,7).toLowerCase()===Vn?(r=t.substr(Yi,7),Yi+=7):(r=Ne,0===Ki&&s(qn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,r=Qn(),e=r):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e,r,n,i;return e=Yi,t.substr(Yi,8).toLowerCase()===Un?(r=t.substr(Yi,8),Yi+=8):(r=Ne,0===Ki&&s(Hn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,r=Zn(),e=r):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}())===Ne&&(e=function(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===Wn?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(Yn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,r=Jn(),e=r):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}()),e}function w(){var e,t,r;return e=Yi,(t=function(){var e,t,r;return e=Yi,(t=F())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=A())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Vt(t,r),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=F())!==Ne&&(e,t=qt(t)),e=t),e}())!==Ne?Se()!==Ne?se()!==Ne?Se()!==Ne?(r=function(){var e,t,r,n;return e=Yi,(t=F())!==Ne&&(e,t=Qt(t)),(e=t)===Ne&&(e=Yi,(t=de())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=A())!==Ne&&Se()!==Ne&&be()!==Ne&&Se()!==Ne&&(n=N())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Ut(r,n),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=de())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=A())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Ht(r),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=de())!==Ne&&(e,t=Zt()),e=t))),e}())!==Ne?(e,e=t=jt(t,r)):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne),e===Ne&&(e=function(){var e,t,r,n;return e=Yi,(t=F())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=N())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Wt(t,r),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=F())!==Ne&&(e,t=qt(t)),(e=t)===Ne&&(e=Yi,(t=de())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=A())!==Ne&&Se()!==Ne&&be()!==Ne&&Se()!==Ne&&(n=N())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Ut(r,n),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=de())!==Ne&&Se()!==Ne&&Ie()!==Ne&&Se()!==Ne&&(r=N())!==Ne&&Se()!==Ne&&xe()!==Ne?(e,t=Yt(r),e=t):(Yi=e,e=Ne),e===Ne&&(e=Yi,(t=de())!==Ne&&(e,t=Jt()),e=t)))),e}()),e}function F(){var e,t;return e=Yi,(t=fe())!==Ne&&(e,t=Xt()),(e=t)===Ne&&(e=Yi,(t=pe())!==Ne&&(e,t=$t()),(e=t)===Ne&&(e=Yi,(t=he())!==Ne&&(e,t=Kt()),(e=t)===Ne&&(e=Yi,(t=ce())!==Ne&&(e,t=er()),(e=t)===Ne&&(e=Yi,(t=le())!==Ne&&(e,t=tr()),e=t)))),e}function N(){var e,t;return e=Yi,(t=k())!==Ne&&(e,t=rr(t)),t}function A(){var e,t;return e=Yi,(t=k())!==Ne&&(e,t=rr(t)),t}function R(){var e;return(e=O())===Ne&&(e=E()),e}function O(){var e,r,n,i,a;if(e=Yi,39===t.charCodeAt(Yi)?(r=sr,Yi++):(r=Ne,0===Ki&&s(ur)),r===Ne&&(t.substr(Yi,2)===lr?(r=lr,Yi+=2):(r=Ne,0===Ki&&s(cr))),r!==Ne){for(n=[],i=Yi,t.substr(Yi,2)===fr?(a=fr,Yi+=2):(a=Ne,0===Ki&&s(pr)),a!==Ne&&(i,a=hr()),(i=a)===Ne&&(dr.test(t.charAt(Yi))?(i=t.charAt(Yi),Yi++):(i=Ne,0===Ki&&s(yr)));i!==Ne;)n.push(i),i=Yi,t.substr(Yi,2)===fr?(a=fr,Yi+=2):(a=Ne,0===Ki&&s(pr)),a!==Ne&&(i,a=hr()),(i=a)===Ne&&(dr.test(t.charAt(Yi))?(i=t.charAt(Yi),Yi++):(i=Ne,0===Ki&&s(yr)));n!==Ne?(39===t.charCodeAt(Yi)?(i=sr,Yi++):(i=Ne,0===Ki&&s(ur)),i!==Ne?(e,e=r=vr(n)):(Yi=e,e=Ne)):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}function C(){var e,t,r;return e=Yi,me()!==Ne?Se()!==Ne?(t=c())!==Ne?Se()!==Ne?ge()!==Ne?Se()!==Ne?(r=c())!==Ne?(e,e=Ir(t,r)):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne),e}function P(){var e,t,r;return e=Yi,me()!==Ne?Se()!==Ne?(t=c())!==Ne?Se()!==Ne?ge()!==Ne?Se()!==Ne?(r=c())!==Ne?(e,e=Ir(t,r)):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne),e}function L(){var e,t;return e=Yi,_e()!==Ne?Se()!==Ne?(t=c())!==Ne?(e,e=xr(t)):(Yi=e,e=Ne):(Yi=e,e=Ne):(Yi=e,e=Ne),e}function D(){var e,r,n;return(e=k())===Ne&&(e=Yi,45===t.charCodeAt(Yi)?(r=pt,Yi++):(r=Ne,0===Ki&&s(ht)),r===Ne&&(43===t.charCodeAt(Yi)?(r=ct,Yi++):(r=Ne,0===Ki&&s(ft))),r!==Ne?(n=k())!==Ne?(e,e=r=Fr(r,n)):(Yi=e,e=Ne):(Yi=e,e=Ne)),e}function z(){var e,r,n;return e=Yi,46===t.charCodeAt(Yi)?(r=Nr,Yi++):(r=Ne,0===Ki&&s(Ar)),r!==Ne?((n=k())===Ne&&(n=null),n!==Ne?(e,e=r=Rr(n)):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function B(){var e,t,r;return e=Yi,(t=j())!==Ne?(r=k())!==Ne?(e,e=t=Or(t,r)):(Yi=e,e=Ne):(Yi=e,e=Ne),e}function k(){var e,t,r;if(e=Yi,t=[],(r=G())!==Ne)for(;r!==Ne;)t.push(r),r=G();else t=Ne;return t!==Ne&&(e,t=Cr(t)),t}function G(){var e;return Pr.test(t.charAt(Yi))?(e=t.charAt(Yi),Yi++):(e=Ne,0===Ki&&s(Lr)),e}function j(){var e,r,n;return e=Yi,Dr.test(t.charAt(Yi))?(r=t.charAt(Yi),Yi++):(r=Ne,0===Ki&&s(zr)),r!==Ne?(Br.test(t.charAt(Yi))?(n=t.charAt(Yi),Yi++):(n=Ne,0===Ki&&s(kr)),n===Ne&&(n=null),n!==Ne?(e,e=r=Gr(r,n)):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function V(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===jr?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(Vr)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?e=r=[r,n]:(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function q(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===qr?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(Qr)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?e=r=[r,n]:(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function Q(){var e,r,n,i;return e=Yi,t.substr(Yi,5).toLowerCase()===Ur?(r=t.substr(Yi,5),Yi+=5):(r=Ne,0===Ki&&s(Hr)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?e=r=[r,n]:(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function U(){var e,r,n,i;return e=Yi,t.substr(Yi,2).toLowerCase()===Zr?(r=t.substr(Yi,2),Yi+=2):(r=Ne,0===Ki&&s(Wr)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Yr()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function H(){var e,r,n,i;return e=Yi,t.substr(Yi,2).toLowerCase()===Jr?(r=t.substr(Yi,2),Yi+=2):(r=Ne,0===Ki&&s(Xr)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=$r()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function Z(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===Kr?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(en)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=tn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function W(){var e,r,n,i;return e=Yi,t.substr(Yi,6).toLowerCase()===rn?(r=t.substr(Yi,6),Yi+=6):(r=Ne,0===Ki&&s(nn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=an()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function Y(){var e,r,n,i;return e=Yi,t.substr(Yi,3).toLowerCase()===on?(r=t.substr(Yi,3),Yi+=3):(r=Ne,0===Ki&&s(sn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=un()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function J(){var e,r,n,i;return e=Yi,t.substr(Yi,3).toLowerCase()===ln?(r=t.substr(Yi,3),Yi+=3):(r=Ne,0===Ki&&s(cn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=fn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function X(){var e,r,n,i;return e=Yi,t.substr(Yi,2).toLowerCase()===pn?(r=t.substr(Yi,2),Yi+=2):(r=Ne,0===Ki&&s(hn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=dn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function $(){var e,r,n,i;return e=Yi,t.substr(Yi,7).toLowerCase()===yn?(r=t.substr(Yi,7),Yi+=7):(r=Ne,0===Ki&&s(vn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=mn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function K(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===gn?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(_n)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=bn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ee(){var e,r,n,i;return e=Yi,t.substr(Yi,3).toLowerCase()===In?(r=t.substr(Yi,3),Yi+=3):(r=Ne,0===Ki&&s(xn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Sn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function te(){var e,r,n,i;return e=Yi,t.substr(Yi,9).toLowerCase()===Tn?(r=t.substr(Yi,9),Yi+=9):(r=Ne,0===Ki&&s(En)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Mn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function re(){var e,r,n,i;return e=Yi,t.substr(Yi,7).toLowerCase()===wn?(r=t.substr(Yi,7),Yi+=7):(r=Ne,0===Ki&&s(Fn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Nn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ne(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===An?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(Rn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=On()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ie(){var e,r,n,i;return e=Yi,t.substr(Yi,8).toLowerCase()===Cn?(r=t.substr(Yi,8),Yi+=8):(r=Ne,0===Ki&&s(Pn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Ln()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ae(){var e,r,n,i;return e=Yi,t.substr(Yi,9).toLowerCase()===Dn?(r=t.substr(Yi,9),Yi+=9):(r=Ne,0===Ki&&s(zn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Bn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function oe(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===kn?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(Gn)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=jn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function se(){var e,r,n,i;return e=Yi,t.substr(Yi,2).toLowerCase()===Xn?(r=t.substr(Yi,2),Yi+=2):(r=Ne,0===Ki&&s($n)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Kn()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ue(){var e,r,n,i;return e=Yi,t.substr(Yi,8).toLowerCase()===ei?(r=t.substr(Yi,8),Yi+=8):(r=Ne,0===Ki&&s(ti)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=ri()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function le(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===ni?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(ii)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=ai()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ce(){var e,r,n,i;return e=Yi,t.substr(Yi,5).toLowerCase()===oi?(r=t.substr(Yi,5),Yi+=5):(r=Ne,0===Ki&&s(si)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=ui()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function fe(){var e,r,n,i;return e=Yi,t.substr(Yi,3).toLowerCase()===li?(r=t.substr(Yi,3),Yi+=3):(r=Ne,0===Ki&&s(ci)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=fi()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function pe(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===pi?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(hi)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=di()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function he(){var e,r,n,i;return e=Yi,t.substr(Yi,6).toLowerCase()===yi?(r=t.substr(Yi,6),Yi+=6):(r=Ne,0===Ki&&s(vi)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=mi()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function de(){var e,r,n,i;return e=Yi,t.substr(Yi,6).toLowerCase()===gi?(r=t.substr(Yi,6),Yi+=6):(r=Ne,0===Ki&&s(_i)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=bi()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ye(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===Ii?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(xi)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Si()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ve(){var e,r,n,i;return e=Yi,t.substr(Yi,3).toLowerCase()===Ti?(r=t.substr(Yi,3),Yi+=3):(r=Ne,0===Ki&&s(Ei)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Mi()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function me(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===wi?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(Fi)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Ni()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function ge(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===Ai?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(Ri)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Oi()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function _e(){var e,r,n,i;return e=Yi,t.substr(Yi,4).toLowerCase()===Ci?(r=t.substr(Yi,4),Yi+=4):(r=Ne,0===Ki&&s(Pi)),r!==Ne?(n=Yi,Ki++,i=S(),Ki--,i===Ne?n=void 0:(Yi=n,n=Ne),n!==Ne?(e,e=r=Li()):(Yi=e,e=Ne)):(Yi=e,e=Ne),e}function be(){var e;return 44===t.charCodeAt(Yi)?(e=Di,Yi++):(e=Ne,0===Ki&&s(zi)),e}function Ie(){var e;return 40===t.charCodeAt(Yi)?(e=Bi,Yi++):(e=Ne,0===Ki&&s(ki)),e}function xe(){var e;return 41===t.charCodeAt(Yi)?(e=Gi,Yi++):(e=Ne,0===Ki&&s(ji)),e}function Se(){var e,t;for(e=[],t=Te();t!==Ne;)e.push(t),t=Te();return e}function Te(){var e;return Vi.test(t.charAt(Yi))?(e=t.charAt(Yi),Yi++):(e=Ne,0===Ki&&s(qi)),e}function Ee(){var e,r,n,i;if(e=Yi,(r=I())!==Ne&&(e,r=It(r)),(e=r)===Ne)if(e=Yi,96===t.charCodeAt(Yi)?(r=Qi,Yi++):(r=Ne,0===Ki&&s(Ui)),r!==Ne){if(n=[],Hi.test(t.charAt(Yi))?(i=t.charAt(Yi),Yi++):(i=Ne,0===Ki&&s(Zi)),i!==Ne)for(;i!==Ne;)n.push(i),Hi.test(t.charAt(Yi))?(i=t.charAt(Yi),Yi++):(i=Ne,0===Ki&&s(Zi));else n=Ne;n!==Ne?(96===t.charCodeAt(Yi)?(i=Qi,Yi++):(i=Ne,0===Ki&&s(Ui)),i!==Ne?(e,e=r=Wi(n)):(Yi=e,e=Ne)):(Yi=e,e=Ne)}else Yi=e,e=Ne;return e}function Me(e,t,r,n){var i={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(i.escape=n),i}function we(e,t){for(var r=e,n=0;n<t.length;n++)r=Me(t[n][1],r,t[n][3]);return r}r=void 0!==r?r:{};var Fe,Ne={},Ae={start:u},Re=u,Oe=function(e){return e},Ce=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r},Pe=function(e,t){return we(e,t)},Le="!",De=n("!",!1),ze="=",Be=n("=",!1),ke=function(e){return function(e,t){return{type:"unary_expr",operator:e,expr:t}}("NOT",e)},Ge=function(e,t){return""==t||null==t||null==t?e:"arithmetic"==t.type?we(e,t.tail):Me(t.op,e,t.right,t.escape)},je=function(e){return{type:"arithmetic",tail:e}},Ve=">=",qe=n(">=",!1),Qe=">",Ue=n(">",!1),He="<=",Ze=n("<=",!1),We="<>",Ye=n("<>",!1),Je="<",Xe=n("<",!1),$e="!=",Ke=n("!=",!1),et=function(e,t){return{op:e+"NOT",right:t}},tt=function(e,t){return{op:e,right:t}},rt=function(e,t,r){return{op:"NOT"+e,right:{type:"expr_list",value:[t,r]}}},nt=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}},it=function(e){return e[0]+" "+e[2]},at=function(e,t,r){return{op:e,right:t,escape:r.value}},ot=function(e,t){return{op:e,right:t,escape:""}},st=function(e,t){return{op:e,right:t}},ut=function(e){return{op:e,right:{type:"expr_list",value:[]}}},lt=function(e,t){return{op:e,right:t}},ct="+",ft=n("+",!1),pt="-",ht=n("-",!1),dt=function(e,t){return we(e,t)},yt="*",vt=n("*",!1),mt="/",gt=n("/",!1),_t=function(e){return e.paren=!0,e},bt=function(e){return{type:"column_ref",table:"",column:e}},It=function(e){return e},xt=function(e,t){return e+t.join("")},St=/^[A-Za-z_\x80-\uFFFF]/,Tt=i([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),Et=/^[A-Za-z0-9_]/,Mt=i([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),wt=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ft=i([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),Nt="@",At=n("@",!1),Rt=function(e){return{type:"param",value:e[1]}},Ot=function(e,t){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},t]}}},Ct=function(e,t,r){return{type:"function",name:"substring",args:{type:"expr_list",value:r?[e,t,r[2]]:[e,t]}}},Pt=function(e,t,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t,r]}}},Lt=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}},Dt=function(e,t){return{type:"function",name:"position",args:{type:"expr_list",value:[e,t]}}},zt=function(e,t){return{type:"function",name:e,args:t||{type:"expr_list",value:[]}}},Bt=function(e){return{type:"timestamp",value:e.value}},kt=function(e,t,r){return{type:"interval",value:t,qualifier:r,op:e}},Gt=function(e,t){return{type:"interval",value:e,qualifier:t,op:""}},jt=function(e,t){return{type:"interval-qualifier",start:e,end:t}},Vt=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}},qt=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},Qt=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},Ut=function(e,t){return{type:"interval-period",period:"second",precision:e,secondary:t}},Ht=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}},Zt=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Wt=function(e,t){return{type:"interval-period",period:e.value,precision:t,secondary:null}},Yt=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}},Jt=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Xt=function(){return{type:"string",value:"day"}},$t=function(){return{type:"string",value:"hour"}},Kt=function(){return{type:"string",value:"minute"}},er=function(){return{type:"string",value:"month"}},tr=function(){return{type:"string",value:"year"}},rr=function(e){return parseFloat(e)},nr=function(e){return{type:"date",value:e.value}},ir=function(){return{type:"null",value:null}},ar=function(){return{type:"bool",value:!0}},or=function(){return{type:"bool",value:!1}},sr="'",ur=n("'",!1),lr="N'",cr=n("N'",!1),fr="''",pr=n("''",!1),hr=function(){return"'"},dr=/^[^']/,yr=i(["'"],!0,!1),vr=function(e){return{type:"string",value:e.join("")}},mr=function(e,t){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:null}},gr=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}},_r=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}},br=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}},Ir=function(e,t){return{type:"when_clause",operand:e,value:t}},xr=function(e){return{type:"else_clause",value:e}},Sr=function(e){return{type:"number",value:e}},Tr=function(e,t,r){return parseFloat(e+t+r)},Er=function(e,t){return parseFloat(e+t)},Mr=function(e,t){return parseFloat(e+t)},wr=function(e){return parseFloat(e)},Fr=function(e,t){return e[0]+t},Nr=".",Ar=n(".",!1),Rr=function(e){return"."+(null!=e?e:"")},Or=function(e,t){return e+t},Cr=function(e){return e.join("")},Pr=/^[0-9]/,Lr=i([["0","9"]],!1,!1),Dr=/^[eE]/,zr=i(["e","E"],!1,!1),Br=/^[+\-]/,kr=i(["+","-"],!1,!1),Gr=function(e,t){return"e"+(null===t?"":t)},jr="null",Vr=n("NULL",!0),qr="true",Qr=n("TRUE",!0),Ur="false",Hr=n("FALSE",!0),Zr="in",Wr=n("IN",!0),Yr=function(){return"IN"},Jr="is",Xr=n("IS",!0),$r=function(){return"IS"},Kr="like",en=n("LIKE",!0),tn=function(){return"LIKE"},rn="escape",nn=n("ESCAPE",!0),an=function(){return"ESCAPE"},on="not",sn=n("NOT",!0),un=function(){return"NOT"},ln="and",cn=n("AND",!0),fn=function(){return"AND"},pn="or",hn=n("OR",!0),dn=function(){return"OR"},yn="between",vn=n("BETWEEN",!0),mn=function(){return"BETWEEN"},gn="from",_n=n("FROM",!0),bn=function(){return"FROM"},In="for",xn=n("FOR",!0),Sn=function(){return"FOR"},Tn="substring",En=n("SUBSTRING",!0),Mn=function(){return"SUBSTRING"},wn="extract",Fn=n("EXTRACT",!0),Nn=function(){return"EXTRACT"},An="trim",Rn=n("TRIM",!0),On=function(){return"TRIM"},Cn="position",Pn=n("POSITION",!0),Ln=function(){return"POSITION"},Dn="timestamp",zn=n("TIMESTAMP",!0),Bn=function(){return"TIMESTAMP"},kn="date",Gn=n("DATE",!0),jn=function(){return"DATE"},Vn="leading",qn=n("LEADING",!0),Qn=function(){return"LEADING"},Un="trailing",Hn=n("TRAILING",!0),Zn=function(){return"TRAILING"},Wn="both",Yn=n("BOTH",!0),Jn=function(){return"BOTH"},Xn="to",$n=n("TO",!0),Kn=function(){return"TO"},ei="interval",ti=n("INTERVAL",!0),ri=function(){return"INTERVAL"},ni="year",ii=n("YEAR",!0),ai=function(){return"YEAR"},oi="month",si=n("MONTH",!0),ui=function(){return"MONTH"},li="day",ci=n("DAY",!0),fi=function(){return"DAY"},pi="hour",hi=n("HOUR",!0),di=function(){return"HOUR"},yi="minute",vi=n("MINUTE",!0),mi=function(){return"MINUTE"},gi="second",_i=n("SECOND",!0),bi=function(){return"SECOND"},Ii="case",xi=n("CASE",!0),Si=function(){return"CASE"},Ti="end",Ei=n("END",!0),Mi=function(){return"END"},wi="when",Fi=n("WHEN",!0),Ni=function(){return"WHEN"},Ai="then",Ri=n("THEN",!0),Oi=function(){return"THEN"},Ci="else",Pi=n("ELSE",!0),Li=function(){return"ELSE"},Di=",",zi=n(",",!1),Bi="(",ki=n("(",!1),Gi=")",ji=n(")",!1),Vi=/^[ \t\n\r]/,qi=i([" ","\t","\n","\r"],!1,!1),Qi="`",Ui=n("`",!1),Hi=/^[^`]/,Zi=i(["`"],!0,!1),Wi=function(e){return e.join("")},Yi=0,Ji=[{line:1,column:1}],Xi=0,$i=[],Ki=0;if("startRule"in r){if(!(r.startRule in Ae))throw new Error("Can't start parsing from rule \""+r.startRule+'".');Re=Ae[r.startRule]}if((Fe=Re())!==Ne&&Yi===t.length)return Fe;throw Fe!==Ne&&Yi<t.length&&s({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}($i,Xi<t.length?t.charAt(Xi):null,Xi<t.length?o(Xi,Xi+1):o(Xi,Xi))}}}.apply(null,[]))||(e.exports=n)},983:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(6),r(8),r(56),r(16),r(4),r(885),r(37),r(880),r(984),r(900),r(886),r(922),r(901)],void 0===(i=function(e,t,r,n,i,a,o,s,u,l,c,f,p,h,d,y){Object.defineProperty(t,"__esModule",{value:!0});var v=function(){function e(e,t,r){this.items=e,this.queryGeometry=t,this.definitionExpression=r.definitionExpression,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.fieldsIndex=r.fieldsIndex,this.timeInfo=r.timeInfo,this.featureAdapter=r.featureAdapter}return Object.defineProperty(e.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),e.prototype.createQueryResponse=function(e){var t;return t=e.outStatistics?e.outStatistics.some((function(e){return"exceedslimit"===e.statisticType}))?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e),e.returnQueryGeometry&&(l.isValid(e.outSR)&&!l.equals(this.queryGeometry.spatialReference,e.outSR)?t.queryGeometry=y.cleanFromGeometryEngine(r({spatialReference:e.outSR},h.project(this.queryGeometry,this.queryGeometry.spatialReference,e.outSR))):t.queryGeometry=y.cleanFromGeometryEngine(r({spatialReference:e.outSR},this.queryGeometry))),t},e.prototype.executeAttributesQuery=function(t){var r=p.getWhereClause(t.where,this.fieldsIndex);if(!r)return s.resolve(this);if(r.isStandardized){for(var n=0,i=[],a=0,o=this.items;a<o.length;a++){var u=o[a];r.testFeature(u,this.featureAdapter)&&(i[n++]=u)}var l=new e(i,this.queryGeometry,this);return l.definitionExpression=t.where,s.resolve(l)}return s.reject(new TypeError("Where clause is not standardized"))},e.prototype.executeObjectIdsQuery=function(t){if(!t.objectIds||!t.objectIds.length)return s.resolve(this);var r=a.SetFromValues(t.objectIds),n=this.featureAdapter.getObjectId;return s.resolve(new e(this.items.filter((function(e){return r.has(n(e))})),this.queryGeometry,this))},e.prototype.executeTimeQuery=function(t){var r=d.getTimeOperator(this.timeInfo,t.timeExtent,this.featureAdapter);if(!o.isSome(r))return s.resolve(this);var n=this.items.filter(r);return s.resolve(new e(n,this.queryGeometry,this))},e.prototype.project=function(t){return i(this,void 0,void 0,(function(){var r,i,a=this;return n(this,(function(n){switch(n.label){case 0:return!t||l.equals(this.spatialReference,t)?[2,this]:(r=this.featureAdapter,[4,h.projectMany(this.items.map((function(e){return y.getGeometry(a,r.getGeometry(e))})),this.spatialReference,t)]);case 1:return i=n.sent(),[2,new e(i.map((function(e,t){return r.cloneWithGeometry(a.items[t],c.convertFromGeometry(e,a.hasZ,a.hasM))})),this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:t,fieldsIndex:this.fieldsIndex,timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}}))}))},e.prototype._createFeatureQueryResponse=function(e){var t=this,r=this.items,n=this,i=n.geometryType,a=n.hasM,o=n.hasZ,s=n.objectIdField,l=n.spatialReference,c=e.outFields,f=e.outSR,p=e.quantizationParameters,h=e.resultRecordCount,d=e.resultOffset,v=!1;if(null!=h&&null!=d){var m=d+h;v=r.length>m,r=r.slice(d,Math.min(r.length,m))}return{exceededTransferLimit:v,features:this._createFeatures(e,r),fields:c&&c.map((function(e){return t.fieldsIndex.get(e)})),geometryType:i,hasM:a,hasZ:o,objectIdFieldName:s,spatialReference:y.cleanFromGeometryEngine(f||l),transform:p&&u.toQuantizationTransform(p)||null}},e.prototype._createFeatures=function(e,t){var r=new f.default(e,this.featureAdapter,this.fieldsIndex),n=e.quantizationParameters,i=e.returnGeometry,a=e.returnCentroid,o=e.maxAllowableOffset,s=e.orderByFields,l=[],c=0;if(t.length&&s&&s.length){var p=s[0].split(" "),h=p[0],d=this.fieldsIndex.get(h),v="DESC"===p[1];t.sort((function(e,t){var n=r.getFieldValue(e,h,d),i=r.getFieldValue(t,h,d);if("number"==typeof n&&"number"==typeof i)return v?i-n:n-i;if("string"==typeof n&&"string"==typeof i){var a=n.toUpperCase(),o=i.toUpperCase();return(v?a>o:a<o)?-1:(v?a<o:a>o)?1:0}}))}if(i||a){var m=u.toQuantizationTransform(n);if(i&&!a)for(var g=0,_=t;g<_.length;g++){var b=_[g];l[c++]={attributes:r.getAttributes(b),geometry:y.getGeometry(this,this.featureAdapter.getGeometry(b),o,m)}}else if(!i&&a)for(var I=0,x=t;I<x.length;I++){b=x[I];l[c++]={attributes:r.getAttributes(b),centroid:y.transformCentroid(this,this.featureAdapter.getCentroid(b,this),m)}}else for(var S=0,T=t;S<T.length;S++){b=T[S];l[c++]={attributes:r.getAttributes(b),centroid:y.transformCentroid(this,this.featureAdapter.getCentroid(b,this),m),geometry:y.getGeometry(this,this.featureAdapter.getGeometry(b),o,m)}}}else for(var E=0,M=t;E<M.length;E++){b=M[E];var w=r.getAttributes(b);w&&(l[c++]={attributes:w})}return l},e.prototype._createExceedsLimitQueryResponse=function(e){for(var t=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=0,o=e.outStatistics;a<o.length;a++){var s=o[a];if("exceedslimit"===s.statisticType){r=null!=s.maxPointCount?s.maxPointCount:Number.POSITIVE_INFINITY,n=null!=s.maxRecordCount?s.maxRecordCount:Number.POSITIVE_INFINITY,i=null!=s.maxVertexCount?s.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>n)t=!0;else{var u=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter;t=this.items.reduce((function(e,t){var r=l.getGeometry(t);return e+(r&&r.coords.length||0)}),0)/u>i}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}},e.prototype._createStatisticsQueryResponse=function(e){for(var t=new f.default(e,this.featureAdapter,this.fieldsIndex),r=e.outStatistics,n=[],i=[],a=e.groupByFieldsForStatistics,o=e.having,s=a&&a.length,u=s&&a[0],l=this.fieldsIndex.get(u),c=!l,p={},h={},d={},y={attributes:{}},v=0,m=r;v<m.length;v++){var g=m[v],_=g.outStatisticFieldName,b=g.statisticType,I="exceedslimit"!==b?g.onStatisticField:void 0,x=this.fieldsIndex.get(I),S=s&&(I===u||c)&&"count"===b;if(s){p[I]||(p[I]=this._calculateUniqueValues(t,u,l));var T=p[I];for(var E in T){var M=T[E],w=M.count,F=M.data,N=M.items;if(!o||t.validateItems(N,o)){var A=h[F]||{attributes:{}},R=null;if(S)R=w;else R=(O=this._calculateStatistics(N,t,I,x))[C="var"===b?"variance":b];A.attributes[_]=R,A.attributes[c?"EXPR_1":u]=F,h[F]=A}}}else{d[I]||(d[I]=this._calculateStatistics(this.items,t,I,x));var O=d[I],C="var"===b?"variance":b;y.attributes[_]=O[C]}i.push({name:_,alias:_,type:"esriFieldTypeDouble"})}if(s)for(var P in h)n.push(h[P]);else n.push(y);return{fields:i,features:n}},e.prototype._calculateStatistics=function(e,t,r,n){for(var i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=null,s=null,u=null,l=null,c=[],f=0,p=0;p<e.length;p++){var h=e[p];"string"==typeof(m=t.getFieldValue(h,r,n))?f++:null==m||isNaN(m)||(o+=m,i=Math.min(i,m),a=Math.max(a,m),c.push(m),f++)}if(f){s=o/f;for(var d=0,y=0,v=c;y<v.length;y++){var m=v[y];d+=Math.pow(m-s,2)}l=f>1?d/(f-1):0,u=Math.sqrt(l)}else i=null,a=null;return{avg:s,count:f,max:a,min:i,stddev:u,sum:o,variance:l}},e.prototype._calculateUniqueValues=function(e,t,r){for(var n={},i=0,a=this.items;i<a.length;i++){var o=a[i],s=e.getFieldValue(o,t,r);(null==s||"string"==typeof s&&""===s.trim())&&(s=null),null==n[s]?n[s]={count:1,data:s,items:[o]}:(n[s].count++,n[s].items.push(o))}return n},e}();t.default=v}.apply(null,n))||(e.exports=i)},984:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(16),r(900)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues,this.fieldsIndex=r,this.featureAdapter=t;var i=e.outFields;if(i&&-1===i.indexOf("*")){this.outFields=i;for(var a=0,o=0,s=i;o<s.length;o++){var u=s[o],l=n.getExpressionFromFieldName(u),c=this.fieldsIndex.get(l),f=c?null:n.getWhereClause(l,r),p=c?c.name:n.getAliasFromFieldName(u)||"FIELD_EXP_"+a++;this._fieldDataCache.set(u,{alias:p,clause:f})}}}return e.prototype.getAttributes=function(e){var t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)},e.prototype.getFieldValue=function(e,t,r){var i=r?r.name:t,a=null;return this._fieldDataCache.has(i)?a=this._fieldDataCache.get(i).clause:r||(a=n.getWhereClause(t,this.fieldsIndex),this._fieldDataCache.set(i,{alias:i,clause:a})),r?this.featureAdapter.getAttribute(e,i):a.calculateValue(e,this.featureAdapter)},e.prototype.validateItem=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testFeature(e,this.featureAdapter)},e.prototype.validateItems=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t,this.fieldsIndex)}),this._fieldDataCache.get(t).clause.testSet(e,this.featureAdapter)},e.prototype._processAttributesForOutFields=function(e){var t=this.outFields;if(!t||!t.length)return this.featureAdapter.getAttributes(e);for(var r={},n=0,i=t;n<i.length;n++){var a=i[n],o=this._fieldDataCache.get(a),s=o.alias,u=o.clause;r[s]=u?u.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,s)}return r},e.prototype._processAttributesForDistinctValues=function(e){if(r.isNone(e)||!this.returnDistinctValues)return e;var t=this.outFields,n=[];if(t)for(var i=0,a=t;i<a.length;i++){var o=a[i],s=this._fieldDataCache.get(o).alias;n.push(e[s])}else for(var s in e)n.push(e[s]);var u=(t||["*"]).join(",")+"="+n.join(","),l=this._returnDistinctMap.get(u)||0;return this._returnDistinctMap.set(u,++l),l>1?null:e},e}();t.default=i}.apply(null,n))||(e.exports=i)},985:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(4)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._deferreds=[],this._values=[]}return e.prototype.push=function(e){var t=this;return r.create((function(r,n){t._deferreds.push({resolve:r,reject:n}),t._values.push(e)}))},e.prototype.unshift=function(e){var t=this;return r.create((function(r,n){t._deferreds.unshift({resolve:r,reject:n}),t._values.unshift(e)}))},Object.defineProperty(e.prototype,"length",{get:function(){return this._deferreds.length},enumerable:!0,configurable:!0}),e.prototype.process=function(){return 0!==this.length&&(this._deferreds.shift().resolve(this._values.shift()),!0)},e.prototype.cancelAll=function(){for(var e=r.createAbortError(),t=0,n=this._deferreds;t<n.length;t++)n[t].reject(e);this._deferreds.length=0,this._values.length=0},e}();t.PromiseQueue=n}.apply(null,n))||(e.exports=i)}}]);