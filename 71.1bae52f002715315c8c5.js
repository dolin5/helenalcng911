(function(){(this||window).webpackJsonp.registerAbsMids({"esri/tasks/RouteTask":593,"esri/tasks/Task":618,"esri/tasks/support/GPMessage":698,"esri/core/queryUtils":735,"esri/tasks/mixins/NAServiceDescription":736,"esri/tasks/support/NAMessage":737,"esri/tasks/support/DirectionsFeatureSet":815,"esri/tasks/support/RouteResultsContainer":1251,"esri/tasks/support/RouteResult":1252})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[71],{1251:function(e,r,t){var s,o;s=[t.dj.c(e.i),r,t(1),t(0),t(67),t(3),t(2),t(315),t(174),t(737),t(1252)],void 0===(o=function(e,r,t,s,o,n,i,a,u,p,l){function c(e){return e&&u.fromJSON(e).features.map((function(e){return e}))}return function(e){function r(r){var t=e.call(this)||this;return t.barriers=null,t.messages=null,t.pointBarriers=null,t.polylineBarriers=null,t.polygonBarriers=null,t.routeResults=null,t}return t(r,e),r.prototype.readPointBarriers=function(e,r){return c(r.barriers||r.pointBarriers)},r.prototype.readPolylineBarriers=function(e){return c(e)},r.prototype.readPolygonBarriers=function(e){return c(e)},s([i.property({aliasOf:"pointBarriers"})],r.prototype,"barriers",void 0),s([i.property({type:[p]})],r.prototype,"messages",void 0),s([i.property({type:[o]})],r.prototype,"pointBarriers",void 0),s([a.reader("pointBarriers",["barriers","pointBarriers"])],r.prototype,"readPointBarriers",null),s([i.property({type:[o]})],r.prototype,"polylineBarriers",void 0),s([a.reader("polylineBarriers")],r.prototype,"readPolylineBarriers",null),s([i.property({type:[o]})],r.prototype,"polygonBarriers",void 0),s([a.reader("polygonBarriers")],r.prototype,"readPolygonBarriers",null),s([i.property({type:[l]})],r.prototype,"routeResults",void 0),s([i.subclass("esri.tasks.support.RouteResultsContainer")],r)}(i.declared(n.JSONSupport))}.apply(null,s))||(e.exports=o)},1252:function(e,r,t){var s,o;s=[t.dj.c(e.i),r,t(0),t(1),t(67),t(3),t(2),t(815)],void 0===(o=function(e,r,t,s,o,n,i,a){return function(e){function r(r){var t=e.call(this,r)||this;return t.directions=null,t.route=null,t.routeName=null,t.stops=null,t}return s(r,e),t([i.property({type:a,json:{write:!0}})],r.prototype,"directions",void 0),t([i.property({type:o,json:{write:!0}})],r.prototype,"route",void 0),t([i.property({type:String,json:{write:!0}})],r.prototype,"routeName",void 0),t([i.property({type:[o],json:{write:!0}})],r.prototype,"stops",void 0),t([i.subclass("esri.tasks.support.RouteResult")],r)}(i.declared(n.JSONSupport))}.apply(null,s))||(e.exports=o)},593:function(e,r,t){var s,o;s=[t.dj.c(e.i),r,t(0),t(1),t(7),t(41),t(46),t(4),t(735),t(63),t(2),t(271),t(618),t(736),t(1251)],void 0===(o=function(e,r,t,s,o,n,i,a,u,p,l,c,f,d,y){var v=u.createQueryParamsHelper({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},outSpatialReference:{name:"outSR",getter:function(e){return e.outSpatialReference.wkid}},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},stops:!0,travelMode:!0});return function(e){function r(r){return e.call(this)||this}return s(r,e),r.prototype.solve=function(e,r){var t=this,s=[],u=[],l={},f={};return e.stops&&e.stops.features&&this._collectGeometries(e.stops.features,u,"stops.features",l),e.pointBarriers&&e.pointBarriers.features&&this._collectGeometries(e.pointBarriers.features,u,"pointBarriers.features",l),e.polylineBarriers&&e.polylineBarriers.features&&this._collectGeometries(e.polylineBarriers.features,u,"polylineBarriers.features",l),e.polygonBarriers&&e.polygonBarriers.features&&this._collectGeometries(e.polygonBarriers.features,u,"polygonBarriers.features",l),i.safeCast(c.normalizeCentralMeridian(u)).then((function(e){for(var r in l){var o=l[r];s.push(r),f[r]=e.slice(o[0],o[1])}return t._isInputGeometryZAware(f,s)?i.safeCast(t.getServiceDescription()):a.resolve({dontCheck:!0})})).then((function(i){for(var a in("dontCheck"in i?i.dontCheck:i.hasZ)||t._dropZValuesOffInputGeometry(f,s),f)!function(r){f[r].forEach((function(t,s){e.get(r)[s].geometry=t}))}(a);var u={query:o({},t.parsedUrl.query,{f:"json"},v.toQueryParams(e))};(t.requestOptions||r)&&(u=o({},t.requestOptions,r,u));var l=t.parsedUrl.path,c=p.endsWith(l,"/solve")?l:l+"/solve";return n(c,u)})).then((function(e){return t._handleSolveResponse(e)}))},r.prototype._collectGeometries=function(e,r,t,s){s[t]=[r.length,r.length+e.length],e.forEach((function(e){r.push(e.geometry)}))},r.prototype._handleSolveResponse=function(e){var r,t,s=[],o=[],n=e.data,i=n.directions,a=void 0===i?[]:i,u=n.routes,p=void 0===u?{}:u,l=p.features,c=void 0===l?[]:l,f=p.spatialReference,d=void 0===f?null:f,v=n.stops,h=void 0===v?{}:v,m=h.features,g=void 0===m?[]:m,b=h.spatialReference,T=void 0===b?null:b,S=n.barriers,M=n.polygonBarriers,w=n.polylineBarriers,N=n.messages,O="esri.tasks.RouteTask.NULL_ROUTE_NAME",B=!0,R=c&&d||g&&T||S&&S.spatialReference||M&&M.spatialReference||w&&w.spatialReference;a.forEach((function(e){s.push(r=e.routeName),o[r]={directions:e}})),c.forEach((function(e){-1===s.indexOf(r=e.attributes.Name)&&(s.push(r),o[r]={}),e.geometry&&(e.geometry.spatialReference=R),o[r].route=e})),g.forEach((function(e){t=e.attributes,-1===s.indexOf(r=t.RouteName||O)&&(s.push(r),o[r]={}),r!==O&&(B=!1),e.geometry&&(e.geometry.spatialReference=R),null==o[r].stops&&(o[r].stops=[]),o[r].stops.push(e)})),g.length>0&&!0===B&&(o[s[0]].stops=o[O].stops,delete o[O],s.splice(s.indexOf(O),1));var k=s.map((function(e){return o[e].routeName=e===O?null:e,o[e]}));return y.fromJSON({routeResults:k,pointBarriers:S,polygonBarriers:M,polylineBarriers:w,messages:N})},t([l.subclass("esri.tasks.RouteTask")],r)}(l.declared(d.NAServiceDescriptionMixin(f)))}.apply(null,s))||(e.exports=o)},618:function(e,r,t){var s,o;s=[t.dj.c(e.i),r,t(1),t(0),t(74),t(7),t(10),t(22),t(2)],void 0===(o=function(e,r,t,s,o,n,i,a,u){return function(e){function r(r){var t=e.call(this)||this;return t.requestOptions=null,t.url=null,t}return t(r,e),r.prototype.normalizeCtorArgs=function(e,r){return"string"!=typeof e?e:n({url:e},r)},Object.defineProperty(r.prototype,"parsedUrl",{get:function(){return this._parseUrl(this.url)},enumerable:!0,configurable:!0}),r.prototype._parseUrl=function(e){return e?a.urlToObject(e):null},r.prototype._encode=function(e,r,t){var s={};for(var o in e)if("declaredClass"!==o){var n=e[o];if(null!=n&&"function"!=typeof n)if(Array.isArray(n)){s[o]=[];for(var i=0;i<n.length;i++)s[o][i]=this._encode(n[i])}else if("object"==typeof n)if(n.toJSON){var a=n.toJSON(t&&t[o]);s[o]=r?a:JSON.stringify(a)}else s[o]=r?n:JSON.stringify(n);else s[o]=n}return s},s([u.property({readOnly:!0,dependsOn:["url"]})],r.prototype,"parsedUrl",null),s([u.property()],r.prototype,"requestOptions",void 0),s([u.property({type:String})],r.prototype,"url",void 0),s([u.subclass("esri.tasks.Task")],r)}(u.declared(i))}.apply(null,s))||(e.exports=o)},698:function(e,r,t){var s,o;s=[t.dj.c(e.i),r,t(1),t(0),t(12),t(3),t(2)],void 0===(o=function(e,r,t,s,o,n,i){var a=new o.default({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});return function(e){function r(r){var t=e.call(this)||this;return t.description=null,t.type=null,t}return t(r,e),s([i.property({type:String,json:{write:!0}})],r.prototype,"description",void 0),s([i.property({type:String,json:{read:a.read,write:a.write}})],r.prototype,"type",void 0),s([i.subclass("esri.tasks.support.GPMessage")],r)}(i.declared(n.JSONSupport))}.apply(null,s))||(e.exports=o)},735:function(e,r,t){var s,o;s=[t.dj.c(e.i),r],void 0===(o=function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=function(){function e(e){void 0===e&&(e={}),this._options=e}return e.prototype.toQueryParams=function(e){var r=this;if(!e)return null;var t=e.toJSON(),s={};return Object.keys(t).forEach((function(e){var o=r._options[e];if(o){var n="boolean"!=typeof o&&o.name?o.name:e,i="boolean"!=typeof o&&o.getter?o.getter(t):t[e];null!=i&&(s[n]=function(e){if(!Array.isArray(e))return!1;var r=e[0];return"number"==typeof r||"string"==typeof r}(i)?i.join(","):"object"==typeof i?JSON.stringify(i):i)}else s[e]=t[e]}),this),s},e}();r.createQueryParamsHelper=function(e){return new t(e)}}.apply(null,s))||(e.exports=o)},736:function(e,r,t){var s,o;s=[t.dj.c(e.i),r,t(0),t(1),t(6),t(8),t(41),t(11),t(16),t(43),t(22),t(2),t(618)],void 0===(o=function(e,r,t,s,o,n,i,a,u,p,l,c,f){function d(e){return n(this,void 0,void 0,(function(){var r,t,s,n;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,i(e+("/"===e[e.length-1]?"":"/")+"retrieveTravelModes",{query:{f:"json"}})];case 1:return r=o.sent().data,t=r.supportedTravelModes,s=r.defaultTravelMode,[2,{supportedTravelModes:t,defaultTravelMode:s}];case 2:throw n=o.sent(),new a("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:n});case 3:return[2]}}))}))}function y(e){return n(this,void 0,void 0,(function(){var r,t,s,n,a,u,c,f,d,y,v,h,m,g,b,T;return o(this,(function(o){switch(o.label){case 0:return[4,i(e.substring(0,e.indexOf("/rest/")+6)+"info",{query:{f:"json"}})];case 1:return(r=o.sent().data)&&r.owningSystemUrl?(e=r.owningSystemUrl,[4,i(e+("/"===e[e.length-1]?"":"/")+"sharing/rest/portals/self",{query:{f:"json"}})]):[2,{supportedTravelModes:[],defaultTravelMode:null}];case 2:return t=o.sent().data,(s=p.getDeepValue("helperServices.routingUtilities.url",t))?(n=l.urlToObject(e),a=/\/solveClosestFacility$/.test(n.path)?"Route":/\/solveClosestFacility$/.test(n.path)?"ClosestFacility":"ServiceAreas",[4,i(s+("/"===s[s.length-1]?"":"/")+"GetTravelModes/execute",{query:{f:"json",serviceName:a}})]):[2,{supportedTravelModes:[],defaultTravelMode:null}];case 3:if(u=o.sent(),c=[],f=null,u&&u.data&&u.data.results&&u.data.results.length)for(d=u.data.results,y=0,v=d;y<v.length;y++)if("supportedTravelModes"===(h=v[y]).paramName){if(h.value&&h.value.features)for(m=0,g=h.value.features;m<g.length;m++)(b=g[m].attributes)&&(T=JSON.parse(b.TravelMode),c.push(T))}else"defaultTravelMode"===h.paramName&&(f=h.value);return[2,{supportedTravelModes:c,defaultTravelMode:f}]}}))}))}Object.defineProperty(r,"__esModule",{value:!0}),r.NAServiceDescriptionMixin=function(e){return function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return s(r,e),r.prototype.getServiceDescription=function(){return n(this,void 0,void 0,(function(){return o(this,(function(e){return this._serviceDescriptionPromise||(this._serviceDescriptionPromise=this._fetchServiceDescription()),[2,this._serviceDescriptionPromise]}))}))},r.prototype._fetchServiceDescription=function(){return n(this,void 0,void 0,(function(){var e,r,t,s,n,u;return o(this,(function(o){switch(o.label){case 0:if(!this.url||!this.parsedUrl)throw new a("network-service:missing-url","Url to Network service is missing");return e=this.url,[4,i(e,{query:{f:"json"}})];case 1:for((r=o.sent().data).supportedTravelModes||(r.supportedTravelModes=[]),t=0;t<r.supportedTravelModes.length;t++)r.supportedTravelModes[t].id||(r.supportedTravelModes[t].id=r.supportedTravelModes[t].itemId);return[4,r.currentVersion>=10.4?d(e):y(e)];case 2:return s=o.sent(),n=s.defaultTravelMode,u=s.supportedTravelModes,r.defaultTravelMode=n,r.supportedTravelModes=u,[2,r]}}))}))},r.prototype._isInputGeometryZAware=function(e,r){for(var t=0;t<r.length;t++){var s=e[r[t]];if(s&&s.length)for(var o=0,n=s;o<n.length;o++){var i=n[o];if(u.isSome(i)&&i.hasZ)return!0}}return!1},r.prototype._dropZValuesOffInputGeometry=function(e,r){for(var t=0;t<r.length;t++){var s=e[r[t]];if(s&&s.length)for(var o=0,n=s;o<n.length;o++){n[o].z=void 0}}console.log("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")},t([c.subclass("esri.tasks.mixins.NAServiceDescription")],r)}(c.declared(e))};var v=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return s(r,e),t([c.subclass("esri.tasks.mixins.NAServiceDescription")],r)}(c.declared(r.NAServiceDescriptionMixin(f)));r.NAServiceDescription=v}.apply(null,s))||(e.exports=o)},737:function(e,r,t){var s,o;s=[t.dj.c(e.i),r,t(1),t(0),t(12),t(2),t(698)],void 0===(o=function(e,r,t,s,o,n,i){var a=new o.default({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});return function(e){function r(r){var t=e.call(this)||this;return t.type=null,t}return t(r,e),s([n.property({type:String,json:{read:a.read,write:a.write}})],r.prototype,"type",void 0),s([n.subclass("esri.tasks.support.NAMessage")],r)}(n.declared(i))}.apply(null,s))||(e.exports=o)},815:function(e,r,t){var s,o;s=[t(33),t(38),t(92),t(26),t(174),t(67)],void 0===(o=function(e,r,t,s,o,n){return o.createSubclass({declaredClass:"esri.tasks.support.DirectionsFeatureSet",properties:{geometryType:"esriGeometryPolyline",extent:{type:e,json:{read:{source:"summary.envelope"}}},features:{value:null,json:{read:function(e,t){(e||[]).forEach((function(e){this._decompressFeatureGeometry(e,t.summary.envelope.spatialReference)}),this);var o=s.fromJSON(t.spatialReference);return e.map((function(e){var t=n.fromJSON(e),s=e.geometry&&e.geometry.spatialReference;return t.geometry&&!s&&(t.geometry.spatialReference=o),t.strings=e.strings,t.events=(e.events||[]).map((function(t){var s=new n({geometry:new r({x:t.point.x,y:t.point.y,z:t.point.z,hasZ:void 0!==t.point.z,spatialReference:e.geometry&&e.geometry.spatialReference}),attributes:{ETA:t.ETA,arriveTimeUTC:t.arriveTimeUTC}});return s.strings=t.strings,s})),t}))}}},mergedGeometry:{value:null,readOnly:!0,dependsOn:["features","extent.spatialReference"],get:function(){if(!this.features)return null;var e=this.features.map((function(e){return e.geometry})),r=this.get("extent.spatialReference");return this._mergePolylinesToSinglePath(e,r)}},routeId:null,routeName:null,strings:{value:null,readOnly:!0,dependsOn:["features"],get:function(){return this.features.map((function(e){return e.strings}))}},totalDriveTime:{value:null,json:{read:{source:"summary.totalDriveTime"}}},totalLength:{value:null,json:{read:{source:"summary.totalLength"}}},totalTime:{value:null,json:{read:{source:"summary.totalTime"}}}},_decompressFeatureGeometry:function(e,r){e.geometry=this._decompressGeometry(e.compressedGeometry,r)},_decompressGeometry:function(e,r){var t,s,o,n,i,a,u,p,l=0,c=0,f=0,d=0,y=[],v=0,h=0,m=0;if((i=e.match(/((\+|\-)[^\+\-\|]+|\|)/g))||(i=[]),0===parseInt(i[v],32)){v=2;var g=parseInt(i[v],32);v++,a=parseInt(i[v],32),v++,1&g&&(h=i.indexOf("|")+1,u=parseInt(i[h],32),h++),2&g&&(m=i.indexOf("|",h)+1,p=parseInt(i[m],32),m++)}else a=parseInt(i[v],32),v++;for(;v<i.length&&"|"!==i[v];){t=parseInt(i[v],32)+l,v++,l=t,s=parseInt(i[v],32)+c,v++,c=s;var b=[t/a,s/a];h&&(n=parseInt(i[h],32)+f,h++,f=n,b.push(n/u)),m&&(o=parseInt(i[m],32)+d,m++,d=o,b.push(o/p)),y.push(b)}return{paths:[y],hasZ:h>0,hasM:m>0,spatialReference:r}},_mergePolylinesToSinglePath:function(e,r){var s=[];(e||[]).forEach((function(e){e.paths.forEach((function(e){s=s.concat(e)}))}));var o=[],n=[0,0];return s.forEach((function(e){e[0]===n[0]&&e[1]===n[1]||(o.push(e),n=e)})),new t({paths:[o]},r)}})}.apply(null,s))||(e.exports=o)}}]);