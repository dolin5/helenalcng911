(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/2d/engine/webgl/definitions":611,"esri/views/layers/support/ClipArea":613,"esri/core/libs/gl-matrix-2/mat4":614,"esri/views/2d/engine/vectorTiles/GeometryUtils":616,"esri/views/2d/layers/graphics/graphicsUtils":623,"esri/core/libs/gl-matrix-2/math/mat4":624,"esri/core/libs/gl-matrix-2/mat4f64":625,"esri/views/layers/LayerView":627,"esri/core/pbf":629,"esri/core/libs/rbush/rbush":630,"esri/core/libs/gl-matrix-2/mat3f64":632,"esri/core/libs/gl-matrix-2/factories/mat3f64":633,"esri/views/2d/layers/LayerView2D":637,"esri/core/libs/gl-matrix-2/factories/mat4f64":639,"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":642,"esri/views/3d/layers/support/FastSymbolUpdates":643,"esri/views/3d/support/debugFlags":644,"esri/views/layers/support/ClipRect":645,"esri/views/layers/support/Geometry":646,"esri/views/layers/support/Path":647,"esri/views/2d/layers/features/support/AttributeStore":648,"esri/core/libs/quickselect/quickselect":649,"esri/views/2d/layers/features/support/Tile":656,"esri/core/MapPool":667,"esri/views/2d/layers/features/support/TileStore":668,"esri/views/2d/engine/FeatureContainer":669,"esri/views/2d/layers/graphics/GraphicsView2D":686,"esri/views/2d/layers/graphics/GraphicContainer":687,"esri/views/2d/layers/graphics/GraphicProcessingQueue":688,"esri/views/2d/layers/graphics/GraphicStore":689,"esri/views/2d/layers/graphics/GraphicStoreItem":690,"esri/views/layers/GraphicsView":691,"esri/views/2d/layers/GeoRSSLayerView2D":1508})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{1508:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(58),i(123),i(17),i(4),i(14),i(2),i(203),i(184),i(173),i(561),i(637),i(686),i(627)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,p,h,c,d,f,y,v){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._graphicsViewMap={},e._popupTemplates=new Map,e.container=new d.Container,e.graphicsViews=[],e}return i(e,t),e.prototype.hitTest=function(t,e){var i=this;if(this.suspended||!this.graphicsViews.length)return s.resolve();var r=this.graphicsViews.reverse().map((function(i){return i.hitTest(t,e)}));return s.all(r).then((function(t){return t.filter((function(t,e){return t&&(t.popupTemplate=i._popupTemplates.get(i.graphicsViews[e]),t.layer=i.layer,t.sourceLayer=i.layer),!!t}))[0]||null}))},e.prototype.update=function(t){if(this.graphicsViews)for(var e=0,i=this.graphicsViews;e<i.length;e++){i[e].update(t)}},e.prototype.attach=function(){var t=this;this.layer.featureCollections.forEach((function(e){var i,r=c.fromJSON(e.featureSet),s=new(a.ofType(n))(r.features);if(t._graphicsViewMap[r.geometryType])(i=t._graphicsViewMap[r.geometryType]).graphics.addMany(s);else{var u=e.layerDefinition.drawingInfo,l=e.popupInfo?o.fromJSON(e.popupInfo):null,p=h.fromJSON(u.renderer);i=new y.default({view:t.view,graphics:s,renderer:p}),t._graphicsViewMap[r.geometryType]=i,t._popupTemplates.set(i,l),"polygon"!==r.geometryType||t.layer.polygonSymbol?"polyline"!==r.geometryType||t.layer.lineSymbol?"point"!==r.geometryType||t.layer.pointSymbol||(t.layer.pointSymbol=p.symbol):t.layer.lineSymbol=p.symbol:t.layer.polygonSymbol=p.symbol,t.graphicsViews.push(i),t.container.addChild(i.container)}})),this.handles.add([u.init(this.layer,"polygonSymbol",(function(e){t._graphicsViewMap.polygon.renderer=new p({symbol:e})})),u.init(this.layer,"lineSymbol",(function(e){t._graphicsViewMap.polyline.renderer=new p({symbol:e})})),u.init(this.layer,"pointSymbol",(function(e){t._graphicsViewMap.point.renderer=new p({symbol:e})})),this.clips.on("change",(function(){return t.graphicsViews.forEach((function(e){return e.container.setClips(t.clips)}))}))]),this.graphicsViews.forEach((function(e){return e.container.setClips(t.clips)}))},e.prototype.detach=function(){this.container.removeAllChildren(),this.graphicsViews.forEach((function(t){t.destroy(),t.view=null,t.renderer=null})),this.graphicsViews.length=0},e.prototype.moveStart=function(){this.requestUpdate()},e.prototype.viewChange=function(){this.requestUpdate()},e.prototype.moveEnd=function(){this.requestUpdate()},r([l.subclass("esri.views.2d.layers.GeoRSSLayerView2D")],e)}(l.declared(f.LayerView2D(v)))}.apply(null,r))||(t.exports=n)},611:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.WEBGL_MAX_STOPS=8,e.WEBGL_MAX_INNER_STOPS=e.WEBGL_MAX_STOPS-2,e.NAN_MAGIC_NUMBER=1e-30,e.EXTRUDE_SCALE=64,e.PICTURE_FILL_COLOR=4294967295,e.TILE_SIZE=512,e.RASTER_TILE_SIZE=256,e.ANGLE_FACTOR_256=256/360,e.DEBUG_LABELS=!1,e.COLLISION_BUCKET_SIZE=128,e.DOT_DENSITY_MAX_FIELDS=8,e.COLLISION_MAX_ZOOM_DELTA=3,e.COLLISION_EARLY_REJECT_BUCKET_SIZE=16,e.COLLISION_BOX_PADDING=16,e.COLLISION_TILE_BOX_SIZE=e.TILE_SIZE/e.COLLISION_BUCKET_SIZE,e.COLLISION_PLACEMENT_PADDING=8,e.HEURISTIC_GLYPHS_PER_LINE=50,e.HEURISTIC_GLYPHS_PER_FEATURE=10,e.GLYPH_SIZE=24,e.TEXT_LINE_HEIGHT=1.2*e.GLYPH_SIZE,e.TEXT_MAX_WIDTH=10*e.GLYPH_SIZE,e.TEXT_SPACING=0,e.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}},e.ATTRIBUTE_STORE_TEXTURE_SIZE=1024,e.TEXTURE_BINDING_SPRITE_ATLAS=0,e.TEXTURE_BINDING_GLYPH_ATLAS=0,e.TEXTURE_BINDING_BITMAP=0,e.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1,e.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2,e.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3,e.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4,e.TEXTURE_BINDING_HIGHLIGHT_0=5,e.TEXTURE_BINDING_HIGHLIGHT_1=6,e.TEXTURE_BINDING_RENDERER_0=5,e.TEXTURE_BINDING_RENDERER_1=6,e.ATTRIBUTE_DATA_FILTER_FLAGS=0,e.ATTRIBUTE_DATA_ANIMATION=1,e.ATTRIBUTE_DATA_VV=2,e.ATTRIBUTE_DATA_DD0=3,e.ATTRIBUTE_DATA_DD1=3,e.MAX_FILTERS=2,e.HIGHLIGHT_FLAG=1,e.FILTER_FLAG_0=2,e.EFFECT_FLAG_0=4,e.THIN_LINE_THRESHOLD=2.5,e.HITTEST_SEARCH_SIZE=24,e.MAX_ANIMATION_TIME_MS=2e3}.apply(null,r))||(t.exports=n)},613:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(0),i(1),i(3),i(2)],void 0===(n=function(t,e,i,r,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([o.subclass("esri.views.layers.support.ClipArea")],e)}(o.declared(n.JSONSupport))}.apply(null,r))||(t.exports=n)},614:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(624)],void 0===(n=function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.mat4=i}.apply(null,r))||(t.exports=n)},616:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){function i(t,e){return(t%=e)>=0?t:t+e}Object.defineProperty(e,"__esModule",{value:!0}),e.C_INFINITY=Number.POSITIVE_INFINITY,e.C_PI=Math.PI,e.C_2PI=2*e.C_PI,e.C_PI_BY_2=e.C_PI/2,e.C_RAD_TO_256=128/e.C_PI,e.C_256_TO_RAD=e.C_PI/128,e.C_DEG_TO_256=256/360,e.C_DEG_TO_RAD=e.C_PI/180,e.C_SQRT2=1.414213562,e.C_SQRT2_INV=1/e.C_SQRT2;var r=1/Math.LN2;e.positiveMod=i,e.radToByte=function(t){return i(t*e.C_RAD_TO_256,256)},e.degToByte=function(t){return i(t*e.C_DEG_TO_256,256)},e.log2=function(t){return Math.log(t)*r},e.sqr=function(t){return t*t},e.interpolate=function(t,e,i){return t*(1-i)+e*i},e.between=function(t,e,i){return t>=e&&t<=i||t>=i&&t<=e}}.apply(null,r))||(t.exports=n)},623:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(16),i(19),i(179),i(282),i(75),i(278),i(26),i(170),i(284),i(181),i(56),i(274),i(38),i(38),i(561)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,p,h,c,d,f,y,v){function _(t,e,i,o,s){var u,l,p=r.pt2px(i.xoffset),h=r.pt2px(i.yoffset),c=w*i.angle,d=w*s;switch(i.type){case"simple-marker":var f=i;u=l=r.pt2px(f.size);break;case"picture-marker":var y=i;u=r.pt2px(y.width),l=r.pt2px(y.height)}var v=n.mat2d.identity(L);n.mat2d.translate(v,v,a.vec2.set(z,t,e)),n.mat2d.rotate(v,v,d-c),n.mat2d.scale(v,v,a.vec2.set(z,o,-o)),n.mat2d.translate(v,v,a.vec2.set(z,p,-h));var _=[0,0];a.vec2.transformMat2d(_,a.vec2.set(z,-.5*u,-.5*l),v);var g=[0,0];a.vec2.transformMat2d(g,a.vec2.set(z,-.5*u,.5*l),v);var m=[0,0];a.vec2.transformMat2d(m,a.vec2.set(z,.5*u,-.5*l),v);var b=[0,0];return a.vec2.transformMat2d(b,a.vec2.set(z,.5*u,.5*l),v),{rings:[[_,m,b,g,_]]}}function g(t,e,i,o,s){var u=v.CIMSymbolHelper.getEnvelope(i.data);if(!u)return null;var l=r.pt2px(u.width),p=r.pt2px(u.height),h=r.pt2px(u.x),c=r.pt2px(u.y),d=0*w,f=w*s,y=n.mat2d.identity(L);n.mat2d.translate(y,y,a.vec2.set(z,t,e)),n.mat2d.rotate(y,y,f-d),n.mat2d.scale(y,y,a.vec2.set(z,o,o));var _=[0,0];a.vec2.transformMat2d(_,a.vec2.set(z,h,c+p),y);var g=[0,0];a.vec2.transformMat2d(g,a.vec2.set(z,h,c),y);var m=[0,0];a.vec2.transformMat2d(m,a.vec2.set(z,h+l,c+p),y);var b=[0,0];return a.vec2.transformMat2d(b,a.vec2.set(z,h+l,c),y),{rings:[[_,m,b,g,_]]}}function m(t,e,i,o,s,u){var l=v.alignmentUtils.getYAnchorDirection(i.verticalAlignment||"baseline"),p="baseline"===(i.verticalAlignment||"baseline"),h=r.pt2px(i.xoffset),c=r.pt2px(i.yoffset),d=r.pt2px(i.font.size)/24,f=4*d,y=p?25*d:o[1]+(1+l)*o[3]*.5,_=w*i.angle,g=w*u,m=n.mat2d.identity(L);n.mat2d.translate(m,m,a.vec2.set(z,t,e)),n.mat2d.rotate(m,m,g-_),n.mat2d.scale(m,m,a.vec2.set(z,s,-s)),n.mat2d.translate(m,m,a.vec2.set(z,h,-c)),n.mat2d.translate(m,m,a.vec2.set(z,-f,-f-y));var b=[0,0];a.vec2.transformMat2d(b,a.vec2.set(z,o[0],o[1]),m);var S=[0,0];a.vec2.transformMat2d(S,a.vec2.set(z,o[0],o[1]+o[3]),m);var x=[0,0];a.vec2.transformMat2d(x,a.vec2.set(z,o[0]+o[2],o[1]),m);var T=[0,0];return a.vec2.transformMat2d(T,a.vec2.set(z,o[0]+o[2],o[1]+o[3]),m),{rings:[[b,x,T,S,b]]}}function b(t,e,i){if(!i||0===i.glyphMosaicItems.length)return t;var n=v.bidiText(e.text),o=n[0],a=n[1],s=v.alignmentUtils.getJustification(e.horizontalAlignment||"center"),u=v.alignmentUtils.getXAnchorDirection(e.horizontalAlignment||"center"),l=i.glyphMosaicItems,p=new v.TextShapingNew([l],v.definitions.TEXT_MAX_WIDTH,v.definitions.TEXT_LINE_HEIGHT,v.definitions.TEXT_SPACING,[0,.5*-A],.5*(1-u),0,s).getShaping(o,a),h=v.fontUtils.getFontDecorationTop(e.font.decoration);isNaN(h)||v.TextShapingNew.addDecoration(p,h);var c=v.TextShapingNew.getBox(p),d=r.pt2px(e.font.size)/k;return t[0]=d*c.x,t[1]=d*c.y,t[2]=d*c.width,t[3]=d*c.height,t}function S(t,e,i,r,n,o,a){var s;switch(r.type){case"simple-marker":case"picture-marker":s=_(e,i,r,o,0);break;case"text":s=m(e,i,r,n,o,0);break;case"cim":s=g(e,i,r,o,0)}for(var u,l,p=0,h=0;h<s.rings[0].length-1;h++)u=(e-(l=s.rings[0][h])[0])*(e-l[0])+(i-l[1])*(i-l[1]),p=Math.max(p,u);p=Math.sqrt(p);var c=d.normalizeMapX(e-p,a),f=d.normalizeMapX(e+p,a);if(c>f){var v=y.getInfo(a);if(v){var b=v.valid;c=b[0],f=b[1]}}return t[0]=c,t[1]=i-p,t[2]=f,t[3]=i+p,t}function x(t,e){return Math.ceil((t-e)/(2*e))}function T(t,e){var i,r=e.valid,n=r[0],o=r[1],a=2*o,s=0;return t>o?(t-=(i=Math.ceil(Math.abs(t-o)/a))*a,s=i):t<n&&(t+=(i=Math.ceil(Math.abs(t-n)/a))*a,s=-i),{x:t,frameId:s}}function E(t,e){var i=e.xmin,r=e.ymin,n=e.xmax,o=e.ymax;return I(t,i,r)&&I(t,i,o)&&I(t,n,o)&&I(t,n,r)}function I(t,e,i){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax}function M(t,e,i){var r;if(Array.isArray(t)){if((r=t[0])>e){var n=x(r,e);t[0]=r+n*(-2*e)}else if(r<i){n=x(r,i);t[0]=r+n*(-2*i)}}else if((r=t.x)>e){n=x(r,e);t.x+=n*(-2*e)}else if(r<i){n=x(r,i);t.x+=n*(-2*i)}return t}Object.defineProperty(e,"__esModule",{value:!0});var w=Math.PI/180,O=v.definitions.TEXT_MAX_WIDTH,A=v.definitions.TEXT_LINE_HEIGHT,R=v.definitions.TEXT_SPACING,L=o.mat2df32.create(),z=s.vec2f32.create(),P=l.create();e.getBounds=function(t,e,i,r,n,o,a,s){if(!r||!i)return t[0]=t[1]=t[2]=t[3]=0,e[0]=e[1]=e[2]=e[3]=0,t;var u=r;if(!c.isPoint(u)){p.getBoundsXY(t,u);var l=e[0];0===l&&(l=function(t,e){var i=0;switch(t.type){case"simple-fill":case"picture-fill":var r=t.outline;if(!r)return 0;i=r.width;break;case"simple-line":i=t.width;break;case"simple-marker":i=t.size;break;case"picture-marker":i=Math.max(t.width,t.height);break;case"text":var n=[0,0,0,0];b(n,t,e),i=Math.max(n[0],n[1]);break;case"cim":var o=v.CIMSymbolHelper.getEnvelope(t.data);i=Math.sqrt(o.width*o.width+o.height*o.height)}return i}(i,n),e[0]=l);var h=o*l/2;return t[0]-=h,t[1]-=h,t[2]+=h,t[3]+=h,t}var d=u.x,f=u.y;return"text"===i.type&&0===e[2]&&0===e[3]&&b(e,i,n),S(t,d,f,i,e,o,s),t},e.isMarkerSymbol=function(t){return"simple-marker"===t||"picture-marker"===t||"text"===t},e.graphicGeometryToNumber=function(t){switch(i.expect(t.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0};var C=s.vec2f32.create(),G=s.vec2f32.create(),N=s.vec2f32.create(),D=s.vec2f32.create(),V=s.vec2f32.create(),B=s.vec2f32.create(),U=s.vec2f32.create();e.isPointOnPolyline=function(t,e,i,r){a.vec2.set(N,e,i);for(var n,o,s,u,l,p,h,c,d,f=t.paths,y=1/0,v=0;v<f.length;v++){var _=f[v];if(!(_.length<2))for(var g=1;g<_.length;g++)n=_[g-1][0],s=_[g-1][1],o=_[g][0],u=_[g][1],l=Math.min(n,o)-r,p=Math.min(s,u)-r,h=Math.max(n,o)+r,c=Math.max(s,u)+r,e<l||e>h||i<p||i>c||(a.vec2.set(C,n,s),a.vec2.set(G,o,u),a.vec2.subtract(D,G,C),a.vec2.subtract(V,C,N),a.vec2.scale(B,D,a.vec2.dot(D,V)/a.vec2.dot(D,D)),a.vec2.subtract(U,V,B),y>(d=a.vec2.dot(U,U))&&(y=d))}return Math.sqrt(y)<=r},e.getMarkerSymbolBounds=_,e.getCIMMarkerBounds=g,e.getTextSymbolBounds=m,e.normalizeCentralMeridian=function(t){var e,i,r,n,o,a,s,u,l=null;if(!t)return null;e=t.spatialReference,i=f.getInfo(e),r=e.isWebMercator,n=F[a=r?102100:4326].maxX,o=F[a].minX,s=F[a].plus180Line,u=F[a].minus180Line;var d,y=t.toJSON();if(!i)return y;if("mesh"===t.type)d=y;else if(c.isPoint(y))d=M(y,n,o);else if(c.isMultipoint(y))y.points=y.points.map((function(t){return M(t,n,o)})),d=y;else if(c.isExtent(y))d=function(t,e){if(!e)return t;var i=function(t,e){var i,r=[],n=t.ymin,o=t.ymax,a=t.xmax-t.xmin,s=t.xmin,u=t.xmax,l=e.valid,p=l[0],h=l[1],c=(i=T(t.xmin,e)).x,d=i.frameId,f=(i=T(t.xmax,e)).x,y=i.frameId,v=c===f&&a>0;if(a>2*h){var _={xmin:s<u?c:f,ymin:n,xmax:h,ymax:o},g={xmin:p,ymin:n,xmax:s<u?f:c,ymax:o},m={xmin:0,ymin:n,xmax:h,ymax:o},b={xmin:p,ymin:n,xmax:0,ymax:o},S=[],x=[];E(_,m)&&S.push(d),E(_,b)&&x.push(d),E(g,m)&&S.push(y),E(g,b)&&x.push(y);for(var I=d+1;I<y;I++)S.push(I),x.push(I);r.push({extent:_,frameIds:[d]},{extent:g,frameIds:[y]},{extent:m,frameIds:S},{extent:b,frameIds:x})}else c>f||v?r.push({extent:{xmin:c,ymin:n,xmax:h,ymax:o},frameIds:[d]},{extent:{xmin:p,ymin:n,xmax:f,ymax:o},frameIds:[y]}):r.push({extent:{xmin:c,ymin:n,xmax:f,ymax:o},frameIds:[d]});return r}(t,e).map((function(t){return t.extent}));return i.length<2?i[0]||t:i.length>2?(t.xmin=e.valid[0],t.xmax=e.valid[1],t):{rings:i.map((function(t){return[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]}))}}(y,i);else if(c.isPolygon(y)||c.isPolyline(y)){var v=P;p.getBoundsXY(v,y);var _={xmin:v[0],ymin:v[1],xmax:v[2],ymax:v[3]},g=x(_.xmin,o)*(2*n),m=0===g?y:function(t,e){for(var i=function(t){return c.isPolygon(t)?t.rings:t.paths}(t),r=0,n=i;r<n.length;r++)for(var o=n[r],a=0,s=o;a<s.length;a++){s[a][0]+=e}return t}(y,g);_.xmin+=g,_.xmax+=g,h.extentIntersectsPolyline(_,s)&&_.xmax!==n?l=m:h.extentIntersectsPolyline(_,u)&&_.xmin!==o?l=m:d=m}else d=t.clone();return null!==l?(new H).cut(l,n):d};var k=24;e.getTextSymbolSize=b,e.getTextSymbolEstimatedSize=function(t,e,i){var n=v.bidiText(e.text),o=n[0],a=n[1],s=v.alignmentUtils.getJustification(e.horizontalAlignment||"center"),u=v.alignmentUtils.getXAnchorDirection(e.horizontalAlignment||"center"),l=new v.TextShapingNew([],O,A,R,[0,.5*-A],.5*(1-u),0,s).getEstimatedShaping(o,a,i),p=v.TextShapingNew.getBox(l),h=r.pt2px(e.font.size)/k;return t[0]=h*p.x,t[1]=h*p.y,t[2]=h*p.width,t[3]=h*p.height,t};var F={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:{paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator},minus180Line:{paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:u.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:u.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:u.WGS84}}},H=function(){function t(){}return t.prototype.cut=function(t,e){var i;if(t.rings)this.closed=!0,i=t.rings,this.minPts=4;else{if(!t.paths)return null;this.closed=!1,i=t.paths,this.minPts=2}for(var r=i.length,n=-2*e,o=0;o<r;o++){var a=i[o];if(a&&a.length>=this.minPts){for(var s=[],u=0,l=a;u<l.length;u++){var p=l[u];s.push([p[0]+n,p[1]])}i.push(s)}}return this.closed?t.rings=i:t.paths=i,t},t}()}.apply(null,r))||(t.exports=n)},624:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(182),i(77)],void 0===(n=function(t,e,i,r){function n(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],p=e[7],h=e[8],c=e[9],d=e[10],f=e[11],y=e[12],v=e[13],_=e[14],g=e[15],m=i[0],b=i[1],S=i[2],x=i[3];return t[0]=m*r+b*s+S*h+x*y,t[1]=m*n+b*u+S*c+x*v,t[2]=m*o+b*l+S*d+x*_,t[3]=m*a+b*p+S*f+x*g,m=i[4],b=i[5],S=i[6],x=i[7],t[4]=m*r+b*s+S*h+x*y,t[5]=m*n+b*u+S*c+x*v,t[6]=m*o+b*l+S*d+x*_,t[7]=m*a+b*p+S*f+x*g,m=i[8],b=i[9],S=i[10],x=i[11],t[8]=m*r+b*s+S*h+x*y,t[9]=m*n+b*u+S*c+x*v,t[10]=m*o+b*l+S*d+x*_,t[11]=m*a+b*p+S*f+x*g,m=i[12],b=i[13],S=i[14],x=i[15],t[12]=m*r+b*s+S*h+x*y,t[13]=m*n+b*u+S*c+x*v,t[14]=m*o+b*l+S*d+x*_,t[15]=m*a+b*p+S*f+x*g,t}function a(t,e,i){var r=e[0],n=e[1],o=e[2],a=e[3],s=r+r,u=n+n,l=o+o,p=r*s,h=r*u,c=r*l,d=n*u,f=n*l,y=o*l,v=a*s,_=a*u,g=a*l;return t[0]=1-(d+y),t[1]=h+g,t[2]=c-_,t[3]=0,t[4]=h-g,t[5]=1-(p+y),t[6]=f+v,t[7]=0,t[8]=c+_,t[9]=f-v,t[10]=1-(p+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function s(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}Object.defineProperty(e,"__esModule",{value:!0}),e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.set=function(t,e,i,r,n,o,a,s,u,l,p,h,c,d,f,y,v){return t[0]=e,t[1]=i,t[2]=r,t[3]=n,t[4]=o,t[5]=a,t[6]=s,t[7]=u,t[8]=l,t[9]=p,t[10]=h,t[11]=c,t[12]=d,t[13]=f,t[14]=y,t[15]=v,t},e.identity=n,e.transpose=function(t,e){if(t===e){var i=e[1],r=e[2],n=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=n,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],p=e[8],h=e[9],c=e[10],d=e[11],f=e[12],y=e[13],v=e[14],_=e[15],g=i*s-r*a,m=i*u-n*a,b=i*l-o*a,S=r*u-n*s,x=r*l-o*s,T=n*l-o*u,E=p*y-h*f,I=p*v-c*f,M=p*_-d*f,w=h*v-c*y,O=h*_-d*y,A=c*_-d*v,R=g*A-m*O+b*w+S*M-x*I+T*E;return R?(R=1/R,t[0]=(s*A-u*O+l*w)*R,t[1]=(n*O-r*A-o*w)*R,t[2]=(y*T-v*x+_*S)*R,t[3]=(c*x-h*T-d*S)*R,t[4]=(u*M-a*A-l*I)*R,t[5]=(i*A-n*M+o*I)*R,t[6]=(v*b-f*T-_*m)*R,t[7]=(p*T-c*b+d*m)*R,t[8]=(a*O-s*M+l*E)*R,t[9]=(r*M-i*O-o*E)*R,t[10]=(f*x-y*b+_*g)*R,t[11]=(h*b-p*x-d*g)*R,t[12]=(s*I-a*w-u*E)*R,t[13]=(i*w-r*I+n*E)*R,t[14]=(y*m-f*S-v*g)*R,t[15]=(p*S-h*m+c*g)*R,t):null},e.adjoint=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],p=e[8],h=e[9],c=e[10],d=e[11],f=e[12],y=e[13],v=e[14],_=e[15];return t[0]=s*(c*_-d*v)-h*(u*_-l*v)+y*(u*d-l*c),t[1]=-(r*(c*_-d*v)-h*(n*_-o*v)+y*(n*d-o*c)),t[2]=r*(u*_-l*v)-s*(n*_-o*v)+y*(n*l-o*u),t[3]=-(r*(u*d-l*c)-s*(n*d-o*c)+h*(n*l-o*u)),t[4]=-(a*(c*_-d*v)-p*(u*_-l*v)+f*(u*d-l*c)),t[5]=i*(c*_-d*v)-p*(n*_-o*v)+f*(n*d-o*c),t[6]=-(i*(u*_-l*v)-a*(n*_-o*v)+f*(n*l-o*u)),t[7]=i*(u*d-l*c)-a*(n*d-o*c)+p*(n*l-o*u),t[8]=a*(h*_-d*y)-p*(s*_-l*y)+f*(s*d-l*h),t[9]=-(i*(h*_-d*y)-p*(r*_-o*y)+f*(r*d-o*h)),t[10]=i*(s*_-l*y)-a*(r*_-o*y)+f*(r*l-o*s),t[11]=-(i*(s*d-l*h)-a*(r*d-o*h)+p*(r*l-o*s)),t[12]=-(a*(h*v-c*y)-p*(s*v-u*y)+f*(s*c-u*h)),t[13]=i*(h*v-c*y)-p*(r*v-n*y)+f*(r*c-n*h),t[14]=-(i*(s*v-u*y)-a*(r*v-n*y)+f*(r*u-n*s)),t[15]=i*(s*c-u*h)-a*(r*c-n*h)+p*(r*u-n*s),t},e.determinant=function(t){var e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],p=t[9],h=t[10],c=t[11],d=t[12],f=t[13],y=t[14],v=t[15];return(e*a-i*o)*(h*v-c*y)-(e*s-r*o)*(p*v-c*f)+(e*u-n*o)*(p*y-h*f)+(i*s-r*a)*(l*v-c*d)-(i*u-n*a)*(l*y-h*d)+(r*u-n*s)*(l*f-p*d)},e.multiply=o,e.translate=function(t,e,i){var r=i[0],n=i[1],o=i[2],a=void 0,s=void 0,u=void 0,l=void 0,p=void 0,h=void 0,c=void 0,d=void 0,f=void 0,y=void 0,v=void 0,_=void 0;return e===t?(t[12]=e[0]*r+e[4]*n+e[8]*o+e[12],t[13]=e[1]*r+e[5]*n+e[9]*o+e[13],t[14]=e[2]*r+e[6]*n+e[10]*o+e[14],t[15]=e[3]*r+e[7]*n+e[11]*o+e[15]):(a=e[0],s=e[1],u=e[2],l=e[3],p=e[4],h=e[5],c=e[6],d=e[7],f=e[8],y=e[9],v=e[10],_=e[11],t[0]=a,t[1]=s,t[2]=u,t[3]=l,t[4]=p,t[5]=h,t[6]=c,t[7]=d,t[8]=f,t[9]=y,t[10]=v,t[11]=_,t[12]=a*r+p*n+f*o+e[12],t[13]=s*r+h*n+y*o+e[13],t[14]=u*r+c*n+v*o+e[14],t[15]=l*r+d*n+_*o+e[15]),t},e.scale=function(t,e,i){var r=i[0],n=i[1],o=i[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,i,n){var o=n[0],a=n[1],s=n[2],u=Math.sqrt(o*o+a*a+s*s),l=void 0,p=void 0,h=void 0,c=void 0,d=void 0,f=void 0,y=void 0,v=void 0,_=void 0,g=void 0,m=void 0,b=void 0,S=void 0,x=void 0,T=void 0,E=void 0,I=void 0,M=void 0,w=void 0,O=void 0,A=void 0,R=void 0,L=void 0,z=void 0;return u<r.EPSILON?null:(o*=u=1/u,a*=u,s*=u,l=Math.sin(i),h=1-(p=Math.cos(i)),c=e[0],d=e[1],f=e[2],y=e[3],v=e[4],_=e[5],g=e[6],m=e[7],b=e[8],S=e[9],x=e[10],T=e[11],E=o*o*h+p,I=a*o*h+s*l,M=s*o*h-a*l,w=o*a*h-s*l,O=a*a*h+p,A=s*a*h+o*l,R=o*s*h+a*l,L=a*s*h-o*l,z=s*s*h+p,t[0]=c*E+v*I+b*M,t[1]=d*E+_*I+S*M,t[2]=f*E+g*I+x*M,t[3]=y*E+m*I+T*M,t[4]=c*w+v*O+b*A,t[5]=d*w+_*O+S*A,t[6]=f*w+g*O+x*A,t[7]=y*w+m*O+T*A,t[8]=c*R+v*L+b*z,t[9]=d*R+_*L+S*z,t[10]=f*R+g*L+x*z,t[11]=y*R+m*L+T*z,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],p=e[9],h=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*n+l*r,t[5]=a*n+p*r,t[6]=s*n+h*r,t[7]=u*n+c*r,t[8]=l*n-o*r,t[9]=p*n-a*r,t[10]=h*n-s*r,t[11]=c*n-u*r,t},e.rotateY=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],p=e[9],h=e[10],c=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n-l*r,t[1]=a*n-p*r,t[2]=s*n-h*r,t[3]=u*n-c*r,t[8]=o*r+l*n,t[9]=a*r+p*n,t[10]=s*r+h*n,t[11]=u*r+c*n,t},e.rotateZ=function(t,e,i){var r=Math.sin(i),n=Math.cos(i),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],p=e[5],h=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*n+l*r,t[1]=a*n+p*r,t[2]=s*n+h*r,t[3]=u*n+c*r,t[4]=l*n-o*r,t[5]=p*n-a*r,t[6]=h*n-s*r,t[7]=c*n-u*r,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,i){var n=i[0],o=i[1],a=i[2],s=Math.sqrt(n*n+o*o+a*a),u=void 0,l=void 0,p=void 0;return s<r.EPSILON?null:(n*=s=1/s,o*=s,a*=s,u=Math.sin(e),p=1-(l=Math.cos(e)),t[0]=n*n*p+l,t[1]=o*n*p+a*u,t[2]=a*n*p-o*u,t[3]=0,t[4]=n*o*p-a*u,t[5]=o*o*p+l,t[6]=a*o*p+n*u,t[7]=0,t[8]=n*a*p+o*u,t[9]=o*a*p-n*u,t[10]=a*a*p+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var i=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=a,e.fromQuat2=function(t,e){var i=u,r=-e[0],n=-e[1],o=-e[2],s=e[3],l=e[4],p=e[5],h=e[6],c=e[7],d=r*r+n*n+o*o+s*s;return d>0?(i[0]=2*(l*s+c*r+p*o-h*n)/d,i[1]=2*(p*s+c*n+h*r-l*o)/d,i[2]=2*(h*s+c*o+l*n-p*r)/d):(i[0]=2*(l*s+c*r+p*o-h*n),i[1]=2*(p*s+c*n+h*r-l*o),i[2]=2*(h*s+c*o+l*n-p*r)),a(t,e,i),t};var u=i.create();e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[4],a=e[5],s=e[6],u=e[8],l=e[9],p=e[10];return t[0]=Math.sqrt(i*i+r*r+n*n),t[1]=Math.sqrt(o*o+a*a+s*s),t[2]=Math.sqrt(u*u+l*l+p*p),t},e.getRotation=function(t,e){var i=e[0]+e[5]+e[10],r=0;return i>0?(r=2*Math.sqrt(i+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,i,r){var n=e[0],o=e[1],a=e[2],s=e[3],u=n+n,l=o+o,p=a+a,h=n*u,c=n*l,d=n*p,f=o*l,y=o*p,v=a*p,_=s*u,g=s*l,m=s*p,b=r[0],S=r[1],x=r[2];return t[0]=(1-(f+v))*b,t[1]=(c+m)*b,t[2]=(d-g)*b,t[3]=0,t[4]=(c-m)*S,t[5]=(1-(h+v))*S,t[6]=(y+_)*S,t[7]=0,t[8]=(d+g)*x,t[9]=(y-_)*x,t[10]=(1-(h+f))*x,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,i,r,n){var o=e[0],a=e[1],s=e[2],u=e[3],l=o+o,p=a+a,h=s+s,c=o*l,d=o*p,f=o*h,y=a*p,v=a*h,_=s*h,g=u*l,m=u*p,b=u*h,S=r[0],x=r[1],T=r[2],E=n[0],I=n[1],M=n[2],w=(1-(y+_))*S,O=(d+b)*S,A=(f-m)*S,R=(d-b)*x,L=(1-(c+_))*x,z=(v+g)*x,P=(f+m)*T,C=(v-g)*T,G=(1-(c+y))*T;return t[0]=w,t[1]=O,t[2]=A,t[3]=0,t[4]=R,t[5]=L,t[6]=z,t[7]=0,t[8]=P,t[9]=C,t[10]=G,t[11]=0,t[12]=i[0]+E-(w*E+R*I+P*M),t[13]=i[1]+I-(O*E+L*I+C*M),t[14]=i[2]+M-(A*E+z*I+G*M),t[15]=1,t},e.fromQuat=function(t,e){var i=e[0],r=e[1],n=e[2],o=e[3],a=i+i,s=r+r,u=n+n,l=i*a,p=r*a,h=r*s,c=n*a,d=n*s,f=n*u,y=o*a,v=o*s,_=o*u;return t[0]=1-h-f,t[1]=p+_,t[2]=c-v,t[3]=0,t[4]=p-_,t[5]=1-l-f,t[6]=d+y,t[7]=0,t[8]=c+v,t[9]=d-y,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,i,r,n,o,a){var s=1/(i-e),u=1/(n-r),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+e)*s,t[9]=(n+r)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t},e.perspective=function(t,e,i,r,n){var o=1/Math.tan(e/2),a=void 0;return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(a=1/(r-n),t[10]=(n+r)*a,t[14]=2*n*r*a):(t[10]=-1,t[14]=-2*r),t},e.perspectiveFromFieldOfView=function(t,e,i,r){var n=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(n+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(n-o)*l*.5,t[10]=r/(i-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*i/(i-r),t[15]=0,t},e.ortho=function(t,e,i,r,n,o,a){var s=1/(e-i),u=1/(r-n),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+i)*s,t[13]=(n+r)*u,t[14]=(a+o)*l,t[15]=1,t},e.lookAt=function(t,e,i,o){var a=void 0,s=void 0,u=void 0,l=void 0,p=void 0,h=void 0,c=void 0,d=void 0,f=void 0,y=void 0,v=e[0],_=e[1],g=e[2],m=o[0],b=o[1],S=o[2],x=i[0],T=i[1],E=i[2];return Math.abs(v-x)<r.EPSILON&&Math.abs(_-T)<r.EPSILON&&Math.abs(g-E)<r.EPSILON?n(t):(c=v-x,d=_-T,f=g-E,a=b*(f*=y=1/Math.sqrt(c*c+d*d+f*f))-S*(d*=y),s=S*(c*=y)-m*f,u=m*d-b*c,(y=Math.sqrt(a*a+s*s+u*u))?(a*=y=1/y,s*=y,u*=y):(a=0,s=0,u=0),l=d*u-f*s,p=f*a-c*u,h=c*s-d*a,(y=Math.sqrt(l*l+p*p+h*h))?(l*=y=1/y,p*=y,h*=y):(l=0,p=0,h=0),t[0]=a,t[1]=l,t[2]=c,t[3]=0,t[4]=s,t[5]=p,t[6]=d,t[7]=0,t[8]=u,t[9]=h,t[10]=f,t[11]=0,t[12]=-(a*v+s*_+u*g),t[13]=-(l*v+p*_+h*g),t[14]=-(c*v+d*_+f*g),t[15]=1,t)},e.targetTo=function(t,e,i,r){var n=e[0],o=e[1],a=e[2],s=r[0],u=r[1],l=r[2],p=n-i[0],h=o-i[1],c=a-i[2],d=p*p+h*h+c*c;d>0&&(p*=d=1/Math.sqrt(d),h*=d,c*=d);var f=u*c-l*h,y=l*p-s*c,v=s*h-u*p;return(d=f*f+y*y+v*v)>0&&(f*=d=1/Math.sqrt(d),y*=d,v*=d),t[0]=f,t[1]=y,t[2]=v,t[3]=0,t[4]=h*v-c*y,t[5]=c*f-p*v,t[6]=p*y-h*f,t[7]=0,t[8]=p,t[9]=h,t[10]=c,t[11]=0,t[12]=n,t[13]=o,t[14]=a,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t},e.subtract=s,e.multiplyScalar=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t},e.multiplyScalarAndAdd=function(t,e,i,r){return t[0]=e[0]+i[0]*r,t[1]=e[1]+i[1]*r,t[2]=e[2]+i[2]*r,t[3]=e[3]+i[3]*r,t[4]=e[4]+i[4]*r,t[5]=e[5]+i[5]*r,t[6]=e[6]+i[6]*r,t[7]=e[7]+i[7]*r,t[8]=e[8]+i[8]*r,t[9]=e[9]+i[9]*r,t[10]=e[10]+i[10]*r,t[11]=e[11]+i[11]*r,t[12]=e[12]+i[12]*r,t[13]=e[13]+i[13]*r,t[14]=e[14]+i[14]*r,t[15]=e[15]+i[15]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var i=t[0],n=t[1],o=t[2],a=t[3],s=t[4],u=t[5],l=t[6],p=t[7],h=t[8],c=t[9],d=t[10],f=t[11],y=t[12],v=t[13],_=t[14],g=t[15],m=e[0],b=e[1],S=e[2],x=e[3],T=e[4],E=e[5],I=e[6],M=e[7],w=e[8],O=e[9],A=e[10],R=e[11],L=e[12],z=e[13],P=e[14],C=e[15];return Math.abs(i-m)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(n-b)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(o-S)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(a-x)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(s-T)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(u-E)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(l-I)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(p-M)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(h-w)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(c-O)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(d-A)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(A))&&Math.abs(f-R)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(y-L)<=r.EPSILON*Math.max(1,Math.abs(y),Math.abs(L))&&Math.abs(v-z)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(z))&&Math.abs(_-P)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(P))&&Math.abs(g-C)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(C))},e.mul=o,e.sub=s}.apply(null,r))||(t.exports=n)},625:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(639)],void 0===(n=function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.mat4f64=i}.apply(null,r))||(t.exports=n)},627:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(10),i(50),i(118),i(177),i(9),i(93),i(4),i(2)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,p,h){return function(t){function e(e){var i=t.call(this)||this;return i.layer=null,i.parent=null,i}return i(e,t),e.prototype.initialize=function(){var t=this;this.addResolvingPromise(this.layer),this.when().catch((function(e){if("layerview:create-error"!==e.name){var i=t.layer&&t.layer.id||"no id",r=t.layer&&t.layer.title||"no title";return u.getLogger(t.declaredClass).error("#resolve()","Failed to resolve layer view (layer title: '"+r+"', id: '"+i+"')",e),p.reject(e)}}))},e.prototype.destroy=function(){this.layer=this.parent=null},Object.defineProperty(e.prototype,"fullOpacity",{get:function(){var t=function(t){return null==t?1:t};return t(this.get("layer.opacity"))*t(this.get("parent.fullOpacity"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"suspended",{get:function(){return!this.canResume()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return!0===this.get("layer.visible")},set:function(t){void 0!==t?this._override("visible",t):this._clearOverride("visible")},enumerable:!0,configurable:!0}),e.prototype.canResume=function(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1},e.prototype.isUpdating=function(){return!1},r([h.property({dependsOn:["layer.opacity","parent.fullOpacity"]})],e.prototype,"fullOpacity",null),r([h.property()],e.prototype,"layer",void 0),r([h.property()],e.prototype,"parent",void 0),r([h.property({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended"]})],e.prototype,"suspended",null),r([h.property({type:Boolean,dependsOn:["updatingHandles.updating"],readOnly:!0})],e.prototype,"updating",null),r([h.property({dependsOn:["layer.visible"]})],e.prototype,"visible",null),r([h.subclass("esri.views.layers.LayerView")],e)}(h.declared(a.HandleOwnerMixin(s.IdentifiableMixin(l.EsriPromiseMixin(o.EventedMixin(n))))))}.apply(null,r))||(t.exports=n)},629:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(15),i(60)],void 0===(n=function(t,e,i,r){var n=i("esri-text-decoder")?new TextDecoder("utf-8"):null,o=i("safari")?6:i("ff")?12:32;return function(){function t(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=t?t.byteLength:0),this._tag=0,this._dataType=99,this.init(t,e,i,r)}return t.prototype.init=function(t,e,i,r){this._data=t,this._dataView=e,this._pos=i,this._end=r},t.prototype.clone=function(){return new t(this._data,this._dataView,this._pos,this._end)},t.prototype.pos=function(){return this._pos},t.prototype.next=function(t){for(;;){if(this._pos===this._end)return!1;var e=this._decodeVarint();if(this._tag=e>>3,this._dataType=7&e,!t||t===this._tag)break;this.skip()}return!0},t.prototype.empty=function(){return this._pos>=this._end},t.prototype.tag=function(){return this._tag},t.prototype.getInt32=function(){return this._decodeVarint()},t.prototype.getInt64=function(){return this._decodeVarint()},t.prototype.getUInt32=function(){var t=4294967295;return t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?t:(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?t:void 0))))},t.prototype.getUInt64=function(){return this._decodeVarint()},t.prototype.getSInt32=function(){var t=this.getUInt32();return t>>>1^-(1&t)|0},t.prototype.getSInt64=function(){return this._decodeSVarint()},t.prototype.getBool=function(){var t=0!==this._data[this._pos];return this._skip(1),t},t.prototype.getEnum=function(){return this._decodeVarint()},t.prototype.getFixed64=function(){var t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+4294967296*t.getUint32(e+4,!0);return this._skip(8),i},t.prototype.getSFixed64=function(){var t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+4294967296*t.getInt32(e+4,!0);return this._skip(8),i},t.prototype.getDouble=function(){var t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t},t.prototype.getFixed32=function(){var t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t},t.prototype.getSFixed32=function(){var t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t},t.prototype.getFloat=function(){var t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t},t.prototype.getString=function(){var t=this._getLength(),e=this._pos,i=this._toString(this._data,e,e+t);return this._skip(t),i},t.prototype.getBytes=function(){var t=this._getLength(),e=this._pos,i=this._toBytes(this._data,e,e+t);return this._skip(t),i},t.prototype.processMessageWithArgs=function(t,e,i,r){var n=this.getMessage(),o=t(n,e,i,r);return n.release(),o},t.prototype.processMessage=function(t){var e=this.getMessage(),i=t(e);return e.release(),i},t.prototype.getMessage=function(){var e=this._getLength(),i=t.pool.acquire();return i.init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),i},t.prototype.release=function(){t.pool.release(this)},t.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}},t.prototype._skip=function(t){if(this._pos+t>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=t},t.prototype._decodeVarint=function(){var t,e=this._data,i=this._pos,r=0;if(this._end-i>=10)do{if(r|=127&(t=e[i++]),0==(128&t))break;if(r|=(127&(t=e[i++]))<<7,0==(128&t))break;if(r|=(127&(t=e[i++]))<<14,0==(128&t))break;if(r|=(127&(t=e[i++]))<<21,0==(128&t))break;if(r+=268435456*(127&(t=e[i++])),0==(128&t))break;if(r+=34359738368*(127&(t=e[i++])),0==(128&t))break;if(r+=4398046511104*(127&(t=e[i++])),0==(128&t))break;if(r+=562949953421312*(127&(t=e[i++])),0==(128&t))break;if(r+=72057594037927940*(127&(t=e[i++])),0==(128&t))break;if(r+=0x8000000000000000*(127&(t=e[i++])),0==(128&t))break;throw new Error("Varint too long!")}while(0);else{for(var n=1;i!==this._end&&0!=(128&(t=e[i]));)++i,r+=(127&t)*n,n*=128;if(i===this._end)throw new Error("Varint overrun!");++i,r+=t*n}return this._pos=i,r},t.prototype._decodeSVarint=function(){var t=this._decodeVarint();return t%2?-(t+1)/2:t/2},t.prototype._getLength=function(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()},t.prototype._toString=function(t,e,i){if((i=Math.min(this._end,i))-e>o&&n){var r=t.subarray(e,i);return n.decode(r)}for(var a="",s="",u=e;u<i;++u){var l=t[u];128&l?s+="%"+l.toString(16):(a+=decodeURIComponent(s)+String.fromCharCode(l),s="")}return s.length&&(a+=decodeURIComponent(s)),a},t.prototype._toBytes=function(t,e,i){return i=Math.min(this._end,i),new Uint8Array(t.buffer,e,i-e)},t.pool=new r(t,!1,(function(t){t._data=null,t._dataView=null})),t}()}.apply(null,r))||(t.exports=n)},630:function(t,e,i){var r,n;r=[i(649)],void 0===(n=function(t){"use strict";function e(t,i){if(!(this instanceof e))return new e(t,i);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this.toBBox=i:this._initFormat(i)),this.clear()}function i(t,e,i){if(!i)return e.indexOf(t);for(var r=0;r<e.length;r++)if(i(t,e[r]))return r;return-1}function r(t,e){n(t,0,t.children.length,e,t)}function n(t,e,i,r,n){n||(n=f(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,s=e;s<i;s++)a=t.children[s],o(n,t.leaf?r(a):a);return n}function o(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function a(t,e){return t.minX-e.minX}function s(t,e){return t.minY-e.minY}function u(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function l(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function h(t,e){var i=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,o-r)}function c(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function f(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(e,i,r,n,o){for(var a,s=[i,r];s.length;)(r=s.pop())-(i=s.pop())<=n||(a=i+Math.ceil((r-i)/n/2)*n,t(e,a,i,r,o),s.push(i,a,a,r))}return e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],r=this.toBBox;if(!d(t,e))return i;for(var n,o,a,s,u=[];e;){for(n=0,o=e.children.length;n<o;n++)a=e.children[n],d(t,s=e.leaf?r(a):a)&&(e.leaf?i.push(a):c(t,s)?this._all(a,i):u.push(a));e=u.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!d(t,e))return!1;for(var r,n,o,a,s=[];e;){for(r=0,n=e.children.length;r<n;r++)if(o=e.children[r],d(t,a=e.leaf?i(o):o)){if(e.leaf||c(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var r=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=f([]),this},remove:function(t,e){if(!t)return this;for(var r,n,o,a,s=this.data,u=this.toBBox(t),l=[],p=[];s||l.length;){if(s||(s=l.pop(),n=l[l.length-1],r=p.pop(),a=!0),s.leaf&&-1!==(o=i(t,s.children,e)))return s.children.splice(o,1),l.push(s),this._condense(l),this;a||s.leaf||!c(s,u)?n?(r++,s=n.children[r],a=!1):s=null:(l.push(s),p.push(r),r=0,n=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:a,compareMinY:s,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var o,a=i-e+1,s=this._maxEntries;if(a<=s)return r(o=f(t.slice(e,i+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,n-1))),(o=f([])).leaf=!1,o.height=n;var u,l,p,h,c=Math.ceil(a/s),d=c*Math.ceil(Math.sqrt(s));for(y(t,e,i,d,this.compareMinX),u=e;u<=i;u+=d)for(y(t,u,p=Math.min(u+d-1,i),c,this.compareMinY),l=u;l<=p;l+=c)h=Math.min(l+c-1,p),o.children.push(this._build(t,l,h,n-1));return r(o,this.toBBox),o},_chooseSubtree:function(t,e,i,r){for(var n,o,a,s,l,h,c,d;r.push(e),!e.leaf&&r.length-1!==i;){for(c=d=1/0,n=0,o=e.children.length;n<o;n++)l=u(a=e.children[n]),(h=p(t,a)-l)<d?(d=h,c=l<c?l:c,s=a):h===d&&l<c&&(c=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,i){var r=this.toBBox,n=i?t:r(t),a=[],s=this._chooseSubtree(n,this.data,e,a);for(s.children.push(t),o(s,n);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(n,a,e)},_split:function(t,e){var i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var a=this._chooseSplitIndex(i,o,n),s=f(i.children.splice(a,i.children.length-a));s.height=i.height,s.leaf=i.leaf,r(i,this.toBBox),r(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(t,e){this.data=f([t,e]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var r,o,a,s,l,p,c,d;for(p=c=1/0,r=e;r<=i-e;r++)s=h(o=n(t,0,r,this.toBBox),a=n(t,r,i,this.toBBox)),l=u(o)+u(a),s<p?(p=s,d=r,c=l<c?l:c):s===p&&l<c&&(c=l,d=r);return d},_chooseSplitAxis:function(t,e,i){var r=t.leaf?this.compareMinX:a,n=t.leaf?this.compareMinY:s;this._allDistMargin(t,e,i,r)<this._allDistMargin(t,e,i,n)&&t.children.sort(r)},_allDistMargin:function(t,e,i,r){t.children.sort(r);var a,s,u=this.toBBox,p=n(t,0,e,u),h=n(t,i-e,i,u),c=l(p)+l(h);for(a=e;a<i-e;a++)s=t.children[a],o(p,t.leaf?u(s):s),c+=l(p);for(a=i-e-1;a>=e;a--)s=t.children[a],o(h,t.leaf?u(s):s),c+=l(h);return c},_adjustParentBBoxes:function(t,e,i){for(var r=i;r>=0;r--)o(e[r],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():r(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}},e}.apply(null,r))||(t.exports=n)},632:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(633)],void 0===(n=function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.mat3f64=i}.apply(null,r))||(t.exports=n)},633:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){return[1,0,0,0,1,0,0,0,1]},e.clone=function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},e.fromValues=function(t,e,i,r,n,o,a,s,u){return[t,e,i,r,n,o,a,s,u]},e.createView=function(t,e){return new Float64Array(t,e,9)}}.apply(null,r))||(t.exports=n)},637:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(17),i(96),i(14),i(2),i(613),i(645),i(646),i(647)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,p,h){Object.defineProperty(e,"__esModule",{value:!0});var c=n.ofType({key:"type",base:u,typeMap:{rect:l,path:h,geometry:p}});e.LayerView2D=function(t){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.clips=new c,e.moving=!1,e.attached=!1,e.lastUpdateId=-1,e.updateRequested=!1,e}return i(e,t),e.prototype.initialize=function(){var t=this;this.when((function(){t.requestUpdate()}),(function(){}));var e=function(){return t.notifyChange("rendering")};this.handles.add([a.init(this,"suspended",(function(e){t.container&&(t.container.visible=!e),t.view&&!e&&t.updateRequested&&t.view.requestLayerViewUpdate(t)}),!0),a.init(this,"fullOpacity",(function(e){t.container&&(t.container.opacity=e)}),!0),a.on(this,"container","post-render",e),a.on(this,"container","will-render",e)])},e.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach()),this.handles.remove("initialize"),this.updateRequested=!1,this.layer=null,this.view=null},Object.defineProperty(e.prototype,"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0}),e.prototype.isVisibleAtScale=function(t){var e=!0,i=this.layer,r=i.minScale,n=i.maxScale;if(null!=r&&null!=n){var o=!r,a=!n;!o&&t<=r&&(o=!0),!a&&t>=n&&(a=!0),e=o&&a}return e},e.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))},e.prototype.processUpdate=function(t){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",t),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(t))):this.updateRequested=!1},e.prototype.isUpdating=function(){return!1},e.prototype.isRendering=function(){return!1},e.prototype.canResume=function(){var t=this.inherited(arguments);return t&&(t=this.isVisibleAtScale(this.view.scale)),t},r([s.property({type:c,set:function(t){var e=o.referenceSetter(t,this._get("clips"),c);this._set("clips",e)}})],e.prototype,"clips",void 0),r([s.property()],e.prototype,"moving",void 0),r([s.property({dependsOn:["attached","suspended","moving"]})],e.prototype,"rendering",null),r([s.property()],e.prototype,"attached",void 0),r([s.property()],e.prototype,"container",void 0),r([s.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],e.prototype,"suspended",void 0),r([s.property({readOnly:!0})],e.prototype,"updateParameters",void 0),r([s.property()],e.prototype,"updateRequested",void 0),r([s.property({dependsOn:["updateRequested","attached","suspended"]})],e.prototype,"updating",null),r([s.property()],e.prototype,"view",void 0),r([s.subclass("esri.views.2d.layers.LayerView2D")],e)}(s.declared(t))}}.apply(null,r))||(t.exports=n)},639:function(t,e,i){var r,n;r=[i.dj.c(t.i),e],void 0===(n=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},e.clone=function(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},e.fromValues=function(t,e,i,r,n,o,a,s,u,l,p,h,c,d,f,y){return[t,e,i,r,n,o,a,s,u,l,p,h,c,d,f,y]},e.createView=function(t,e){return new Float64Array(t,e,16)}}.apply(null,r))||(t.exports=n)},642:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(19),i(561),i(643)],void 0===(n=function(t,e,i,r,n){function o(t){return{value:t.value,size:i.toPt(t.size)}}function a(t){return t.map((function(t){return o(t)}))}function s(t){if("string"==typeof t||"number"==typeof t)return i.toPt(t);var e=t;return{type:"size",expression:e.expression,stops:a(e.stops)}}function u(t){var e={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(r.Utils.isString(t.field)){if(!t.stops)return null;if(t.stops.length>8)return null;for(var i=t.stops,n=0;n<8;++n){var o=i[Math.min(n,i.length-1)];e.values[n]=o.value,e.opacities[n]=o.opacity}}else{if(!(t.stops&&t.stops.length>=0))return null;var a=t.stops&&t.stops.length>=0&&t.stops[0].opacity;for(n=0;n<8;n++)e.values[n]=1/0,e.opacities[n]=a}return e}Object.defineProperty(e,"__esModule",{value:!0});var l=r.enums.WGLVVFlag;e.getVisualVariableSizeValueRepresentationRatio=function(t,e){if(!t||!e)return t;switch(e){case"radius":case"distance":return 2*t;case"diameter":case"width":return t;case"area":return Math.sqrt(t)}return t},e.stopToSizeStop=o,e.normalizeSizeStops=a,e.normalizeSizeElement=s,e.getVisualVariablesFields=function(t){var e=t&&t.length>0?{}:null;return e&&t.forEach((function(t){var i=t.type;t.field&&(e[i]=t.field)})),e},e.convertVisualVariables=function(t){var e=t&&t.length>0?{}:null,o=e?{}:null;if(!e)return{vvFields:e,vvRanges:o};for(var p=0,h=t;p<h.length;p++){var c=h[p],d=c.type;if(c.field&&(e[d]=c.field),"size"===d){o.size||(o.size={});var f=c;switch(r.getTypeOfSizeVisualVariable(f)){case l.SIZE_MINMAX_VALUE:o.size.minMaxValue={minDataValue:f.minDataValue,maxDataValue:f.maxDataValue,minSize:s(f.minSize),maxSize:s(f.maxSize)};break;case l.SIZE_SCALE_STOPS:o.size.scaleStops={stops:a(f.stops)};break;case l.SIZE_FIELD_STOPS:for(var y=[],v=[],_=a(f.stops),g=_.length,m=0;m<6;m++){var b=_[Math.min(m,g-1)];y.push(b.value),v.push(i.pt2px(b.size))}o.size.fieldStops={values:y,sizes:v};break;case l.SIZE_UNIT_VALUE:o.size.unitValue={unit:f.valueUnit,valueRepresentation:f.valueRepresentation}}}else if("color"===d){var S=n.convertVisualVariables([c],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null});o.color=S.color;for(m=0;m<32;m+=4)r.color.premultiplyAlpha(o.color.colors,m,!0)}else if("opacity"===d)o.opacity=u(c);else if("rotation"===d){var x=c;o.rotation={type:x.rotationType}}}return{vvFields:e,vvRanges:o}}}.apply(null,r))||(t.exports=n)},643:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(35),i(67),i(283),i(632),i(614),i(625),i(171),i(276),i(285),i(644)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,p,h){function c(t){return null!=t}function d(t){return"number"==typeof t}function f(t){return"string"==typeof t}function y(t,e){t&&t.push(e),_(e)}function v(t){O&&console.warn("[FastSymbolUpdates] "+t)}function _(t){O&&console.info("[FastSymbolUpdates] "+t)}function g(t,e,i,r,n){var o=t.minSize,a=t.maxSize;if(t.expression)return y(n,"Could not convert size info: expression not supported"),!1;if(t.useSymbolValue){var s=r.symbolSize[i];return e.minSize[i]=s,e.maxSize[i]=s,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=1,!0}if(c(t.field))return c(t.stops)?2===t.stops.length&&d(t.stops[0].size)&&d(t.stops[1].size)?(m(t.stops[0].size,t.stops[1].size,t.stops[0].value,t.stops[1].value,e,i),e.type[i]=1,!0):(y(n,"Could not convert size info: stops only supported with 2 elements"),!1):d(o)&&d(a)&&c(t.minDataValue)&&c(t.maxDataValue)?(m(o,a,t.minDataValue,t.maxDataValue,e,i),e.type[i]=1,!0):null!=p.meterIn[t.valueUnit]?(e.minSize[i]=-1/0,e.maxSize[i]=1/0,e.offset[i]=0,e.factor[i]=1/p.meterIn[t.valueUnit],e.type[i]=1,!0):"unknown"===t.valueUnit?(y(n,"Could not convert size info: proportional size not supported"),!1):(y(n,"Could not convert size info: scale-dependent size not supported"),!1);if(!c(t.field)){if(t.stops&&t.stops[0]&&d(t.stops[0].size))return e.minSize[i]=t.stops[0].size,e.maxSize[i]=t.stops[0].size,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=1,!0;if(d(o))return e.minSize[i]=o,e.maxSize[i]=o,e.offset[i]=o,e.factor[i]=0,e.type[i]=1,!0}return y(n,"Could not convert size info: unsupported variant of sizeInfo"),!1}function m(t,e,i,r,n,o){var a=Math.abs(r-i)>0?(e-t)/(r-i):0;n.minSize[o]=a>0?t:e,n.maxSize[o]=a>0?e:t,n.offset[o]=t-i*a,n.factor[o]=a}function b(t,e,i,r){if(t.normalizationField||t.valueRepresentation)return y(r,"Could not convert size info: unsupported property"),null;if(!function(t){return null==t||f(t)}(t.field))return y(r,"Could not convert size info: field is not a string"),null;if(e.size){if(t.field)if(e.size.field){if(t.field!==e.size.field)return y(r,"Could not convert size info: multiple fields in use"),null}else e.size.field=t.field}else e.size={field:t.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};var n;switch(t.axis){case"width":return(n=g(t,e.size,0,i,r))?e:null;case"height":return(n=g(t,e.size,2,i,r))?e:null;case"depth":return(n=g(t,e.size,1,i,r))?e:null;case"width-and-depth":return(n=g(t,e.size,0,i,r))&&g(t,e.size,1,i,r),n?e:null;case null:case void 0:case"all":return(n=(n=(n=g(t,e.size,0,i,r))&&g(t,e.size,1,i,r))&&g(t,e.size,2,i,r))?e:null;default:return y(r,'Could not convert size info: unknown axis "'+t.axis+'""'),null}}function S(t,e,i){t[4*e+0]=i.r/255,t[4*e+1]=i.g/255,t[4*e+2]=i.b/255,t[4*e+3]=i.a}function x(t,e,i,r){var n=2===i&&"arithmetic"===t.rotationType;e.offset[i]=n?90:0,e.factor[i]=n?-1:1,e.type[i]=1}function T(t,e,r){if(!t)return null;var n=!e.supportedTypes||!!e.supportedTypes.size,o=!e.supportedTypes||!!e.supportedTypes.color,a=!e.supportedTypes||!!e.supportedTypes.rotation,s=!!e.supportedTypes&&!!e.supportedTypes.opacity;O&&(r=r||[]);var u=t.reduce((function(t,u){if(!t)return t;if(u.valueExpression)return y(r,"Could not convert visual variables: arcade expressions not supported"),null;switch(u.type){case"size":return n?b(u,t,e,r):t;case"color":return o?function(t,e,i){if(t.normalizationField)return y(i,"Could not convert color info: unsupported property"),null;if(f(t.field)){if(!t.stops)return y(i,"Could not convert color info: missing stops or colors"),null;if(t.stops.length>8)return y(i,"Could not convert color info: too many color stops"),null;e.color={field:t.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(var r=t.stops,n=0;n<8;++n){var o=r[Math.min(n,r.length-1)];e.color.values[n]=o.value,S(e.color.colors,n,o.color)}}else{if(!(t.stops&&t.stops.length>=0))return y(i,"Could not convert color info: no field and no colors/stops"),null;var a=t.stops&&t.stops.length>=0&&t.stops[0].color;e.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(n=0;n<8;n++)e.color.values[n]=1/0,S(e.color.colors,n,a)}return e}(u,t,r):t;case"opacity":return s?function(t,e,i){if(t.normalizationField)return y(i,"Could not convert opacity info: unsupported property"),null;if(f(t.field)){if(!t.stops)return y(i,"Could not convert opacity info: missing stops or opacities"),null;if(t.stops.length>8)return y(i,"Could not convert opacity info: too many opacity stops"),null;e.opacity={field:t.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(var r=t.stops,n=0;n<8;++n){var o=r[Math.min(n,r.length-1)];e.opacity.values[n]=o.value,e.opacity.opacityValues[n]=o.opacity}}else{if(!(t.stops&&t.stops.length>=0))return y(i,"Could not convert opacity info: no field and no opacities/stops"),null;var a=t.stops&&t.stops.length>=0&&t.stops[0].opacity;e.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(n=0;n<8;n++)e.opacity.values[n]=1/0,e.opacity.opacityValues[n]=a}return e}(u,t,r):null;case"rotation":return a?function(t,e,i){if(!f(t.field))return y(i,"Could not convert rotation info: field is not a string"),null;if(e.rotation){if(t.field)if(e.rotation.field){if(t.field!==e.rotation.field)return y(i,"Could not convert rotation info: multiple fields in use"),null}else e.rotation.field=t.field}else e.rotation={field:t.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(t.axis){case"tilt":return x(t,e.rotation,0),e;case"roll":return x(t,e.rotation,1),e;case null:case void 0:case"heading":return x(t,e.rotation,2),e;default:return y(i,'Could not convert rotation info: unknown axis "'+t.axis+'""'),null}}(u,t,r):t;default:return i.neverReached(u),null}}),{size:null,color:null,opacity:null,rotation:null});return!(t.length>0&&u)||u.size||u.color||u.opacity||u.rotation?u&&u.size&&!function(t,e,i){for(var r=0;r<3;++r){var n=e.unitInMeters;1===t.type[r]&&(n*=e.modelSize[r],t.type[r]=2),t.minSize[r]=t.minSize[r]/n,t.maxSize[r]=t.maxSize[r]/n,t.offset[r]=t.offset[r]/n,t.factor[r]=t.factor[r]/n}var o;if(0!==t.type[0])o=0;else if(0!==t.type[1])o=1;else{if(0===t.type[2])return y(i,"No size axis contains a valid size or scale"),!1;o=2}for(r=0;r<3;++r)0===t.type[r]&&(t.minSize[r]=t.minSize[o],t.maxSize[r]=t.maxSize[o],t.offset[r]=t.offset[o],t.factor[r]=t.factor[o],t.type[r]=t.type[o]);return!0}(u.size,e,r)?null:u:null}function E(t){return t&&null!=t.size}function I(t,e,i){if(!!t!=!!e)return v("State update failed ({$name} enabled/disabled)"),!1;if(t&&t.field!==e.field)return v("State update failed ({$name} field changed)"),!1;if(t&&"rotation"===i)for(var r=t,n=e,o=0;o<3;o++)if(r.type[o]!==n.type[o]||r.offset[o]!==n.offset[o]||r.factor[o]!==n.factor[o])return!1;return!0}function M(t,e){var i={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},r=E(t);return t&&t.size?(i.vvSizeEnabled=!0,i.vvSizeMinSize=t.size.minSize,i.vvSizeMaxSize=t.size.maxSize,i.vvSizeOffset=t.size.offset,i.vvSizeFactor=t.size.factor):t&&r&&(i.vvSizeValue=e.transformation.scale),t&&r&&(i.vvSymbolAnchor=e.transformation.anchor,i.vvSymbolRotationMatrix=o.mat3f64.create(),a.mat4.identity(R),function(t,e,i,r){void 0===r&&(r=s.mat4f64.create());var n=t||0,o=e||0,u=i||0;0!==n&&a.mat4.rotateZ(r,r,-n/180*Math.PI),0!==o&&a.mat4.rotateX(r,r,o/180*Math.PI),0!==u&&a.mat4.rotateY(r,r,u/180*Math.PI)}(e.transformation.rotation[2],e.transformation.rotation[0],e.transformation.rotation[1],R),n.mat3.fromMat4(i.vvSymbolRotationMatrix,R)),t&&t.color&&(i.vvColorEnabled=!0,i.vvColorValues=t.color.values,i.vvColorColors=t.color.colors),t&&t.opacity&&(i.vvOpacityEnabled=!0,i.vvOpacityValues=t.opacity.values,i.vvOpacityOpacities=t.opacity.opacityValues),i}Object.defineProperty(e,"__esModule",{value:!0});var w,O=!1,A=!1;e.convertVisualVariables=T,e.initFastSymbolUpdatesState=function(t,e){if(A)return v("State not initialized, fast updates disabled (globally disabled)"),{enabled:!1};if(!t)return v("State not initialized, fast updates disabled (no renderer)"),{enabled:!1};if(h.DISABLE_FAST_UPDATES)return v("State not initialized, fast updates disabled (DISABLE_FAST_SYMBOL_UPDATES set)"),{enabled:!1};var i=T(t.visualVariables,e);return i?(_("State initialized, fast updates enabled"),{enabled:!0,visualVariables:i,materialParameters:M(i,e),requiresShaderTransformation:E(i)}):(v("State not initialized, fast updates disabled (conversion failed)"),{enabled:!1})},e.updateFastSymbolUpdatesState=function(t,e,i){if(!e||!t.enabled)return!1;var r=t.visualVariables,n=T(e.visualVariables,i);return n?!!(I(r.size,n.size,"size")&&I(r.color,n.color,"color")&&I(r.rotation,n.rotation,"rotation")&&I(r.opacity,n.opacity,"opacity"))&&(t.visualVariables=n,t.materialParameters=M(n,i),t.requiresShaderTransformation=E(n),_("State updated"),!0):(v("State update failed (conversion failed)"),!1)},e.getMaterialParams=M,function(t){var e=s.mat4f64.create(),i=l.vec3f64.create();t.evaluateModelTransform=function(t,n,o){if(!t.vvSizeEnabled)return o;a.mat4.copy(e,o);var s=t.vvSymbolRotationMatrix;a.mat4.set(R,s[0],s[1],s[2],0,s[3],s[4],s[5],0,s[6],s[7],s[8],0,0,0,0,1),a.mat4.multiply(e,e,R);for(var u=0;u<3;++u){var l=t.vvSizeOffset[u]+n[0]*t.vvSizeFactor[u];i[u]=r.clamp(l,t.vvSizeMinSize[u],t.vvSizeMaxSize[u])}return a.mat4.scale(e,e,i),a.mat4.translate(e,e,t.vvSymbolAnchor),e},t.evaluateModelTransformScale=function(t,e,i){if(!e.vvSizeEnabled)return u.vec3.set(t,1,1,1);for(var n=0;n<3;++n){var o=e.vvSizeOffset[n]+i[0]*e.vvSizeFactor[n];t[n]=r.clamp(o,e.vvSizeMinSize[n],e.vvSizeMaxSize[n])}return t}}(w||(w={}));var R=s.mat4f64.create();e.evaluateModelTransform=w.evaluateModelTransform,e.evaluateModelTransformScale=w.evaluateModelTransformScale}.apply(null,r))||(t.exports=n)},644:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(10),i(2)],void 0===(n=function(t,e,i,r,n,o){return new(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,e.SCENEVIEW_LOCKING_LOG=!1,e.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1,e.HIGHLIGHTS_VISUALIZE_BLOCKS=!1,e.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1,e.DECONFLICTOR_SHOW_OUTLINES=!1,e.DECONFLICTOR_SHOW_GRID=!1,e.LABELS_SHOW_BORDER=!1,e.OVERLAY_DRAW_TEST_TEXTURE=!1,e.OVERLAY_SHOW_CENTER=!1,e.TESTS_DISABLE_UPDATE_THRESHOLDS=!1,e.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=!1,e.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1,e.DRAW_MESH_GEOMETRY_NORMALS=!1,e.FEATURE_TILE_FETCH_SHOW_TILES=!1,e.FEATURE_TILE_TREE_SHOW_TILES=!1,e.TERRAIN_TILE_TREE_SHOW_TILES=!1,e.I3S_TREE_SHOW_TILES=!1,e.ENABLE_PROFILE_DEPTH_RANGE=!1,e.DISABLE_FAST_UPDATES=!1,e.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,e.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,e.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,e}return i(e,t),r([o.property()],e.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),r([o.property()],e.prototype,"SCENEVIEW_LOCKING_LOG",void 0),r([o.property()],e.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0),r([o.property()],e.prototype,"HIGHLIGHTS_VISUALIZE_BLOCKS",void 0),r([o.property()],e.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0),r([o.property()],e.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0),r([o.property()],e.prototype,"DECONFLICTOR_SHOW_GRID",void 0),r([o.property()],e.prototype,"LABELS_SHOW_BORDER",void 0),r([o.property()],e.prototype,"OVERLAY_DRAW_TEST_TEXTURE",void 0),r([o.property()],e.prototype,"OVERLAY_SHOW_CENTER",void 0),r([o.property()],e.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0),r([o.property()],e.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0),r([o.property()],e.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0),r([o.property()],e.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),r([o.property()],e.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),r([o.property()],e.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),r([o.property()],e.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),r([o.property()],e.prototype,"I3S_TREE_SHOW_TILES",void 0),r([o.property()],e.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0),r([o.property()],e.prototype,"DISABLE_FAST_UPDATES",void 0),r([o.property()],e.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),r([o.property()],e.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),r([o.property()],e.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),r([o.subclass("esri.views.3d.support.DebugFlags")],e)}(o.declared(n)))}.apply(null,r))||(t.exports=n)},645:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(0),i(1),i(2),i(613)],void 0===(n=function(t,e,i,r,n,o){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="rect",e.left=null,e.right=null,e.top=null,e.bottom=null,e}var o;return r(e,t),o=e,e.prototype.clone=function(){return new o({left:this.left,right:this.right,top:this.top,bottom:this.bottom})},Object.defineProperty(e.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),i([n.property({type:[Number,String],json:{write:!0}})],e.prototype,"left",void 0),i([n.property({type:[Number,String],json:{write:!0}})],e.prototype,"right",void 0),i([n.property({type:[Number,String],json:{write:!0}})],e.prototype,"top",void 0),i([n.property({type:[Number,String],json:{write:!0}})],e.prototype,"bottom",void 0),i([n.property({readOnly:!0,dependsOn:["left","right","top","bottom"]})],e.prototype,"version",null),o=i([n.subclass("esri.views.layers.support.ClipRect")],e)}(n.declared(o))}.apply(null,r))||(t.exports=n)},646:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(0),i(1),i(20),i(2),i(46),i(56),i(613)],void 0===(n=function(t,e,i,r,n,o,a,s,u){var l={base:a,key:"type",typeMap:{extent:n.Extent,polygon:n.Polygon}};return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="geometry",e.geometry=null,e}var n;return r(e,t),n=e,Object.defineProperty(e.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new n({geometry:this.geometry.clone()})},i([o.property({types:l,json:{read:s.fromJSON,write:!0}})],e.prototype,"geometry",void 0),i([o.property({readOnly:!0,dependsOn:["geometry"]})],e.prototype,"version",null),n=i([o.subclass("esri.views.layers.support.Geometry")],e)}(o.declared(u))}.apply(null,r))||(t.exports=n)},647:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(0),i(1),i(2),i(613)],void 0===(n=function(t,e,i,r,n,o){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="path",e.path=[],e}return r(e,t),Object.defineProperty(e.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0}),i([n.property({type:[[[Number]]],json:{write:!0}})],e.prototype,"path",void 0),i([n.property({readOnly:!0,dependsOn:["path"]})],e.prototype,"version",null),i([n.subclass("esri.views.layers.support.Path")],e)}(n.declared(o))}.apply(null,r))||(t.exports=n)},648:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(6),i(8),i(11),i(15),i(9),i(67),i(16),i(4),i(277),i(94),i(562),i(561),i(665),i(611),i(642),i(51)],void 0===(n=function(t,e,r,n,o,a,s,u,l,p,h,c,d,f,y,v,_){Object.defineProperty(e,"__esModule",{value:!0});var g=(d.enums.PixelType,s.getLogger("esri.views.layers.2d.features.support.AttributeStore")),m=f.debug.createDebugLogger(f.debug.DEBUG_ATTR_UPDATES,g),b=function(t,e){return function(i,r,n){var o;try{o=e(i,r,n)}catch(t){o=NaN}return(null===o||isNaN(o)||o===1/0)&&t||o}},S={sharedArrayBuffer:a("esri-shared-array-buffer"),oesTextureFloat:a("esri-webgl-texture-float"),maxTextureSize:a("esri-webgl-max-texture-size"),atomics:a("esri-atomics")},x=function(){function t(t,e,i,r){this.texelSize=4;var n=r.pixelType,o=r.layout,a=r.textureOnly;this.textureOnly=a||!1,this.pixelType=n,this._ctype=e,this.layout=o,this._resetRange(),this._shared=t,a||(this.data=this._initData(n,i,t,e))}return Object.defineProperty(t.prototype,"buffer",{get:function(){return l.andThen(this.data,(function(t){return t.buffer}))},enumerable:!0,configurable:!0}),t.prototype.getData=function(t,e){return l.expect(this.data)[t*this.texelSize+e]},t.prototype.setData=function(t,e,i,r){void 0===r&&(r=!0);var n=1<<e;0!=(this.layout&n)?(this.data[t*this.texelSize+e]=i,this.dirtyStart=Math.min(this.dirtyStart,t),this.dirtyEnd=Math.max(this.dirtyEnd,t)):g.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")},t.prototype.lock=function(){a("esri-2d-debug")&&5121===this.pixelType?g.error("AttributeStore-Bad-Type","Tried to lock non integer array type with float array"):this._shared&&S.atomics&&Atomics.store(this.data,0,1)},t.prototype.unlock=function(){a("esri-2d-debug")&&5121===this.pixelType?g.error("AttributeStore-Bad-Type","Tried to unlock non integer array type with float array"):this._shared&&S.atomics&&Atomics.store(this.data,0,0)},t.prototype.expand=function(t){if(!this.textureOnly){var e=this._initData(this.pixelType,t,this._shared,this._ctype),i=l.expect(this.data);e.set(i),this.data=e}},t.prototype.toMessage=function(){var t=this.dirtyStart,e=this.dirtyEnd,i=this.texelSize;if(t>e)return null;this._resetRange();var r=!(this._shared||"local"===this._ctype),n=this.pixelType,o=this.layout,a=l.expect(this.data);return a.slice?{start:t,end:e,data:r&&a.slice(t*i,(e+1)*i)||null,pixelType:n,layout:o}:r?{start:t,end:e,data:new(f.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,t*i,(e+1)*i)),pixelType:n,layout:o}:{start:t,end:e,data:null,pixelType:n,layout:o}},t.prototype._initData=function(t,e,i,r){for(var n=i&&"local"!==r?SharedArrayBuffer:ArrayBuffer,o=f.Utils.getPixelArrayCtor(t),a=new o(new n(e*e*4*o.BYTES_PER_ELEMENT)),s=0;s<a.length;s+=4)a[s+1]=255;return a},t.prototype._resetRange=function(){this.dirtyStart=4294967295,this.dirtyEnd=0},t}(),T=function(){function t(t){this._attributeComputeMap=new Map,this._blocks=new Array,this._idMap=new Map,this._localToObjectId=new Map,this._filters=new Array(f.definitions.MAX_FILTERS),this._freeList=[],this._abortController=p.createAbortController(),this._hasScaleExpr=!1,this._size=32,this._idCounter=1,this._idsToHighlight=new Set;var e=S.oesTextureFloat?5126:5121;m("Creating AttributeStore "+(S.sharedArrayBuffer?"with":"without")+" shared memory"),a("esri-2d-debug")&&S.sharedArrayBuffer&&!S.atomics&&g.warn("Browser supports SharedArrayBuffer but not Atomics. Rendering may be impacted"),this._client=t,this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:e,layout:15},{pixelType:e,layout:15}],this._blocks=this._blockDescriptors.map((function(t){return null}))}return t.prototype.destroy=function(){this._abortController.abort()},Object.defineProperty(t.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0}),t.prototype.createLocalId=function(t){if(!this._idMap.has(t)){var e=this._getFreeId();this._idMap.set(t,-1===e?0:e),this._localToObjectId.set(e,t)}return this._idMap.get(t)},t.prototype.freeLocalId=function(t){var e=this._idMap.get(t);this._idMap.delete(t),this._localToObjectId.delete(e),this._freeList.push(e)},t.prototype.getFeatureId=function(t){return this._localToObjectId.get(t)},t.prototype.getLocalId=function(t){return this._idMap.has(t)?this._idMap.get(t):null},t.prototype.setHighlight=function(t){return n(this,void 0,void 0,(function(){var e,i,n,o,a,s,u=this;return r(this,(function(r){switch(r.label){case 0:for(1,this._getBlock(0).lock(),this._idsToHighlight.forEach((function(t){var e=u.getLocalId(t);if(e){var i=u._getBlock(0).getData(e,0);u._getBlock(0).setData(e,0,-2&i)}})),this._idsToHighlight.clear(),e=0,i=t;e<i.length;e++)n=i[e],this._idsToHighlight.add(n);for(o=0;o<t.length;o++)null!=(a=this.getLocalId(t[o]))&&(s=this._getBlock(0).getData(a,0),this._getBlock(0).setData(a,0,1|s));return this._getBlock(0).unlock(),[4,this.sendUpdates()];case 1:return r.sent(),[2]}}))}))},t.prototype.addHighlight=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2]}))}))},t.prototype.removeHighlight=function(t){return n(this,void 0,void 0,(function(){return r(this,(function(t){return[2]}))}))},t.prototype.updateFilters=function(t){return n(this,void 0,void 0,(function(){var e,i,n,o,a,s,u=this;return r(this,(function(r){switch(r.label){case 0:return e=t.config,i=t.service,n=t.spatialReference,o=e.filters,a=e.definitionExpression,s=o.map((function(e,r){return u._updateFilter(t,e,r,i,a,n)})),[4,p.all(s)];case 1:return r.sent(),[2]}}))}))},t.prototype.setAttributeBindings=function(t,e){return n(this,void 0,void 0,(function(){return r(this,(function(i){switch(this._hasScaleExpr=!1,t.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":return[2,this._bindVVEvaluators(t.visualVariables,e)];case"dot-density":return[2,this._bindDDEvaluators(t.attributes,e)];case"heatmap":break;default:g.error(new o("attribute-store","Found invalid renderer type: "+t))}return[2]}))}))},t.prototype.setData=function(t,e,i,r){this._getBlock(e).setData(t,i,r)},t.prototype.setAttributeData=function(t,e,i,r){var n=this,o=t;this._getBlock(0).setData(o,0,this._getFilterFlags(e));var a=this._attributeComputeMap,s=S.oesTextureFloat?1:2;a.forEach((function(t,a){var l=a*s%4,p=Math.floor(a*s/4),h=n._getBlock(p+v.ATTRIBUTE_DATA_VV),c=t(e,{$view:r},i);if(S.oesTextureFloat)h.setData(o,l,c);else if(c===f.definitions.NAN_MAGIC_NUMBER)h.setData(o,l,255),h.setData(o,l+1,255);else{var d=u.clamp(Math.round(c),-32767,32766)+32768,y=255&d,_=(65280&d)>>8;h.setData(o,l,y),h.setData(o,l+1,_)}}))},t.prototype.sendUpdates=function(){var t=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=p.createResolver(),this._nextUpdate.promise;var e={blocks:this._blocks.map((function(t){return l.isSome(t)?t.toMessage():null}))};return this._currUpdate=this._createResources().then((function(){var i=t._client.update(e,t._signal).then((function(){if(t._currUpdate=null,t._nextUpdate){var e=t._nextUpdate;t._nextUpdate=null,t.sendUpdates().then((function(){return e.resolve()}))}}));return t._client.render(),i})),this._currUpdate},t.prototype._createResources=function(){var t=this;if(l.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(v.ATTRIBUTE_DATA_ANIMATION),m("Initializing AttributeStore");var e={shared:S.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:l.mapMany(this._blocks,(function(t){return{textureOnly:t.textureOnly,buffer:t.buffer,pixelType:t.pixelType}}))},i=this._client.initialize(e,this._signal);return this._createResourcesPromise=i,i.then((function(){return l.isNone(t._createResourcesPromise)?t._createResources():void 0})),i},t.prototype._getBlock=function(t){var e=this._blocks[t];if(l.isSome(e))return e;m("Initializing AttributeBlock at index "+t);var i=S.sharedArrayBuffer,r=this._client.type,n=new x(i,r,this._size,this._blockDescriptors[t]);return this._blocks[t]=n,this._createResourcesPromise=null,n},t.prototype._expand=function(){if(this._size<S.maxTextureSize){var t=this._size<<=1;return m("Expanding block size to",t,this._blocks),l.forEachSome(this._blocks,(function(e){return e.expand(t)})),this._createResourcesPromise=null,this._size=t,0}return g.error(new o("mapview-limitations","Maximum number of onscreen features exceeded.")),-1},t.prototype._getFreeId=function(){return this._freeList.length?this._freeList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++},t.prototype._updateFilter=function(t,e,i,o,a,s){return n(this,void 0,void 0,(function(){var n,u,p,h,c,d,f,y=this;return r(this,(function(r){switch(r.label){case 0:return n=this._filters[i],(l.isSome(n)&&n.hash)===JSON.stringify(e)?[2]:(u=1<<i+1,l.isNone(e)?(this._filters[i]=null,this._idMap.forEach((function(t){var e=y._getBlock(0).getData(t,0);y._getBlock(0).setData(t,0,e|u)})),[2]):[4,t.queryObjectIds(e)]);case 1:return p=r.sent(),e.hiddenIds&&e.hiddenIds.length&&(p=p.filter((function(t){return-1===e.hiddenIds.indexOf(t)}))),h=p.map((function(t){return y._idMap.get(t)})),[4,this._getFilter(i,o)];case 2:for(r.sent().update(e,a,s),this._getBlock(0).lock(),this._idMap.forEach((function(t){var e=y._getBlock(0).getData(t,0);y._getBlock(0).setData(t,0,e&~u)})),c=0;c<h.length;c++)null!=(d=h[c])&&(f=this._getBlock(0).getData(d,0),this._getBlock(0).setData(d,0,f|u));return this._getBlock(0).unlock(),[2]}}))}))},t.prototype._getFilter=function(t,e){return n(this,void 0,void 0,(function(){var n,o,a;return r(this,(function(r){switch(r.label){case 0:return n=this._filters[t],l.isSome(n)?[2,n]:[4,new Promise((function(t,e){Promise.all([i.e(5),i.e(66)]).then(function(){var e=[i(703)];t.apply(null,e)}.bind(this)).catch(e.bind(this))}))];case 1:return o=r.sent().default,a=new o({geometryType:e.geometryType,hasM:!1,hasZ:!1,timeInfo:e.timeInfo,fieldsIndex:new h(e.fields)}),this._filters[t]=a,[2,a]}}))}))},t.prototype._getFilterFlags=function(t){for(var e=0,i=0;i<this._filters.length;i++){var r=this._filters[i];e|=(l.isNone(r)||r.check(t)?1:0)<<i}var n=this.getFeatureId(t.localId);return e<<1|(this._idsToHighlight.has(n)?1:0)},t.prototype._bindVVEvaluators=function(t,e){return n(this,void 0,void 0,(function(){var i=this;return r(this,(function(o){switch(o.label){case 0:return this._attributeComputeMap.clear(),l.isSome(t)?[4,p.all(t.map((function(t){return n(i,void 0,void 0,(function(){var i,n;return r(this,(function(r){switch(r.label){case 0:return i=f.Utils.getVVType(t.type),[4,this._createGetValueFunction(t,e)];case 1:return n=r.sent(),l.isSome(n)&&this._attributeComputeMap.set(i,n),[2]}}))}))})))]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}}))}))},t.prototype._bindDDEvaluators=function(t,e){return n(this,void 0,void 0,(function(){var i,n,o,a=this;return r(this,(function(r){switch(r.label){case 0:return this._attributeComputeMap.clear(),t.length>f.definitions.DOT_DENSITY_MAX_FIELDS&&g.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+f.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+t.length),[4,p.all(t.map((function(t){return a._createNormalizedFunction(t,e)})))];case 1:for(i=r.sent().map((function(t){return b(0,t)})),n=0;n<f.definitions.DOT_DENSITY_MAX_FIELDS;n++)(o=n<t.length&&i[n])?this._attributeComputeMap.set(n,o):this._attributeComputeMap.has(n)&&this._attributeComputeMap.delete(n);return[2]}}))}))},t.prototype._createGetValueFunction=function(t,e){return n(this,void 0,void 0,(function(){var i,n,o,a,s,u,l;return r(this,(function(r){switch(r.label){case 0:return"size"!==t.type?[3,2]:(i=f.getTypeOfSizeVisualVariable(t))===f.enums.WGLVVFlag.SIZE_SCALE_STOPS?[2,null]:(n=i===f.enums.WGLVVFlag.SIZE_UNIT_VALUE,o=n&&function(e){return _.getVisualVariableSizeValueRepresentationRatio(e,t.valueRepresentation)},a=b,s=[f.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(t,e,o)]);case 1:return[2,a.apply(void 0,s.concat([r.sent()]))];case 2:return u=b,l=[f.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(t,e)];case 3:return[2,u.apply(void 0,l.concat([r.sent()]))]}}))}))},t.prototype._createNormalizedFunction=function(t,e,i){return n(this,void 0,void 0,(function(){var n,a,s;return r(this,(function(r){switch(r.label){case 0:return(n=t.field)?"string"==typeof n?(a=t.normalizationField)?[2,function(t){if(t.attributes[n]&&t.attributes[a]){var e=t.attributes[n]/t.attributes[a];return i?i(e):e}}]:[2,i?function(t){return i(t.attributes[n])}:function(t){return t.attributes[n]}]:(g.error(new o("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof n)),[2,function(t){}]):t.valueExpression?(this._hasScaleExpr=this._hasScaleExpr||-1!==t.valueExpression.indexOf("scale"),[4,c.createVVExpression(t.valueExpression,e.spatialReference,e.fields)]):[3,2];case 1:return s=r.sent(),[2,y.callWithOptimizedFeature.bind(null,s)];case 2:return g.error("Unable to create a normalized function for visual variable: "+t),[2,function(t){}]}}))}))},t}();e.default=T}.apply(null,r))||(t.exports=n)},649:function(t,e,i){var r;void 0===(r=function(){"use strict";function t(i,r,n,o,a){for(;o>n;){if(o-n>600){var s=o-n+1,u=r-n+1,l=Math.log(s),p=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*p*(s-p)/s)*(u-s/2<0?-1:1);t(i,r,Math.max(n,Math.floor(r-u*p/s+h)),Math.min(o,Math.floor(r+(s-u)*p/s+h)),a)}var c=i[r],d=n,f=o;for(e(i,n,r),a(i[o],c)>0&&e(i,n,o);d<f;){for(e(i,d,f),d++,f--;a(i[d],c)<0;)d++;for(;a(i[f],c)>0;)f--}0===a(i[n],c)?e(i,n,f):e(i,++f,o),f<=r&&(n=f+1),r<=f&&(o=f-1)}}function e(t,e,i){var r=t[e];t[e]=t[i],t[i]=r}function i(t,e){return t<e?-1:t>e?1:0}return function(e,r,n,o,a){t(e,r,n||0,o||e.length-1,a||i)}}.apply(null,[]))||(t.exports=r)},656:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(97),i(30),i(170),i(291),i(91)],void 0===(n=function(t,e,i,r,n,o,a){function s(t,e){var i=t.bounds,r=e.bounds;return t.key.id!==e.key.id&&t.key.world===e.key.world&&i[0]<=r[0]&&i[1]<=r[1]&&i[2]>=r[2]&&i[3]>=r[3]}Object.defineProperty(e,"__esModule",{value:!0}),e.isParentOf=s,e.isChildOf=function(t,e){return s(e,t)};var u=function(){function t(t,e){this.bounds=n.create(),this.key=new a(0,0,0,0),this.objectIds=new Set,this.key.set(e);var i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level,this.needsClear=!0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extent",{get:function(){return r.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this.tileInfoView,this.id)},t.prototype.createChildTiles=function(){for(var e=this.key.getChildKeys(),r=i.acquire(),n=0;n<e.length;n++)r[n]=new t(this.tileInfoView,e[n]);return r},t.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},t}();e.Tile=u,e.default=u}.apply(null,r))||(t.exports=n)},667:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(60)],void 0===(n=function(t,e,i){var r=function(){function t(t,e){void 0===t&&(t=50),void 0===e&&(e=50),this._pool=new i(Map,!1,(function(t){return t.clear()}),e,t)}return t.prototype.acquire=function(){return this._pool.acquire()},t.prototype.release=function(t){this._pool.release(t)},t.acquire=function(){return n.acquire()},t.release=function(t){return n.release(t)},t}(),n=new r(100);return r}.apply(null,r))||(t.exports=n)},668:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(18),i(0),i(50),i(15),i(630),i(656),i(186),i(91)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l){Object.defineProperty(e,"__esModule",{value:!0});var p={added:[],removed:[]},h=new Set,c=new l(0,0,0,0),d=function(t){function e(e){var i=t.call(this)||this;return i._tiles=new Map,i._index=a(9,o("csp-restrictions")?function(t){return{minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),i.tiles=[],i.tileScheme=e,i}return i(e,t),e.prototype.destroy=function(){this._tiles.clear()},e.prototype.has=function(t){return this._tiles.has(t)},e.prototype.get=function(t){return this._tiles.get(t)},e.prototype.findByKey=function(t){return this._tiles.get(t.id)},e.prototype.intersections=function(t,e){var i="string"==typeof t?this.get(t):t;if(!i)return[];for(var r=e*i.resolution,n=i.bounds[0]-r,o=i.bounds[1]-r,a=i.bounds[2]+r,s=i.bounds[3]+r,u=[],l=0,p=this._index.search({minX:n,minY:o,maxX:a,maxY:s});l<p.length;l++){var h=p[l],c=h.bounds.slice();c[0]=Math.max(c[0],n),c[1]=Math.max(c[1],o),c[2]=Math.min(c[2],a),c[3]=Math.min(c[3],s),c[2]-c[0]>0&&c[3]-c[1]>0&&u.push({bounds:c,tile:h})}return u},e.prototype.boundsIntersections=function(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})},e.prototype.setViewState=function(t){var e=this.tileScheme.getTileCoverage(t,0);if(e){var i=e.spans,r=e.lodInfo,n=r.level;if(i.length>0)for(var o=0,a=i;o<a.length;o++)for(var l=a[o],d=l.row,f=l.colFrom,y=l.colTo,v=f;v<=y;v++){var _=c.set(n,d,r.normalizeCol(v),r.getWorldForColumn(v)).id;if(h.add(_),!this.has(_)){var g=new s.default(this.tileScheme,_);this._tiles.set(_,g),this._index.insert(g),this.tiles.push(g),p.added.push(g)}}for(var m=this.tiles.length-1;m>=0;m--){g=this.tiles[m];h.has(g.id)||(this._tiles.delete(g.id),this.tiles.splice(m,1),this._index.remove(g),p.removed.push(g))}(p.added.length||p.removed.length)&&this.emit("update",p),u.pool.release(e),h.clear(),p.added.length=0,p.removed.length=0}},e}(n);e.default=d}.apply(null,r))||(t.exports=n)},669:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(6),i(8),i(18),i(7),i(4),i(4),i(170),i(561)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l){Object.defineProperty(e,"__esModule",{value:!0});var p=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._rendererInfo=new l.WGLRendererInfo,r.attributeView=new l.AttributeStoreView,r}return n(e,t),e.prototype.destroy=function(){this.removeAllChildren(),this.children.forEach((function(t){return t.destroy()})),this.attributeView.destroy()},e.prototype.whenAttached=function(){var t=this;return this.attached?a.resolve():a.create((function(e){return t.once("attached",(function(){return e()}))}))},e.prototype.setRendererInfo=function(t,e,i){this._rendererInfo.setInfo(t,e,i),this.requestRender()},e.prototype.getMaterialItems=function(t,e){return r(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:return t&&0!==t.length?[4,this.whenAttached()]:[2,null];case 1:return i.sent(),r=this.stage.painter.textureManager,n=t.map((function(t){return r.rasterizeItem(t.symbol,t.glyphIds,e)})),[4,s.all(n)];case 2:return o=i.sent(),[2,o.map((function(e,i){return{id:t[i].id,mosaicItem:e}}))]}}))}))},e.prototype.onTileData=function(t,e){if(e.addOrUpdate&&"tileDisplayData"in e.addOrUpdate)t.setData(e,this.hasLabels,this.labelsVisible);else{var i=e.addOrUpdate&&l.TileData.decode(e.addOrUpdate),r=o({},e,{addOrUpdate:i});t.setData(r,this.hasLabels,this.labelsVisible)}this.contains(t)||this.addChild(t),this.requestRender()},e.prototype.onTileError=function(t){t.clear(),this.contains(t)||this.addChild(t)},e.prototype.renderChildren=function(e){this._rendererInfo.update(e.state),this.attributeView.bindTextures(this.stage.context),t.prototype.renderChildren.call(this,e)},e.prototype.createTile=function(t){var e=this._tileInfoView.getTileBounds(u.create(),t);return new l.WGLTile(t,e)},e.prototype.destroyTile=function(t){this.removeChild(t),t.destroy()},e.prototype.attach=function(){return this._initializeExtensions(),t.prototype.attach.call(this)},e.prototype.createRenderParams=function(e){return o({},t.prototype.createRenderParams.call(this,e),{rendererInfo:this._rendererInfo,attributeView:this.attributeView})},e.prototype._initializeExtensions=function(){var t=this.stage.context.capabilities;t.textureFloat,t.vao},e}(l.TileContainer);e.FeatureContainer=p}.apply(null,r))||(t.exports=n)},686:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(7),i(6),i(8),i(10),i(45),i(118),i(177),i(57),i(667),i(16),i(4),i(4),i(19),i(2),i(92),i(170),i(185),i(56),i(38),i(621),i(299),i(300),i(561),i(611),i(648),i(668),i(687),i(688),i(689),i(623),i(691)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,p,h,c,d,f,y,v,_,g,m,b,S,x,T,E,I,M,w,O,A,R,L,z,P,C){function G(t,e,i){if(i.has(t))return i.get(t);var r={tile:e,addedOrModified:[],removed:[]};return i.set(t,r),r}Object.defineProperty(e,"__esModule",{value:!0});var N=function(t){function e(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=t.apply(this,e)||this;return r._tiles=new Map,r._graphicStoreUpdate=!1,r._graphicsSet=new Set,r._matcher=f.resolve(null),r._tileUpdateSet=new Set,r._tilesToUpdate=new Map,r._graphicIdToAbortController=new Map,r._attached=!1,r._highlightIds=new Map,r._updatingGraphicsTimer=null,r.lastUpdateId=-1,r.updateRequested=!1,r.graphicUpdateHandler=r.graphicUpdateHandler.bind(r),r.addOrUpdateGraphic=r.addOrUpdateGraphic.bind(r),r._processAnalyzedGraphics=r._processAnalyzedGraphics.bind(r),r._graphicsChangeHandler=r._graphicsChangeHandler.bind(r),r}return i(e,t),e.prototype.initialize=function(){var t=this;this._tileStore=new A.default(this.view.featuresTilingScheme),this.container=new R.default(this.view.featuresTilingScheme,null),this._attributeStore=new O.default({type:"local",initialize:function(e){return f.resolve(t.container.attributeView.initialize(e))},update:function(e){return u.safeCast(t.container.attributeView.requestUpdate(e))},render:function(){return t.container.requestRender()}});this._graphicStore=new z.default(this.view.featuresTilingScheme,this.view.state.scale,this.uid,this.graphics,(function(e){var i=t._attributeStore.createLocalId(e.uid);t._attributeStore.setData(i,0,0,e.visible?w.FILTER_FLAG_0:0)}),(function(e){t._attributeStore.freeLocalId(e.uid)})),this._graphicProcessingQueue=new L.default({process:this.addOrUpdateGraphic});var e=new M.WGLTemplateStore(this.container.getMaterialItems.bind(this.container),!0),i=this._tileStore.tileScheme.tileInfo;this.renderer&&(this._matcher=M.createMatcher(this.renderer,e,null)),this._meshFactory=new M.WGLMeshFactory(null,this.uid,null,e,null,i),this.watch("renderer",(function(i){i&&(t._matcher=M.createMatcher(t.renderer,e,null))})),this._tileStore.on("update",this._onTileUpdate.bind(this)),this.container.on("attach",(function(){t.graphics.items.length>0&&t._graphicsChangeHandler({target:t.graphics,added:t.graphics.items,removed:[],moved:[]}),t.handles.add(t.graphics.on("change",t._graphicsChangeHandler),"graphics"),t._attached=!0,t.notifyChange("updating")})),this.container.on("detach",(function(){t._graphicProcessingQueue&&t._graphicProcessingQueue.clear()}))},e.prototype.destroy=function(){this._updatingGraphicsTimer&&(clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=null,this.notifyChange("updating")),this.container.dispose(),this._set("graphics",null),this._graphicProcessingQueue&&(this._graphicProcessingQueue.destroy(),this._graphicProcessingQueue=null),this._graphicStore.clear(),this._tileStore.destroy(),this._attributeStore=null},Object.defineProperty(e.prototype,"updating",{get:function(){return!this._attached||null!==this._updatingGraphicsTimer||this._graphicProcessingQueue.updating||this._tileUpdateSet.size>0||this._tilesToUpdate.size>0},enumerable:!0,configurable:!0}),e.prototype.install=function(t){t.addChild(this.container)},e.prototype.uninstall=function(t){t.removeChild(this.container)},e.prototype.hitTest=function(t,e){if(!this.view||!this.view.position)return f.resolve();var i=this.view.toMap(v.createScreenPoint(t,e));return this.searchFeatures(i).then((function(t){return t&&t.length?t[0]:null}))},e.prototype.searchFeatures=function(t,e){var i=this;return void 0===e&&(e=2),f.create((function(r){r(i._graphicStore.hitTest(t.x,t.y,e,i.view.state.resolution,i.view.state.rotation))}))},e.prototype.update=function(t){var e=t.state,i=this.view.featuresTilingScheme.getClosestInfoForScale(e.scale).level;this._graphicStore.updateLevel(i),this._tileStore.setViewState(e),this._graphicStoreUpdate=!0,this.updateRequested=!1},e.prototype.viewChange=function(){this.requestUpdate()},e.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.view.requestUpdate(this))},e.prototype.processUpdate=function(t){this.updateRequested&&(this.updateRequested=!1,this.update(t))},e.prototype.graphicUpdateHandler=function(t){var e=t.graphic,i=t.property,r=t.newValue,n=e;switch(i){case"attributes":break;case"geometry":case"symbol":this._graphicProcessingQueue.push(n,"update");break;case"visible":this._setVisible(n.uid,r),this._attributeStore.sendUpdates()}},e.prototype.addHighlight=function(t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(this._highlightIds.has(r)){var n=this._highlightIds.get(r);this._highlightIds.set(r,n+1)}else this._highlightIds.set(r,1)}this._updateHighlight()},e.prototype.removeHighlight=function(t){for(var e=0,i=t;e<i.length;e++){var r=i[e];if(this._highlightIds.has(r)){var n=this._highlightIds.get(r)-1;0===n?this._highlightIds.delete(r):this._highlightIds.set(r,n)}}this._updateHighlight()},e.prototype._updateHighlight=function(){this._attributeStore.setHighlight(h.keysOfMap(this._highlightIds))},e.prototype._getIntersectingTiles=function(t){var e=this._graphicStore.getBounds(t);return e&&0!==m.width(e)&&0!==m.height(e)?this._tileStore.boundsIntersections(e):[]},e.prototype._updateTile=function(t){var e=this,i=t.tile,r=this._getGraphicsData(i,t.addedOrModified);return u.safeCast(this._processGraphics(i.key,r)).then((function(r){return e._patchTile(i.key,{addOrUpdate:r,remove:t.removed}),r}))},e.prototype._patchTile=function(t,e){if(this._tiles.has(t)){var i=this._tiles.get(t);this.container.onTileData(i,e),this.container.requestRender()}},e.prototype._graphicsChangeHandler=function(t){var e=this;if(!this._graphicStoreUpdate){var i=this.view.state,r=this.view.featuresTilingScheme.getClosestInfoForScale(i.scale).level;this._graphicStore.updateLevel(r),this._tileStore.setViewState(i)}for(var n=t.added,o=t.removed,a=t.moved,s=this._tilesToUpdate,u=[],l=new Array(n.length),p=0;p<n.length;p++){var h=n[p];l[p]=h,this._graphicsSet.add(h),u.push(this.addGraphic(h))}for(var c=0,d=o;c<d.length;c++){var y=d[c];this._abortProcessingGraphic(y.uid);for(var v=0,_=this._getIntersectingTiles(y);v<_.length;v++){var g=_[v];G(g.key.id,g,s).removed.push(this._attributeStore.getLocalId(y.uid))}this._graphicsSet.delete(y),this._graphicStore.remove(y)}for(var m=0,b=a;m<b.length;m++)for(var S=b[m],x=0,T=this._getIntersectingTiles(S);x<T.length;x++){g=T[x];G(g.key.id,g,s).addedOrModified.push(S)}this._flipUpdatingGraphics(),f.all(u).then((function(){for(var t,i=0;i<l.length;i++){t=l[i];for(var r=0,n=e._getIntersectingTiles(t);r<n.length;r++){var o=n[r];G(o.key.id,o,s).addedOrModified.push(t)}}e._graphicStore.updateZ();var a=[];return s.forEach((function(t){return a.push(e._updateTile(t))})),f.all(a).then((function(){s.clear(),e.notifyChange("updating")}))})).catch((function(){s.clear(),e.notifyChange("updating")}))},e.prototype._getSymbolResources=function(t,e){return a(this,void 0,void 0,(function(){var i,r,n,a,s,u,l,p;return o(this,(function(o){switch(o.label){case 0:return this.container.attached?(i=d.isSome(t.symbol)?t.symbol:null)?[3,3]:this.renderer?[4,this.renderer.getSymbolAsync(t,{scale:this.view.scale})]:[3,2]:[2,f.resolve(null)];case 1:return i=o.sent(),[3,3];case 2:i=this._getNullSymbol(t),o.label=3;case 3:return[4,E.expandSymbol(i,e)];case 4:if(i=o.sent(),r=[],"text"===i.type){for(n=new Set,s=(a=i).text,u=0;u<s.length;u++)n.add(s.charCodeAt(u));l=[],n.forEach((function(t){return l.push(t)})),r.push({symbol:a.toJSON(),id:0,glyphIds:l})}else r.push({symbol:i.toJSON(),id:t.uid,glyphIds:null});return[4,this.container.getMaterialItems(r,e).then((function(t){return t&&t.length>0?t[0].mosaicItem:null}))];case 5:return p=o.sent(),[2,{symbol:i,mosaicItem:p}]}}))}))},e.prototype._projectAndNormalizeGeometry=function(t){return a(this,void 0,void 0,(function(){var e,i,r,n=this;return o(this,(function(o){return d.isNone(t.geometry)?[2,f.resolve(null)]:(e=t.geometry,S.isPolygon(e)?(i=e.rings,e.rings=i):S.isPolyline(e)?(r=e.paths,e.paths=r):S.isExtent(e)&&(e=g.fromExtent(e)),[2,T.checkProjectionSupport(e.spatialReference,this.view.spatialReference).then((function(){var t=P.normalizeCentralMeridian(e),i=T.project(t,e.spatialReference,n.view.spatialReference);return b.closeRingsAndFixWinding(i),i}))])}))}))},e.prototype._onTileUpdate=function(t){var e=x.getInfo(this.view.spatialReference);if(t.added&&t.added.length>0)for(var i=0,r=t.added;i<r.length;i++){var n=r[i];this._addNewTile(n,e)}if(t.removed&&t.removed.length>0)for(var o=0,a=t.removed;o<a.length;o++){var s=a[o];this._removeTile(s.key)}},e.prototype.addOrUpdateGraphic=function(t,e,i){return this._addOrUpdateGraphic(t,e,i)},e.prototype.addGraphic=function(t){var e=this;this._abortProcessingGraphic(t.uid);var i=y.createAbortController();this._graphicIdToAbortController.set(t.uid,i);var r={signal:i.signal};return this._addOrUpdateGraphic(t,"add",r).then((function(){e._graphicIdToAbortController.delete(t.uid)})).catch((function(i){if(e._graphicIdToAbortController.delete(t.uid),!f.isAbortError(i))throw i}))},e.prototype._addOrUpdateGraphic=function(t,e,i){var r=this,n=this._projectAndNormalizeGeometry(t),o=this._getSymbolResources(t,i);return f.all([n,o]).then((function(n){var o=n[0],a=n[1];return"add"===e?r._addProjectedGraphic(t,a,o):r._updateGraphic(t,a,o,i)}))},e.prototype._addProjectedGraphic=function(t,e,i){this._graphicsSet.has(t)&&this._graphicStore.add(t,e,i)},e.prototype._updateGraphic=function(t,e,i,r){var n=this;if(!this._graphicStore.has(t)||f.isAborted(r))return f.resolve();for(var o=this._graphicStore.update(t,e,i),a=o.oldBounds,s=o.newBounds,l=0===m.width(a)&&0===m.height(a),p=0===m.width(s)&&0===m.height(s),h=l?[]:this._tileStore.boundsIntersections(a),d=p?[]:this._tileStore.boundsIntersections(s),y=c.acquire(),v=0,_=h;v<_.length;v++){var g=_[v];y.set(g.key,{addOrUpdate:null,remove:[this._attributeStore.getLocalId(t.uid)]})}for(var b=0,S=d;b<S.length;b++){g=S[b];var x=this._getGraphicData(g,t);if(y.has(g.key)){var T=y.get(g.key);T.remove.length=0,T.addOrUpdate=x}else y.set(g.key,{addOrUpdate:x,remove:null})}var E=[];return y.forEach((function(t,e){var i=u.safeCast(n._processGraphics(e,t.addOrUpdate,r)).then((function(i){n._patchTile(e,{addOrUpdate:i,remove:t.remove})}));E.push(i)})),c.release(y),f.all(E).then((function(){}))},e.prototype._addTile=function(t,e){var i=m.create();this.view.featuresTilingScheme.getTileBounds(i,t);var r=new M.WGLTile(t,i,!0),n={clear:!0,addOrUpdate:e,remove:[]};this._tiles.set(t,r),this.container.addChild(r),r.setData(n,!1,!1)},e.prototype._addNewTile=function(t,e){var i=this,r=this._graphicStore.queryTileData(t);if(e)for(var n=Math.round((e.valid[1]-e.valid[0])/t.resolution),o=0,a=r;o<a.length;o++){var s=a[o];s.geometry&&S.isPoint(s.geometry)&&this._wrapPoints(s,n)}var u=t.key;this._tileUpdateSet.add(t.key),this.notifyChange("updating"),this._processGraphics(u,r).then((function(t){i._addTile(u,t),i._tileUpdateSet.delete(u),i.notifyChange("updating")})).catch((function(t){if(i._tileUpdateSet.delete(u),i.notifyChange("updating"),!f.isAbortError(t))throw t}))},e.prototype._removeTile=function(t){if(this._tiles.has(t)){var e=this._tiles.get(t);this.container.removeChild(e),e.destroy(),this._tiles.delete(t)}},e.prototype._setVisible=function(t,e){var i=this._attributeStore.getLocalId(t);this._attributeStore.setData(i,0,0,e?w.FILTER_FLAG_0:0)},e.prototype._getGraphicsData=function(t,e){var i=x.getInfo(this.view.spatialReference),r=this._graphicStore.getGraphicsData(t,e);if(i)for(var n=Math.round((i.valid[1]-i.valid[0])/t.resolution),o=0,a=r;o<a.length;o++){var s=a[o];s.geometry&&S.isPoint(s.geometry)&&this._wrapPoints(s,n)}return r.sort((function(t,e){return t.insertAfter-e.insertAfter})),r},e.prototype._getGraphicData=function(t,e){var i=this._graphicStore.getGraphicData(t,e),r=[i],n=x.getInfo(this.view.spatialReference);if(n){var o=Math.round((n.valid[1]-n.valid[0])/t.resolution);i.geometry&&S.isPoint(i.geometry)&&this._wrapPoints(i,o)}return r},e.prototype._wrapPoints=function(t,e){var i=t.geometry;512===e?i.x<20?t.geometry={points:[[i.x,i.y],[e,0]]}:i.x>492&&(t.geometry={points:[[i.x,i.y],[-e,0]]}):i.x<-20?t.geometry={points:[[i.x,i.y],[e,0]]}:i.x>532&&(t.geometry={points:[[i.x,i.y],[-e,0]]})},e.prototype._processGraphics=function(t,e,i){return a(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return e&&e.length&&this._meshFactory?(r=this._meshFactory,[4,u.safeCast(this._matcher.then((function(t){return r.analyze(e,!0,t,null,null,i)})))]):[2,null];case 1:return n=o.sent(),this._attributeStore.sendUpdates(),[2,this._processAnalyzedGraphics(t,n)]}}))}))},e.prototype._processAnalyzedGraphics=function(t,e){for(var i=this._meshFactory,r=i.createMeshData(e.length),n=this._attributeStore,o=0,a=e;o<a.length;o++){var s=a[o];s.insertAfter=-1===s.insertAfter?-1:n.getLocalId(s.insertAfter),s.localId=n.getLocalId(s.attributes[this.uid]),i.write(r,s,null,null,t.level)}return M.TileData.fromMeshData(r)},e.prototype._abortProcessingGraphic=function(t){this._graphicIdToAbortController.has(t)&&this._graphicIdToAbortController.get(t).abort()},e.prototype._getNullSymbol=function(t){var e=t.geometry;return S.isPolyline(e)?I.errorPolylineSymbol2D:S.isPolygon(e)||S.isExtent(e)?I.errorPolygonSymbol2D:I.errorPointSymbol2D},e.prototype._flipUpdatingGraphics=function(){var t=this;this._updatingGraphicsTimer&&clearTimeout(this._updatingGraphicsTimer),this._updatingGraphicsTimer=setTimeout((function(){t._updatingGraphicsTimer=null,t.notifyChange("updating")}),160),this.notifyChange("updating")},r([_.property()],e.prototype,"_graphicProcessingQueue",void 0),r([_.property({constructOnly:!0})],e.prototype,"graphics",void 0),r([_.property({dependsOn:["_graphicProcessingQueue.updating"]})],e.prototype,"updating",null),r([_.property()],e.prototype,"view",void 0),r([_.property()],e.prototype,"updateRequested",void 0),r([_.subclass("esri.views.2d.layers.support.GraphicsView2D")],e)}(_.declared(C.GraphicsView(l.HandleOwnerMixin(p.IdentifiableMixin(s)))));e.default=N}.apply(null,r))||(t.exports=n)},687:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(7),i(18),i(6),i(8),i(669)],void 0===(n=function(t,e,i,r,n,o,a){Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"hasLabels",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelsVisible",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype._renderGraphics=function(t,e){for(var i=0,r=this.children;i<r.length;i++){var n=r[i];n.isReady&&n.hasData&&(n.commitChanges(t),t.context.setStencilFunction(514,n.stencilRef,255),n._displayList.replay(t,n,e))}},e.prototype.renderChildren=function(e){var i=e.painter;if(this.children.some((function(t){return t.hasData}))){t.prototype.renderChildren.call(this,e),this._renderGraphics(e);var r=i.effects.highlight;r.bind(e),this._renderGraphics(e,r.defines),r.draw(e),r.unbind(e)}},e}(a.FeatureContainer);e.default=s}.apply(null,r))||(t.exports=n)},688:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(10),i(4),i(32),i(2)],void 0===(n=function(t,e,i,r,n,o,a,s){Object.defineProperty(e,"__esModule",{value:!0});var u=function(t){function e(e){var i=t.call(this,e)||this;return i._queue=new Map,i._queueArray=[],i._onGoingGraphic=null,i._onGoingPromise=null,i._scheduledNextHandle=null,i._next=i._next.bind(i),i._finalize=i._finalize.bind(i),i}return i(e,t),Object.defineProperty(e.prototype,"length",{get:function(){return this._queueArray.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this._queueArray.length>0||null!==this._onGoingPromise},enumerable:!0,configurable:!0}),e.prototype.cancel=function(t){if(this._onGoingGraphic&&this._onGoingGraphic.graphic===t&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._queue.has(t)){var e=this._queue.get(t);this._queue.delete(t);var i=this._queueArray.indexOf(e);this._queueArray.slice(i,1)}this._scheduleNext(),this.notifyChange("updating")},e.prototype.clear=function(){this._queue.clear(),this._queueArray.length=0,this._onGoingPromise&&(this._ongoingAbortController.abort(),this._onGoingGraphic=this._onGoingPromise=null),this._cancelNext(),this.notifyChange("updating")},e.prototype.has=function(t){return this._queue.has(t)},e.prototype.isOngoing=function(t){return this._onGoingGraphic&&this._onGoingGraphic.graphic===t},e.prototype.push=function(t,e){if(!this._queue.has(t)){var i={graphic:t,addOrUpdate:e};this._queueArray.push(i),this._queue.set(t,i),this._scheduleNext(),this.notifyChange("updating")}},e.prototype.refresh=function(){this.reset()},e.prototype.reset=function(){var t=this._onGoingGraphic;if(t){var e=t.graphic,i=t.addOrUpdate;this.push(e,i)}},e.prototype._finalize=function(){this._onGoingGraphic=null,this._ongoingAbortController=null,this._onGoingPromise=null,this.notifyChange("updating"),this._scheduleNext()},e.prototype._cancelNext=function(){this._scheduledNextHandle&&(this._scheduledNextHandle.remove(),this._scheduledNextHandle=null)},e.prototype._scheduleNext=function(){this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingGraphic||(this._scheduledNextHandle=a.schedule(this._next))},e.prototype._next=function(){if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingGraphic)this._scheduledNextHandle=null;else{this._scheduledNextHandle=null;var t=this._peek(),e=t.graphic,i=t.addOrUpdate,r=o.createAbortController();this._queue.delete(e),this._onGoingGraphic=t,this._onGoingPromise=this.process(e,i,{signal:r.signal}),this._ongoingAbortController=r,this._onGoingPromise.then(this._finalize,this._finalize),this.notifyChange("updating")}},e.prototype._peek=function(){return 0===this._queueArray.length?null:this._queueArray.pop()},r([s.property({readOnly:!0})],e.prototype,"length",null),r([s.property({readOnly:!0})],e.prototype,"updating",null),r([s.property({constructOnly:!0})],e.prototype,"process",void 0),r([s.subclass("esri.views.2d.layers.graphics.GraphicProcessingQueue")],e)}(s.declared(n));e.default=u}.apply(null,r))||(t.exports=n)},689:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(7),i(15),i(19),i(630),i(170),i(95),i(183),i(56),i(274),i(690),i(623)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l,p,h,c){function d(t,e,i,r,n){return f.minX=e,f.minY=i,f.maxX=r,f.maxY=n,t.search(f)}Object.defineProperty(e,"__esModule",{value:!0});var f={minX:0,minY:0,maxX:0,maxY:0},y=a.create(),v=[],_=function(){function t(t,e,i,n,a,s){this._graphics=n,this._onAdd=a,this._onRemove=s,this._index=o(9,r("csp-restrictions")?function(t){return{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this._itemByGraphic=new Map,this._currentLevel=-1/0,this._tileInfoView=t,this._uidFieldName=i;var u=t.getClosestInfoForScale(e);u&&(this._currentLevel=u.level,this._resolution=this._tileInfoView.getTileResolution(u.level))}return t.prototype.hitTest=function(t,e,i,r,o){t=p.normalizeMapX(t,this._tileInfoView.spatialReference);var h=.5*r*i;y[0]=t-h,y[1]=e-h,y[2]=t+h,y[3]=e+h;var f=.5*r*(i+50),v=d(this._index,t-f,e-f,t+f,e+f);if(!v||0===v.length)return[];for(var _,g={x:t,y:e},m=[],b=0,S=v;b<S.length;b++){var x=S[b];if(x.graphic.visible)switch(l.getJsonType(x.geometry)){case"esriGeometryPoint":var T=x.symbol;if(!T)continue;var E=x.geometry,I=void 0;switch(T.type){case"text":I=c.getTextSymbolBounds(E.x,E.y,T,x.size,this._resolution,o);break;case"cim":I=c.getCIMMarkerBounds(E.x,E.y,T,this._resolution,o);break;default:I=c.getMarkerSymbolBounds(E.x,E.y,T,this._resolution,o)}s.polygonContainsPoint(I,g)&&m.push(x);break;case"esriGeometryPolyline":var M=x.symbol;if(!M)continue;_=1.5*r*window.devicePixelRatio*n.pt2px(M.width),c.isPointOnPolyline(x.geometry,t,e,_)&&m.push(x);break;case"esriGeometryEnvelope":var w=x.geometry,O=a.fromValues(w.xmin,w.ymin,w.xmax,w.ymax);a.intersects(O,y)&&m.push(x);break;case"esriGeometryPolygon":if(s.polygonContainsPoint(x.geometry,g)){m.push(x);break}var A=u.getPolygonExtent(x.geometry);if(Math.abs(A.ymax-A.ymin)<5*r||Math.abs(A.xmax-A.xmin)<5*r){var R=a.fromValues(A.xmin,A.ymin,A.xmax,A.ymax);a.intersects(R,y)&&m.push(x)}break;case"esriGeometryMultipoint":var L=x.symbol;if(!L)continue;for(var z=x.geometry.points,P=void 0,C=0;C<z.length;C++){if("text"===L.type){var G=L;P=c.getTextSymbolBounds(z[C][0],z[C][1],G,x.size,this._resolution,o)}else P=c.getMarkerSymbolBounds(z[C][0],z[C][1],L,this._resolution,o);if(s.polygonContainsPoint(P,g)){m.push(x);break}}}}return m.sort((function(t,e){var i=c.graphicGeometryToNumber(t.graphic),r=c.graphicGeometryToNumber(e.graphic);return i===r?e.zorder-t.zorder:i-r})),m.map((function(t){return t.graphic}))},t.prototype.getGraphicsData=function(t,e){var r=d(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);if(0===r.length||0===e.length)return[];r.sort((function(t,e){return t.zorder-e.zorder})),r[0].insertAfter=-1;for(var n=1;n<r.length;n++)r[n].insertAfter=r[n-1].graphic.uid;r.sort((function(t,e){return t.graphic.uid-e.graphic.uid})),e.sort((function(t,e){return t.uid-e.uid}));for(var o,a=0,s=0,u=[],l={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},p=0,c=e;p<c.length;p++){var f=c[p];for(s=-2;a<r.length;)if(o=r[a],a++,f.uid===o.graphic.uid){s=o.insertAfter;break}if(o.geometry&&-2!==s){var y=o.getGeometryQuantized(l),v=i({},o.graphic.attributes);v[this._uidFieldName]=f.uid,u.push({centroid:h.default.getCentroidQuantized(o,l,this._scale),geometry:y,attributes:v,symbol:o.symbol,insertAfter:s})}}return u},t.prototype.getGraphicData=function(t,e){var r=this._itemByGraphic.get(e);if(!r)return null;var n=d(this._index,t.bounds[0],t.bounds[1],t.bounds[2],t.bounds[3]);n.sort((function(t,e){return t.zorder-e.zorder}));var o=n.indexOf(r),a=0===o||-1===o?-1:n[o-1].graphic.uid,s={originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]},u=r.getGeometryQuantized(s),l=i({},r.graphic.attributes);return l[this._uidFieldName]=e.uid,{centroid:h.default.getCentroidQuantized(r,s,this._scale),geometry:u,attributes:l,symbol:r.symbol,insertAfter:a}},t.prototype.queryTileData=function(t){var e=50*t.resolution,i=a.pad(t.bounds,e,a.create()),r=d(this._index,i[0],i[1],i[2],i[3]),n=[];return this._createTileGraphics(n,r,{originPosition:"upperLeft",scale:[t.resolution,t.resolution],translate:[t.bounds[0],t.bounds[3]]}),n},t.prototype.has=function(t){return this._itemByGraphic.has(t)},t.prototype.getBounds=function(t){return this._itemByGraphic.has(t)?this._itemByGraphic.get(t).bounds:null},t.prototype.add=function(t,e,i){if(t){this._onAdd(t);var r=h.default.acquire(t,e,i,this._resolution,this._scale,this._tileInfoView.spatialReference);return this._itemByGraphic.set(t,r),i&&this._index.insert(r),r.bounds}},t.prototype.remove=function(t){if(this._itemByGraphic.has(t)){this._onRemove(t);var e=this._itemByGraphic.get(t);this._index.remove(e),this._itemByGraphic.delete(t)}},t.prototype.updateZ=function(){for(var t,e,i=this._graphics.items,r=0;r<i.length;r++)e=i[r],(t=this._itemByGraphic.get(e))&&(t.zorder=r)},t.prototype.update=function(t,e,i){var r=this._itemByGraphic.get(t),n=a.clone(r.bounds);return r.size[0]=r.size[1]=0,this._index.remove(r),r.set(t,e,i,this._resolution,this._scale,this._tileInfoView.spatialReference),i&&this._index.insert(r),{oldBounds:n,newBounds:r.bounds}},t.prototype.updateLevel=function(t){var e=this;if(this._currentLevel!==t){this._currentLevel=t;var i=this._tileInfoView.getTileResolution(t);this._resolution=i,this._scale=this._tileInfoView.getTileScale({level:t,row:0,col:0,world:0}),this._index.clear(),v.length=0,this._itemByGraphic.forEach((function(t){t.updateBounds(t.symbol,e._resolution,e._scale,e._tileInfoView.spatialReference),t.geometry&&v.push(t)})),this._index.load(v)}},t.prototype.clear=function(){this._itemByGraphic.clear(),this._index.clear()},t.prototype._createTileGraphics=function(t,e,r){var n=this._uidFieldName;e.sort((function(t,e){return t.zorder-e.zorder}));for(var o,a,s,u,l=0;l<e.length;l++){o=(s=e[l]).graphic,a=s.getGeometryQuantized(r),u=0===l?-1:e[l-1].graphic.uid;var p=i({},s.graphic.attributes);p[n]=o.uid,t.push({centroid:h.default.getCentroidQuantized(s,r,this._scale),geometry:a,attributes:p,symbol:s.symbol,insertAfter:u})}},t}();e.default=_}.apply(null,r))||(t.exports=n)},690:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(16),i(170),i(301),i(56),i(620),i(615),i(612),i(623)],void 0===(n=function(t,e,i,r,n,o,a,s,u,l){function p(t){t.coords.length=0,t.lengths.length=0}Object.defineProperty(e,"__esModule",{value:!0});var h=new u.default,c=new u.default,d=function(){function t(){this.bounds=r.create(),this.graphic=null,this.size=[0,0,0,0]}return t.acquire=function(e,i,r,n,o,a){var s;return void 0===e&&(e=null),0===t._pool.length?s=new t:(s=t._pool.pop(),this._set.delete(s)),s.acquire(e,i,r,n,o,a),s},t.release=function(t){t&&!this._set.has(t)&&(t.release(),this._pool.push(t),this._set.add(t))},t.getCentroidQuantized=function(t,e,r){if(o.isPolygon(t.geometry)){var s=t.symbol;if(i.isNone(s))return null;if(l.isMarkerSymbol(s.type)){var u=n.polygonCentroid(t.geometry);return a.quantizePoint(e,{},{x:u[0],y:u[1]},!1,!1)}}return null},t.prototype.acquire=function(t,e,i,r,n,o){void 0===t&&(t=null),t&&this.set(t,e,i,r,n,o)},t.prototype.release=function(){this.graphic=null,this.symbol=null,this.geometry=null},t.prototype.set=function(t,e,i,r,n,o){this.graphic=t,this.geometry=i,this.symbol=e.symbol,l.getBounds(this.bounds,this.size,e.symbol,i,e.mosaicItem,r,n,o)},t.prototype.updateBounds=function(t,e,i,r){l.getBounds(this.bounds,this.size,t,this.geometry,null,e,i,r)},t.prototype.getGeometryQuantized=function(t){if(o.isPolygon(this.geometry)){var e=this.geometry.rings;if(1===e.length&&2===e[0].length)return a.quantizeGeometry(t,{paths:[[e[0][0],e[0][1]]]})}else if(o.isPolyline(this.geometry))return p(h),p(c),s.convertFromPolyline(h,this.geometry),s.generalizeOptimizedGeometry(c,h,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",t.scale[0]),s.quantizeOptimizedGeometry(h,c,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",t),s.convertToPolyline(h,this.geometry.hasZ,this.geometry.hasM);return a.quantizeGeometry(t,this.geometry)},t._pool=[],t._set=new Set,t}();e.default=d}.apply(null,r))||(t.exports=n)},691:function(t,e,i){var r,n;r=[i.dj.c(t.i),e,i(1),i(0),i(2)],void 0===(n=function(t,e,i,r,n){Object.defineProperty(e,"__esModule",{value:!0}),e.GraphicsView=function(t){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.graphics=null,e.renderer=null,e.view=null,e}return i(e,t),r([n.property()],e.prototype,"graphics",void 0),r([n.property()],e.prototype,"renderer",void 0),r([n.property()],e.prototype,"updating",void 0),r([n.property()],e.prototype,"view",void 0),r([n.subclass("esri.views.layers.GraphicsView")],e)}(n.declared(t))}}.apply(null,r))||(t.exports=n)}}]);